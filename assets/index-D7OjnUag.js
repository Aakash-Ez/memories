(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function lR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Xv={exports:{}},ch={};var A1;function z2(){if(A1)return ch;A1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,o){var l=null;if(o!==void 0&&(l=""+o),i.key!==void 0&&(l=""+i.key),"key"in i){o={};for(var u in i)u!=="key"&&(o[u]=i[u])}else o=i;return i=o.ref,{$$typeof:n,type:r,key:l,ref:i!==void 0?i:null,props:o}}return ch.Fragment=e,ch.jsx=t,ch.jsxs=t,ch}var C1;function F2(){return C1||(C1=1,Xv.exports=z2()),Xv.exports}var S=F2(),Zv={exports:{}},Oe={};var x1;function H2(){if(x1)return Oe;x1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),b=Symbol.iterator;function _(F){return F===null||typeof F!="object"?null:(F=b&&F[b]||F["@@iterator"],typeof F=="function"?F:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,A={};function R(F,se,fe){this.props=F,this.context=se,this.refs=A,this.updater=fe||T}R.prototype.isReactComponent={},R.prototype.setState=function(F,se){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,se,"setState")},R.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function M(){}M.prototype=R.prototype;function j(F,se,fe){this.props=F,this.context=se,this.refs=A,this.updater=fe||T}var Y=j.prototype=new M;Y.constructor=j,x(Y,R.prototype),Y.isPureReactComponent=!0;var $=Array.isArray;function G(){}var I={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function P(F,se,fe){var ye=fe.ref;return{$$typeof:n,type:F,key:se,ref:ye!==void 0?ye:null,props:fe}}function B(F,se){return P(F.type,se,F.props)}function z(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function L(F){var se={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(fe){return se[fe]})}var D=/\/+/g;function ue(F,se){return typeof F=="object"&&F!==null&&F.key!=null?L(""+F.key):se.toString(36)}function ve(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(G,G):(F.status="pending",F.then(function(se){F.status==="pending"&&(F.status="fulfilled",F.value=se)},function(se){F.status==="pending"&&(F.status="rejected",F.reason=se)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function J(F,se,fe,ye,Ie){var Pe=typeof F;(Pe==="undefined"||Pe==="boolean")&&(F=null);var Qe=!1;if(F===null)Qe=!0;else switch(Pe){case"bigint":case"string":case"number":Qe=!0;break;case"object":switch(F.$$typeof){case n:case e:Qe=!0;break;case p:return Qe=F._init,J(Qe(F._payload),se,fe,ye,Ie)}}if(Qe)return Ie=Ie(F),Qe=ye===""?"."+ue(F,0):ye,$(Ie)?(fe="",Qe!=null&&(fe=Qe.replace(D,"$&/")+"/"),J(Ie,se,fe,"",function(aa){return aa})):Ie!=null&&(z(Ie)&&(Ie=B(Ie,fe+(Ie.key==null||F&&F.key===Ie.key?"":(""+Ie.key).replace(D,"$&/")+"/")+Qe)),se.push(Ie)),1;Qe=0;var tn=ye===""?".":ye+":";if($(F))for(var bt=0;bt<F.length;bt++)ye=F[bt],Pe=tn+ue(ye,bt),Qe+=J(ye,se,fe,Pe,Ie);else if(bt=_(F),typeof bt=="function")for(F=bt.call(F),bt=0;!(ye=F.next()).done;)ye=ye.value,Pe=tn+ue(ye,bt++),Qe+=J(ye,se,fe,Pe,Ie);else if(Pe==="object"){if(typeof F.then=="function")return J(ve(F),se,fe,ye,Ie);throw se=String(F),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return Qe}function ne(F,se,fe){if(F==null)return F;var ye=[],Ie=0;return J(F,ye,"","",function(Pe){return se.call(fe,Pe,Ie++)}),ye}function pe(F){if(F._status===-1){var se=F._result;se=se(),se.then(function(fe){(F._status===0||F._status===-1)&&(F._status=1,F._result=fe)},function(fe){(F._status===0||F._status===-1)&&(F._status=2,F._result=fe)}),F._status===-1&&(F._status=0,F._result=se)}if(F._status===1)return F._result.default;throw F._result}var ke=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},Be={map:ne,forEach:function(F,se,fe){ne(F,function(){se.apply(this,arguments)},fe)},count:function(F){var se=0;return ne(F,function(){se++}),se},toArray:function(F){return ne(F,function(se){return se})||[]},only:function(F){if(!z(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return Oe.Activity=g,Oe.Children=Be,Oe.Component=R,Oe.Fragment=t,Oe.Profiler=i,Oe.PureComponent=j,Oe.StrictMode=r,Oe.Suspense=h,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(F){return I.H.useMemoCache(F)}},Oe.cache=function(F){return function(){return F.apply(null,arguments)}},Oe.cacheSignal=function(){return null},Oe.cloneElement=function(F,se,fe){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var ye=x({},F.props),Ie=F.key;if(se!=null)for(Pe in se.key!==void 0&&(Ie=""+se.key),se)!N.call(se,Pe)||Pe==="key"||Pe==="__self"||Pe==="__source"||Pe==="ref"&&se.ref===void 0||(ye[Pe]=se[Pe]);var Pe=arguments.length-2;if(Pe===1)ye.children=fe;else if(1<Pe){for(var Qe=Array(Pe),tn=0;tn<Pe;tn++)Qe[tn]=arguments[tn+2];ye.children=Qe}return P(F.type,Ie,ye)},Oe.createContext=function(F){return F={$$typeof:l,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:o,_context:F},F},Oe.createElement=function(F,se,fe){var ye,Ie={},Pe=null;if(se!=null)for(ye in se.key!==void 0&&(Pe=""+se.key),se)N.call(se,ye)&&ye!=="key"&&ye!=="__self"&&ye!=="__source"&&(Ie[ye]=se[ye]);var Qe=arguments.length-2;if(Qe===1)Ie.children=fe;else if(1<Qe){for(var tn=Array(Qe),bt=0;bt<Qe;bt++)tn[bt]=arguments[bt+2];Ie.children=tn}if(F&&F.defaultProps)for(ye in Qe=F.defaultProps,Qe)Ie[ye]===void 0&&(Ie[ye]=Qe[ye]);return P(F,Pe,Ie)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(F){return{$$typeof:u,render:F}},Oe.isValidElement=z,Oe.lazy=function(F){return{$$typeof:p,_payload:{_status:-1,_result:F},_init:pe}},Oe.memo=function(F,se){return{$$typeof:d,type:F,compare:se===void 0?null:se}},Oe.startTransition=function(F){var se=I.T,fe={};I.T=fe;try{var ye=F(),Ie=I.S;Ie!==null&&Ie(fe,ye),typeof ye=="object"&&ye!==null&&typeof ye.then=="function"&&ye.then(G,ke)}catch(Pe){ke(Pe)}finally{se!==null&&fe.types!==null&&(se.types=fe.types),I.T=se}},Oe.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Oe.use=function(F){return I.H.use(F)},Oe.useActionState=function(F,se,fe){return I.H.useActionState(F,se,fe)},Oe.useCallback=function(F,se){return I.H.useCallback(F,se)},Oe.useContext=function(F){return I.H.useContext(F)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(F,se){return I.H.useDeferredValue(F,se)},Oe.useEffect=function(F,se){return I.H.useEffect(F,se)},Oe.useEffectEvent=function(F){return I.H.useEffectEvent(F)},Oe.useId=function(){return I.H.useId()},Oe.useImperativeHandle=function(F,se,fe){return I.H.useImperativeHandle(F,se,fe)},Oe.useInsertionEffect=function(F,se){return I.H.useInsertionEffect(F,se)},Oe.useLayoutEffect=function(F,se){return I.H.useLayoutEffect(F,se)},Oe.useMemo=function(F,se){return I.H.useMemo(F,se)},Oe.useOptimistic=function(F,se){return I.H.useOptimistic(F,se)},Oe.useReducer=function(F,se,fe){return I.H.useReducer(F,se,fe)},Oe.useRef=function(F){return I.H.useRef(F)},Oe.useState=function(F){return I.H.useState(F)},Oe.useSyncExternalStore=function(F,se,fe){return I.H.useSyncExternalStore(F,se,fe)},Oe.useTransition=function(){return I.H.useTransition()},Oe.version="19.2.4",Oe}var R1;function gf(){return R1||(R1=1,Zv.exports=H2()),Zv.exports}var V=gf();const Xa=lR(V);var eb={exports:{}},uh={},tb={exports:{}},nb={};var k1;function q2(){return k1||(k1=1,(function(n){function e(J,ne){var pe=J.length;J.push(ne);e:for(;0<pe;){var ke=pe-1>>>1,Be=J[ke];if(0<i(Be,ne))J[ke]=ne,J[pe]=Be,pe=ke;else break e}}function t(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var ne=J[0],pe=J.pop();if(pe!==ne){J[0]=pe;e:for(var ke=0,Be=J.length,F=Be>>>1;ke<F;){var se=2*(ke+1)-1,fe=J[se],ye=se+1,Ie=J[ye];if(0>i(fe,pe))ye<Be&&0>i(Ie,fe)?(J[ke]=Ie,J[ye]=pe,ke=ye):(J[ke]=fe,J[se]=pe,ke=se);else if(ye<Be&&0>i(Ie,pe))J[ke]=Ie,J[ye]=pe,ke=ye;else break e}}return ne}function i(J,ne){var pe=J.sortIndex-ne.sortIndex;return pe!==0?pe:J.id-ne.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var h=[],d=[],p=1,g=null,b=3,_=!1,T=!1,x=!1,A=!1,R=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;function Y(J){for(var ne=t(d);ne!==null;){if(ne.callback===null)r(d);else if(ne.startTime<=J)r(d),ne.sortIndex=ne.expirationTime,e(h,ne);else break;ne=t(d)}}function $(J){if(x=!1,Y(J),!T)if(t(h)!==null)T=!0,G||(G=!0,L());else{var ne=t(d);ne!==null&&ve($,ne.startTime-J)}}var G=!1,I=-1,N=5,P=-1;function B(){return A?!0:!(n.unstable_now()-P<N)}function z(){if(A=!1,G){var J=n.unstable_now();P=J;var ne=!0;try{e:{T=!1,x&&(x=!1,M(I),I=-1),_=!0;var pe=b;try{t:{for(Y(J),g=t(h);g!==null&&!(g.expirationTime>J&&B());){var ke=g.callback;if(typeof ke=="function"){g.callback=null,b=g.priorityLevel;var Be=ke(g.expirationTime<=J);if(J=n.unstable_now(),typeof Be=="function"){g.callback=Be,Y(J),ne=!0;break t}g===t(h)&&r(h),Y(J)}else r(h);g=t(h)}if(g!==null)ne=!0;else{var F=t(d);F!==null&&ve($,F.startTime-J),ne=!1}}break e}finally{g=null,b=pe,_=!1}ne=void 0}}finally{ne?L():G=!1}}}var L;if(typeof j=="function")L=function(){j(z)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,ue=D.port2;D.port1.onmessage=z,L=function(){ue.postMessage(null)}}else L=function(){R(z,0)};function ve(J,ne){I=R(function(){J(n.unstable_now())},ne)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(J){switch(b){case 1:case 2:case 3:var ne=3;break;default:ne=b}var pe=b;b=ne;try{return J()}finally{b=pe}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(J,ne){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var pe=b;b=J;try{return ne()}finally{b=pe}},n.unstable_scheduleCallback=function(J,ne,pe){var ke=n.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?ke+pe:ke):pe=ke,J){case 1:var Be=-1;break;case 2:Be=250;break;case 5:Be=1073741823;break;case 4:Be=1e4;break;default:Be=5e3}return Be=pe+Be,J={id:p++,callback:ne,priorityLevel:J,startTime:pe,expirationTime:Be,sortIndex:-1},pe>ke?(J.sortIndex=pe,e(d,J),t(h)===null&&J===t(d)&&(x?(M(I),I=-1):x=!0,ve($,pe-ke))):(J.sortIndex=Be,e(h,J),T||_||(T=!0,G||(G=!0,L()))),J},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(J){var ne=b;return function(){var pe=b;b=ne;try{return J.apply(this,arguments)}finally{b=pe}}}})(nb)),nb}var I1;function $2(){return I1||(I1=1,tb.exports=q2()),tb.exports}var rb={exports:{}},Mn={};var N1;function G2(){if(N1)return Mn;N1=1;var n=gf();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(h,d,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:g==null?null:""+g,children:h,containerInfo:d,implementation:p}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Mn.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,p)},Mn.flushSync=function(h){var d=l.T,p=r.p;try{if(l.T=null,r.p=2,h)return h()}finally{l.T=d,r.p=p,r.d.f()}},Mn.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(h,d))},Mn.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},Mn.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,g=u(p,d.crossOrigin),b=typeof d.integrity=="string"?d.integrity:void 0,_=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?r.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:b,fetchPriority:_}):p==="script"&&r.d.X(h,{crossOrigin:g,integrity:b,fetchPriority:_,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Mn.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);r.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(h)},Mn.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,g=u(p,d.crossOrigin);r.d.L(h,p,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Mn.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);r.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(h)},Mn.requestFormReset=function(h){r.d.r(h)},Mn.unstable_batchedUpdates=function(h,d){return h(d)},Mn.useFormState=function(h,d,p){return l.H.useFormState(h,d,p)},Mn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Mn.version="19.2.4",Mn}var M1;function cR(){if(M1)return rb.exports;M1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),rb.exports=G2(),rb.exports}var O1;function K2(){if(O1)return uh;O1=1;var n=$2(),e=gf(),t=cR();function r(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var a=s,c=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(c=a.return),s=a.return;while(s)}return a.tag===3?c:null}function l(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function u(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function h(s){if(o(s)!==s)throw Error(r(188))}function d(s){var a=s.alternate;if(!a){if(a=o(s),a===null)throw Error(r(188));return a!==s?null:s}for(var c=s,f=a;;){var y=c.return;if(y===null)break;var v=y.alternate;if(v===null){if(f=y.return,f!==null){c=f;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===c)return h(y),s;if(v===f)return h(y),a;v=v.sibling}throw Error(r(188))}if(c.return!==f.return)c=y,f=v;else{for(var w=!1,k=y.child;k;){if(k===c){w=!0,c=y,f=v;break}if(k===f){w=!0,f=y,c=v;break}k=k.sibling}if(!w){for(k=v.child;k;){if(k===c){w=!0,c=v,f=y;break}if(k===f){w=!0,f=v,c=y;break}k=k.sibling}if(!w)throw Error(r(189))}}if(c.alternate!==f)throw Error(r(190))}if(c.tag!==3)throw Error(r(188));return c.stateNode.current===c?s:a}function p(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=p(s),a!==null)return a;s=s.sibling}return null}var g=Object.assign,b=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),j=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),z=Symbol.iterator;function L(s){return s===null||typeof s!="object"?null:(s=z&&s[z]||s["@@iterator"],typeof s=="function"?s:null)}var D=Symbol.for("react.client.reference");function ue(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===D?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case x:return"Fragment";case R:return"Profiler";case A:return"StrictMode";case $:return"Suspense";case G:return"SuspenseList";case P:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case T:return"Portal";case j:return s.displayName||"Context";case M:return(s._context.displayName||"Context")+".Consumer";case Y:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case I:return a=s.displayName||null,a!==null?a:ue(s.type)||"Memo";case N:a=s._payload,s=s._init;try{return ue(s(a))}catch{}}return null}var ve=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},ke=[],Be=-1;function F(s){return{current:s}}function se(s){0>Be||(s.current=ke[Be],ke[Be]=null,Be--)}function fe(s,a){Be++,ke[Be]=s.current,s.current=a}var ye=F(null),Ie=F(null),Pe=F(null),Qe=F(null);function tn(s,a){switch(fe(Pe,a),fe(Ie,s),fe(ye,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?Ww(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=Ww(a),s=Qw(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}se(ye),fe(ye,s)}function bt(){se(ye),se(Ie),se(Pe)}function aa(s){s.memoizedState!==null&&fe(Qe,s);var a=ye.current,c=Qw(a,s.type);a!==c&&(fe(Ie,s),fe(ye,c))}function bl(s){Ie.current===s&&(se(ye),se(Ie)),Qe.current===s&&(se(Qe),sh._currentValue=pe)}var _l,El;function hi(s){if(_l===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);_l=a&&a[1]||"",El=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_l+s+El}var su=!1;function la(s,a){if(!s||su)return"";su=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(a){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(ee){var X=ee}Reflect.construct(s,[],oe)}else{try{oe.call()}catch(ee){X=ee}s.call(oe.prototype)}}else{try{throw Error()}catch(ee){X=ee}(oe=s())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(ee){if(ee&&X&&typeof ee.stack=="string")return[ee.stack,X.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),w=v[0],k=v[1];if(w&&k){var U=w.split(`
`),Q=k.split(`
`);for(y=f=0;f<U.length&&!U[f].includes("DetermineComponentFrameRoot");)f++;for(;y<Q.length&&!Q[y].includes("DetermineComponentFrameRoot");)y++;if(f===U.length||y===Q.length)for(f=U.length-1,y=Q.length-1;1<=f&&0<=y&&U[f]!==Q[y];)y--;for(;1<=f&&0<=y;f--,y--)if(U[f]!==Q[y]){if(f!==1||y!==1)do if(f--,y--,0>y||U[f]!==Q[y]){var te=`
`+U[f].replace(" at new "," at ");return s.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",s.displayName)),te}while(1<=f&&0<=y);break}}}finally{su=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?hi(c):""}function ou(s,a){switch(s.tag){case 26:case 27:case 5:return hi(s.type);case 16:return hi("Lazy");case 13:return s.child!==a&&a!==null?hi("Suspense Fallback"):hi("Suspense");case 19:return hi("SuspenseList");case 0:case 15:return la(s.type,!1);case 11:return la(s.type.render,!1);case 1:return la(s.type,!0);case 31:return hi("Activity");default:return""}}function au(s){try{var a="",c=null;do a+=ou(s,c),c=s,s=s.return;while(s);return a}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Bt=Object.prototype.hasOwnProperty,nn=n.unstable_scheduleCallback,Ds=n.unstable_cancelCallback,ey=n.unstable_shouldYield,Vf=n.unstable_requestPaint,Un=n.unstable_now,ca=n.unstable_getCurrentPriorityLevel,lu=n.unstable_ImmediatePriority,cu=n.unstable_UserBlockingPriority,Ls=n.unstable_NormalPriority,ty=n.unstable_LowPriority,jf=n.unstable_IdlePriority,Uf=n.log,Bf=n.unstable_setDisableYieldValue,Hr=null,yn=null;function Tr(s){if(typeof Uf=="function"&&Bf(s),yn&&typeof yn.setStrictMode=="function")try{yn.setStrictMode(Hr,s)}catch{}}var Ot=Math.clz32?Math.clz32:Ff,zf=Math.log,Tl=Math.LN2;function Ff(s){return s>>>=0,s===0?32:31-(zf(s)/Tl|0)|0}var fi=256,ua=262144,zt=4194304;function di(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function pi(s,a,c){var f=s.pendingLanes;if(f===0)return 0;var y=0,v=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var k=f&134217727;return k!==0?(f=k&~v,f!==0?y=di(f):(w&=k,w!==0?y=di(w):c||(c=k&~s,c!==0&&(y=di(c))))):(k=f&~v,k!==0?y=di(k):w!==0?y=di(w):c||(c=f&~s,c!==0&&(y=di(c)))),y===0?0:a!==0&&a!==y&&(a&v)===0&&(v=y&-y,c=a&-a,v>=c||v===32&&(c&4194048)!==0)?a:y}function qr(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function ny(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hf(){var s=zt;return zt<<=1,(zt&62914560)===0&&(zt=4194304),s}function mi(s){for(var a=[],c=0;31>c;c++)a.push(s);return a}function ha(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ry(s,a,c,f,y,v){var w=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var k=s.entanglements,U=s.expirationTimes,Q=s.hiddenUpdates;for(c=w&~c;0<c;){var te=31-Ot(c),oe=1<<te;k[te]=0,U[te]=-1;var X=Q[te];if(X!==null)for(Q[te]=null,te=0;te<X.length;te++){var ee=X[te];ee!==null&&(ee.lane&=-536870913)}c&=~oe}f!==0&&fa(s,f,0),v!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=v&~(w&~a))}function fa(s,a,c){s.pendingLanes|=a,s.suspendedLanes&=~a;var f=31-Ot(a);s.entangledLanes|=a,s.entanglements[f]=s.entanglements[f]|1073741824|c&261930}function uu(s,a){var c=s.entangledLanes|=a;for(s=s.entanglements;c;){var f=31-Ot(c),y=1<<f;y&a|s[f]&a&&(s[f]|=a),c&=~y}}function hu(s,a){var c=a&-a;return c=(c&42)!==0?1:da(c),(c&(s.suspendedLanes|a))!==0?0:c}function da(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ji(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function qf(){var s=ne.p;return s!==0?s:(s=window.event,s===void 0?32:v1(s.type))}function $r(s,a){var c=ne.p;try{return ne.p=s,a()}finally{ne.p=c}}var Gr=Math.random().toString(36).slice(2),Ft="__reactFiber$"+Gr,an="__reactProps$"+Gr,gi="__reactContainer$"+Gr,Sl="__reactEvents$"+Gr,iy="__reactListeners$"+Gr,$f="__reactHandles$"+Gr,Gf="__reactResources$"+Gr,yi="__reactMarker$"+Gr;function wl(s){delete s[Ft],delete s[an],delete s[Sl],delete s[iy],delete s[$f]}function vi(s){var a=s[Ft];if(a)return a;for(var c=s.parentNode;c;){if(a=c[gi]||c[Ft]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(s=n1(s);s!==null;){if(c=s[Ft])return c;s=n1(s)}return a}s=c,c=s.parentNode}return null}function Sr(s){if(s=s[Ft]||s[gi]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function sr(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(r(33))}function bi(s){var a=s[Gf];return a||(a=s[Gf]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Ht(s){s[yi]=!0}var fu=new Set,du={};function _i(s,a){Ei(s,a),Ei(s+"Capture",a)}function Ei(s,a){for(du[s]=a,s=0;s<a.length;s++)fu.add(a[s])}var pu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),mu={},gu={};function Kf(s){return Bt.call(gu,s)?!0:Bt.call(mu,s)?!1:pu.test(s)?gu[s]=!0:(mu[s]=!0,!1)}function Al(s,a,c){if(Kf(a))if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var f=a.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+c)}}function or(s,a,c){if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+c)}}function qt(s,a,c,f){if(f===null)s.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(a,c,""+f)}}function ln(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ps(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function yu(s,a,c){var f=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var y=f.get,v=f.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return y.call(this)},set:function(w){c=""+w,v.call(this,w)}}),Object.defineProperty(s,a,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(w){c=""+w},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function nt(s){if(!s._valueTracker){var a=Ps(s)?"checked":"value";s._valueTracker=yu(s,a,""+s[a])}}function pa(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var c=a.getValue(),f="";return s&&(f=Ps(s)?s.checked?"true":"false":s.value),s=f,s!==c?(a.setValue(s),!0):!1}function Ti(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ma=/[\n"\\]/g;function Wn(s){return s.replace(ma,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Cl(s,a,c,f,y,v,w,k){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),a!=null?w==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+ln(a)):s.value!==""+ln(a)&&(s.value=""+ln(a)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),a!=null?vu(s,w,ln(a)):c!=null?vu(s,w,ln(c)):f!=null&&s.removeAttribute("value"),y==null&&v!=null&&(s.defaultChecked=!!v),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.name=""+ln(k):s.removeAttribute("name")}function Wf(s,a,c,f,y,v,w,k){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),a!=null||c!=null){if(!(v!=="submit"&&v!=="reset"||a!=null)){nt(s);return}c=c!=null?""+ln(c):"",a=a!=null?""+ln(a):c,k||a===s.value||(s.value=a),s.defaultValue=a}f=f??y,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=k?s.checked:!!f,s.defaultChecked=!!f,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),nt(s)}function vu(s,a,c){a==="number"&&Ti(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Vs(s,a,c,f){if(s=s.options,a){a={};for(var y=0;y<c.length;y++)a["$"+c[y]]=!0;for(c=0;c<s.length;c++)y=a.hasOwnProperty("$"+s[c].value),s[c].selected!==y&&(s[c].selected=y),y&&f&&(s[c].defaultSelected=!0)}else{for(c=""+ln(c),a=null,y=0;y<s.length;y++){if(s[y].value===c){s[y].selected=!0,f&&(s[y].defaultSelected=!0);return}a!==null||s[y].disabled||(a=s[y])}a!==null&&(a.selected=!0)}}function Qf(s,a,c){if(a!=null&&(a=""+ln(a),a!==s.value&&(s.value=a),c==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=c!=null?""+ln(c):""}function js(s,a,c,f){if(a==null){if(f!=null){if(c!=null)throw Error(r(92));if(ve(f)){if(1<f.length)throw Error(r(93));f=f[0]}c=f}c==null&&(c=""),a=c}c=ln(a),s.defaultValue=c,f=s.textContent,f===c&&f!==""&&f!==null&&(s.value=f),nt(s)}function Qn(s,a){if(a){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=a;return}}s.textContent=a}var Yf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bu(s,a,c){var f=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":f?s.setProperty(a,c):typeof c!="number"||c===0||Yf.has(a)?a==="float"?s.cssFloat=c:s[a]=(""+c).trim():s[a]=c+"px"}function _u(s,a,c){if(a!=null&&typeof a!="object")throw Error(r(62));if(s=s.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||a!=null&&a.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var y in a)f=a[y],a.hasOwnProperty(y)&&c[y]!==f&&bu(s,y,f)}else for(var v in a)a.hasOwnProperty(v)&&bu(s,v,a[v])}function xl(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Us=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Rl(s){return Us.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Kr(){}var Eu=null;function wr(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Bs=null,Si=null;function ga(s){var a=Sr(s);if(a&&(s=a.stateNode)){var c=s[an]||null;e:switch(s=a.stateNode,a.type){case"input":if(Cl(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Wn(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var f=c[a];if(f!==s&&f.form===s.form){var y=f[an]||null;if(!y)throw Error(r(90));Cl(f,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(a=0;a<c.length;a++)f=c[a],f.form===s.form&&pa(f)}break e;case"textarea":Qf(s,c.value,c.defaultValue);break e;case"select":a=c.value,a!=null&&Vs(s,!!c.multiple,a,!1)}}}var kl=!1;function zs(s,a,c){if(kl)return s(a,c);kl=!0;try{var f=s(a);return f}finally{if(kl=!1,(Bs!==null||Si!==null)&&(qd(),Bs&&(a=Bs,s=Si,Si=Bs=null,ga(a),s)))for(a=0;a<s.length;a++)ga(s[a])}}function Wr(s,a){var c=s.stateNode;if(c===null)return null;var f=c[an]||null;if(f===null)return null;c=f[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(r(231,a,typeof c));return c}var Ar=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ya=!1;if(Ar)try{var ot={};Object.defineProperty(ot,"passive",{get:function(){ya=!0}}),window.addEventListener("test",ot,ot),window.removeEventListener("test",ot,ot)}catch{ya=!1}var wi=null,Tu=null,va=null;function Su(){if(va)return va;var s,a=Tu,c=a.length,f,y="value"in wi?wi.value:wi.textContent,v=y.length;for(s=0;s<c&&a[s]===y[s];s++);var w=c-s;for(f=1;f<=w&&a[c-f]===y[v-f];f++);return va=y.slice(s,1<f?1-f:void 0)}function ba(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Xi(){return!0}function Qr(){return!1}function vn(s){function a(c,f,y,v,w){this._reactName=c,this._targetInst=y,this.type=f,this.nativeEvent=v,this.target=w,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(c=s[k],this[k]=c?c(v):v[k]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Xi:Qr,this.isPropagationStopped=Qr,this}return g(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Xi)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Xi)},persist:function(){},isPersistent:Xi}),a}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ai=vn(Zi),Fs=g({},Zi,{view:0,detail:0}),wu=vn(Fs),Hs,Il,Ci,Nl=g({},Fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:qs,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ci&&(Ci&&s.type==="mousemove"?(Hs=s.screenX-Ci.screenX,Il=s.screenY-Ci.screenY):Il=Hs=0,Ci=s),Hs)},movementY:function(s){return"movementY"in s?s.movementY:Il}}),Au=vn(Nl),_a=g({},Nl,{dataTransfer:0}),Xf=vn(_a),Zf=g({},Fs,{relatedTarget:0}),Ea=vn(Zf),Cu=g({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),ed=vn(Cu),Ml=g({},Zi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),td=vn(Ml),nd=g({},Zi,{data:0}),xi=vn(nd),rd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},id={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function od(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=sd[s])?!!a[s]:!1}function qs(){return od}var Bn=g({},Fs,{key:function(s){if(s.key){var a=rd[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=ba(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?id[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:qs,charCode:function(s){return s.type==="keypress"?ba(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ba(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ad=vn(Bn),ld=g({},Nl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),es=vn(ld),m=g({},Fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:qs}),E=vn(m),C=g({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),O=vn(C),K=g({},Nl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Z=vn(K),he=g({},Zi,{newState:0,oldState:0}),De=vn(he),Dt=[9,13,27,32],et=Ar&&"CompositionEvent"in window,_t=null;Ar&&"documentMode"in document&&(_t=document.documentMode);var Cr=Ar&&"TextEvent"in window&&!_t,Ri=Ar&&(!et||_t&&8<_t&&11>=_t),Yr=" ",Jr=!1;function Ta(s,a){switch(s){case"keyup":return Dt.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ol(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Dl=!1;function hD(s,a){switch(s){case"compositionend":return Ol(a);case"keypress":return a.which!==32?null:(Jr=!0,Yr);case"textInput":return s=a.data,s===Yr&&Jr?null:s;default:return null}}function fD(s,a){if(Dl)return s==="compositionend"||!et&&Ta(s,a)?(s=Su(),va=Tu=wi=null,Dl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ri&&a.locale!=="ko"?null:a.data;default:return null}}var dD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sT(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!dD[s.type]:a==="textarea"}function oT(s,a,c,f){Bs?Si?Si.push(f):Si=[f]:Bs=f,a=Jd(a,"onChange"),0<a.length&&(c=new Ai("onChange","change",null,c,f),s.push({event:c,listeners:a}))}var xu=null,Ru=null;function pD(s){Fw(s,0)}function cd(s){var a=sr(s);if(pa(a))return s}function aT(s,a){if(s==="change")return a}var lT=!1;if(Ar){var sy;if(Ar){var oy="oninput"in document;if(!oy){var cT=document.createElement("div");cT.setAttribute("oninput","return;"),oy=typeof cT.oninput=="function"}sy=oy}else sy=!1;lT=sy&&(!document.documentMode||9<document.documentMode)}function uT(){xu&&(xu.detachEvent("onpropertychange",hT),Ru=xu=null)}function hT(s){if(s.propertyName==="value"&&cd(Ru)){var a=[];oT(a,Ru,s,wr(s)),zs(pD,a)}}function mD(s,a,c){s==="focusin"?(uT(),xu=a,Ru=c,xu.attachEvent("onpropertychange",hT)):s==="focusout"&&uT()}function gD(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return cd(Ru)}function yD(s,a){if(s==="click")return cd(a)}function vD(s,a){if(s==="input"||s==="change")return cd(a)}function bD(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var ar=typeof Object.is=="function"?Object.is:bD;function ku(s,a){if(ar(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var c=Object.keys(s),f=Object.keys(a);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var y=c[f];if(!Bt.call(a,y)||!ar(s[y],a[y]))return!1}return!0}function fT(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function dT(s,a){var c=fT(s);s=0;for(var f;c;){if(c.nodeType===3){if(f=s+c.textContent.length,s<=a&&f>=a)return{node:c,offset:a-s};s=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=fT(c)}}function pT(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?pT(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function mT(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Ti(s.document);a instanceof s.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)s=a.contentWindow;else break;a=Ti(s.document)}return a}function ay(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var _D=Ar&&"documentMode"in document&&11>=document.documentMode,Ll=null,ly=null,Iu=null,cy=!1;function gT(s,a,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;cy||Ll==null||Ll!==Ti(f)||(f=Ll,"selectionStart"in f&&ay(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Iu&&ku(Iu,f)||(Iu=f,f=Jd(ly,"onSelect"),0<f.length&&(a=new Ai("onSelect","select",null,a,c),s.push({event:a,listeners:f}),a.target=Ll)))}function Sa(s,a){var c={};return c[s.toLowerCase()]=a.toLowerCase(),c["Webkit"+s]="webkit"+a,c["Moz"+s]="moz"+a,c}var Pl={animationend:Sa("Animation","AnimationEnd"),animationiteration:Sa("Animation","AnimationIteration"),animationstart:Sa("Animation","AnimationStart"),transitionrun:Sa("Transition","TransitionRun"),transitionstart:Sa("Transition","TransitionStart"),transitioncancel:Sa("Transition","TransitionCancel"),transitionend:Sa("Transition","TransitionEnd")},uy={},yT={};Ar&&(yT=document.createElement("div").style,"AnimationEvent"in window||(delete Pl.animationend.animation,delete Pl.animationiteration.animation,delete Pl.animationstart.animation),"TransitionEvent"in window||delete Pl.transitionend.transition);function wa(s){if(uy[s])return uy[s];if(!Pl[s])return s;var a=Pl[s],c;for(c in a)if(a.hasOwnProperty(c)&&c in yT)return uy[s]=a[c];return s}var vT=wa("animationend"),bT=wa("animationiteration"),_T=wa("animationstart"),ED=wa("transitionrun"),TD=wa("transitionstart"),SD=wa("transitioncancel"),ET=wa("transitionend"),TT=new Map,hy="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hy.push("scrollEnd");function Xr(s,a){TT.set(s,a),_i(a,[s])}var ud=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},xr=[],Vl=0,fy=0;function hd(){for(var s=Vl,a=fy=Vl=0;a<s;){var c=xr[a];xr[a++]=null;var f=xr[a];xr[a++]=null;var y=xr[a];xr[a++]=null;var v=xr[a];if(xr[a++]=null,f!==null&&y!==null){var w=f.pending;w===null?y.next=y:(y.next=w.next,w.next=y),f.pending=y}v!==0&&ST(c,y,v)}}function fd(s,a,c,f){xr[Vl++]=s,xr[Vl++]=a,xr[Vl++]=c,xr[Vl++]=f,fy|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function dy(s,a,c,f){return fd(s,a,c,f),dd(s)}function Aa(s,a){return fd(s,null,null,a),dd(s)}function ST(s,a,c){s.lanes|=c;var f=s.alternate;f!==null&&(f.lanes|=c);for(var y=!1,v=s.return;v!==null;)v.childLanes|=c,f=v.alternate,f!==null&&(f.childLanes|=c),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(y=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,y&&a!==null&&(y=31-Ot(c),s=v.hiddenUpdates,f=s[y],f===null?s[y]=[a]:f.push(a),a.lane=c|536870912),v):null}function dd(s){if(50<Xu)throw Xu=0,Tv=null,Error(r(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var jl={};function wD(s,a,c,f){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lr(s,a,c,f){return new wD(s,a,c,f)}function py(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ts(s,a){var c=s.alternate;return c===null?(c=lr(s.tag,a,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=a,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,a=s.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function wT(s,a){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,a=c.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function pd(s,a,c,f,y,v){var w=0;if(f=s,typeof s=="function")py(s)&&(w=1);else if(typeof s=="string")w=k2(s,c,ye.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case P:return s=lr(31,c,a,y),s.elementType=P,s.lanes=v,s;case x:return Ca(c.children,y,v,a);case A:w=8,y|=24;break;case R:return s=lr(12,c,a,y|2),s.elementType=R,s.lanes=v,s;case $:return s=lr(13,c,a,y),s.elementType=$,s.lanes=v,s;case G:return s=lr(19,c,a,y),s.elementType=G,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case j:w=10;break e;case M:w=9;break e;case Y:w=11;break e;case I:w=14;break e;case N:w=16,f=null;break e}w=29,c=Error(r(130,s===null?"null":typeof s,"")),f=null}return a=lr(w,c,a,y),a.elementType=s,a.type=f,a.lanes=v,a}function Ca(s,a,c,f){return s=lr(7,s,f,a),s.lanes=c,s}function my(s,a,c){return s=lr(6,s,null,a),s.lanes=c,s}function AT(s){var a=lr(18,null,null,0);return a.stateNode=s,a}function gy(s,a,c){return a=lr(4,s.children!==null?s.children:[],s.key,a),a.lanes=c,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var CT=new WeakMap;function Rr(s,a){if(typeof s=="object"&&s!==null){var c=CT.get(s);return c!==void 0?c:(a={value:s,source:a,stack:au(a)},CT.set(s,a),a)}return{value:s,source:a,stack:au(a)}}var Ul=[],Bl=0,md=null,Nu=0,kr=[],Ir=0,$s=null,ki=1,Ii="";function ns(s,a){Ul[Bl++]=Nu,Ul[Bl++]=md,md=s,Nu=a}function xT(s,a,c){kr[Ir++]=ki,kr[Ir++]=Ii,kr[Ir++]=$s,$s=s;var f=ki;s=Ii;var y=32-Ot(f)-1;f&=~(1<<y),c+=1;var v=32-Ot(a)+y;if(30<v){var w=y-y%5;v=(f&(1<<w)-1).toString(32),f>>=w,y-=w,ki=1<<32-Ot(a)+y|c<<y|f,Ii=v+s}else ki=1<<v|c<<y|f,Ii=s}function yy(s){s.return!==null&&(ns(s,1),xT(s,1,0))}function vy(s){for(;s===md;)md=Ul[--Bl],Ul[Bl]=null,Nu=Ul[--Bl],Ul[Bl]=null;for(;s===$s;)$s=kr[--Ir],kr[Ir]=null,Ii=kr[--Ir],kr[Ir]=null,ki=kr[--Ir],kr[Ir]=null}function RT(s,a){kr[Ir++]=ki,kr[Ir++]=Ii,kr[Ir++]=$s,ki=a.id,Ii=a.overflow,$s=s}var bn=null,gt=null,We=!1,Gs=null,Nr=!1,by=Error(r(519));function Ks(s){var a=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Mu(Rr(a,s)),by}function kT(s){var a=s.stateNode,c=s.type,f=s.memoizedProps;switch(a[Ft]=s,a[an]=f,c){case"dialog":Fe("cancel",a),Fe("close",a);break;case"iframe":case"object":case"embed":Fe("load",a);break;case"video":case"audio":for(c=0;c<eh.length;c++)Fe(eh[c],a);break;case"source":Fe("error",a);break;case"img":case"image":case"link":Fe("error",a),Fe("load",a);break;case"details":Fe("toggle",a);break;case"input":Fe("invalid",a),Wf(a,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Fe("invalid",a);break;case"textarea":Fe("invalid",a),js(a,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||f.suppressHydrationWarning===!0||Gw(a.textContent,c)?(f.popover!=null&&(Fe("beforetoggle",a),Fe("toggle",a)),f.onScroll!=null&&Fe("scroll",a),f.onScrollEnd!=null&&Fe("scrollend",a),f.onClick!=null&&(a.onclick=Kr),a=!0):a=!1,a||Ks(s,!0)}function IT(s){for(bn=s.return;bn;)switch(bn.tag){case 5:case 31:case 13:Nr=!1;return;case 27:case 3:Nr=!0;return;default:bn=bn.return}}function zl(s){if(s!==bn)return!1;if(!We)return IT(s),We=!0,!1;var a=s.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||Vv(s.type,s.memoizedProps)),c=!c),c&&gt&&Ks(s),IT(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));gt=t1(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));gt=t1(s)}else a===27?(a=gt,ao(s.type)?(s=Fv,Fv=null,gt=s):gt=a):gt=bn?Or(s.stateNode.nextSibling):null;return!0}function xa(){gt=bn=null,We=!1}function _y(){var s=Gs;return s!==null&&(Zn===null?Zn=s:Zn.push.apply(Zn,s),Gs=null),s}function Mu(s){Gs===null?Gs=[s]:Gs.push(s)}var Ey=F(null),Ra=null,rs=null;function Ws(s,a,c){fe(Ey,a._currentValue),a._currentValue=c}function is(s){s._currentValue=Ey.current,se(Ey)}function Ty(s,a,c){for(;s!==null;){var f=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,f!==null&&(f.childLanes|=a)):f!==null&&(f.childLanes&a)!==a&&(f.childLanes|=a),s===c)break;s=s.return}}function Sy(s,a,c,f){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var v=y.dependencies;if(v!==null){var w=y.child;v=v.firstContext;e:for(;v!==null;){var k=v;v=y;for(var U=0;U<a.length;U++)if(k.context===a[U]){v.lanes|=c,k=v.alternate,k!==null&&(k.lanes|=c),Ty(v.return,c,s),f||(w=null);break e}v=k.next}}else if(y.tag===18){if(w=y.return,w===null)throw Error(r(341));w.lanes|=c,v=w.alternate,v!==null&&(v.lanes|=c),Ty(w,c,s),w=null}else w=y.child;if(w!==null)w.return=y;else for(w=y;w!==null;){if(w===s){w=null;break}if(y=w.sibling,y!==null){y.return=w.return,w=y;break}w=w.return}y=w}}function Fl(s,a,c,f){s=null;for(var y=a,v=!1;y!==null;){if(!v){if((y.flags&524288)!==0)v=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var w=y.alternate;if(w===null)throw Error(r(387));if(w=w.memoizedProps,w!==null){var k=y.type;ar(y.pendingProps.value,w.value)||(s!==null?s.push(k):s=[k])}}else if(y===Qe.current){if(w=y.alternate,w===null)throw Error(r(387));w.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(sh):s=[sh])}y=y.return}s!==null&&Sy(a,s,c,f),a.flags|=262144}function gd(s){for(s=s.firstContext;s!==null;){if(!ar(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ka(s){Ra=s,rs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function _n(s){return NT(Ra,s)}function yd(s,a){return Ra===null&&ka(s),NT(s,a)}function NT(s,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},rs===null){if(s===null)throw Error(r(308));rs=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else rs=rs.next=a;return c}var AD=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(c,f){s.push(f)}};this.abort=function(){a.aborted=!0,s.forEach(function(c){return c()})}},CD=n.unstable_scheduleCallback,xD=n.unstable_NormalPriority,$t={$$typeof:j,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wy(){return{controller:new AD,data:new Map,refCount:0}}function Ou(s){s.refCount--,s.refCount===0&&CD(xD,function(){s.controller.abort()})}var Du=null,Ay=0,Hl=0,ql=null;function RD(s,a){if(Du===null){var c=Du=[];Ay=0,Hl=Rv(),ql={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Ay++,a.then(MT,MT),a}function MT(){if(--Ay===0&&Du!==null){ql!==null&&(ql.status="fulfilled");var s=Du;Du=null,Hl=0,ql=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function kD(s,a){var c=[],f={status:"pending",value:null,reason:null,then:function(y){c.push(y)}};return s.then(function(){f.status="fulfilled",f.value=a;for(var y=0;y<c.length;y++)(0,c[y])(a)},function(y){for(f.status="rejected",f.reason=y,y=0;y<c.length;y++)(0,c[y])(void 0)}),f}var OT=J.S;J.S=function(s,a){gw=Un(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&RD(s,a),OT!==null&&OT(s,a)};var Ia=F(null);function Cy(){var s=Ia.current;return s!==null?s:ft.pooledCache}function vd(s,a){a===null?fe(Ia,Ia.current):fe(Ia,a.pool)}function DT(){var s=Cy();return s===null?null:{parent:$t._currentValue,pool:s}}var $l=Error(r(460)),xy=Error(r(474)),bd=Error(r(542)),_d={then:function(){}};function LT(s){return s=s.status,s==="fulfilled"||s==="rejected"}function PT(s,a,c){switch(c=s[c],c===void 0?s.push(a):c!==a&&(a.then(Kr,Kr),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,jT(s),s;default:if(typeof a.status=="string")a.then(Kr,Kr);else{if(s=ft,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=a,s.status="pending",s.then(function(f){if(a.status==="pending"){var y=a;y.status="fulfilled",y.value=f}},function(f){if(a.status==="pending"){var y=a;y.status="rejected",y.reason=f}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,jT(s),s}throw Ma=a,$l}}function Na(s){try{var a=s._init;return a(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Ma=c,$l):c}}var Ma=null;function VT(){if(Ma===null)throw Error(r(459));var s=Ma;return Ma=null,s}function jT(s){if(s===$l||s===bd)throw Error(r(483))}var Gl=null,Lu=0;function Ed(s){var a=Lu;return Lu+=1,Gl===null&&(Gl=[]),PT(Gl,s,a)}function Pu(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function Td(s,a){throw a.$$typeof===b?Error(r(525)):(s=Object.prototype.toString.call(a),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function UT(s){function a(q,H){if(s){var W=q.deletions;W===null?(q.deletions=[H],q.flags|=16):W.push(H)}}function c(q,H){if(!s)return null;for(;H!==null;)a(q,H),H=H.sibling;return null}function f(q){for(var H=new Map;q!==null;)q.key!==null?H.set(q.key,q):H.set(q.index,q),q=q.sibling;return H}function y(q,H){return q=ts(q,H),q.index=0,q.sibling=null,q}function v(q,H,W){return q.index=W,s?(W=q.alternate,W!==null?(W=W.index,W<H?(q.flags|=67108866,H):W):(q.flags|=67108866,H)):(q.flags|=1048576,H)}function w(q){return s&&q.alternate===null&&(q.flags|=67108866),q}function k(q,H,W,re){return H===null||H.tag!==6?(H=my(W,q.mode,re),H.return=q,H):(H=y(H,W),H.return=q,H)}function U(q,H,W,re){var Se=W.type;return Se===x?te(q,H,W.props.children,re,W.key):H!==null&&(H.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===N&&Na(Se)===H.type)?(H=y(H,W.props),Pu(H,W),H.return=q,H):(H=pd(W.type,W.key,W.props,null,q.mode,re),Pu(H,W),H.return=q,H)}function Q(q,H,W,re){return H===null||H.tag!==4||H.stateNode.containerInfo!==W.containerInfo||H.stateNode.implementation!==W.implementation?(H=gy(W,q.mode,re),H.return=q,H):(H=y(H,W.children||[]),H.return=q,H)}function te(q,H,W,re,Se){return H===null||H.tag!==7?(H=Ca(W,q.mode,re,Se),H.return=q,H):(H=y(H,W),H.return=q,H)}function oe(q,H,W){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return H=my(""+H,q.mode,W),H.return=q,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case _:return W=pd(H.type,H.key,H.props,null,q.mode,W),Pu(W,H),W.return=q,W;case T:return H=gy(H,q.mode,W),H.return=q,H;case N:return H=Na(H),oe(q,H,W)}if(ve(H)||L(H))return H=Ca(H,q.mode,W,null),H.return=q,H;if(typeof H.then=="function")return oe(q,Ed(H),W);if(H.$$typeof===j)return oe(q,yd(q,H),W);Td(q,H)}return null}function X(q,H,W,re){var Se=H!==null?H.key:null;if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return Se!==null?null:k(q,H,""+W,re);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case _:return W.key===Se?U(q,H,W,re):null;case T:return W.key===Se?Q(q,H,W,re):null;case N:return W=Na(W),X(q,H,W,re)}if(ve(W)||L(W))return Se!==null?null:te(q,H,W,re,null);if(typeof W.then=="function")return X(q,H,Ed(W),re);if(W.$$typeof===j)return X(q,H,yd(q,W),re);Td(q,W)}return null}function ee(q,H,W,re,Se){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return q=q.get(W)||null,k(H,q,""+re,Se);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case _:return q=q.get(re.key===null?W:re.key)||null,U(H,q,re,Se);case T:return q=q.get(re.key===null?W:re.key)||null,Q(H,q,re,Se);case N:return re=Na(re),ee(q,H,W,re,Se)}if(ve(re)||L(re))return q=q.get(W)||null,te(H,q,re,Se,null);if(typeof re.then=="function")return ee(q,H,W,Ed(re),Se);if(re.$$typeof===j)return ee(q,H,W,yd(H,re),Se);Td(H,re)}return null}function be(q,H,W,re){for(var Se=null,Xe=null,_e=H,Ve=H=0,qe=null;_e!==null&&Ve<W.length;Ve++){_e.index>Ve?(qe=_e,_e=null):qe=_e.sibling;var Ze=X(q,_e,W[Ve],re);if(Ze===null){_e===null&&(_e=qe);break}s&&_e&&Ze.alternate===null&&a(q,_e),H=v(Ze,H,Ve),Xe===null?Se=Ze:Xe.sibling=Ze,Xe=Ze,_e=qe}if(Ve===W.length)return c(q,_e),We&&ns(q,Ve),Se;if(_e===null){for(;Ve<W.length;Ve++)_e=oe(q,W[Ve],re),_e!==null&&(H=v(_e,H,Ve),Xe===null?Se=_e:Xe.sibling=_e,Xe=_e);return We&&ns(q,Ve),Se}for(_e=f(_e);Ve<W.length;Ve++)qe=ee(_e,q,Ve,W[Ve],re),qe!==null&&(s&&qe.alternate!==null&&_e.delete(qe.key===null?Ve:qe.key),H=v(qe,H,Ve),Xe===null?Se=qe:Xe.sibling=qe,Xe=qe);return s&&_e.forEach(function(fo){return a(q,fo)}),We&&ns(q,Ve),Se}function Ce(q,H,W,re){if(W==null)throw Error(r(151));for(var Se=null,Xe=null,_e=H,Ve=H=0,qe=null,Ze=W.next();_e!==null&&!Ze.done;Ve++,Ze=W.next()){_e.index>Ve?(qe=_e,_e=null):qe=_e.sibling;var fo=X(q,_e,Ze.value,re);if(fo===null){_e===null&&(_e=qe);break}s&&_e&&fo.alternate===null&&a(q,_e),H=v(fo,H,Ve),Xe===null?Se=fo:Xe.sibling=fo,Xe=fo,_e=qe}if(Ze.done)return c(q,_e),We&&ns(q,Ve),Se;if(_e===null){for(;!Ze.done;Ve++,Ze=W.next())Ze=oe(q,Ze.value,re),Ze!==null&&(H=v(Ze,H,Ve),Xe===null?Se=Ze:Xe.sibling=Ze,Xe=Ze);return We&&ns(q,Ve),Se}for(_e=f(_e);!Ze.done;Ve++,Ze=W.next())Ze=ee(_e,q,Ve,Ze.value,re),Ze!==null&&(s&&Ze.alternate!==null&&_e.delete(Ze.key===null?Ve:Ze.key),H=v(Ze,H,Ve),Xe===null?Se=Ze:Xe.sibling=Ze,Xe=Ze);return s&&_e.forEach(function(B2){return a(q,B2)}),We&&ns(q,Ve),Se}function ct(q,H,W,re){if(typeof W=="object"&&W!==null&&W.type===x&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case _:e:{for(var Se=W.key;H!==null;){if(H.key===Se){if(Se=W.type,Se===x){if(H.tag===7){c(q,H.sibling),re=y(H,W.props.children),re.return=q,q=re;break e}}else if(H.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===N&&Na(Se)===H.type){c(q,H.sibling),re=y(H,W.props),Pu(re,W),re.return=q,q=re;break e}c(q,H);break}else a(q,H);H=H.sibling}W.type===x?(re=Ca(W.props.children,q.mode,re,W.key),re.return=q,q=re):(re=pd(W.type,W.key,W.props,null,q.mode,re),Pu(re,W),re.return=q,q=re)}return w(q);case T:e:{for(Se=W.key;H!==null;){if(H.key===Se)if(H.tag===4&&H.stateNode.containerInfo===W.containerInfo&&H.stateNode.implementation===W.implementation){c(q,H.sibling),re=y(H,W.children||[]),re.return=q,q=re;break e}else{c(q,H);break}else a(q,H);H=H.sibling}re=gy(W,q.mode,re),re.return=q,q=re}return w(q);case N:return W=Na(W),ct(q,H,W,re)}if(ve(W))return be(q,H,W,re);if(L(W)){if(Se=L(W),typeof Se!="function")throw Error(r(150));return W=Se.call(W),Ce(q,H,W,re)}if(typeof W.then=="function")return ct(q,H,Ed(W),re);if(W.$$typeof===j)return ct(q,H,yd(q,W),re);Td(q,W)}return typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint"?(W=""+W,H!==null&&H.tag===6?(c(q,H.sibling),re=y(H,W),re.return=q,q=re):(c(q,H),re=my(W,q.mode,re),re.return=q,q=re),w(q)):c(q,H)}return function(q,H,W,re){try{Lu=0;var Se=ct(q,H,W,re);return Gl=null,Se}catch(_e){if(_e===$l||_e===bd)throw _e;var Xe=lr(29,_e,null,q.mode);return Xe.lanes=re,Xe.return=q,Xe}}}var Oa=UT(!0),BT=UT(!1),Qs=!1;function Ry(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ky(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ys(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Js(s,a,c){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(tt&2)!==0){var y=f.pending;return y===null?a.next=a:(a.next=y.next,y.next=a),f.pending=a,a=dd(s),ST(s,null,c),a}return fd(s,f,a,c),dd(s)}function Vu(s,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var f=a.lanes;f&=s.pendingLanes,c|=f,a.lanes=c,uu(s,c)}}function Iy(s,a){var c=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var y=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var w={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};v===null?y=v=w:v=v.next=w,c=c.next}while(c!==null);v===null?y=v=a:v=v.next=a}else y=v=a;c={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=a:s.next=a,c.lastBaseUpdate=a}var Ny=!1;function ju(){if(Ny){var s=ql;if(s!==null)throw s}}function Uu(s,a,c,f){Ny=!1;var y=s.updateQueue;Qs=!1;var v=y.firstBaseUpdate,w=y.lastBaseUpdate,k=y.shared.pending;if(k!==null){y.shared.pending=null;var U=k,Q=U.next;U.next=null,w===null?v=Q:w.next=Q,w=U;var te=s.alternate;te!==null&&(te=te.updateQueue,k=te.lastBaseUpdate,k!==w&&(k===null?te.firstBaseUpdate=Q:k.next=Q,te.lastBaseUpdate=U))}if(v!==null){var oe=y.baseState;w=0,te=Q=U=null,k=v;do{var X=k.lane&-536870913,ee=X!==k.lane;if(ee?(He&X)===X:(f&X)===X){X!==0&&X===Hl&&(Ny=!0),te!==null&&(te=te.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var be=s,Ce=k;X=a;var ct=c;switch(Ce.tag){case 1:if(be=Ce.payload,typeof be=="function"){oe=be.call(ct,oe,X);break e}oe=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=Ce.payload,X=typeof be=="function"?be.call(ct,oe,X):be,X==null)break e;oe=g({},oe,X);break e;case 2:Qs=!0}}X=k.callback,X!==null&&(s.flags|=64,ee&&(s.flags|=8192),ee=y.callbacks,ee===null?y.callbacks=[X]:ee.push(X))}else ee={lane:X,tag:k.tag,payload:k.payload,callback:k.callback,next:null},te===null?(Q=te=ee,U=oe):te=te.next=ee,w|=X;if(k=k.next,k===null){if(k=y.shared.pending,k===null)break;ee=k,k=ee.next,ee.next=null,y.lastBaseUpdate=ee,y.shared.pending=null}}while(!0);te===null&&(U=oe),y.baseState=U,y.firstBaseUpdate=Q,y.lastBaseUpdate=te,v===null&&(y.shared.lanes=0),no|=w,s.lanes=w,s.memoizedState=oe}}function zT(s,a){if(typeof s!="function")throw Error(r(191,s));s.call(a)}function FT(s,a){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)zT(c[s],a)}var Kl=F(null),Sd=F(0);function HT(s,a){s=ps,fe(Sd,s),fe(Kl,a),ps=s|a.baseLanes}function My(){fe(Sd,ps),fe(Kl,Kl.current)}function Oy(){ps=Sd.current,se(Kl),se(Sd)}var cr=F(null),Mr=null;function Xs(s){var a=s.alternate;fe(Lt,Lt.current&1),fe(cr,s),Mr===null&&(a===null||Kl.current!==null||a.memoizedState!==null)&&(Mr=s)}function Dy(s){fe(Lt,Lt.current),fe(cr,s),Mr===null&&(Mr=s)}function qT(s){s.tag===22?(fe(Lt,Lt.current),fe(cr,s),Mr===null&&(Mr=s)):Zs()}function Zs(){fe(Lt,Lt.current),fe(cr,cr.current)}function ur(s){se(cr),Mr===s&&(Mr=null),se(Lt)}var Lt=F(0);function wd(s){for(var a=s;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Bv(c)||zv(c)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ss=0,Le=null,at=null,Gt=null,Ad=!1,Wl=!1,Da=!1,Cd=0,Bu=0,Ql=null,ID=0;function Ct(){throw Error(r(321))}function Ly(s,a){if(a===null)return!1;for(var c=0;c<a.length&&c<s.length;c++)if(!ar(s[c],a[c]))return!1;return!0}function Py(s,a,c,f,y,v){return ss=v,Le=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,J.H=s===null||s.memoizedState===null?xS:Jy,Da=!1,v=c(f,y),Da=!1,Wl&&(v=GT(a,c,f,y)),$T(s),v}function $T(s){J.H=Hu;var a=at!==null&&at.next!==null;if(ss=0,Gt=at=Le=null,Ad=!1,Bu=0,Ql=null,a)throw Error(r(300));s===null||Kt||(s=s.dependencies,s!==null&&gd(s)&&(Kt=!0))}function GT(s,a,c,f){Le=s;var y=0;do{if(Wl&&(Ql=null),Bu=0,Wl=!1,25<=y)throw Error(r(301));if(y+=1,Gt=at=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}J.H=RS,v=a(c,f)}while(Wl);return v}function ND(){var s=J.H,a=s.useState()[0];return a=typeof a.then=="function"?zu(a):a,s=s.useState()[0],(at!==null?at.memoizedState:null)!==s&&(Le.flags|=1024),a}function Vy(){var s=Cd!==0;return Cd=0,s}function jy(s,a,c){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~c}function Uy(s){if(Ad){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Ad=!1}ss=0,Gt=at=Le=null,Wl=!1,Bu=Cd=0,Ql=null}function zn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?Le.memoizedState=Gt=s:Gt=Gt.next=s,Gt}function Pt(){if(at===null){var s=Le.alternate;s=s!==null?s.memoizedState:null}else s=at.next;var a=Gt===null?Le.memoizedState:Gt.next;if(a!==null)Gt=a,at=s;else{if(s===null)throw Le.alternate===null?Error(r(467)):Error(r(310));at=s,s={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},Gt===null?Le.memoizedState=Gt=s:Gt=Gt.next=s}return Gt}function xd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zu(s){var a=Bu;return Bu+=1,Ql===null&&(Ql=[]),s=PT(Ql,s,a),a=Le,(Gt===null?a.memoizedState:Gt.next)===null&&(a=a.alternate,J.H=a===null||a.memoizedState===null?xS:Jy),s}function Rd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return zu(s);if(s.$$typeof===j)return _n(s)}throw Error(r(438,String(s)))}function By(s){var a=null,c=Le.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var f=Le.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(a={data:f.data.map(function(y){return y.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=xd(),Le.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(s),f=0;f<s;f++)c[f]=B;return a.index++,c}function as(s,a){return typeof a=="function"?a(s):a}function kd(s){var a=Pt();return zy(a,at,s)}function zy(s,a,c){var f=s.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=c;var y=s.baseQueue,v=f.pending;if(v!==null){if(y!==null){var w=y.next;y.next=v.next,v.next=w}a.baseQueue=y=v,f.pending=null}if(v=s.baseState,y===null)s.memoizedState=v;else{a=y.next;var k=w=null,U=null,Q=a,te=!1;do{var oe=Q.lane&-536870913;if(oe!==Q.lane?(He&oe)===oe:(ss&oe)===oe){var X=Q.revertLane;if(X===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),oe===Hl&&(te=!0);else if((ss&X)===X){Q=Q.next,X===Hl&&(te=!0);continue}else oe={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(k=U=oe,w=v):U=U.next=oe,Le.lanes|=X,no|=X;oe=Q.action,Da&&c(v,oe),v=Q.hasEagerState?Q.eagerState:c(v,oe)}else X={lane:oe,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},U===null?(k=U=X,w=v):U=U.next=X,Le.lanes|=oe,no|=oe;Q=Q.next}while(Q!==null&&Q!==a);if(U===null?w=v:U.next=k,!ar(v,s.memoizedState)&&(Kt=!0,te&&(c=ql,c!==null)))throw c;s.memoizedState=v,s.baseState=w,s.baseQueue=U,f.lastRenderedState=v}return y===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function Fy(s){var a=Pt(),c=a.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=s;var f=c.dispatch,y=c.pending,v=a.memoizedState;if(y!==null){c.pending=null;var w=y=y.next;do v=s(v,w.action),w=w.next;while(w!==y);ar(v,a.memoizedState)||(Kt=!0),a.memoizedState=v,a.baseQueue===null&&(a.baseState=v),c.lastRenderedState=v}return[v,f]}function KT(s,a,c){var f=Le,y=Pt(),v=We;if(v){if(c===void 0)throw Error(r(407));c=c()}else c=a();var w=!ar((at||y).memoizedState,c);if(w&&(y.memoizedState=c,Kt=!0),y=y.queue,$y(YT.bind(null,f,y,s),[s]),y.getSnapshot!==a||w||Gt!==null&&Gt.memoizedState.tag&1){if(f.flags|=2048,Yl(9,{destroy:void 0},QT.bind(null,f,y,c,a),null),ft===null)throw Error(r(349));v||(ss&127)!==0||WT(f,a,c)}return c}function WT(s,a,c){s.flags|=16384,s={getSnapshot:a,value:c},a=Le.updateQueue,a===null?(a=xd(),Le.updateQueue=a,a.stores=[s]):(c=a.stores,c===null?a.stores=[s]:c.push(s))}function QT(s,a,c,f){a.value=c,a.getSnapshot=f,JT(a)&&XT(s)}function YT(s,a,c){return c(function(){JT(a)&&XT(s)})}function JT(s){var a=s.getSnapshot;s=s.value;try{var c=a();return!ar(s,c)}catch{return!0}}function XT(s){var a=Aa(s,2);a!==null&&er(a,s,2)}function Hy(s){var a=zn();if(typeof s=="function"){var c=s;if(s=c(),Da){Tr(!0);try{c()}finally{Tr(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:as,lastRenderedState:s},a}function ZT(s,a,c,f){return s.baseState=c,zy(s,at,typeof f=="function"?f:as)}function MD(s,a,c,f,y){if(Md(s))throw Error(r(485));if(s=a.action,s!==null){var v={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){v.listeners.push(w)}};J.T!==null?c(!0):v.isTransition=!1,f(v),c=a.pending,c===null?(v.next=a.pending=v,eS(a,v)):(v.next=c.next,a.pending=c.next=v)}}function eS(s,a){var c=a.action,f=a.payload,y=s.state;if(a.isTransition){var v=J.T,w={};J.T=w;try{var k=c(y,f),U=J.S;U!==null&&U(w,k),tS(s,a,k)}catch(Q){qy(s,a,Q)}finally{v!==null&&w.types!==null&&(v.types=w.types),J.T=v}}else try{v=c(y,f),tS(s,a,v)}catch(Q){qy(s,a,Q)}}function tS(s,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){nS(s,a,f)},function(f){return qy(s,a,f)}):nS(s,a,c)}function nS(s,a,c){a.status="fulfilled",a.value=c,rS(a),s.state=c,a=s.pending,a!==null&&(c=a.next,c===a?s.pending=null:(c=c.next,a.next=c,eS(s,c)))}function qy(s,a,c){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do a.status="rejected",a.reason=c,rS(a),a=a.next;while(a!==f)}s.action=null}function rS(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function iS(s,a){return a}function sS(s,a){if(We){var c=ft.formState;if(c!==null){e:{var f=Le;if(We){if(gt){t:{for(var y=gt,v=Nr;y.nodeType!==8;){if(!v){y=null;break t}if(y=Or(y.nextSibling),y===null){y=null;break t}}v=y.data,y=v==="F!"||v==="F"?y:null}if(y){gt=Or(y.nextSibling),f=y.data==="F!";break e}}Ks(f)}f=!1}f&&(a=c[0])}}return c=zn(),c.memoizedState=c.baseState=a,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:iS,lastRenderedState:a},c.queue=f,c=wS.bind(null,Le,f),f.dispatch=c,f=Hy(!1),v=Yy.bind(null,Le,!1,f.queue),f=zn(),y={state:a,dispatch:null,action:s,pending:null},f.queue=y,c=MD.bind(null,Le,y,v,c),y.dispatch=c,f.memoizedState=s,[a,c,!1]}function oS(s){var a=Pt();return aS(a,at,s)}function aS(s,a,c){if(a=zy(s,a,iS)[0],s=kd(as)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var f=zu(a)}catch(w){throw w===$l?bd:w}else f=a;a=Pt();var y=a.queue,v=y.dispatch;return c!==a.memoizedState&&(Le.flags|=2048,Yl(9,{destroy:void 0},OD.bind(null,y,c),null)),[f,v,s]}function OD(s,a){s.action=a}function lS(s){var a=Pt(),c=at;if(c!==null)return aS(a,c,s);Pt(),a=a.memoizedState,c=Pt();var f=c.queue.dispatch;return c.memoizedState=s,[a,f,!1]}function Yl(s,a,c,f){return s={tag:s,create:c,deps:f,inst:a,next:null},a=Le.updateQueue,a===null&&(a=xd(),Le.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=s.next=s:(f=c.next,c.next=s,s.next=f,a.lastEffect=s),s}function cS(){return Pt().memoizedState}function Id(s,a,c,f){var y=zn();Le.flags|=s,y.memoizedState=Yl(1|a,{destroy:void 0},c,f===void 0?null:f)}function Nd(s,a,c,f){var y=Pt();f=f===void 0?null:f;var v=y.memoizedState.inst;at!==null&&f!==null&&Ly(f,at.memoizedState.deps)?y.memoizedState=Yl(a,v,c,f):(Le.flags|=s,y.memoizedState=Yl(1|a,v,c,f))}function uS(s,a){Id(8390656,8,s,a)}function $y(s,a){Nd(2048,8,s,a)}function DD(s){Le.flags|=4;var a=Le.updateQueue;if(a===null)a=xd(),Le.updateQueue=a,a.events=[s];else{var c=a.events;c===null?a.events=[s]:c.push(s)}}function hS(s){var a=Pt().memoizedState;return DD({ref:a,nextImpl:s}),function(){if((tt&2)!==0)throw Error(r(440));return a.impl.apply(void 0,arguments)}}function fS(s,a){return Nd(4,2,s,a)}function dS(s,a){return Nd(4,4,s,a)}function pS(s,a){if(typeof a=="function"){s=s();var c=a(s);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function mS(s,a,c){c=c!=null?c.concat([s]):null,Nd(4,4,pS.bind(null,a,s),c)}function Gy(){}function gS(s,a){var c=Pt();a=a===void 0?null:a;var f=c.memoizedState;return a!==null&&Ly(a,f[1])?f[0]:(c.memoizedState=[s,a],s)}function yS(s,a){var c=Pt();a=a===void 0?null:a;var f=c.memoizedState;if(a!==null&&Ly(a,f[1]))return f[0];if(f=s(),Da){Tr(!0);try{s()}finally{Tr(!1)}}return c.memoizedState=[f,a],f}function Ky(s,a,c){return c===void 0||(ss&1073741824)!==0&&(He&261930)===0?s.memoizedState=a:(s.memoizedState=c,s=vw(),Le.lanes|=s,no|=s,c)}function vS(s,a,c,f){return ar(c,a)?c:Kl.current!==null?(s=Ky(s,c,f),ar(s,a)||(Kt=!0),s):(ss&42)===0||(ss&1073741824)!==0&&(He&261930)===0?(Kt=!0,s.memoizedState=c):(s=vw(),Le.lanes|=s,no|=s,a)}function bS(s,a,c,f,y){var v=ne.p;ne.p=v!==0&&8>v?v:8;var w=J.T,k={};J.T=k,Yy(s,!1,a,c);try{var U=y(),Q=J.S;if(Q!==null&&Q(k,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var te=kD(U,f);Fu(s,a,te,dr(s))}else Fu(s,a,f,dr(s))}catch(oe){Fu(s,a,{then:function(){},status:"rejected",reason:oe},dr())}finally{ne.p=v,w!==null&&k.types!==null&&(w.types=k.types),J.T=w}}function LD(){}function Wy(s,a,c,f){if(s.tag!==5)throw Error(r(476));var y=_S(s).queue;bS(s,y,a,pe,c===null?LD:function(){return ES(s),c(f)})}function _S(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:as,lastRenderedState:pe},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:as,lastRenderedState:c},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function ES(s){var a=_S(s);a.next===null&&(a=s.alternate.memoizedState),Fu(s,a.next.queue,{},dr())}function Qy(){return _n(sh)}function TS(){return Pt().memoizedState}function SS(){return Pt().memoizedState}function PD(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var c=dr();s=Ys(c);var f=Js(a,s,c);f!==null&&(er(f,a,c),Vu(f,a,c)),a={cache:wy()},s.payload=a;return}a=a.return}}function VD(s,a,c){var f=dr();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Md(s)?AS(a,c):(c=dy(s,a,c,f),c!==null&&(er(c,s,f),CS(c,a,f)))}function wS(s,a,c){var f=dr();Fu(s,a,c,f)}function Fu(s,a,c,f){var y={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Md(s))AS(a,y);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=a.lastRenderedReducer,v!==null))try{var w=a.lastRenderedState,k=v(w,c);if(y.hasEagerState=!0,y.eagerState=k,ar(k,w))return fd(s,a,y,0),ft===null&&hd(),!1}catch{}if(c=dy(s,a,y,f),c!==null)return er(c,s,f),CS(c,a,f),!0}return!1}function Yy(s,a,c,f){if(f={lane:2,revertLane:Rv(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Md(s)){if(a)throw Error(r(479))}else a=dy(s,c,f,2),a!==null&&er(a,s,2)}function Md(s){var a=s.alternate;return s===Le||a!==null&&a===Le}function AS(s,a){Wl=Ad=!0;var c=s.pending;c===null?a.next=a:(a.next=c.next,c.next=a),s.pending=a}function CS(s,a,c){if((c&4194048)!==0){var f=a.lanes;f&=s.pendingLanes,c|=f,a.lanes=c,uu(s,c)}}var Hu={readContext:_n,use:Rd,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useLayoutEffect:Ct,useInsertionEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useSyncExternalStore:Ct,useId:Ct,useHostTransitionStatus:Ct,useFormState:Ct,useActionState:Ct,useOptimistic:Ct,useMemoCache:Ct,useCacheRefresh:Ct};Hu.useEffectEvent=Ct;var xS={readContext:_n,use:Rd,useCallback:function(s,a){return zn().memoizedState=[s,a===void 0?null:a],s},useContext:_n,useEffect:uS,useImperativeHandle:function(s,a,c){c=c!=null?c.concat([s]):null,Id(4194308,4,pS.bind(null,a,s),c)},useLayoutEffect:function(s,a){return Id(4194308,4,s,a)},useInsertionEffect:function(s,a){Id(4,2,s,a)},useMemo:function(s,a){var c=zn();a=a===void 0?null:a;var f=s();if(Da){Tr(!0);try{s()}finally{Tr(!1)}}return c.memoizedState=[f,a],f},useReducer:function(s,a,c){var f=zn();if(c!==void 0){var y=c(a);if(Da){Tr(!0);try{c(a)}finally{Tr(!1)}}}else y=a;return f.memoizedState=f.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},f.queue=s,s=s.dispatch=VD.bind(null,Le,s),[f.memoizedState,s]},useRef:function(s){var a=zn();return s={current:s},a.memoizedState=s},useState:function(s){s=Hy(s);var a=s.queue,c=wS.bind(null,Le,a);return a.dispatch=c,[s.memoizedState,c]},useDebugValue:Gy,useDeferredValue:function(s,a){var c=zn();return Ky(c,s,a)},useTransition:function(){var s=Hy(!1);return s=bS.bind(null,Le,s.queue,!0,!1),zn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,c){var f=Le,y=zn();if(We){if(c===void 0)throw Error(r(407));c=c()}else{if(c=a(),ft===null)throw Error(r(349));(He&127)!==0||WT(f,a,c)}y.memoizedState=c;var v={value:c,getSnapshot:a};return y.queue=v,uS(YT.bind(null,f,v,s),[s]),f.flags|=2048,Yl(9,{destroy:void 0},QT.bind(null,f,v,c,a),null),c},useId:function(){var s=zn(),a=ft.identifierPrefix;if(We){var c=Ii,f=ki;c=(f&~(1<<32-Ot(f)-1)).toString(32)+c,a="_"+a+"R_"+c,c=Cd++,0<c&&(a+="H"+c.toString(32)),a+="_"}else c=ID++,a="_"+a+"r_"+c.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:Qy,useFormState:sS,useActionState:sS,useOptimistic:function(s){var a=zn();a.memoizedState=a.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=Yy.bind(null,Le,!0,c),c.dispatch=a,[s,a]},useMemoCache:By,useCacheRefresh:function(){return zn().memoizedState=PD.bind(null,Le)},useEffectEvent:function(s){var a=zn(),c={impl:s};return a.memoizedState=c,function(){if((tt&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}},Jy={readContext:_n,use:Rd,useCallback:gS,useContext:_n,useEffect:$y,useImperativeHandle:mS,useInsertionEffect:fS,useLayoutEffect:dS,useMemo:yS,useReducer:kd,useRef:cS,useState:function(){return kd(as)},useDebugValue:Gy,useDeferredValue:function(s,a){var c=Pt();return vS(c,at.memoizedState,s,a)},useTransition:function(){var s=kd(as)[0],a=Pt().memoizedState;return[typeof s=="boolean"?s:zu(s),a]},useSyncExternalStore:KT,useId:TS,useHostTransitionStatus:Qy,useFormState:oS,useActionState:oS,useOptimistic:function(s,a){var c=Pt();return ZT(c,at,s,a)},useMemoCache:By,useCacheRefresh:SS};Jy.useEffectEvent=hS;var RS={readContext:_n,use:Rd,useCallback:gS,useContext:_n,useEffect:$y,useImperativeHandle:mS,useInsertionEffect:fS,useLayoutEffect:dS,useMemo:yS,useReducer:Fy,useRef:cS,useState:function(){return Fy(as)},useDebugValue:Gy,useDeferredValue:function(s,a){var c=Pt();return at===null?Ky(c,s,a):vS(c,at.memoizedState,s,a)},useTransition:function(){var s=Fy(as)[0],a=Pt().memoizedState;return[typeof s=="boolean"?s:zu(s),a]},useSyncExternalStore:KT,useId:TS,useHostTransitionStatus:Qy,useFormState:lS,useActionState:lS,useOptimistic:function(s,a){var c=Pt();return at!==null?ZT(c,at,s,a):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:By,useCacheRefresh:SS};RS.useEffectEvent=hS;function Xy(s,a,c,f){a=s.memoizedState,c=c(f,a),c=c==null?a:g({},a,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Zy={enqueueSetState:function(s,a,c){s=s._reactInternals;var f=dr(),y=Ys(f);y.payload=a,c!=null&&(y.callback=c),a=Js(s,y,f),a!==null&&(er(a,s,f),Vu(a,s,f))},enqueueReplaceState:function(s,a,c){s=s._reactInternals;var f=dr(),y=Ys(f);y.tag=1,y.payload=a,c!=null&&(y.callback=c),a=Js(s,y,f),a!==null&&(er(a,s,f),Vu(a,s,f))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var c=dr(),f=Ys(c);f.tag=2,a!=null&&(f.callback=a),a=Js(s,f,c),a!==null&&(er(a,s,c),Vu(a,s,c))}};function kS(s,a,c,f,y,v,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,v,w):a.prototype&&a.prototype.isPureReactComponent?!ku(c,f)||!ku(y,v):!0}function IS(s,a,c,f){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,f),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,f),a.state!==s&&Zy.enqueueReplaceState(a,a.state,null)}function La(s,a){var c=a;if("ref"in a){c={};for(var f in a)f!=="ref"&&(c[f]=a[f])}if(s=s.defaultProps){c===a&&(c=g({},c));for(var y in s)c[y]===void 0&&(c[y]=s[y])}return c}function NS(s){ud(s)}function MS(s){console.error(s)}function OS(s){ud(s)}function Od(s,a){try{var c=s.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(f){setTimeout(function(){throw f})}}function DS(s,a,c){try{var f=s.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function ev(s,a,c){return c=Ys(c),c.tag=3,c.payload={element:null},c.callback=function(){Od(s,a)},c}function LS(s){return s=Ys(s),s.tag=3,s}function PS(s,a,c,f){var y=c.type.getDerivedStateFromError;if(typeof y=="function"){var v=f.value;s.payload=function(){return y(v)},s.callback=function(){DS(a,c,f)}}var w=c.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){DS(a,c,f),typeof y!="function"&&(ro===null?ro=new Set([this]):ro.add(this));var k=f.stack;this.componentDidCatch(f.value,{componentStack:k!==null?k:""})})}function jD(s,a,c,f,y){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(a=c.alternate,a!==null&&Fl(a,c,y,!0),c=cr.current,c!==null){switch(c.tag){case 31:case 13:return Mr===null?$d():c.alternate===null&&xt===0&&(xt=3),c.flags&=-257,c.flags|=65536,c.lanes=y,f===_d?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([f]):a.add(f),Av(s,f,y)),!1;case 22:return c.flags|=65536,f===_d?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([f]):c.add(f)),Av(s,f,y)),!1}throw Error(r(435,c.tag))}return Av(s,f,y),$d(),!1}if(We)return a=cr.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=y,f!==by&&(s=Error(r(422),{cause:f}),Mu(Rr(s,c)))):(f!==by&&(a=Error(r(423),{cause:f}),Mu(Rr(a,c))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,f=Rr(f,c),y=ev(s.stateNode,f,y),Iy(s,y),xt!==4&&(xt=2)),!1;var v=Error(r(520),{cause:f});if(v=Rr(v,c),Ju===null?Ju=[v]:Ju.push(v),xt!==4&&(xt=2),a===null)return!0;f=Rr(f,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,s=y&-y,c.lanes|=s,s=ev(c.stateNode,f,s),Iy(c,s),!1;case 1:if(a=c.type,v=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ro===null||!ro.has(v))))return c.flags|=65536,y&=-y,c.lanes|=y,y=LS(y),PS(y,s,c,f),Iy(c,y),!1}c=c.return}while(c!==null);return!1}var tv=Error(r(461)),Kt=!1;function En(s,a,c,f){a.child=s===null?BT(a,null,c,f):Oa(a,s.child,c,f)}function VS(s,a,c,f,y){c=c.render;var v=a.ref;if("ref"in f){var w={};for(var k in f)k!=="ref"&&(w[k]=f[k])}else w=f;return ka(a),f=Py(s,a,c,w,v,y),k=Vy(),s!==null&&!Kt?(jy(s,a,y),ls(s,a,y)):(We&&k&&yy(a),a.flags|=1,En(s,a,f,y),a.child)}function jS(s,a,c,f,y){if(s===null){var v=c.type;return typeof v=="function"&&!py(v)&&v.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=v,US(s,a,v,f,y)):(s=pd(c.type,null,f,a,a.mode,y),s.ref=a.ref,s.return=a,a.child=s)}if(v=s.child,!cv(s,y)){var w=v.memoizedProps;if(c=c.compare,c=c!==null?c:ku,c(w,f)&&s.ref===a.ref)return ls(s,a,y)}return a.flags|=1,s=ts(v,f),s.ref=a.ref,s.return=a,a.child=s}function US(s,a,c,f,y){if(s!==null){var v=s.memoizedProps;if(ku(v,f)&&s.ref===a.ref)if(Kt=!1,a.pendingProps=f=v,cv(s,y))(s.flags&131072)!==0&&(Kt=!0);else return a.lanes=s.lanes,ls(s,a,y)}return nv(s,a,c,f,y)}function BS(s,a,c,f){var y=f.children,v=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((a.flags&128)!==0){if(v=v!==null?v.baseLanes|c:c,s!==null){for(f=a.child=s.child,y=0;f!==null;)y=y|f.lanes|f.childLanes,f=f.sibling;f=y&~v}else f=0,a.child=null;return zS(s,a,v,c,f)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&vd(a,v!==null?v.cachePool:null),v!==null?HT(a,v):My(),qT(a);else return f=a.lanes=536870912,zS(s,a,v!==null?v.baseLanes|c:c,c,f)}else v!==null?(vd(a,v.cachePool),HT(a,v),Zs(),a.memoizedState=null):(s!==null&&vd(a,null),My(),Zs());return En(s,a,y,c),a.child}function qu(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function zS(s,a,c,f,y){var v=Cy();return v=v===null?null:{parent:$t._currentValue,pool:v},a.memoizedState={baseLanes:c,cachePool:v},s!==null&&vd(a,null),My(),qT(a),s!==null&&Fl(s,a,f,!0),a.childLanes=y,null}function Dd(s,a){return a=Pd({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function FS(s,a,c){return Oa(a,s.child,null,c),s=Dd(a,a.pendingProps),s.flags|=2,ur(a),a.memoizedState=null,s}function UD(s,a,c){var f=a.pendingProps,y=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(We){if(f.mode==="hidden")return s=Dd(a,f),a.lanes=536870912,qu(null,s);if(Dy(a),(s=gt)?(s=e1(s,Nr),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:$s!==null?{id:ki,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},c=AT(s),c.return=a,a.child=c,bn=a,gt=null)):s=null,s===null)throw Ks(a);return a.lanes=536870912,null}return Dd(a,f)}var v=s.memoizedState;if(v!==null){var w=v.dehydrated;if(Dy(a),y)if(a.flags&256)a.flags&=-257,a=FS(s,a,c);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(r(558));else if(Kt||Fl(s,a,c,!1),y=(c&s.childLanes)!==0,Kt||y){if(f=ft,f!==null&&(w=hu(f,c),w!==0&&w!==v.retryLane))throw v.retryLane=w,Aa(s,w),er(f,s,w),tv;$d(),a=FS(s,a,c)}else s=v.treeContext,gt=Or(w.nextSibling),bn=a,We=!0,Gs=null,Nr=!1,s!==null&&RT(a,s),a=Dd(a,f),a.flags|=4096;return a}return s=ts(s.child,{mode:f.mode,children:f.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Ld(s,a){var c=a.ref;if(c===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(r(284));(s===null||s.ref!==c)&&(a.flags|=4194816)}}function nv(s,a,c,f,y){return ka(a),c=Py(s,a,c,f,void 0,y),f=Vy(),s!==null&&!Kt?(jy(s,a,y),ls(s,a,y)):(We&&f&&yy(a),a.flags|=1,En(s,a,c,y),a.child)}function HS(s,a,c,f,y,v){return ka(a),a.updateQueue=null,c=GT(a,f,c,y),$T(s),f=Vy(),s!==null&&!Kt?(jy(s,a,v),ls(s,a,v)):(We&&f&&yy(a),a.flags|=1,En(s,a,c,v),a.child)}function qS(s,a,c,f,y){if(ka(a),a.stateNode===null){var v=jl,w=c.contextType;typeof w=="object"&&w!==null&&(v=_n(w)),v=new c(f,v),a.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Zy,a.stateNode=v,v._reactInternals=a,v=a.stateNode,v.props=f,v.state=a.memoizedState,v.refs={},Ry(a),w=c.contextType,v.context=typeof w=="object"&&w!==null?_n(w):jl,v.state=a.memoizedState,w=c.getDerivedStateFromProps,typeof w=="function"&&(Xy(a,c,w,f),v.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(w=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),w!==v.state&&Zy.enqueueReplaceState(v,v.state,null),Uu(a,f,v,y),ju(),v.state=a.memoizedState),typeof v.componentDidMount=="function"&&(a.flags|=4194308),f=!0}else if(s===null){v=a.stateNode;var k=a.memoizedProps,U=La(c,k);v.props=U;var Q=v.context,te=c.contextType;w=jl,typeof te=="object"&&te!==null&&(w=_n(te));var oe=c.getDerivedStateFromProps;te=typeof oe=="function"||typeof v.getSnapshotBeforeUpdate=="function",k=a.pendingProps!==k,te||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(k||Q!==w)&&IS(a,v,f,w),Qs=!1;var X=a.memoizedState;v.state=X,Uu(a,f,v,y),ju(),Q=a.memoizedState,k||X!==Q||Qs?(typeof oe=="function"&&(Xy(a,c,oe,f),Q=a.memoizedState),(U=Qs||kS(a,c,U,f,X,Q,w))?(te||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(a.flags|=4194308)):(typeof v.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=f,a.memoizedState=Q),v.props=f,v.state=Q,v.context=w,f=U):(typeof v.componentDidMount=="function"&&(a.flags|=4194308),f=!1)}else{v=a.stateNode,ky(s,a),w=a.memoizedProps,te=La(c,w),v.props=te,oe=a.pendingProps,X=v.context,Q=c.contextType,U=jl,typeof Q=="object"&&Q!==null&&(U=_n(Q)),k=c.getDerivedStateFromProps,(Q=typeof k=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(w!==oe||X!==U)&&IS(a,v,f,U),Qs=!1,X=a.memoizedState,v.state=X,Uu(a,f,v,y),ju();var ee=a.memoizedState;w!==oe||X!==ee||Qs||s!==null&&s.dependencies!==null&&gd(s.dependencies)?(typeof k=="function"&&(Xy(a,c,k,f),ee=a.memoizedState),(te=Qs||kS(a,c,te,f,X,ee,U)||s!==null&&s.dependencies!==null&&gd(s.dependencies))?(Q||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,ee,U),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,ee,U)),typeof v.componentDidUpdate=="function"&&(a.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof v.componentDidUpdate!="function"||w===s.memoizedProps&&X===s.memoizedState||(a.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&X===s.memoizedState||(a.flags|=1024),a.memoizedProps=f,a.memoizedState=ee),v.props=f,v.state=ee,v.context=U,f=te):(typeof v.componentDidUpdate!="function"||w===s.memoizedProps&&X===s.memoizedState||(a.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&X===s.memoizedState||(a.flags|=1024),f=!1)}return v=f,Ld(s,a),f=(a.flags&128)!==0,v||f?(v=a.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:v.render(),a.flags|=1,s!==null&&f?(a.child=Oa(a,s.child,null,y),a.child=Oa(a,null,c,y)):En(s,a,c,y),a.memoizedState=v.state,s=a.child):s=ls(s,a,y),s}function $S(s,a,c,f){return xa(),a.flags|=256,En(s,a,c,f),a.child}var rv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function iv(s){return{baseLanes:s,cachePool:DT()}}function sv(s,a,c){return s=s!==null?s.childLanes&~c:0,a&&(s|=fr),s}function GS(s,a,c){var f=a.pendingProps,y=!1,v=(a.flags&128)!==0,w;if((w=v)||(w=s!==null&&s.memoizedState===null?!1:(Lt.current&2)!==0),w&&(y=!0,a.flags&=-129),w=(a.flags&32)!==0,a.flags&=-33,s===null){if(We){if(y?Xs(a):Zs(),(s=gt)?(s=e1(s,Nr),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:$s!==null?{id:ki,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},c=AT(s),c.return=a,a.child=c,bn=a,gt=null)):s=null,s===null)throw Ks(a);return zv(s)?a.lanes=32:a.lanes=536870912,null}var k=f.children;return f=f.fallback,y?(Zs(),y=a.mode,k=Pd({mode:"hidden",children:k},y),f=Ca(f,y,c,null),k.return=a,f.return=a,k.sibling=f,a.child=k,f=a.child,f.memoizedState=iv(c),f.childLanes=sv(s,w,c),a.memoizedState=rv,qu(null,f)):(Xs(a),ov(a,k))}var U=s.memoizedState;if(U!==null&&(k=U.dehydrated,k!==null)){if(v)a.flags&256?(Xs(a),a.flags&=-257,a=av(s,a,c)):a.memoizedState!==null?(Zs(),a.child=s.child,a.flags|=128,a=null):(Zs(),k=f.fallback,y=a.mode,f=Pd({mode:"visible",children:f.children},y),k=Ca(k,y,c,null),k.flags|=2,f.return=a,k.return=a,f.sibling=k,a.child=f,Oa(a,s.child,null,c),f=a.child,f.memoizedState=iv(c),f.childLanes=sv(s,w,c),a.memoizedState=rv,a=qu(null,f));else if(Xs(a),zv(k)){if(w=k.nextSibling&&k.nextSibling.dataset,w)var Q=w.dgst;w=Q,f=Error(r(419)),f.stack="",f.digest=w,Mu({value:f,source:null,stack:null}),a=av(s,a,c)}else if(Kt||Fl(s,a,c,!1),w=(c&s.childLanes)!==0,Kt||w){if(w=ft,w!==null&&(f=hu(w,c),f!==0&&f!==U.retryLane))throw U.retryLane=f,Aa(s,f),er(w,s,f),tv;Bv(k)||$d(),a=av(s,a,c)}else Bv(k)?(a.flags|=192,a.child=s.child,a=null):(s=U.treeContext,gt=Or(k.nextSibling),bn=a,We=!0,Gs=null,Nr=!1,s!==null&&RT(a,s),a=ov(a,f.children),a.flags|=4096);return a}return y?(Zs(),k=f.fallback,y=a.mode,U=s.child,Q=U.sibling,f=ts(U,{mode:"hidden",children:f.children}),f.subtreeFlags=U.subtreeFlags&65011712,Q!==null?k=ts(Q,k):(k=Ca(k,y,c,null),k.flags|=2),k.return=a,f.return=a,f.sibling=k,a.child=f,qu(null,f),f=a.child,k=s.child.memoizedState,k===null?k=iv(c):(y=k.cachePool,y!==null?(U=$t._currentValue,y=y.parent!==U?{parent:U,pool:U}:y):y=DT(),k={baseLanes:k.baseLanes|c,cachePool:y}),f.memoizedState=k,f.childLanes=sv(s,w,c),a.memoizedState=rv,qu(s.child,f)):(Xs(a),c=s.child,s=c.sibling,c=ts(c,{mode:"visible",children:f.children}),c.return=a,c.sibling=null,s!==null&&(w=a.deletions,w===null?(a.deletions=[s],a.flags|=16):w.push(s)),a.child=c,a.memoizedState=null,c)}function ov(s,a){return a=Pd({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Pd(s,a){return s=lr(22,s,null,a),s.lanes=0,s}function av(s,a,c){return Oa(a,s.child,null,c),s=ov(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function KS(s,a,c){s.lanes|=a;var f=s.alternate;f!==null&&(f.lanes|=a),Ty(s.return,a,c)}function lv(s,a,c,f,y,v){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:y,treeForkCount:v}:(w.isBackwards=a,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=c,w.tailMode=y,w.treeForkCount=v)}function WS(s,a,c){var f=a.pendingProps,y=f.revealOrder,v=f.tail;f=f.children;var w=Lt.current,k=(w&2)!==0;if(k?(w=w&1|2,a.flags|=128):w&=1,fe(Lt,w),En(s,a,f,c),f=We?Nu:0,!k&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&KS(s,c,a);else if(s.tag===19)KS(s,c,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(y){case"forwards":for(c=a.child,y=null;c!==null;)s=c.alternate,s!==null&&wd(s)===null&&(y=c),c=c.sibling;c=y,c===null?(y=a.child,a.child=null):(y=c.sibling,c.sibling=null),lv(a,!1,y,c,v,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,y=a.child,a.child=null;y!==null;){if(s=y.alternate,s!==null&&wd(s)===null){a.child=y;break}s=y.sibling,y.sibling=c,c=y,y=s}lv(a,!0,c,null,v,f);break;case"together":lv(a,!1,null,null,void 0,f);break;default:a.memoizedState=null}return a.child}function ls(s,a,c){if(s!==null&&(a.dependencies=s.dependencies),no|=a.lanes,(c&a.childLanes)===0)if(s!==null){if(Fl(s,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(r(153));if(a.child!==null){for(s=a.child,c=ts(s,s.pendingProps),a.child=c,c.return=a;s.sibling!==null;)s=s.sibling,c=c.sibling=ts(s,s.pendingProps),c.return=a;c.sibling=null}return a.child}function cv(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&gd(s)))}function BD(s,a,c){switch(a.tag){case 3:tn(a,a.stateNode.containerInfo),Ws(a,$t,s.memoizedState.cache),xa();break;case 27:case 5:aa(a);break;case 4:tn(a,a.stateNode.containerInfo);break;case 10:Ws(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Dy(a),null;break;case 13:var f=a.memoizedState;if(f!==null)return f.dehydrated!==null?(Xs(a),a.flags|=128,null):(c&a.child.childLanes)!==0?GS(s,a,c):(Xs(a),s=ls(s,a,c),s!==null?s.sibling:null);Xs(a);break;case 19:var y=(s.flags&128)!==0;if(f=(c&a.childLanes)!==0,f||(Fl(s,a,c,!1),f=(c&a.childLanes)!==0),y){if(f)return WS(s,a,c);a.flags|=128}if(y=a.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),fe(Lt,Lt.current),f)break;return null;case 22:return a.lanes=0,BS(s,a,c,a.pendingProps);case 24:Ws(a,$t,s.memoizedState.cache)}return ls(s,a,c)}function QS(s,a,c){if(s!==null)if(s.memoizedProps!==a.pendingProps)Kt=!0;else{if(!cv(s,c)&&(a.flags&128)===0)return Kt=!1,BD(s,a,c);Kt=(s.flags&131072)!==0}else Kt=!1,We&&(a.flags&1048576)!==0&&xT(a,Nu,a.index);switch(a.lanes=0,a.tag){case 16:e:{var f=a.pendingProps;if(s=Na(a.elementType),a.type=s,typeof s=="function")py(s)?(f=La(s,f),a.tag=1,a=qS(null,a,s,f,c)):(a.tag=0,a=nv(null,a,s,f,c));else{if(s!=null){var y=s.$$typeof;if(y===Y){a.tag=11,a=VS(null,a,s,f,c);break e}else if(y===I){a.tag=14,a=jS(null,a,s,f,c);break e}}throw a=ue(s)||s,Error(r(306,a,""))}}return a;case 0:return nv(s,a,a.type,a.pendingProps,c);case 1:return f=a.type,y=La(f,a.pendingProps),qS(s,a,f,y,c);case 3:e:{if(tn(a,a.stateNode.containerInfo),s===null)throw Error(r(387));f=a.pendingProps;var v=a.memoizedState;y=v.element,ky(s,a),Uu(a,f,null,c);var w=a.memoizedState;if(f=w.cache,Ws(a,$t,f),f!==v.cache&&Sy(a,[$t],c,!0),ju(),f=w.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:w.cache},a.updateQueue.baseState=v,a.memoizedState=v,a.flags&256){a=$S(s,a,f,c);break e}else if(f!==y){y=Rr(Error(r(424)),a),Mu(y),a=$S(s,a,f,c);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,gt=Or(s.firstChild),bn=a,We=!0,Gs=null,Nr=!0,c=BT(a,null,f,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(xa(),f===y){a=ls(s,a,c);break e}En(s,a,f,c)}a=a.child}return a;case 26:return Ld(s,a),s===null?(c=o1(a.type,null,a.pendingProps,null))?a.memoizedState=c:We||(c=a.type,s=a.pendingProps,f=Xd(Pe.current).createElement(c),f[Ft]=a,f[an]=s,Tn(f,c,s),Ht(f),a.stateNode=f):a.memoizedState=o1(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return aa(a),s===null&&We&&(f=a.stateNode=r1(a.type,a.pendingProps,Pe.current),bn=a,Nr=!0,y=gt,ao(a.type)?(Fv=y,gt=Or(f.firstChild)):gt=y),En(s,a,a.pendingProps.children,c),Ld(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&We&&((y=f=gt)&&(f=g2(f,a.type,a.pendingProps,Nr),f!==null?(a.stateNode=f,bn=a,gt=Or(f.firstChild),Nr=!1,y=!0):y=!1),y||Ks(a)),aa(a),y=a.type,v=a.pendingProps,w=s!==null?s.memoizedProps:null,f=v.children,Vv(y,v)?f=null:w!==null&&Vv(y,w)&&(a.flags|=32),a.memoizedState!==null&&(y=Py(s,a,ND,null,null,c),sh._currentValue=y),Ld(s,a),En(s,a,f,c),a.child;case 6:return s===null&&We&&((s=c=gt)&&(c=y2(c,a.pendingProps,Nr),c!==null?(a.stateNode=c,bn=a,gt=null,s=!0):s=!1),s||Ks(a)),null;case 13:return GS(s,a,c);case 4:return tn(a,a.stateNode.containerInfo),f=a.pendingProps,s===null?a.child=Oa(a,null,f,c):En(s,a,f,c),a.child;case 11:return VS(s,a,a.type,a.pendingProps,c);case 7:return En(s,a,a.pendingProps,c),a.child;case 8:return En(s,a,a.pendingProps.children,c),a.child;case 12:return En(s,a,a.pendingProps.children,c),a.child;case 10:return f=a.pendingProps,Ws(a,a.type,f.value),En(s,a,f.children,c),a.child;case 9:return y=a.type._context,f=a.pendingProps.children,ka(a),y=_n(y),f=f(y),a.flags|=1,En(s,a,f,c),a.child;case 14:return jS(s,a,a.type,a.pendingProps,c);case 15:return US(s,a,a.type,a.pendingProps,c);case 19:return WS(s,a,c);case 31:return UD(s,a,c);case 22:return BS(s,a,c,a.pendingProps);case 24:return ka(a),f=_n($t),s===null?(y=Cy(),y===null&&(y=ft,v=wy(),y.pooledCache=v,v.refCount++,v!==null&&(y.pooledCacheLanes|=c),y=v),a.memoizedState={parent:f,cache:y},Ry(a),Ws(a,$t,y)):((s.lanes&c)!==0&&(ky(s,a),Uu(a,null,null,c),ju()),y=s.memoizedState,v=a.memoizedState,y.parent!==f?(y={parent:f,cache:f},a.memoizedState=y,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=y),Ws(a,$t,f)):(f=v.cache,Ws(a,$t,f),f!==y.cache&&Sy(a,[$t],c,!0))),En(s,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}function cs(s){s.flags|=4}function uv(s,a,c,f,y){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(y&335544128)===y)if(s.stateNode.complete)s.flags|=8192;else if(Tw())s.flags|=8192;else throw Ma=_d,xy}else s.flags&=-16777217}function YS(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!h1(a))if(Tw())s.flags|=8192;else throw Ma=_d,xy}function Vd(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Hf():536870912,s.lanes|=a,ec|=a)}function $u(s,a){if(!We)switch(s.tailMode){case"hidden":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function yt(s){var a=s.alternate!==null&&s.alternate.child===s.child,c=0,f=0;if(a)for(var y=s.child;y!==null;)c|=y.lanes|y.childLanes,f|=y.subtreeFlags&65011712,f|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)c|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=f,s.childLanes=c,a}function zD(s,a,c){var f=a.pendingProps;switch(vy(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(a),null;case 1:return yt(a),null;case 3:return c=a.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),a.memoizedState.cache!==f&&(a.flags|=2048),is($t),bt(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(zl(a)?cs(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,_y())),yt(a),null;case 26:var y=a.type,v=a.memoizedState;return s===null?(cs(a),v!==null?(yt(a),YS(a,v)):(yt(a),uv(a,y,null,f,c))):v?v!==s.memoizedState?(cs(a),yt(a),YS(a,v)):(yt(a),a.flags&=-16777217):(s=s.memoizedProps,s!==f&&cs(a),yt(a),uv(a,y,s,f,c)),null;case 27:if(bl(a),c=Pe.current,y=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==f&&cs(a);else{if(!f){if(a.stateNode===null)throw Error(r(166));return yt(a),null}s=ye.current,zl(a)?kT(a):(s=r1(y,f,c),a.stateNode=s,cs(a))}return yt(a),null;case 5:if(bl(a),y=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==f&&cs(a);else{if(!f){if(a.stateNode===null)throw Error(r(166));return yt(a),null}if(v=ye.current,zl(a))kT(a);else{var w=Xd(Pe.current);switch(v){case 1:v=w.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:v=w.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":v=w.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":v=w.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":v=w.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof f.is=="string"?w.createElement("select",{is:f.is}):w.createElement("select"),f.multiple?v.multiple=!0:f.size&&(v.size=f.size);break;default:v=typeof f.is=="string"?w.createElement(y,{is:f.is}):w.createElement(y)}}v[Ft]=a,v[an]=f;e:for(w=a.child;w!==null;){if(w.tag===5||w.tag===6)v.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===a)break e;for(;w.sibling===null;){if(w.return===null||w.return===a)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}a.stateNode=v;e:switch(Tn(v,y,f),y){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&cs(a)}}return yt(a),uv(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,c),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==f&&cs(a);else{if(typeof f!="string"&&a.stateNode===null)throw Error(r(166));if(s=Pe.current,zl(a)){if(s=a.stateNode,c=a.memoizedProps,f=null,y=bn,y!==null)switch(y.tag){case 27:case 5:f=y.memoizedProps}s[Ft]=a,s=!!(s.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||Gw(s.nodeValue,c)),s||Ks(a,!0)}else s=Xd(s).createTextNode(f),s[Ft]=a,a.stateNode=s}return yt(a),null;case 31:if(c=a.memoizedState,s===null||s.memoizedState!==null){if(f=zl(a),c!==null){if(s===null){if(!f)throw Error(r(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Ft]=a}else xa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;yt(a),s=!1}else c=_y(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return a.flags&256?(ur(a),a):(ur(a),null);if((a.flags&128)!==0)throw Error(r(558))}return yt(a),null;case 13:if(f=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=zl(a),f!==null&&f.dehydrated!==null){if(s===null){if(!y)throw Error(r(318));if(y=a.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[Ft]=a}else xa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;yt(a),y=!1}else y=_y(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return a.flags&256?(ur(a),a):(ur(a),null)}return ur(a),(a.flags&128)!==0?(a.lanes=c,a):(c=f!==null,s=s!==null&&s.memoizedState!==null,c&&(f=a.child,y=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(y=f.alternate.memoizedState.cachePool.pool),v=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==y&&(f.flags|=2048)),c!==s&&c&&(a.child.flags|=8192),Vd(a,a.updateQueue),yt(a),null);case 4:return bt(),s===null&&Mv(a.stateNode.containerInfo),yt(a),null;case 10:return is(a.type),yt(a),null;case 19:if(se(Lt),f=a.memoizedState,f===null)return yt(a),null;if(y=(a.flags&128)!==0,v=f.rendering,v===null)if(y)$u(f,!1);else{if(xt!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(v=wd(s),v!==null){for(a.flags|=128,$u(f,!1),s=v.updateQueue,a.updateQueue=s,Vd(a,s),a.subtreeFlags=0,s=c,c=a.child;c!==null;)wT(c,s),c=c.sibling;return fe(Lt,Lt.current&1|2),We&&ns(a,f.treeForkCount),a.child}s=s.sibling}f.tail!==null&&Un()>Fd&&(a.flags|=128,y=!0,$u(f,!1),a.lanes=4194304)}else{if(!y)if(s=wd(v),s!==null){if(a.flags|=128,y=!0,s=s.updateQueue,a.updateQueue=s,Vd(a,s),$u(f,!0),f.tail===null&&f.tailMode==="hidden"&&!v.alternate&&!We)return yt(a),null}else 2*Un()-f.renderingStartTime>Fd&&c!==536870912&&(a.flags|=128,y=!0,$u(f,!1),a.lanes=4194304);f.isBackwards?(v.sibling=a.child,a.child=v):(s=f.last,s!==null?s.sibling=v:a.child=v,f.last=v)}return f.tail!==null?(s=f.tail,f.rendering=s,f.tail=s.sibling,f.renderingStartTime=Un(),s.sibling=null,c=Lt.current,fe(Lt,y?c&1|2:c&1),We&&ns(a,f.treeForkCount),s):(yt(a),null);case 22:case 23:return ur(a),Oy(),f=a.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(a.flags|=8192):f&&(a.flags|=8192),f?(c&536870912)!==0&&(a.flags&128)===0&&(yt(a),a.subtreeFlags&6&&(a.flags|=8192)):yt(a),c=a.updateQueue,c!==null&&Vd(a,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),f=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(f=a.memoizedState.cachePool.pool),f!==c&&(a.flags|=2048),s!==null&&se(Ia),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),is($t),yt(a),null;case 25:return null;case 30:return null}throw Error(r(156,a.tag))}function FD(s,a){switch(vy(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return is($t),bt(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return bl(a),null;case 31:if(a.memoizedState!==null){if(ur(a),a.alternate===null)throw Error(r(340));xa()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(ur(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(r(340));xa()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return se(Lt),null;case 4:return bt(),null;case 10:return is(a.type),null;case 22:case 23:return ur(a),Oy(),s!==null&&se(Ia),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return is($t),null;case 25:return null;default:return null}}function JS(s,a){switch(vy(a),a.tag){case 3:is($t),bt();break;case 26:case 27:case 5:bl(a);break;case 4:bt();break;case 31:a.memoizedState!==null&&ur(a);break;case 13:ur(a);break;case 19:se(Lt);break;case 10:is(a.type);break;case 22:case 23:ur(a),Oy(),s!==null&&se(Ia);break;case 24:is($t)}}function Gu(s,a){try{var c=a.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var y=f.next;c=y;do{if((c.tag&s)===s){f=void 0;var v=c.create,w=c.inst;f=v(),w.destroy=f}c=c.next}while(c!==y)}}catch(k){it(a,a.return,k)}}function eo(s,a,c){try{var f=a.updateQueue,y=f!==null?f.lastEffect:null;if(y!==null){var v=y.next;f=v;do{if((f.tag&s)===s){var w=f.inst,k=w.destroy;if(k!==void 0){w.destroy=void 0,y=a;var U=c,Q=k;try{Q()}catch(te){it(y,U,te)}}}f=f.next}while(f!==v)}}catch(te){it(a,a.return,te)}}function XS(s){var a=s.updateQueue;if(a!==null){var c=s.stateNode;try{FT(a,c)}catch(f){it(s,s.return,f)}}}function ZS(s,a,c){c.props=La(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(f){it(s,a,f)}}function Ku(s,a){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof c=="function"?s.refCleanup=c(f):c.current=f}}catch(y){it(s,a,y)}}function Ni(s,a){var c=s.ref,f=s.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(y){it(s,a,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(y){it(s,a,y)}else c.current=null}function ew(s){var a=s.type,c=s.memoizedProps,f=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(y){it(s,s.return,y)}}function hv(s,a,c){try{var f=s.stateNode;u2(f,s.type,c,a),f[an]=a}catch(y){it(s,s.return,y)}}function tw(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ao(s.type)||s.tag===4}function fv(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||tw(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ao(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function dv(s,a,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(s),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Kr));else if(f!==4&&(f===27&&ao(s.type)&&(c=s.stateNode,a=null),s=s.child,s!==null))for(dv(s,a,c),s=s.sibling;s!==null;)dv(s,a,c),s=s.sibling}function jd(s,a,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,a?c.insertBefore(s,a):c.appendChild(s);else if(f!==4&&(f===27&&ao(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(jd(s,a,c),s=s.sibling;s!==null;)jd(s,a,c),s=s.sibling}function nw(s){var a=s.stateNode,c=s.memoizedProps;try{for(var f=s.type,y=a.attributes;y.length;)a.removeAttributeNode(y[0]);Tn(a,f,c),a[Ft]=s,a[an]=c}catch(v){it(s,s.return,v)}}var us=!1,Wt=!1,pv=!1,rw=typeof WeakSet=="function"?WeakSet:Set,cn=null;function HD(s,a){if(s=s.containerInfo,Lv=sp,s=mT(s),ay(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var y=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var w=0,k=-1,U=-1,Q=0,te=0,oe=s,X=null;t:for(;;){for(var ee;oe!==c||y!==0&&oe.nodeType!==3||(k=w+y),oe!==v||f!==0&&oe.nodeType!==3||(U=w+f),oe.nodeType===3&&(w+=oe.nodeValue.length),(ee=oe.firstChild)!==null;)X=oe,oe=ee;for(;;){if(oe===s)break t;if(X===c&&++Q===y&&(k=w),X===v&&++te===f&&(U=w),(ee=oe.nextSibling)!==null)break;oe=X,X=oe.parentNode}oe=ee}c=k===-1||U===-1?null:{start:k,end:U}}else c=null}c=c||{start:0,end:0}}else c=null;for(Pv={focusedElem:s,selectionRange:c},sp=!1,cn=a;cn!==null;)if(a=cn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,cn=s;else for(;cn!==null;){switch(a=cn,v=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)y=s[c],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,c=a,y=v.memoizedProps,v=v.memoizedState,f=c.stateNode;try{var be=La(c.type,y);s=f.getSnapshotBeforeUpdate(be,v),f.__reactInternalSnapshotBeforeUpdate=s}catch(Ce){it(c,c.return,Ce)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,c=s.nodeType,c===9)Uv(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Uv(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=a.sibling,s!==null){s.return=a.return,cn=s;break}cn=a.return}}function iw(s,a,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:fs(s,c),f&4&&Gu(5,c);break;case 1:if(fs(s,c),f&4)if(s=c.stateNode,a===null)try{s.componentDidMount()}catch(w){it(c,c.return,w)}else{var y=La(c.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(y,a,s.__reactInternalSnapshotBeforeUpdate)}catch(w){it(c,c.return,w)}}f&64&&XS(c),f&512&&Ku(c,c.return);break;case 3:if(fs(s,c),f&64&&(s=c.updateQueue,s!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{FT(s,a)}catch(w){it(c,c.return,w)}}break;case 27:a===null&&f&4&&nw(c);case 26:case 5:fs(s,c),a===null&&f&4&&ew(c),f&512&&Ku(c,c.return);break;case 12:fs(s,c);break;case 31:fs(s,c),f&4&&aw(s,c);break;case 13:fs(s,c),f&4&&lw(s,c),f&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=XD.bind(null,c),v2(s,c))));break;case 22:if(f=c.memoizedState!==null||us,!f){a=a!==null&&a.memoizedState!==null||Wt,y=us;var v=Wt;us=f,(Wt=a)&&!v?ds(s,c,(c.subtreeFlags&8772)!==0):fs(s,c),us=y,Wt=v}break;case 30:break;default:fs(s,c)}}function sw(s){var a=s.alternate;a!==null&&(s.alternate=null,sw(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&wl(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Et=null,Yn=!1;function hs(s,a,c){for(c=c.child;c!==null;)ow(s,a,c),c=c.sibling}function ow(s,a,c){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(Hr,c)}catch{}switch(c.tag){case 26:Wt||Ni(c,a),hs(s,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Wt||Ni(c,a);var f=Et,y=Yn;ao(c.type)&&(Et=c.stateNode,Yn=!1),hs(s,a,c),nh(c.stateNode),Et=f,Yn=y;break;case 5:Wt||Ni(c,a);case 6:if(f=Et,y=Yn,Et=null,hs(s,a,c),Et=f,Yn=y,Et!==null)if(Yn)try{(Et.nodeType===9?Et.body:Et.nodeName==="HTML"?Et.ownerDocument.body:Et).removeChild(c.stateNode)}catch(v){it(c,a,v)}else try{Et.removeChild(c.stateNode)}catch(v){it(c,a,v)}break;case 18:Et!==null&&(Yn?(s=Et,Xw(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),lc(s)):Xw(Et,c.stateNode));break;case 4:f=Et,y=Yn,Et=c.stateNode.containerInfo,Yn=!0,hs(s,a,c),Et=f,Yn=y;break;case 0:case 11:case 14:case 15:eo(2,c,a),Wt||eo(4,c,a),hs(s,a,c);break;case 1:Wt||(Ni(c,a),f=c.stateNode,typeof f.componentWillUnmount=="function"&&ZS(c,a,f)),hs(s,a,c);break;case 21:hs(s,a,c);break;case 22:Wt=(f=Wt)||c.memoizedState!==null,hs(s,a,c),Wt=f;break;default:hs(s,a,c)}}function aw(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{lc(s)}catch(c){it(a,a.return,c)}}}function lw(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{lc(s)}catch(c){it(a,a.return,c)}}function qD(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new rw),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new rw),a;default:throw Error(r(435,s.tag))}}function Ud(s,a){var c=qD(s);a.forEach(function(f){if(!c.has(f)){c.add(f);var y=ZD.bind(null,s,f);f.then(y,y)}})}function Jn(s,a){var c=a.deletions;if(c!==null)for(var f=0;f<c.length;f++){var y=c[f],v=s,w=a,k=w;e:for(;k!==null;){switch(k.tag){case 27:if(ao(k.type)){Et=k.stateNode,Yn=!1;break e}break;case 5:Et=k.stateNode,Yn=!1;break e;case 3:case 4:Et=k.stateNode.containerInfo,Yn=!0;break e}k=k.return}if(Et===null)throw Error(r(160));ow(v,w,y),Et=null,Yn=!1,v=y.alternate,v!==null&&(v.return=null),y.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)cw(a,s),a=a.sibling}var Zr=null;function cw(s,a){var c=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Jn(a,s),Xn(s),f&4&&(eo(3,s,s.return),Gu(3,s),eo(5,s,s.return));break;case 1:Jn(a,s),Xn(s),f&512&&(Wt||c===null||Ni(c,c.return)),f&64&&us&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var y=Zr;if(Jn(a,s),Xn(s),f&512&&(Wt||c===null||Ni(c,c.return)),f&4){var v=c!==null?c.memoizedState:null;if(f=s.memoizedState,c===null)if(f===null)if(s.stateNode===null){e:{f=s.type,c=s.memoizedProps,y=y.ownerDocument||y;t:switch(f){case"title":v=y.getElementsByTagName("title")[0],(!v||v[yi]||v[Ft]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=y.createElement(f),y.head.insertBefore(v,y.querySelector("head > title"))),Tn(v,f,c),v[Ft]=s,Ht(v),f=v;break e;case"link":var w=c1("link","href",y).get(f+(c.href||""));if(w){for(var k=0;k<w.length;k++)if(v=w[k],v.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&v.getAttribute("rel")===(c.rel==null?null:c.rel)&&v.getAttribute("title")===(c.title==null?null:c.title)&&v.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){w.splice(k,1);break t}}v=y.createElement(f),Tn(v,f,c),y.head.appendChild(v);break;case"meta":if(w=c1("meta","content",y).get(f+(c.content||""))){for(k=0;k<w.length;k++)if(v=w[k],v.getAttribute("content")===(c.content==null?null:""+c.content)&&v.getAttribute("name")===(c.name==null?null:c.name)&&v.getAttribute("property")===(c.property==null?null:c.property)&&v.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&v.getAttribute("charset")===(c.charSet==null?null:c.charSet)){w.splice(k,1);break t}}v=y.createElement(f),Tn(v,f,c),y.head.appendChild(v);break;default:throw Error(r(468,f))}v[Ft]=s,Ht(v),f=v}s.stateNode=f}else u1(y,s.type,s.stateNode);else s.stateNode=l1(y,f,s.memoizedProps);else v!==f?(v===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):v.count--,f===null?u1(y,s.type,s.stateNode):l1(y,f,s.memoizedProps)):f===null&&s.stateNode!==null&&hv(s,s.memoizedProps,c.memoizedProps)}break;case 27:Jn(a,s),Xn(s),f&512&&(Wt||c===null||Ni(c,c.return)),c!==null&&f&4&&hv(s,s.memoizedProps,c.memoizedProps);break;case 5:if(Jn(a,s),Xn(s),f&512&&(Wt||c===null||Ni(c,c.return)),s.flags&32){y=s.stateNode;try{Qn(y,"")}catch(be){it(s,s.return,be)}}f&4&&s.stateNode!=null&&(y=s.memoizedProps,hv(s,y,c!==null?c.memoizedProps:y)),f&1024&&(pv=!0);break;case 6:if(Jn(a,s),Xn(s),f&4){if(s.stateNode===null)throw Error(r(162));f=s.memoizedProps,c=s.stateNode;try{c.nodeValue=f}catch(be){it(s,s.return,be)}}break;case 3:if(tp=null,y=Zr,Zr=Zd(a.containerInfo),Jn(a,s),Zr=y,Xn(s),f&4&&c!==null&&c.memoizedState.isDehydrated)try{lc(a.containerInfo)}catch(be){it(s,s.return,be)}pv&&(pv=!1,uw(s));break;case 4:f=Zr,Zr=Zd(s.stateNode.containerInfo),Jn(a,s),Xn(s),Zr=f;break;case 12:Jn(a,s),Xn(s);break;case 31:Jn(a,s),Xn(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Ud(s,f)));break;case 13:Jn(a,s),Xn(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(zd=Un()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Ud(s,f)));break;case 22:y=s.memoizedState!==null;var U=c!==null&&c.memoizedState!==null,Q=us,te=Wt;if(us=Q||y,Wt=te||U,Jn(a,s),Wt=te,us=Q,Xn(s),f&8192)e:for(a=s.stateNode,a._visibility=y?a._visibility&-2:a._visibility|1,y&&(c===null||U||us||Wt||Pa(s)),c=null,a=s;;){if(a.tag===5||a.tag===26){if(c===null){U=c=a;try{if(v=U.stateNode,y)w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{k=U.stateNode;var oe=U.memoizedProps.style,X=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;k.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(be){it(U,U.return,be)}}}else if(a.tag===6){if(c===null){U=a;try{U.stateNode.nodeValue=y?"":U.memoizedProps}catch(be){it(U,U.return,be)}}}else if(a.tag===18){if(c===null){U=a;try{var ee=U.stateNode;y?Zw(ee,!0):Zw(U.stateNode,!1)}catch(be){it(U,U.return,be)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}f&4&&(f=s.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,Ud(s,c))));break;case 19:Jn(a,s),Xn(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Ud(s,f)));break;case 30:break;case 21:break;default:Jn(a,s),Xn(s)}}function Xn(s){var a=s.flags;if(a&2){try{for(var c,f=s.return;f!==null;){if(tw(f)){c=f;break}f=f.return}if(c==null)throw Error(r(160));switch(c.tag){case 27:var y=c.stateNode,v=fv(s);jd(s,v,y);break;case 5:var w=c.stateNode;c.flags&32&&(Qn(w,""),c.flags&=-33);var k=fv(s);jd(s,k,w);break;case 3:case 4:var U=c.stateNode.containerInfo,Q=fv(s);dv(s,Q,U);break;default:throw Error(r(161))}}catch(te){it(s,s.return,te)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function uw(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;uw(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function fs(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)iw(s,a.alternate,a),a=a.sibling}function Pa(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:eo(4,a,a.return),Pa(a);break;case 1:Ni(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&ZS(a,a.return,c),Pa(a);break;case 27:nh(a.stateNode);case 26:case 5:Ni(a,a.return),Pa(a);break;case 22:a.memoizedState===null&&Pa(a);break;case 30:Pa(a);break;default:Pa(a)}s=s.sibling}}function ds(s,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var f=a.alternate,y=s,v=a,w=v.flags;switch(v.tag){case 0:case 11:case 15:ds(y,v,c),Gu(4,v);break;case 1:if(ds(y,v,c),f=v,y=f.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Q){it(f,f.return,Q)}if(f=v,y=f.updateQueue,y!==null){var k=f.stateNode;try{var U=y.shared.hiddenCallbacks;if(U!==null)for(y.shared.hiddenCallbacks=null,y=0;y<U.length;y++)zT(U[y],k)}catch(Q){it(f,f.return,Q)}}c&&w&64&&XS(v),Ku(v,v.return);break;case 27:nw(v);case 26:case 5:ds(y,v,c),c&&f===null&&w&4&&ew(v),Ku(v,v.return);break;case 12:ds(y,v,c);break;case 31:ds(y,v,c),c&&w&4&&aw(y,v);break;case 13:ds(y,v,c),c&&w&4&&lw(y,v);break;case 22:v.memoizedState===null&&ds(y,v,c),Ku(v,v.return);break;case 30:break;default:ds(y,v,c)}a=a.sibling}}function mv(s,a){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&Ou(c))}function gv(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ou(s))}function ei(s,a,c,f){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)hw(s,a,c,f),a=a.sibling}function hw(s,a,c,f){var y=a.flags;switch(a.tag){case 0:case 11:case 15:ei(s,a,c,f),y&2048&&Gu(9,a);break;case 1:ei(s,a,c,f);break;case 3:ei(s,a,c,f),y&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ou(s)));break;case 12:if(y&2048){ei(s,a,c,f),s=a.stateNode;try{var v=a.memoizedProps,w=v.id,k=v.onPostCommit;typeof k=="function"&&k(w,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(U){it(a,a.return,U)}}else ei(s,a,c,f);break;case 31:ei(s,a,c,f);break;case 13:ei(s,a,c,f);break;case 23:break;case 22:v=a.stateNode,w=a.alternate,a.memoizedState!==null?v._visibility&2?ei(s,a,c,f):Wu(s,a):v._visibility&2?ei(s,a,c,f):(v._visibility|=2,Jl(s,a,c,f,(a.subtreeFlags&10256)!==0||!1)),y&2048&&mv(w,a);break;case 24:ei(s,a,c,f),y&2048&&gv(a.alternate,a);break;default:ei(s,a,c,f)}}function Jl(s,a,c,f,y){for(y=y&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var v=s,w=a,k=c,U=f,Q=w.flags;switch(w.tag){case 0:case 11:case 15:Jl(v,w,k,U,y),Gu(8,w);break;case 23:break;case 22:var te=w.stateNode;w.memoizedState!==null?te._visibility&2?Jl(v,w,k,U,y):Wu(v,w):(te._visibility|=2,Jl(v,w,k,U,y)),y&&Q&2048&&mv(w.alternate,w);break;case 24:Jl(v,w,k,U,y),y&&Q&2048&&gv(w.alternate,w);break;default:Jl(v,w,k,U,y)}a=a.sibling}}function Wu(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=s,f=a,y=f.flags;switch(f.tag){case 22:Wu(c,f),y&2048&&mv(f.alternate,f);break;case 24:Wu(c,f),y&2048&&gv(f.alternate,f);break;default:Wu(c,f)}a=a.sibling}}var Qu=8192;function Xl(s,a,c){if(s.subtreeFlags&Qu)for(s=s.child;s!==null;)fw(s,a,c),s=s.sibling}function fw(s,a,c){switch(s.tag){case 26:Xl(s,a,c),s.flags&Qu&&s.memoizedState!==null&&I2(c,Zr,s.memoizedState,s.memoizedProps);break;case 5:Xl(s,a,c);break;case 3:case 4:var f=Zr;Zr=Zd(s.stateNode.containerInfo),Xl(s,a,c),Zr=f;break;case 22:s.memoizedState===null&&(f=s.alternate,f!==null&&f.memoizedState!==null?(f=Qu,Qu=16777216,Xl(s,a,c),Qu=f):Xl(s,a,c));break;default:Xl(s,a,c)}}function dw(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Yu(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var f=a[c];cn=f,mw(f,s)}dw(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)pw(s),s=s.sibling}function pw(s){switch(s.tag){case 0:case 11:case 15:Yu(s),s.flags&2048&&eo(9,s,s.return);break;case 3:Yu(s);break;case 12:Yu(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,Bd(s)):Yu(s);break;default:Yu(s)}}function Bd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var f=a[c];cn=f,mw(f,s)}dw(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:eo(8,a,a.return),Bd(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,Bd(a));break;default:Bd(a)}s=s.sibling}}function mw(s,a){for(;cn!==null;){var c=cn;switch(c.tag){case 0:case 11:case 15:eo(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Ou(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,cn=f;else e:for(c=s;cn!==null;){f=cn;var y=f.sibling,v=f.return;if(sw(f),f===c){cn=null;break e}if(y!==null){y.return=v,cn=y;break e}cn=v}}}var $D={getCacheForType:function(s){var a=_n($t),c=a.data.get(s);return c===void 0&&(c=s(),a.data.set(s,c)),c},cacheSignal:function(){return _n($t).controller.signal}},GD=typeof WeakMap=="function"?WeakMap:Map,tt=0,ft=null,ze=null,He=0,rt=0,hr=null,to=!1,Zl=!1,yv=!1,ps=0,xt=0,no=0,Va=0,vv=0,fr=0,ec=0,Ju=null,Zn=null,bv=!1,zd=0,gw=0,Fd=1/0,Hd=null,ro=null,rn=0,io=null,tc=null,ms=0,_v=0,Ev=null,yw=null,Xu=0,Tv=null;function dr(){return(tt&2)!==0&&He!==0?He&-He:J.T!==null?Rv():qf()}function vw(){if(fr===0)if((He&536870912)===0||We){var s=ua;ua<<=1,(ua&3932160)===0&&(ua=262144),fr=s}else fr=536870912;return s=cr.current,s!==null&&(s.flags|=32),fr}function er(s,a,c){(s===ft&&(rt===2||rt===9)||s.cancelPendingCommit!==null)&&(nc(s,0),so(s,He,fr,!1)),ha(s,c),((tt&2)===0||s!==ft)&&(s===ft&&((tt&2)===0&&(Va|=c),xt===4&&so(s,He,fr,!1)),Mi(s))}function bw(s,a,c){if((tt&6)!==0)throw Error(r(327));var f=!c&&(a&127)===0&&(a&s.expiredLanes)===0||qr(s,a),y=f?QD(s,a):wv(s,a,!0),v=f;do{if(y===0){Zl&&!f&&so(s,a,0,!1);break}else{if(c=s.current.alternate,v&&!KD(c)){y=wv(s,a,!1),v=!1;continue}if(y===2){if(v=a,s.errorRecoveryDisabledLanes&v)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){a=w;e:{var k=s;y=Ju;var U=k.current.memoizedState.isDehydrated;if(U&&(nc(k,w).flags|=256),w=wv(k,w,!1),w!==2){if(yv&&!U){k.errorRecoveryDisabledLanes|=v,Va|=v,y=4;break e}v=Zn,Zn=y,v!==null&&(Zn===null?Zn=v:Zn.push.apply(Zn,v))}y=w}if(v=!1,y!==2)continue}}if(y===1){nc(s,0),so(s,a,0,!0);break}e:{switch(f=s,v=y,v){case 0:case 1:throw Error(r(345));case 4:if((a&4194048)!==a)break;case 6:so(f,a,fr,!to);break e;case 2:Zn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((a&62914560)===a&&(y=zd+300-Un(),10<y)){if(so(f,a,fr,!to),pi(f,0,!0)!==0)break e;ms=a,f.timeoutHandle=Yw(_w.bind(null,f,c,Zn,Hd,bv,a,fr,Va,ec,to,v,"Throttled",-0,0),y);break e}_w(f,c,Zn,Hd,bv,a,fr,Va,ec,to,v,null,-0,0)}}break}while(!0);Mi(s)}function _w(s,a,c,f,y,v,w,k,U,Q,te,oe,X,ee){if(s.timeoutHandle=-1,oe=a.subtreeFlags,oe&8192||(oe&16785408)===16785408){oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Kr},fw(a,v,oe);var be=(v&62914560)===v?zd-Un():(v&4194048)===v?gw-Un():0;if(be=N2(oe,be),be!==null){ms=v,s.cancelPendingCommit=be(Rw.bind(null,s,a,v,c,f,y,w,k,U,te,oe,null,X,ee)),so(s,v,w,!Q);return}}Rw(s,a,v,c,f,y,w,k,U)}function KD(s){for(var a=s;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var y=c[f],v=y.getSnapshot;y=y.value;try{if(!ar(v(),y))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function so(s,a,c,f){a&=~vv,a&=~Va,s.suspendedLanes|=a,s.pingedLanes&=~a,f&&(s.warmLanes|=a),f=s.expirationTimes;for(var y=a;0<y;){var v=31-Ot(y),w=1<<v;f[v]=-1,y&=~w}c!==0&&fa(s,c,a)}function qd(){return(tt&6)===0?(Zu(0),!1):!0}function Sv(){if(ze!==null){if(rt===0)var s=ze.return;else s=ze,rs=Ra=null,Uy(s),Gl=null,Lu=0,s=ze;for(;s!==null;)JS(s.alternate,s),s=s.return;ze=null}}function nc(s,a){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,d2(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),ms=0,Sv(),ft=s,ze=c=ts(s.current,null),He=a,rt=0,hr=null,to=!1,Zl=qr(s,a),yv=!1,ec=fr=vv=Va=no=xt=0,Zn=Ju=null,bv=!1,(a&8)!==0&&(a|=a&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=a;0<f;){var y=31-Ot(f),v=1<<y;a|=s[y],f&=~v}return ps=a,hd(),c}function Ew(s,a){Le=null,J.H=Hu,a===$l||a===bd?(a=VT(),rt=3):a===xy?(a=VT(),rt=4):rt=a===tv?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,hr=a,ze===null&&(xt=1,Od(s,Rr(a,s.current)))}function Tw(){var s=cr.current;return s===null?!0:(He&4194048)===He?Mr===null:(He&62914560)===He||(He&536870912)!==0?s===Mr:!1}function Sw(){var s=J.H;return J.H=Hu,s===null?Hu:s}function ww(){var s=J.A;return J.A=$D,s}function $d(){xt=4,to||(He&4194048)!==He&&cr.current!==null||(Zl=!0),(no&134217727)===0&&(Va&134217727)===0||ft===null||so(ft,He,fr,!1)}function wv(s,a,c){var f=tt;tt|=2;var y=Sw(),v=ww();(ft!==s||He!==a)&&(Hd=null,nc(s,a)),a=!1;var w=xt;e:do try{if(rt!==0&&ze!==null){var k=ze,U=hr;switch(rt){case 8:Sv(),w=6;break e;case 3:case 2:case 9:case 6:cr.current===null&&(a=!0);var Q=rt;if(rt=0,hr=null,rc(s,k,U,Q),c&&Zl){w=0;break e}break;default:Q=rt,rt=0,hr=null,rc(s,k,U,Q)}}WD(),w=xt;break}catch(te){Ew(s,te)}while(!0);return a&&s.shellSuspendCounter++,rs=Ra=null,tt=f,J.H=y,J.A=v,ze===null&&(ft=null,He=0,hd()),w}function WD(){for(;ze!==null;)Aw(ze)}function QD(s,a){var c=tt;tt|=2;var f=Sw(),y=ww();ft!==s||He!==a?(Hd=null,Fd=Un()+500,nc(s,a)):Zl=qr(s,a);e:do try{if(rt!==0&&ze!==null){a=ze;var v=hr;t:switch(rt){case 1:rt=0,hr=null,rc(s,a,v,1);break;case 2:case 9:if(LT(v)){rt=0,hr=null,Cw(a);break}a=function(){rt!==2&&rt!==9||ft!==s||(rt=7),Mi(s)},v.then(a,a);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:LT(v)?(rt=0,hr=null,Cw(a)):(rt=0,hr=null,rc(s,a,v,7));break;case 5:var w=null;switch(ze.tag){case 26:w=ze.memoizedState;case 5:case 27:var k=ze;if(w?h1(w):k.stateNode.complete){rt=0,hr=null;var U=k.sibling;if(U!==null)ze=U;else{var Q=k.return;Q!==null?(ze=Q,Gd(Q)):ze=null}break t}}rt=0,hr=null,rc(s,a,v,5);break;case 6:rt=0,hr=null,rc(s,a,v,6);break;case 8:Sv(),xt=6;break e;default:throw Error(r(462))}}YD();break}catch(te){Ew(s,te)}while(!0);return rs=Ra=null,J.H=f,J.A=y,tt=c,ze!==null?0:(ft=null,He=0,hd(),xt)}function YD(){for(;ze!==null&&!ey();)Aw(ze)}function Aw(s){var a=QS(s.alternate,s,ps);s.memoizedProps=s.pendingProps,a===null?Gd(s):ze=a}function Cw(s){var a=s,c=a.alternate;switch(a.tag){case 15:case 0:a=HS(c,a,a.pendingProps,a.type,void 0,He);break;case 11:a=HS(c,a,a.pendingProps,a.type.render,a.ref,He);break;case 5:Uy(a);default:JS(c,a),a=ze=wT(a,ps),a=QS(c,a,ps)}s.memoizedProps=s.pendingProps,a===null?Gd(s):ze=a}function rc(s,a,c,f){rs=Ra=null,Uy(a),Gl=null,Lu=0;var y=a.return;try{if(jD(s,y,a,c,He)){xt=1,Od(s,Rr(c,s.current)),ze=null;return}}catch(v){if(y!==null)throw ze=y,v;xt=1,Od(s,Rr(c,s.current)),ze=null;return}a.flags&32768?(We||f===1?s=!0:Zl||(He&536870912)!==0?s=!1:(to=s=!0,(f===2||f===9||f===3||f===6)&&(f=cr.current,f!==null&&f.tag===13&&(f.flags|=16384))),xw(a,s)):Gd(a)}function Gd(s){var a=s;do{if((a.flags&32768)!==0){xw(a,to);return}s=a.return;var c=zD(a.alternate,a,ps);if(c!==null){ze=c;return}if(a=a.sibling,a!==null){ze=a;return}ze=a=s}while(a!==null);xt===0&&(xt=5)}function xw(s,a){do{var c=FD(s.alternate,s);if(c!==null){c.flags&=32767,ze=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(s=s.sibling,s!==null)){ze=s;return}ze=s=c}while(s!==null);xt=6,ze=null}function Rw(s,a,c,f,y,v,w,k,U){s.cancelPendingCommit=null;do Kd();while(rn!==0);if((tt&6)!==0)throw Error(r(327));if(a!==null){if(a===s.current)throw Error(r(177));if(v=a.lanes|a.childLanes,v|=fy,ry(s,c,v,w,k,U),s===ft&&(ze=ft=null,He=0),tc=a,io=s,ms=c,_v=v,Ev=y,yw=f,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,e2(Ls,function(){return Ow(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||f){f=J.T,J.T=null,y=ne.p,ne.p=2,w=tt,tt|=4;try{HD(s,a,c)}finally{tt=w,ne.p=y,J.T=f}}rn=1,kw(),Iw(),Nw()}}function kw(){if(rn===1){rn=0;var s=io,a=tc,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=J.T,J.T=null;var f=ne.p;ne.p=2;var y=tt;tt|=4;try{cw(a,s);var v=Pv,w=mT(s.containerInfo),k=v.focusedElem,U=v.selectionRange;if(w!==k&&k&&k.ownerDocument&&pT(k.ownerDocument.documentElement,k)){if(U!==null&&ay(k)){var Q=U.start,te=U.end;if(te===void 0&&(te=Q),"selectionStart"in k)k.selectionStart=Q,k.selectionEnd=Math.min(te,k.value.length);else{var oe=k.ownerDocument||document,X=oe&&oe.defaultView||window;if(X.getSelection){var ee=X.getSelection(),be=k.textContent.length,Ce=Math.min(U.start,be),ct=U.end===void 0?Ce:Math.min(U.end,be);!ee.extend&&Ce>ct&&(w=ct,ct=Ce,Ce=w);var q=dT(k,Ce),H=dT(k,ct);if(q&&H&&(ee.rangeCount!==1||ee.anchorNode!==q.node||ee.anchorOffset!==q.offset||ee.focusNode!==H.node||ee.focusOffset!==H.offset)){var W=oe.createRange();W.setStart(q.node,q.offset),ee.removeAllRanges(),Ce>ct?(ee.addRange(W),ee.extend(H.node,H.offset)):(W.setEnd(H.node,H.offset),ee.addRange(W))}}}}for(oe=[],ee=k;ee=ee.parentNode;)ee.nodeType===1&&oe.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<oe.length;k++){var re=oe[k];re.element.scrollLeft=re.left,re.element.scrollTop=re.top}}sp=!!Lv,Pv=Lv=null}finally{tt=y,ne.p=f,J.T=c}}s.current=a,rn=2}}function Iw(){if(rn===2){rn=0;var s=io,a=tc,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=J.T,J.T=null;var f=ne.p;ne.p=2;var y=tt;tt|=4;try{iw(s,a.alternate,a)}finally{tt=y,ne.p=f,J.T=c}}rn=3}}function Nw(){if(rn===4||rn===3){rn=0,Vf();var s=io,a=tc,c=ms,f=yw;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?rn=5:(rn=0,tc=io=null,Mw(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(ro=null),Ji(c),a=a.stateNode,yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(Hr,a,void 0,(a.current.flags&128)===128)}catch{}if(f!==null){a=J.T,y=ne.p,ne.p=2,J.T=null;try{for(var v=s.onRecoverableError,w=0;w<f.length;w++){var k=f[w];v(k.value,{componentStack:k.stack})}}finally{J.T=a,ne.p=y}}(ms&3)!==0&&Kd(),Mi(s),y=s.pendingLanes,(c&261930)!==0&&(y&42)!==0?s===Tv?Xu++:(Xu=0,Tv=s):Xu=0,Zu(0)}}function Mw(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Ou(a)))}function Kd(){return kw(),Iw(),Nw(),Ow()}function Ow(){if(rn!==5)return!1;var s=io,a=_v;_v=0;var c=Ji(ms),f=J.T,y=ne.p;try{ne.p=32>c?32:c,J.T=null,c=Ev,Ev=null;var v=io,w=ms;if(rn=0,tc=io=null,ms=0,(tt&6)!==0)throw Error(r(331));var k=tt;if(tt|=4,pw(v.current),hw(v,v.current,w,c),tt=k,Zu(0,!1),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(Hr,v)}catch{}return!0}finally{ne.p=y,J.T=f,Mw(s,a)}}function Dw(s,a,c){a=Rr(c,a),a=ev(s.stateNode,a,2),s=Js(s,a,2),s!==null&&(ha(s,2),Mi(s))}function it(s,a,c){if(s.tag===3)Dw(s,s,c);else for(;a!==null;){if(a.tag===3){Dw(a,s,c);break}else if(a.tag===1){var f=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ro===null||!ro.has(f))){s=Rr(c,s),c=LS(2),f=Js(a,c,2),f!==null&&(PS(c,f,a,s),ha(f,2),Mi(f));break}}a=a.return}}function Av(s,a,c){var f=s.pingCache;if(f===null){f=s.pingCache=new GD;var y=new Set;f.set(a,y)}else y=f.get(a),y===void 0&&(y=new Set,f.set(a,y));y.has(c)||(yv=!0,y.add(c),s=JD.bind(null,s,a,c),a.then(s,s))}function JD(s,a,c){var f=s.pingCache;f!==null&&f.delete(a),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,ft===s&&(He&c)===c&&(xt===4||xt===3&&(He&62914560)===He&&300>Un()-zd?(tt&2)===0&&nc(s,0):vv|=c,ec===He&&(ec=0)),Mi(s)}function Lw(s,a){a===0&&(a=Hf()),s=Aa(s,a),s!==null&&(ha(s,a),Mi(s))}function XD(s){var a=s.memoizedState,c=0;a!==null&&(c=a.retryLane),Lw(s,c)}function ZD(s,a){var c=0;switch(s.tag){case 31:case 13:var f=s.stateNode,y=s.memoizedState;y!==null&&(c=y.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(a),Lw(s,c)}function e2(s,a){return nn(s,a)}var Wd=null,ic=null,Cv=!1,Qd=!1,xv=!1,oo=0;function Mi(s){s!==ic&&s.next===null&&(ic===null?Wd=ic=s:ic=ic.next=s),Qd=!0,Cv||(Cv=!0,n2())}function Zu(s,a){if(!xv&&Qd){xv=!0;do for(var c=!1,f=Wd;f!==null;){if(s!==0){var y=f.pendingLanes;if(y===0)var v=0;else{var w=f.suspendedLanes,k=f.pingedLanes;v=(1<<31-Ot(42|s)+1)-1,v&=y&~(w&~k),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(c=!0,Uw(f,v))}else v=He,v=pi(f,f===ft?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(v&3)===0||qr(f,v)||(c=!0,Uw(f,v));f=f.next}while(c);xv=!1}}function t2(){Pw()}function Pw(){Qd=Cv=!1;var s=0;oo!==0&&f2()&&(s=oo);for(var a=Un(),c=null,f=Wd;f!==null;){var y=f.next,v=Vw(f,a);v===0?(f.next=null,c===null?Wd=y:c.next=y,y===null&&(ic=c)):(c=f,(s!==0||(v&3)!==0)&&(Qd=!0)),f=y}rn!==0&&rn!==5||Zu(s),oo!==0&&(oo=0)}function Vw(s,a){for(var c=s.suspendedLanes,f=s.pingedLanes,y=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var w=31-Ot(v),k=1<<w,U=y[w];U===-1?((k&c)===0||(k&f)!==0)&&(y[w]=ny(k,a)):U<=a&&(s.expiredLanes|=k),v&=~k}if(a=ft,c=He,c=pi(s,s===a?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,c===0||s===a&&(rt===2||rt===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&Ds(f),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||qr(s,c)){if(a=c&-c,a===s.callbackPriority)return a;switch(f!==null&&Ds(f),Ji(c)){case 2:case 8:c=cu;break;case 32:c=Ls;break;case 268435456:c=jf;break;default:c=Ls}return f=jw.bind(null,s),c=nn(c,f),s.callbackPriority=a,s.callbackNode=c,a}return f!==null&&f!==null&&Ds(f),s.callbackPriority=2,s.callbackNode=null,2}function jw(s,a){if(rn!==0&&rn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(Kd()&&s.callbackNode!==c)return null;var f=He;return f=pi(s,s===ft?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(bw(s,f,a),Vw(s,Un()),s.callbackNode!=null&&s.callbackNode===c?jw.bind(null,s):null)}function Uw(s,a){if(Kd())return null;bw(s,a,!0)}function n2(){p2(function(){(tt&6)!==0?nn(lu,t2):Pw()})}function Rv(){if(oo===0){var s=Hl;s===0&&(s=fi,fi<<=1,(fi&261888)===0&&(fi=256)),oo=s}return oo}function Bw(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Rl(""+s)}function zw(s,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,s.id&&c.setAttribute("form",s.id),a.parentNode.insertBefore(c,a),s=new FormData(s),c.parentNode.removeChild(c),s}function r2(s,a,c,f,y){if(a==="submit"&&c&&c.stateNode===y){var v=Bw((y[an]||null).action),w=f.submitter;w&&(a=(a=w[an]||null)?Bw(a.formAction):w.getAttribute("formAction"),a!==null&&(v=a,w=null));var k=new Ai("action","action",null,f,y);s.push({event:k,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(oo!==0){var U=w?zw(y,w):new FormData(y);Wy(c,{pending:!0,data:U,method:y.method,action:v},null,U)}}else typeof v=="function"&&(k.preventDefault(),U=w?zw(y,w):new FormData(y),Wy(c,{pending:!0,data:U,method:y.method,action:v},v,U))},currentTarget:y}]})}}for(var kv=0;kv<hy.length;kv++){var Iv=hy[kv],i2=Iv.toLowerCase(),s2=Iv[0].toUpperCase()+Iv.slice(1);Xr(i2,"on"+s2)}Xr(vT,"onAnimationEnd"),Xr(bT,"onAnimationIteration"),Xr(_T,"onAnimationStart"),Xr("dblclick","onDoubleClick"),Xr("focusin","onFocus"),Xr("focusout","onBlur"),Xr(ED,"onTransitionRun"),Xr(TD,"onTransitionStart"),Xr(SD,"onTransitionCancel"),Xr(ET,"onTransitionEnd"),Ei("onMouseEnter",["mouseout","mouseover"]),Ei("onMouseLeave",["mouseout","mouseover"]),Ei("onPointerEnter",["pointerout","pointerover"]),Ei("onPointerLeave",["pointerout","pointerover"]),_i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_i("onBeforeInput",["compositionend","keypress","textInput","paste"]),_i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var eh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(eh));function Fw(s,a){a=(a&4)!==0;for(var c=0;c<s.length;c++){var f=s[c],y=f.event;f=f.listeners;e:{var v=void 0;if(a)for(var w=f.length-1;0<=w;w--){var k=f[w],U=k.instance,Q=k.currentTarget;if(k=k.listener,U!==v&&y.isPropagationStopped())break e;v=k,y.currentTarget=Q;try{v(y)}catch(te){ud(te)}y.currentTarget=null,v=U}else for(w=0;w<f.length;w++){if(k=f[w],U=k.instance,Q=k.currentTarget,k=k.listener,U!==v&&y.isPropagationStopped())break e;v=k,y.currentTarget=Q;try{v(y)}catch(te){ud(te)}y.currentTarget=null,v=U}}}}function Fe(s,a){var c=a[Sl];c===void 0&&(c=a[Sl]=new Set);var f=s+"__bubble";c.has(f)||(Hw(a,s,2,!1),c.add(f))}function Nv(s,a,c){var f=0;a&&(f|=4),Hw(c,s,f,a)}var Yd="_reactListening"+Math.random().toString(36).slice(2);function Mv(s){if(!s[Yd]){s[Yd]=!0,fu.forEach(function(c){c!=="selectionchange"&&(o2.has(c)||Nv(c,!1,s),Nv(c,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Yd]||(a[Yd]=!0,Nv("selectionchange",!1,a))}}function Hw(s,a,c,f){switch(v1(a)){case 2:var y=D2;break;case 8:y=L2;break;default:y=Kv}c=y.bind(null,a,c,s),y=void 0,!ya||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(y=!0),f?y!==void 0?s.addEventListener(a,c,{capture:!0,passive:y}):s.addEventListener(a,c,!0):y!==void 0?s.addEventListener(a,c,{passive:y}):s.addEventListener(a,c,!1)}function Ov(s,a,c,f,y){var v=f;if((a&1)===0&&(a&2)===0&&f!==null)e:for(;;){if(f===null)return;var w=f.tag;if(w===3||w===4){var k=f.stateNode.containerInfo;if(k===y)break;if(w===4)for(w=f.return;w!==null;){var U=w.tag;if((U===3||U===4)&&w.stateNode.containerInfo===y)return;w=w.return}for(;k!==null;){if(w=vi(k),w===null)return;if(U=w.tag,U===5||U===6||U===26||U===27){f=v=w;continue e}k=k.parentNode}}f=f.return}zs(function(){var Q=v,te=wr(c),oe=[];e:{var X=TT.get(s);if(X!==void 0){var ee=Ai,be=s;switch(s){case"keypress":if(ba(c)===0)break e;case"keydown":case"keyup":ee=ad;break;case"focusin":be="focus",ee=Ea;break;case"focusout":be="blur",ee=Ea;break;case"beforeblur":case"afterblur":ee=Ea;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=Au;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=Xf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=E;break;case vT:case bT:case _T:ee=ed;break;case ET:ee=O;break;case"scroll":case"scrollend":ee=wu;break;case"wheel":ee=Z;break;case"copy":case"cut":case"paste":ee=td;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=es;break;case"toggle":case"beforetoggle":ee=De}var Ce=(a&4)!==0,ct=!Ce&&(s==="scroll"||s==="scrollend"),q=Ce?X!==null?X+"Capture":null:X;Ce=[];for(var H=Q,W;H!==null;){var re=H;if(W=re.stateNode,re=re.tag,re!==5&&re!==26&&re!==27||W===null||q===null||(re=Wr(H,q),re!=null&&Ce.push(th(H,re,W))),ct)break;H=H.return}0<Ce.length&&(X=new ee(X,be,null,c,te),oe.push({event:X,listeners:Ce}))}}if((a&7)===0){e:{if(X=s==="mouseover"||s==="pointerover",ee=s==="mouseout"||s==="pointerout",X&&c!==Eu&&(be=c.relatedTarget||c.fromElement)&&(vi(be)||be[gi]))break e;if((ee||X)&&(X=te.window===te?te:(X=te.ownerDocument)?X.defaultView||X.parentWindow:window,ee?(be=c.relatedTarget||c.toElement,ee=Q,be=be?vi(be):null,be!==null&&(ct=o(be),Ce=be.tag,be!==ct||Ce!==5&&Ce!==27&&Ce!==6)&&(be=null)):(ee=null,be=Q),ee!==be)){if(Ce=Au,re="onMouseLeave",q="onMouseEnter",H="mouse",(s==="pointerout"||s==="pointerover")&&(Ce=es,re="onPointerLeave",q="onPointerEnter",H="pointer"),ct=ee==null?X:sr(ee),W=be==null?X:sr(be),X=new Ce(re,H+"leave",ee,c,te),X.target=ct,X.relatedTarget=W,re=null,vi(te)===Q&&(Ce=new Ce(q,H+"enter",be,c,te),Ce.target=W,Ce.relatedTarget=ct,re=Ce),ct=re,ee&&be)t:{for(Ce=a2,q=ee,H=be,W=0,re=q;re;re=Ce(re))W++;re=0;for(var Se=H;Se;Se=Ce(Se))re++;for(;0<W-re;)q=Ce(q),W--;for(;0<re-W;)H=Ce(H),re--;for(;W--;){if(q===H||H!==null&&q===H.alternate){Ce=q;break t}q=Ce(q),H=Ce(H)}Ce=null}else Ce=null;ee!==null&&qw(oe,X,ee,Ce,!1),be!==null&&ct!==null&&qw(oe,ct,be,Ce,!0)}}e:{if(X=Q?sr(Q):window,ee=X.nodeName&&X.nodeName.toLowerCase(),ee==="select"||ee==="input"&&X.type==="file")var Xe=aT;else if(sT(X))if(lT)Xe=vD;else{Xe=gD;var _e=mD}else ee=X.nodeName,!ee||ee.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?Q&&xl(Q.elementType)&&(Xe=aT):Xe=yD;if(Xe&&(Xe=Xe(s,Q))){oT(oe,Xe,c,te);break e}_e&&_e(s,X,Q),s==="focusout"&&Q&&X.type==="number"&&Q.memoizedProps.value!=null&&vu(X,"number",X.value)}switch(_e=Q?sr(Q):window,s){case"focusin":(sT(_e)||_e.contentEditable==="true")&&(Ll=_e,ly=Q,Iu=null);break;case"focusout":Iu=ly=Ll=null;break;case"mousedown":cy=!0;break;case"contextmenu":case"mouseup":case"dragend":cy=!1,gT(oe,c,te);break;case"selectionchange":if(_D)break;case"keydown":case"keyup":gT(oe,c,te)}var Ve;if(et)e:{switch(s){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else Dl?Ta(s,c)&&(qe="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(qe="onCompositionStart");qe&&(Ri&&c.locale!=="ko"&&(Dl||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&Dl&&(Ve=Su()):(wi=te,Tu="value"in wi?wi.value:wi.textContent,Dl=!0)),_e=Jd(Q,qe),0<_e.length&&(qe=new xi(qe,s,null,c,te),oe.push({event:qe,listeners:_e}),Ve?qe.data=Ve:(Ve=Ol(c),Ve!==null&&(qe.data=Ve)))),(Ve=Cr?hD(s,c):fD(s,c))&&(qe=Jd(Q,"onBeforeInput"),0<qe.length&&(_e=new xi("onBeforeInput","beforeinput",null,c,te),oe.push({event:_e,listeners:qe}),_e.data=Ve)),r2(oe,s,Q,c,te)}Fw(oe,a)})}function th(s,a,c){return{instance:s,listener:a,currentTarget:c}}function Jd(s,a){for(var c=a+"Capture",f=[];s!==null;){var y=s,v=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||v===null||(y=Wr(s,c),y!=null&&f.unshift(th(s,y,v)),y=Wr(s,a),y!=null&&f.push(th(s,y,v))),s.tag===3)return f;s=s.return}return[]}function a2(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function qw(s,a,c,f,y){for(var v=a._reactName,w=[];c!==null&&c!==f;){var k=c,U=k.alternate,Q=k.stateNode;if(k=k.tag,U!==null&&U===f)break;k!==5&&k!==26&&k!==27||Q===null||(U=Q,y?(Q=Wr(c,v),Q!=null&&w.unshift(th(c,Q,U))):y||(Q=Wr(c,v),Q!=null&&w.push(th(c,Q,U)))),c=c.return}w.length!==0&&s.push({event:a,listeners:w})}var l2=/\r\n?/g,c2=/\u0000|\uFFFD/g;function $w(s){return(typeof s=="string"?s:""+s).replace(l2,`
`).replace(c2,"")}function Gw(s,a){return a=$w(a),$w(s)===a}function lt(s,a,c,f,y,v){switch(c){case"children":typeof f=="string"?a==="body"||a==="textarea"&&f===""||Qn(s,f):(typeof f=="number"||typeof f=="bigint")&&a!=="body"&&Qn(s,""+f);break;case"className":or(s,"class",f);break;case"tabIndex":or(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":or(s,c,f);break;case"style":_u(s,f,v);break;case"data":if(a!=="object"){or(s,"data",f);break}case"src":case"href":if(f===""&&(a!=="a"||c!=="href")){s.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=Rl(""+f),s.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(c==="formAction"?(a!=="input"&&lt(s,a,"name",y.name,y,null),lt(s,a,"formEncType",y.formEncType,y,null),lt(s,a,"formMethod",y.formMethod,y,null),lt(s,a,"formTarget",y.formTarget,y,null)):(lt(s,a,"encType",y.encType,y,null),lt(s,a,"method",y.method,y,null),lt(s,a,"target",y.target,y,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=Rl(""+f),s.setAttribute(c,f);break;case"onClick":f!=null&&(s.onclick=Kr);break;case"onScroll":f!=null&&Fe("scroll",s);break;case"onScrollEnd":f!=null&&Fe("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(c=f.__html,c!=null){if(y.children!=null)throw Error(r(60));s.innerHTML=c}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}c=Rl(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""+f):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":f===!0?s.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,f):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(c,f):s.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(c):s.setAttribute(c,f);break;case"popover":Fe("beforetoggle",s),Fe("toggle",s),Al(s,"popover",f);break;case"xlinkActuate":qt(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":qt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":qt(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":qt(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":qt(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":qt(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":qt(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":qt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":qt(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Al(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Jf.get(c)||c,Al(s,c,f))}}function Dv(s,a,c,f,y,v){switch(c){case"style":_u(s,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(c=f.__html,c!=null){if(y.children!=null)throw Error(r(60));s.innerHTML=c}}break;case"children":typeof f=="string"?Qn(s,f):(typeof f=="number"||typeof f=="bigint")&&Qn(s,""+f);break;case"onScroll":f!=null&&Fe("scroll",s);break;case"onScrollEnd":f!=null&&Fe("scrollend",s);break;case"onClick":f!=null&&(s.onclick=Kr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!du.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(y=c.endsWith("Capture"),a=c.slice(2,y?c.length-7:void 0),v=s[an]||null,v=v!=null?v[c]:null,typeof v=="function"&&s.removeEventListener(a,v,y),typeof f=="function")){typeof v!="function"&&v!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(a,f,y);break e}c in s?s[c]=f:f===!0?s.setAttribute(c,""):Al(s,c,f)}}}function Tn(s,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Fe("error",s),Fe("load",s);var f=!1,y=!1,v;for(v in c)if(c.hasOwnProperty(v)){var w=c[v];if(w!=null)switch(v){case"src":f=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:lt(s,a,v,w,c,null)}}y&&lt(s,a,"srcSet",c.srcSet,c,null),f&&lt(s,a,"src",c.src,c,null);return;case"input":Fe("invalid",s);var k=v=w=y=null,U=null,Q=null;for(f in c)if(c.hasOwnProperty(f)){var te=c[f];if(te!=null)switch(f){case"name":y=te;break;case"type":w=te;break;case"checked":U=te;break;case"defaultChecked":Q=te;break;case"value":v=te;break;case"defaultValue":k=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(r(137,a));break;default:lt(s,a,f,te,c,null)}}Wf(s,v,k,U,Q,w,y,!1);return;case"select":Fe("invalid",s),f=w=v=null;for(y in c)if(c.hasOwnProperty(y)&&(k=c[y],k!=null))switch(y){case"value":v=k;break;case"defaultValue":w=k;break;case"multiple":f=k;default:lt(s,a,y,k,c,null)}a=v,c=w,s.multiple=!!f,a!=null?Vs(s,!!f,a,!1):c!=null&&Vs(s,!!f,c,!0);return;case"textarea":Fe("invalid",s),v=y=f=null;for(w in c)if(c.hasOwnProperty(w)&&(k=c[w],k!=null))switch(w){case"value":f=k;break;case"defaultValue":y=k;break;case"children":v=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(r(91));break;default:lt(s,a,w,k,c,null)}js(s,f,y,v);return;case"option":for(U in c)c.hasOwnProperty(U)&&(f=c[U],f!=null)&&(U==="selected"?s.selected=f&&typeof f!="function"&&typeof f!="symbol":lt(s,a,U,f,c,null));return;case"dialog":Fe("beforetoggle",s),Fe("toggle",s),Fe("cancel",s),Fe("close",s);break;case"iframe":case"object":Fe("load",s);break;case"video":case"audio":for(f=0;f<eh.length;f++)Fe(eh[f],s);break;case"image":Fe("error",s),Fe("load",s);break;case"details":Fe("toggle",s);break;case"embed":case"source":case"link":Fe("error",s),Fe("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in c)if(c.hasOwnProperty(Q)&&(f=c[Q],f!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:lt(s,a,Q,f,c,null)}return;default:if(xl(a)){for(te in c)c.hasOwnProperty(te)&&(f=c[te],f!==void 0&&Dv(s,a,te,f,c,void 0));return}}for(k in c)c.hasOwnProperty(k)&&(f=c[k],f!=null&&lt(s,a,k,f,c,null))}function u2(s,a,c,f){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,v=null,w=null,k=null,U=null,Q=null,te=null;for(ee in c){var oe=c[ee];if(c.hasOwnProperty(ee)&&oe!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":U=oe;default:f.hasOwnProperty(ee)||lt(s,a,ee,null,f,oe)}}for(var X in f){var ee=f[X];if(oe=c[X],f.hasOwnProperty(X)&&(ee!=null||oe!=null))switch(X){case"type":v=ee;break;case"name":y=ee;break;case"checked":Q=ee;break;case"defaultChecked":te=ee;break;case"value":w=ee;break;case"defaultValue":k=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(137,a));break;default:ee!==oe&&lt(s,a,X,ee,f,oe)}}Cl(s,w,k,U,Q,te,v,y);return;case"select":ee=w=k=X=null;for(v in c)if(U=c[v],c.hasOwnProperty(v)&&U!=null)switch(v){case"value":break;case"multiple":ee=U;default:f.hasOwnProperty(v)||lt(s,a,v,null,f,U)}for(y in f)if(v=f[y],U=c[y],f.hasOwnProperty(y)&&(v!=null||U!=null))switch(y){case"value":X=v;break;case"defaultValue":k=v;break;case"multiple":w=v;default:v!==U&&lt(s,a,y,v,f,U)}a=k,c=w,f=ee,X!=null?Vs(s,!!c,X,!1):!!f!=!!c&&(a!=null?Vs(s,!!c,a,!0):Vs(s,!!c,c?[]:"",!1));return;case"textarea":ee=X=null;for(k in c)if(y=c[k],c.hasOwnProperty(k)&&y!=null&&!f.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:lt(s,a,k,null,f,y)}for(w in f)if(y=f[w],v=c[w],f.hasOwnProperty(w)&&(y!=null||v!=null))switch(w){case"value":X=y;break;case"defaultValue":ee=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==v&&lt(s,a,w,y,f,v)}Qf(s,X,ee);return;case"option":for(var be in c)X=c[be],c.hasOwnProperty(be)&&X!=null&&!f.hasOwnProperty(be)&&(be==="selected"?s.selected=!1:lt(s,a,be,null,f,X));for(U in f)X=f[U],ee=c[U],f.hasOwnProperty(U)&&X!==ee&&(X!=null||ee!=null)&&(U==="selected"?s.selected=X&&typeof X!="function"&&typeof X!="symbol":lt(s,a,U,X,f,ee));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in c)X=c[Ce],c.hasOwnProperty(Ce)&&X!=null&&!f.hasOwnProperty(Ce)&&lt(s,a,Ce,null,f,X);for(Q in f)if(X=f[Q],ee=c[Q],f.hasOwnProperty(Q)&&X!==ee&&(X!=null||ee!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(r(137,a));break;default:lt(s,a,Q,X,f,ee)}return;default:if(xl(a)){for(var ct in c)X=c[ct],c.hasOwnProperty(ct)&&X!==void 0&&!f.hasOwnProperty(ct)&&Dv(s,a,ct,void 0,f,X);for(te in f)X=f[te],ee=c[te],!f.hasOwnProperty(te)||X===ee||X===void 0&&ee===void 0||Dv(s,a,te,X,f,ee);return}}for(var q in c)X=c[q],c.hasOwnProperty(q)&&X!=null&&!f.hasOwnProperty(q)&&lt(s,a,q,null,f,X);for(oe in f)X=f[oe],ee=c[oe],!f.hasOwnProperty(oe)||X===ee||X==null&&ee==null||lt(s,a,oe,X,f,ee)}function Kw(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function h2(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var y=c[f],v=y.transferSize,w=y.initiatorType,k=y.duration;if(v&&k&&Kw(w)){for(w=0,k=y.responseEnd,f+=1;f<c.length;f++){var U=c[f],Q=U.startTime;if(Q>k)break;var te=U.transferSize,oe=U.initiatorType;te&&Kw(oe)&&(U=U.responseEnd,w+=te*(U<k?1:(k-Q)/(U-Q)))}if(--f,a+=8*(v+w)/(y.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Lv=null,Pv=null;function Xd(s){return s.nodeType===9?s:s.ownerDocument}function Ww(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qw(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function Vv(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var jv=null;function f2(){var s=window.event;return s&&s.type==="popstate"?s===jv?!1:(jv=s,!0):(jv=null,!1)}var Yw=typeof setTimeout=="function"?setTimeout:void 0,d2=typeof clearTimeout=="function"?clearTimeout:void 0,Jw=typeof Promise=="function"?Promise:void 0,p2=typeof queueMicrotask=="function"?queueMicrotask:typeof Jw<"u"?function(s){return Jw.resolve(null).then(s).catch(m2)}:Yw;function m2(s){setTimeout(function(){throw s})}function ao(s){return s==="head"}function Xw(s,a){var c=a,f=0;do{var y=c.nextSibling;if(s.removeChild(c),y&&y.nodeType===8)if(c=y.data,c==="/$"||c==="/&"){if(f===0){s.removeChild(y),lc(a);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")nh(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,nh(c);for(var v=c.firstChild;v;){var w=v.nextSibling,k=v.nodeName;v[yi]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&v.rel.toLowerCase()==="stylesheet"||c.removeChild(v),v=w}}else c==="body"&&nh(s.ownerDocument.body);c=y}while(c);lc(a)}function Zw(s,a){var c=s;s=0;do{var f=c.nextSibling;if(c.nodeType===1?a?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(a?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=f}while(c)}function Uv(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Uv(c),wl(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function g2(s,a,c,f){for(;s.nodeType===1;){var y=c;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[yi])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var v=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=Or(s.nextSibling),s===null)break}return null}function y2(s,a,c){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Or(s.nextSibling),s===null))return null;return s}function e1(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=Or(s.nextSibling),s===null))return null;return s}function Bv(s){return s.data==="$?"||s.data==="$~"}function zv(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function v2(s,a){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||c.readyState!=="loading")a();else{var f=function(){a(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function Or(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var Fv=null;function t1(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(a===0)return Or(s.nextSibling);a--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||a++}s=s.nextSibling}return null}function n1(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(a===0)return s;a--}else c!=="/$"&&c!=="/&"||a++}s=s.previousSibling}return null}function r1(s,a,c){switch(a=Xd(c),s){case"html":if(s=a.documentElement,!s)throw Error(r(452));return s;case"head":if(s=a.head,!s)throw Error(r(453));return s;case"body":if(s=a.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function nh(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);wl(s)}var Dr=new Map,i1=new Set;function Zd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var gs=ne.d;ne.d={f:b2,r:_2,D:E2,C:T2,L:S2,m:w2,X:C2,S:A2,M:x2};function b2(){var s=gs.f(),a=qd();return s||a}function _2(s){var a=Sr(s);a!==null&&a.tag===5&&a.type==="form"?ES(a):gs.r(s)}var sc=typeof document>"u"?null:document;function s1(s,a,c){var f=sc;if(f&&typeof a=="string"&&a){var y=Wn(a);y='link[rel="'+s+'"][href="'+y+'"]',typeof c=="string"&&(y+='[crossorigin="'+c+'"]'),i1.has(y)||(i1.add(y),s={rel:s,crossOrigin:c,href:a},f.querySelector(y)===null&&(a=f.createElement("link"),Tn(a,"link",s),Ht(a),f.head.appendChild(a)))}}function E2(s){gs.D(s),s1("dns-prefetch",s,null)}function T2(s,a){gs.C(s,a),s1("preconnect",s,a)}function S2(s,a,c){gs.L(s,a,c);var f=sc;if(f&&s&&a){var y='link[rel="preload"][as="'+Wn(a)+'"]';a==="image"&&c&&c.imageSrcSet?(y+='[imagesrcset="'+Wn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(y+='[imagesizes="'+Wn(c.imageSizes)+'"]')):y+='[href="'+Wn(s)+'"]';var v=y;switch(a){case"style":v=oc(s);break;case"script":v=ac(s)}Dr.has(v)||(s=g({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:s,as:a},c),Dr.set(v,s),f.querySelector(y)!==null||a==="style"&&f.querySelector(rh(v))||a==="script"&&f.querySelector(ih(v))||(a=f.createElement("link"),Tn(a,"link",s),Ht(a),f.head.appendChild(a)))}}function w2(s,a){gs.m(s,a);var c=sc;if(c&&s){var f=a&&typeof a.as=="string"?a.as:"script",y='link[rel="modulepreload"][as="'+Wn(f)+'"][href="'+Wn(s)+'"]',v=y;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ac(s)}if(!Dr.has(v)&&(s=g({rel:"modulepreload",href:s},a),Dr.set(v,s),c.querySelector(y)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ih(v)))return}f=c.createElement("link"),Tn(f,"link",s),Ht(f),c.head.appendChild(f)}}}function A2(s,a,c){gs.S(s,a,c);var f=sc;if(f&&s){var y=bi(f).hoistableStyles,v=oc(s);a=a||"default";var w=y.get(v);if(!w){var k={loading:0,preload:null};if(w=f.querySelector(rh(v)))k.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":a},c),(c=Dr.get(v))&&Hv(s,c);var U=w=f.createElement("link");Ht(U),Tn(U,"link",s),U._p=new Promise(function(Q,te){U.onload=Q,U.onerror=te}),U.addEventListener("load",function(){k.loading|=1}),U.addEventListener("error",function(){k.loading|=2}),k.loading|=4,ep(w,a,f)}w={type:"stylesheet",instance:w,count:1,state:k},y.set(v,w)}}}function C2(s,a){gs.X(s,a);var c=sc;if(c&&s){var f=bi(c).hoistableScripts,y=ac(s),v=f.get(y);v||(v=c.querySelector(ih(y)),v||(s=g({src:s,async:!0},a),(a=Dr.get(y))&&qv(s,a),v=c.createElement("script"),Ht(v),Tn(v,"link",s),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(y,v))}}function x2(s,a){gs.M(s,a);var c=sc;if(c&&s){var f=bi(c).hoistableScripts,y=ac(s),v=f.get(y);v||(v=c.querySelector(ih(y)),v||(s=g({src:s,async:!0,type:"module"},a),(a=Dr.get(y))&&qv(s,a),v=c.createElement("script"),Ht(v),Tn(v,"link",s),c.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(y,v))}}function o1(s,a,c,f){var y=(y=Pe.current)?Zd(y):null;if(!y)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=oc(c.href),c=bi(y).hoistableStyles,f=c.get(a),f||(f={type:"style",instance:null,count:0,state:null},c.set(a,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=oc(c.href);var v=bi(y).hoistableStyles,w=v.get(s);if(w||(y=y.ownerDocument||y,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,w),(v=y.querySelector(rh(s)))&&!v._p&&(w.instance=v,w.state.loading=5),Dr.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Dr.set(s,c),v||R2(y,s,c,w.state))),a&&f===null)throw Error(r(528,""));return w}if(a&&f!==null)throw Error(r(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=ac(c),c=bi(y).hoistableScripts,f=c.get(a),f||(f={type:"script",instance:null,count:0,state:null},c.set(a,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function oc(s){return'href="'+Wn(s)+'"'}function rh(s){return'link[rel="stylesheet"]['+s+"]"}function a1(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function R2(s,a,c,f){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?f.loading=1:(a=s.createElement("link"),f.preload=a,a.addEventListener("load",function(){return f.loading|=1}),a.addEventListener("error",function(){return f.loading|=2}),Tn(a,"link",c),Ht(a),s.head.appendChild(a))}function ac(s){return'[src="'+Wn(s)+'"]'}function ih(s){return"script[async]"+s}function l1(s,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var f=s.querySelector('style[data-href~="'+Wn(c.href)+'"]');if(f)return a.instance=f,Ht(f),f;var y=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),Ht(f),Tn(f,"style",y),ep(f,c.precedence,s),a.instance=f;case"stylesheet":y=oc(c.href);var v=s.querySelector(rh(y));if(v)return a.state.loading|=4,a.instance=v,Ht(v),v;f=a1(c),(y=Dr.get(y))&&Hv(f,y),v=(s.ownerDocument||s).createElement("link"),Ht(v);var w=v;return w._p=new Promise(function(k,U){w.onload=k,w.onerror=U}),Tn(v,"link",f),a.state.loading|=4,ep(v,c.precedence,s),a.instance=v;case"script":return v=ac(c.src),(y=s.querySelector(ih(v)))?(a.instance=y,Ht(y),y):(f=c,(y=Dr.get(v))&&(f=g({},c),qv(f,y)),s=s.ownerDocument||s,y=s.createElement("script"),Ht(y),Tn(y,"link",f),s.head.appendChild(y),a.instance=y);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(f=a.instance,a.state.loading|=4,ep(f,c.precedence,s));return a.instance}function ep(s,a,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=f.length?f[f.length-1]:null,v=y,w=0;w<f.length;w++){var k=f[w];if(k.dataset.precedence===a)v=k;else if(v!==y)break}v?v.parentNode.insertBefore(s,v.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(s,a.firstChild))}function Hv(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function qv(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var tp=null;function c1(s,a,c){if(tp===null){var f=new Map,y=tp=new Map;y.set(c,f)}else y=tp,f=y.get(c),f||(f=new Map,y.set(c,f));if(f.has(s))return f;for(f.set(s,null),c=c.getElementsByTagName(s),y=0;y<c.length;y++){var v=c[y];if(!(v[yi]||v[Ft]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var w=v.getAttribute(a)||"";w=s+w;var k=f.get(w);k?k.push(v):f.set(w,[v])}}return f}function u1(s,a,c){s=s.ownerDocument||s,s.head.insertBefore(c,a==="title"?s.querySelector("head > title"):null)}function k2(s,a,c){if(c===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function h1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function I2(s,a,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var y=oc(f.href),v=a.querySelector(rh(y));if(v){a=v._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=np.bind(s),a.then(s,s)),c.state.loading|=4,c.instance=v,Ht(v);return}v=a.ownerDocument||a,f=a1(f),(y=Dr.get(y))&&Hv(f,y),v=v.createElement("link"),Ht(v);var w=v;w._p=new Promise(function(k,U){w.onload=k,w.onerror=U}),Tn(v,"link",f),c.instance=v}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=np.bind(s),a.addEventListener("load",c),a.addEventListener("error",c))}}var $v=0;function N2(s,a){return s.stylesheets&&s.count===0&&ip(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var f=setTimeout(function(){if(s.stylesheets&&ip(s,s.stylesheets),s.unsuspend){var v=s.unsuspend;s.unsuspend=null,v()}},6e4+a);0<s.imgBytes&&$v===0&&($v=62500*h2());var y=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&ip(s,s.stylesheets),s.unsuspend)){var v=s.unsuspend;s.unsuspend=null,v()}},(s.imgBytes>$v?50:800)+a);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(f),clearTimeout(y)}}:null}function np(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ip(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var rp=null;function ip(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,rp=new Map,a.forEach(M2,s),rp=null,np.call(s))}function M2(s,a){if(!(a.state.loading&4)){var c=rp.get(s);if(c)var f=c.get(null);else{c=new Map,rp.set(s,c);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<y.length;v++){var w=y[v];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(c.set(w.dataset.precedence,w),f=w)}f&&c.set(null,f)}y=a.instance,w=y.getAttribute("data-precedence"),v=c.get(w)||f,v===f&&c.set(null,y),c.set(w,y),this.count++,f=np.bind(this),y.addEventListener("load",f),y.addEventListener("error",f),v?v.parentNode.insertBefore(y,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),a.state.loading|=4}}var sh={$$typeof:j,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function O2(s,a,c,f,y,v,w,k,U){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=mi(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mi(0),this.hiddenUpdates=mi(null),this.identifierPrefix=f,this.onUncaughtError=y,this.onCaughtError=v,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function f1(s,a,c,f,y,v,w,k,U,Q,te,oe){return s=new O2(s,a,c,w,U,Q,te,oe,k),a=1,v===!0&&(a|=24),v=lr(3,null,null,a),s.current=v,v.stateNode=s,a=wy(),a.refCount++,s.pooledCache=a,a.refCount++,v.memoizedState={element:f,isDehydrated:c,cache:a},Ry(v),s}function d1(s){return s?(s=jl,s):jl}function p1(s,a,c,f,y,v){y=d1(y),f.context===null?f.context=y:f.pendingContext=y,f=Ys(a),f.payload={element:c},v=v===void 0?null:v,v!==null&&(f.callback=v),c=Js(s,f,a),c!==null&&(er(c,s,a),Vu(c,s,a))}function m1(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<a?c:a}}function Gv(s,a){m1(s,a),(s=s.alternate)&&m1(s,a)}function g1(s){if(s.tag===13||s.tag===31){var a=Aa(s,67108864);a!==null&&er(a,s,67108864),Gv(s,67108864)}}function y1(s){if(s.tag===13||s.tag===31){var a=dr();a=da(a);var c=Aa(s,a);c!==null&&er(c,s,a),Gv(s,a)}}var sp=!0;function D2(s,a,c,f){var y=J.T;J.T=null;var v=ne.p;try{ne.p=2,Kv(s,a,c,f)}finally{ne.p=v,J.T=y}}function L2(s,a,c,f){var y=J.T;J.T=null;var v=ne.p;try{ne.p=8,Kv(s,a,c,f)}finally{ne.p=v,J.T=y}}function Kv(s,a,c,f){if(sp){var y=Wv(f);if(y===null)Ov(s,a,f,op,c),b1(s,f);else if(V2(y,s,a,c,f))f.stopPropagation();else if(b1(s,f),a&4&&-1<P2.indexOf(s)){for(;y!==null;){var v=Sr(y);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var w=di(v.pendingLanes);if(w!==0){var k=v;for(k.pendingLanes|=2,k.entangledLanes|=2;w;){var U=1<<31-Ot(w);k.entanglements[1]|=U,w&=~U}Mi(v),(tt&6)===0&&(Fd=Un()+500,Zu(0))}}break;case 31:case 13:k=Aa(v,2),k!==null&&er(k,v,2),qd(),Gv(v,2)}if(v=Wv(f),v===null&&Ov(s,a,f,op,c),v===y)break;y=v}y!==null&&f.stopPropagation()}else Ov(s,a,f,null,c)}}function Wv(s){return s=wr(s),Qv(s)}var op=null;function Qv(s){if(op=null,s=vi(s),s!==null){var a=o(s);if(a===null)s=null;else{var c=a.tag;if(c===13){if(s=l(a),s!==null)return s;s=null}else if(c===31){if(s=u(a),s!==null)return s;s=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return op=s,null}function v1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ca()){case lu:return 2;case cu:return 8;case Ls:case ty:return 32;case jf:return 268435456;default:return 32}default:return 32}}var Yv=!1,lo=null,co=null,uo=null,oh=new Map,ah=new Map,ho=[],P2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function b1(s,a){switch(s){case"focusin":case"focusout":lo=null;break;case"dragenter":case"dragleave":co=null;break;case"mouseover":case"mouseout":uo=null;break;case"pointerover":case"pointerout":oh.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":ah.delete(a.pointerId)}}function lh(s,a,c,f,y,v){return s===null||s.nativeEvent!==v?(s={blockedOn:a,domEventName:c,eventSystemFlags:f,nativeEvent:v,targetContainers:[y]},a!==null&&(a=Sr(a),a!==null&&g1(a)),s):(s.eventSystemFlags|=f,a=s.targetContainers,y!==null&&a.indexOf(y)===-1&&a.push(y),s)}function V2(s,a,c,f,y){switch(a){case"focusin":return lo=lh(lo,s,a,c,f,y),!0;case"dragenter":return co=lh(co,s,a,c,f,y),!0;case"mouseover":return uo=lh(uo,s,a,c,f,y),!0;case"pointerover":var v=y.pointerId;return oh.set(v,lh(oh.get(v)||null,s,a,c,f,y)),!0;case"gotpointercapture":return v=y.pointerId,ah.set(v,lh(ah.get(v)||null,s,a,c,f,y)),!0}return!1}function _1(s){var a=vi(s.target);if(a!==null){var c=o(a);if(c!==null){if(a=c.tag,a===13){if(a=l(c),a!==null){s.blockedOn=a,$r(s.priority,function(){y1(c)});return}}else if(a===31){if(a=u(c),a!==null){s.blockedOn=a,$r(s.priority,function(){y1(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ap(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var c=Wv(s.nativeEvent);if(c===null){c=s.nativeEvent;var f=new c.constructor(c.type,c);Eu=f,c.target.dispatchEvent(f),Eu=null}else return a=Sr(c),a!==null&&g1(a),s.blockedOn=c,!1;a.shift()}return!0}function E1(s,a,c){ap(s)&&c.delete(a)}function j2(){Yv=!1,lo!==null&&ap(lo)&&(lo=null),co!==null&&ap(co)&&(co=null),uo!==null&&ap(uo)&&(uo=null),oh.forEach(E1),ah.forEach(E1)}function lp(s,a){s.blockedOn===a&&(s.blockedOn=null,Yv||(Yv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,j2)))}var cp=null;function T1(s){cp!==s&&(cp=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){cp===s&&(cp=null);for(var a=0;a<s.length;a+=3){var c=s[a],f=s[a+1],y=s[a+2];if(typeof f!="function"){if(Qv(f||c)===null)continue;break}var v=Sr(c);v!==null&&(s.splice(a,3),a-=3,Wy(v,{pending:!0,data:y,method:c.method,action:f},f,y))}}))}function lc(s){function a(U){return lp(U,s)}lo!==null&&lp(lo,s),co!==null&&lp(co,s),uo!==null&&lp(uo,s),oh.forEach(a),ah.forEach(a);for(var c=0;c<ho.length;c++){var f=ho[c];f.blockedOn===s&&(f.blockedOn=null)}for(;0<ho.length&&(c=ho[0],c.blockedOn===null);)_1(c),c.blockedOn===null&&ho.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var y=c[f],v=c[f+1],w=y[an]||null;if(typeof v=="function")w||T1(c);else if(w){var k=null;if(v&&v.hasAttribute("formAction")){if(y=v,w=v[an]||null)k=w.formAction;else if(Qv(y)!==null)continue}else k=w.action;typeof k=="function"?c[f+1]=k:(c.splice(f,3),f-=3),T1(c)}}}function S1(){function s(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(w){return y=w})},focusReset:"manual",scroll:"manual"})}function a(){y!==null&&(y(),y=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,y=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),y!==null&&(y(),y=null)}}}function Jv(s){this._internalRoot=s}up.prototype.render=Jv.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(r(409));var c=a.current,f=dr();p1(c,f,s,a,null,null)},up.prototype.unmount=Jv.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;p1(s.current,2,null,s,null,null),qd(),a[gi]=null}};function up(s){this._internalRoot=s}up.prototype.unstable_scheduleHydration=function(s){if(s){var a=qf();s={blockedOn:null,target:s,priority:a};for(var c=0;c<ho.length&&a!==0&&a<ho[c].priority;c++);ho.splice(c,0,s),c===0&&_1(s)}};var w1=e.version;if(w1!=="19.2.4")throw Error(r(527,w1,"19.2.4"));ne.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(a),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var U2={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hp.isDisabled&&hp.supportsFiber)try{Hr=hp.inject(U2),yn=hp}catch{}}return uh.createRoot=function(s,a){if(!i(s))throw Error(r(299));var c=!1,f="",y=NS,v=MS,w=OS;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(f=a.identifierPrefix),a.onUncaughtError!==void 0&&(y=a.onUncaughtError),a.onCaughtError!==void 0&&(v=a.onCaughtError),a.onRecoverableError!==void 0&&(w=a.onRecoverableError)),a=f1(s,1,!1,null,null,c,f,null,y,v,w,S1),s[gi]=a.current,Mv(s),new Jv(a)},uh.hydrateRoot=function(s,a,c){if(!i(s))throw Error(r(299));var f=!1,y="",v=NS,w=MS,k=OS,U=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(v=c.onUncaughtError),c.onCaughtError!==void 0&&(w=c.onCaughtError),c.onRecoverableError!==void 0&&(k=c.onRecoverableError),c.formState!==void 0&&(U=c.formState)),a=f1(s,1,!0,a,c??null,f,y,U,v,w,k,S1),a.context=d1(null),c=a.current,f=dr(),f=da(f),y=Ys(f),y.callback=null,Js(c,y,f),c=f,a.current.lanes=c,ha(a,c),Mi(a),s[gi]=a.current,Mv(s),new up(a)},uh.version="19.2.4",uh}var D1;function W2(){if(D1)return eb.exports;D1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),eb.exports=K2(),eb.exports}var Q2=W2();var L1="popstate";function Y2(n={}){function e(i,o){let{pathname:l="/",search:u="",hash:h=""}=ul(i.location.hash.substring(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),Xb("",{pathname:l,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(i,o){let l=i.document.querySelector("base"),u="";if(l&&l.getAttribute("href")){let h=i.location.href,d=h.indexOf("#");u=d===-1?h:h.slice(0,d)}return u+"#"+(typeof o=="string"?o:Gh(o))}function r(i,o){Fr(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(o)})`)}return X2(e,t,r,n)}function Tt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Fr(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function J2(){return Math.random().toString(36).substring(2,10)}function P1(n,e){return{usr:n.state,key:n.key,idx:e}}function Xb(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?ul(e):e,state:t,key:e&&e.key||r||J2()}}function Gh({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function ul(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function X2(n,e,t,r={}){let{window:i=document.defaultView,v5Compat:o=!1}=r,l=i.history,u="POP",h=null,d=p();d==null&&(d=0,l.replaceState({...l.state,idx:d},""));function p(){return(l.state||{idx:null}).idx}function g(){u="POP";let A=p(),R=A==null?null:A-d;d=A,h&&h({action:u,location:x.location,delta:R})}function b(A,R){u="PUSH";let M=Xb(x.location,A,R);t&&t(M,A),d=p()+1;let j=P1(M,d),Y=x.createHref(M);try{l.pushState(j,"",Y)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;i.location.assign(Y)}o&&h&&h({action:u,location:x.location,delta:1})}function _(A,R){u="REPLACE";let M=Xb(x.location,A,R);t&&t(M,A),d=p();let j=P1(M,d),Y=x.createHref(M);l.replaceState(j,"",Y),o&&h&&h({action:u,location:x.location,delta:0})}function T(A){return Z2(A)}let x={get action(){return u},get location(){return n(i,l)},listen(A){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(L1,g),h=A,()=>{i.removeEventListener(L1,g),h=null}},createHref(A){return e(i,A)},createURL:T,encodeLocation(A){let R=T(A);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:b,replace:_,go(A){return l.go(A)}};return x}function Z2(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Tt(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Gh(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function uR(n,e,t="/"){return eL(n,e,t,!1)}function eL(n,e,t,r){let i=typeof e=="string"?ul(e):e,o=Rs(i.pathname||"/",t);if(o==null)return null;let l=hR(n);tL(l);let u=null;for(let h=0;u==null&&h<l.length;++h){let d=fL(o);u=uL(l[h],d,r)}return u}function hR(n,e=[],t=[],r="",i=!1){let o=(l,u,h=i,d)=>{let p={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(r)&&h)return;Tt(p.relativePath.startsWith(r),`Absolute route path "${p.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(r.length)}let g=As([r,p.relativePath]),b=t.concat(p);l.children&&l.children.length>0&&(Tt(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),hR(l.children,e,b,g,h)),!(l.path==null&&!l.index)&&e.push({path:g,score:lL(g,l.index),routesMeta:b})};return n.forEach((l,u)=>{if(l.path===""||!l.path?.includes("?"))o(l,u);else for(let h of fR(l.path))o(l,u,!0,h)}),e}function fR(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let l=fR(r.join("/")),u=[];return u.push(...l.map(h=>h===""?o:[o,h].join("/"))),i&&u.push(...l),u.map(h=>n.startsWith("/")&&h===""?"/":h)}function tL(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:cL(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var nL=/^:[\w-]+$/,rL=3,iL=2,sL=1,oL=10,aL=-2,V1=n=>n==="*";function lL(n,e){let t=n.split("/"),r=t.length;return t.some(V1)&&(r+=aL),e&&(r+=iL),t.filter(i=>!V1(i)).reduce((i,o)=>i+(nL.test(o)?rL:o===""?sL:oL),r)}function cL(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function uL(n,e,t=!1){let{routesMeta:r}=n,i={},o="/",l=[];for(let u=0;u<r.length;++u){let h=r[u],d=u===r.length-1,p=o==="/"?e:e.slice(o.length)||"/",g=em({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},p),b=h.route;if(!g&&d&&t&&!r[r.length-1].route.index&&(g=em({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!g)return null;Object.assign(i,g.params),l.push({params:i,pathname:As([o,g.pathname]),pathnameBase:gL(As([o,g.pathnameBase])),route:b}),g.pathnameBase!=="/"&&(o=As([o,g.pathnameBase]))}return l}function em(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=hL(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let o=i[0],l=o.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:r.reduce((d,{paramName:p,isOptional:g},b)=>{if(p==="*"){let T=u[b]||"";l=o.slice(0,o.length-T.length).replace(/(.)\/+$/,"$1")}const _=u[b];return g&&!_?d[p]=void 0:d[p]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:l,pattern:n}}function hL(n,e=!1,t=!0){Fr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,h)=>(r.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function fL(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Fr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Rs(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var dL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function pL(n,e="/"){let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?ul(n):n,o;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?o=j1(t.substring(1),"/"):o=j1(t,e)):o=e,{pathname:o,search:yL(r),hash:vL(i)}}function j1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function ib(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function mL(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function r_(n){let e=mL(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function i_(n,e,t,r=!1){let i;typeof n=="string"?i=ul(n):(i={...n},Tt(!i.pathname||!i.pathname.includes("?"),ib("?","pathname","search",i)),Tt(!i.pathname||!i.pathname.includes("#"),ib("#","pathname","hash",i)),Tt(!i.search||!i.search.includes("#"),ib("#","search","hash",i)));let o=n===""||i.pathname==="",l=o?"/":i.pathname,u;if(l==null)u=t;else{let g=e.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),g-=1;i.pathname=b.join("/")}u=g>=0?e[g]:"/"}let h=pL(i,u),d=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(d||p)&&(h.pathname+="/"),h}var As=n=>n.join("/").replace(/\/\/+/g,"/"),gL=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),yL=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,vL=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,bL=class{constructor(n,e,t,r=!1){this.status=n,this.statusText=e||"",this.internal=r,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function _L(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function EL(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var dR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function pR(n,e){let t=n;if(typeof t!="string"||!dL.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let r=t,i=!1;if(dR)try{let o=new URL(window.location.href),l=t.startsWith("//")?new URL(o.protocol+t):new URL(t),u=Rs(l.pathname,e);l.origin===o.origin&&u!=null?t=u+l.search+l.hash:i=!0}catch{Fr(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:i,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var mR=["POST","PUT","PATCH","DELETE"];new Set(mR);var TL=["GET",...mR];new Set(TL);var Wc=V.createContext(null);Wc.displayName="DataRouter";var fg=V.createContext(null);fg.displayName="DataRouterState";var SL=V.createContext(!1),gR=V.createContext({isTransitioning:!1});gR.displayName="ViewTransition";var wL=V.createContext(new Map);wL.displayName="Fetchers";var AL=V.createContext(null);AL.displayName="Await";var _r=V.createContext(null);_r.displayName="Navigation";var yf=V.createContext(null);yf.displayName="Location";var ci=V.createContext({outlet:null,matches:[],isDataRoute:!1});ci.displayName="Route";var s_=V.createContext(null);s_.displayName="RouteError";var yR="REACT_ROUTER_ERROR",CL="REDIRECT",xL="ROUTE_ERROR_RESPONSE";function RL(n){if(n.startsWith(`${yR}:${CL}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function kL(n){if(n.startsWith(`${yR}:${xL}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new bL(e.status,e.statusText,e.data)}catch{}}function IL(n,{relative:e}={}){Tt(Qc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=V.useContext(_r),{hash:i,pathname:o,search:l}=vf(n,{relative:e}),u=o;return t!=="/"&&(u=o==="/"?t:As([t,o])),r.createHref({pathname:u,search:l,hash:i})}function Qc(){return V.useContext(yf)!=null}function Wi(){return Tt(Qc(),"useLocation() may be used only in the context of a <Router> component."),V.useContext(yf).location}var vR="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function bR(n){V.useContext(_r).static||V.useLayoutEffect(n)}function o_(){let{isDataRoute:n}=V.useContext(ci);return n?qL():NL()}function NL(){Tt(Qc(),"useNavigate() may be used only in the context of a <Router> component.");let n=V.useContext(Wc),{basename:e,navigator:t}=V.useContext(_r),{matches:r}=V.useContext(ci),{pathname:i}=Wi(),o=JSON.stringify(r_(r)),l=V.useRef(!1);return bR(()=>{l.current=!0}),V.useCallback((h,d={})=>{if(Fr(l.current,vR),!l.current)return;if(typeof h=="number"){t.go(h);return}let p=i_(h,JSON.parse(o),i,d.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:As([e,p.pathname])),(d.replace?t.replace:t.push)(p,d.state,d)},[e,t,o,i,n])}V.createContext(null);function ML(){let{matches:n}=V.useContext(ci),e=n[n.length-1];return e?e.params:{}}function vf(n,{relative:e}={}){let{matches:t}=V.useContext(ci),{pathname:r}=Wi(),i=JSON.stringify(r_(t));return V.useMemo(()=>i_(n,JSON.parse(i),r,e==="path"),[n,i,r,e])}function OL(n,e){return _R(n,e)}function _R(n,e,t,r,i){Tt(Qc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=V.useContext(_r),{matches:l}=V.useContext(ci),u=l[l.length-1],h=u?u.params:{},d=u?u.pathname:"/",p=u?u.pathnameBase:"/",g=u&&u.route;{let M=g&&g.path||"";TR(d,!g||M.endsWith("*")||M.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${M}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${M}"> to <Route path="${M==="/"?"*":`${M}/*`}">.`)}let b=Wi(),_;if(e){let M=typeof e=="string"?ul(e):e;Tt(p==="/"||M.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${M.pathname}" was given in the \`location\` prop.`),_=M}else _=b;let T=_.pathname||"/",x=T;if(p!=="/"){let M=p.replace(/^\//,"").split("/");x="/"+T.replace(/^\//,"").split("/").slice(M.length).join("/")}let A=uR(n,{pathname:x});Fr(g||A!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),Fr(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=jL(A&&A.map(M=>Object.assign({},M,{params:Object.assign({},h,M.params),pathname:As([p,o.encodeLocation?o.encodeLocation(M.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?p:As([p,o.encodeLocation?o.encodeLocation(M.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:M.pathnameBase])})),l,t,r,i);return e&&R?V.createElement(yf.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},R):R}function DL(){let n=HL(),e=_L(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=V.createElement(V.Fragment,null,V.createElement("p",null," Hey developer "),V.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",V.createElement("code",{style:o},"ErrorBoundary")," or"," ",V.createElement("code",{style:o},"errorElement")," prop on your route.")),V.createElement(V.Fragment,null,V.createElement("h2",null,"Unexpected Application Error!"),V.createElement("h3",{style:{fontStyle:"italic"}},e),t?V.createElement("pre",{style:i},t):null,l)}var LL=V.createElement(DL,null),ER=class extends V.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=kL(n.digest);t&&(n=t)}let e=n!==void 0?V.createElement(ci.Provider,{value:this.props.routeContext},V.createElement(s_.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?V.createElement(PL,{error:n},e):e}};ER.contextType=SL;var sb=new WeakMap;function PL({children:n,error:e}){let{basename:t}=V.useContext(_r);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let r=RL(e.digest);if(r){let i=sb.get(e);if(i)throw i;let o=pR(r.location,t);if(dR&&!sb.get(e))if(o.isExternal||r.reloadDocument)window.location.href=o.absoluteURL||o.to;else{const l=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(o.to,{replace:r.replace}));throw sb.set(e,l),l}return V.createElement("meta",{httpEquiv:"refresh",content:`0;url=${o.absoluteURL||o.to}`})}}return n}function VL({routeContext:n,match:e,children:t}){let r=V.useContext(Wc);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),V.createElement(ci.Provider,{value:n},t)}function jL(n,e=[],t=null,r=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,l=t?.errors;if(l!=null){let p=o.findIndex(g=>g.route.id&&l?.[g.route.id]!==void 0);Tt(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),o=o.slice(0,Math.min(o.length,p+1))}let u=!1,h=-1;if(t)for(let p=0;p<o.length;p++){let g=o[p];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(h=p),g.route.id){let{loaderData:b,errors:_}=t,T=g.route.loader&&!b.hasOwnProperty(g.route.id)&&(!_||_[g.route.id]===void 0);if(g.route.lazy||T){u=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}let d=t&&r?(p,g)=>{r(p,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:EL(t.matches),errorInfo:g})}:void 0;return o.reduceRight((p,g,b)=>{let _,T=!1,x=null,A=null;t&&(_=l&&g.route.id?l[g.route.id]:void 0,x=g.route.errorElement||LL,u&&(h<0&&b===0?(TR("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),T=!0,A=null):h===b&&(T=!0,A=g.route.hydrateFallbackElement||null)));let R=e.concat(o.slice(0,b+1)),M=()=>{let j;return _?j=x:T?j=A:g.route.Component?j=V.createElement(g.route.Component,null):g.route.element?j=g.route.element:j=p,V.createElement(VL,{match:g,routeContext:{outlet:p,matches:R,isDataRoute:t!=null},children:j})};return t&&(g.route.ErrorBoundary||g.route.errorElement||b===0)?V.createElement(ER,{location:t.location,revalidation:t.revalidation,component:x,error:_,children:M(),routeContext:{outlet:null,matches:R,isDataRoute:!0},onError:d}):M()},null)}function a_(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function UL(n){let e=V.useContext(Wc);return Tt(e,a_(n)),e}function BL(n){let e=V.useContext(fg);return Tt(e,a_(n)),e}function zL(n){let e=V.useContext(ci);return Tt(e,a_(n)),e}function l_(n){let e=zL(n),t=e.matches[e.matches.length-1];return Tt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function FL(){return l_("useRouteId")}function HL(){let n=V.useContext(s_),e=BL("useRouteError"),t=l_("useRouteError");return n!==void 0?n:e.errors?.[t]}function qL(){let{router:n}=UL("useNavigate"),e=l_("useNavigate"),t=V.useRef(!1);return bR(()=>{t.current=!0}),V.useCallback(async(i,o={})=>{Fr(t.current,vR),t.current&&(typeof i=="number"?await n.navigate(i):await n.navigate(i,{fromRouteId:e,...o}))},[n,e])}var U1={};function TR(n,e,t){!e&&!U1[n]&&(U1[n]=!0,Fr(!1,t))}V.memo($L);function $L({routes:n,future:e,state:t,onError:r}){return _R(n,void 0,t,r,e)}function GL({to:n,replace:e,state:t,relative:r}){Tt(Qc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:i}=V.useContext(_r);Fr(!i,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=V.useContext(ci),{pathname:l}=Wi(),u=o_(),h=i_(n,r_(o),l,r==="path"),d=JSON.stringify(h);return V.useEffect(()=>{u(JSON.parse(d),{replace:e,state:t,relative:r})},[u,d,r,e,t]),null}function tr(n){Tt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function KL({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:i,static:o=!1,unstable_useTransitions:l}){Tt(!Qc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=n.replace(/^\/*/,"/"),h=V.useMemo(()=>({basename:u,navigator:i,static:o,unstable_useTransitions:l,future:{}}),[u,i,o,l]);typeof t=="string"&&(t=ul(t));let{pathname:d="/",search:p="",hash:g="",state:b=null,key:_="default"}=t,T=V.useMemo(()=>{let x=Rs(d,u);return x==null?null:{location:{pathname:x,search:p,hash:g,state:b,key:_},navigationType:r}},[u,d,p,g,b,_,r]);return Fr(T!=null,`<Router basename="${u}"> is not able to match the URL "${d}${p}${g}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:V.createElement(_r.Provider,{value:h},V.createElement(yf.Provider,{children:e,value:T}))}function WL({children:n,location:e}){return OL(Zb(n),e)}function Zb(n,e=[]){let t=[];return V.Children.forEach(n,(r,i)=>{if(!V.isValidElement(r))return;let o=[...e,i];if(r.type===V.Fragment){t.push.apply(t,Zb(r.props.children,o));return}Tt(r.type===tr,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Tt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Zb(r.props.children,o)),t.push(l)}),t}var Lp="get",Pp="application/x-www-form-urlencoded";function dg(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function QL(n){return dg(n)&&n.tagName.toLowerCase()==="button"}function YL(n){return dg(n)&&n.tagName.toLowerCase()==="form"}function JL(n){return dg(n)&&n.tagName.toLowerCase()==="input"}function XL(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function ZL(n,e){return n.button===0&&(!e||e==="_self")&&!XL(n)}var fp=null;function eP(){if(fp===null)try{new FormData(document.createElement("form"),0),fp=!1}catch{fp=!0}return fp}var tP=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ob(n){return n!=null&&!tP.has(n)?(Fr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Pp}"`),null):n}function nP(n,e){let t,r,i,o,l;if(YL(n)){let u=n.getAttribute("action");r=u?Rs(u,e):null,t=n.getAttribute("method")||Lp,i=ob(n.getAttribute("enctype"))||Pp,o=new FormData(n)}else if(QL(n)||JL(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=n.getAttribute("formaction")||u.getAttribute("action");if(r=h?Rs(h,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||Lp,i=ob(n.getAttribute("formenctype"))||ob(u.getAttribute("enctype"))||Pp,o=new FormData(u,n),!eP()){let{name:d,type:p,value:g}=n;if(p==="image"){let b=d?`${d}.`:"";o.append(`${b}x`,"0"),o.append(`${b}y`,"0")}else d&&o.append(d,g)}}else{if(dg(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Lp,r=null,i=Pp,l=n}return o&&i==="text/plain"&&(l=o,o=void 0),{action:r,method:t.toLowerCase(),encType:i,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function c_(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function rP(n,e,t,r){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?i.pathname.endsWith("/")?i.pathname=`${i.pathname}_.${r}`:i.pathname=`${i.pathname}.${r}`:i.pathname==="/"?i.pathname=`_root.${r}`:e&&Rs(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${r}`,i}async function iP(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function sP(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function oP(n,e,t){let r=await Promise.all(n.map(async i=>{let o=e.routes[i.route.id];if(o){let l=await iP(o,t);return l.links?l.links():[]}return[]}));return uP(r.flat(1).filter(sP).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function B1(n,e,t,r,i,o){let l=(h,d)=>t[d]?h.route.id!==t[d].route.id:!0,u=(h,d)=>t[d].pathname!==h.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==h.params["*"];return o==="assets"?e.filter((h,d)=>l(h,d)||u(h,d)):o==="data"?e.filter((h,d)=>{let p=r.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(l(h,d)||u(h,d))return!0;if(h.route.shouldRevalidate){let g=h.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function aP(n,e,{includeHydrateFallback:t}={}){return lP(n.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let o=[i.module];return i.clientActionModule&&(o=o.concat(i.clientActionModule)),i.clientLoaderModule&&(o=o.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(o=o.concat(i.hydrateFallbackModule)),i.imports&&(o=o.concat(i.imports)),o}).flat(1))}function lP(n){return[...new Set(n)]}function cP(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function uP(n,e){let t=new Set;return new Set(e),n.reduce((r,i)=>{let o=JSON.stringify(cP(i));return t.has(o)||(t.add(o),r.push({key:o,link:i})),r},[])}function SR(){let n=V.useContext(Wc);return c_(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function hP(){let n=V.useContext(fg);return c_(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var u_=V.createContext(void 0);u_.displayName="FrameworkContext";function wR(){let n=V.useContext(u_);return c_(n,"You must render this element inside a <HydratedRouter> element"),n}function fP(n,e){let t=V.useContext(u_),[r,i]=V.useState(!1),[o,l]=V.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:d,onMouseLeave:p,onTouchStart:g}=e,b=V.useRef(null);V.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let x=R=>{R.forEach(M=>{l(M.isIntersecting)})},A=new IntersectionObserver(x,{threshold:.5});return b.current&&A.observe(b.current),()=>{A.disconnect()}}},[n]),V.useEffect(()=>{if(r){let x=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(x)}}},[r]);let _=()=>{i(!0)},T=()=>{i(!1),l(!1)};return t?n!=="intent"?[o,b,{}]:[o,b,{onFocus:hh(u,_),onBlur:hh(h,T),onMouseEnter:hh(d,_),onMouseLeave:hh(p,T),onTouchStart:hh(g,_)}]:[!1,b,{}]}function hh(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function dP({page:n,...e}){let{router:t}=SR(),r=V.useMemo(()=>uR(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?V.createElement(mP,{page:n,matches:r,...e}):null}function pP(n){let{manifest:e,routeModules:t}=wR(),[r,i]=V.useState([]);return V.useEffect(()=>{let o=!1;return oP(n,e,t).then(l=>{o||i(l)}),()=>{o=!0}},[n,e,t]),r}function mP({page:n,matches:e,...t}){let r=Wi(),{future:i,manifest:o,routeModules:l}=wR(),{basename:u}=SR(),{loaderData:h,matches:d}=hP(),p=V.useMemo(()=>B1(n,e,d,o,r,"data"),[n,e,d,o,r]),g=V.useMemo(()=>B1(n,e,d,o,r,"assets"),[n,e,d,o,r]),b=V.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let x=new Set,A=!1;if(e.forEach(M=>{let j=o.routes[M.route.id];!j||!j.hasLoader||(!p.some(Y=>Y.route.id===M.route.id)&&M.route.id in h&&l[M.route.id]?.shouldRevalidate||j.hasClientLoader?A=!0:x.add(M.route.id))}),x.size===0)return[];let R=rP(n,u,i.unstable_trailingSlashAwareDataRequests,"data");return A&&x.size>0&&R.searchParams.set("_routes",e.filter(M=>x.has(M.route.id)).map(M=>M.route.id).join(",")),[R.pathname+R.search]},[u,i.unstable_trailingSlashAwareDataRequests,h,r,o,p,e,n,l]),_=V.useMemo(()=>aP(g,o),[g,o]),T=pP(g);return V.createElement(V.Fragment,null,b.map(x=>V.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),_.map(x=>V.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),T.map(({key:x,link:A})=>V.createElement("link",{key:x,nonce:t.nonce,...A,crossOrigin:A.crossOrigin??t.crossOrigin})))}function gP(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var yP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{yP&&(window.__reactRouterVersion="7.13.0")}catch{}function vP({basename:n,children:e,unstable_useTransitions:t,window:r}){let i=V.useRef();i.current==null&&(i.current=Y2({window:r,v5Compat:!0}));let o=i.current,[l,u]=V.useState({action:o.action,location:o.location}),h=V.useCallback(d=>{t===!1?u(d):V.startTransition(()=>u(d))},[t]);return V.useLayoutEffect(()=>o.listen(h),[o,h]),V.createElement(KL,{basename:n,children:e,location:l.location,navigationType:l.action,navigator:o,unstable_useTransitions:t})}var AR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bf=V.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:i,reloadDocument:o,replace:l,state:u,target:h,to:d,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:b,..._},T){let{basename:x,unstable_useTransitions:A}=V.useContext(_r),R=typeof d=="string"&&AR.test(d),M=pR(d,x);d=M.to;let j=IL(d,{relative:i}),[Y,$,G]=fP(r,_),I=EP(d,{replace:l,state:u,target:h,preventScrollReset:p,relative:i,viewTransition:g,unstable_defaultShouldRevalidate:b,unstable_useTransitions:A});function N(B){e&&e(B),B.defaultPrevented||I(B)}let P=V.createElement("a",{..._,...G,href:M.absoluteURL||j,onClick:M.isExternal||o?e:N,ref:gP(T,$),target:h,"data-discover":!R&&t==="render"?"true":void 0});return Y&&!R?V.createElement(V.Fragment,null,P,V.createElement(dP,{page:j})):P});bf.displayName="Link";var e0=V.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:i=!1,style:o,to:l,viewTransition:u,children:h,...d},p){let g=vf(l,{relative:d.relative}),b=Wi(),_=V.useContext(fg),{navigator:T,basename:x}=V.useContext(_r),A=_!=null&&CP(g)&&u===!0,R=T.encodeLocation?T.encodeLocation(g).pathname:g.pathname,M=b.pathname,j=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;t||(M=M.toLowerCase(),j=j?j.toLowerCase():null,R=R.toLowerCase()),j&&x&&(j=Rs(j,x)||j);const Y=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let $=M===R||!i&&M.startsWith(R)&&M.charAt(Y)==="/",G=j!=null&&(j===R||!i&&j.startsWith(R)&&j.charAt(R.length)==="/"),I={isActive:$,isPending:G,isTransitioning:A},N=$?e:void 0,P;typeof r=="function"?P=r(I):P=[r,$?"active":null,G?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let B=typeof o=="function"?o(I):o;return V.createElement(bf,{...d,"aria-current":N,className:P,ref:p,style:B,to:l,viewTransition:u},typeof h=="function"?h(I):h)});e0.displayName="NavLink";var bP=V.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:i,state:o,method:l=Lp,action:u,onSubmit:h,relative:d,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:b,..._},T)=>{let{unstable_useTransitions:x}=V.useContext(_r),A=wP(),R=AP(u,{relative:d}),M=l.toLowerCase()==="get"?"get":"post",j=typeof u=="string"&&AR.test(u),Y=$=>{if(h&&h($),$.defaultPrevented)return;$.preventDefault();let G=$.nativeEvent.submitter,I=G?.getAttribute("formmethod")||l,N=()=>A(G||$.currentTarget,{fetcherKey:e,method:I,navigate:t,replace:i,state:o,relative:d,preventScrollReset:p,viewTransition:g,unstable_defaultShouldRevalidate:b});x&&t!==!1?V.startTransition(()=>N()):N()};return V.createElement("form",{ref:T,method:M,action:R,onSubmit:r?h:Y,..._,"data-discover":!j&&n==="render"?"true":void 0})});bP.displayName="Form";function _P(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CR(n){let e=V.useContext(Wc);return Tt(e,_P(n)),e}function EP(n,{target:e,replace:t,state:r,preventScrollReset:i,relative:o,viewTransition:l,unstable_defaultShouldRevalidate:u,unstable_useTransitions:h}={}){let d=o_(),p=Wi(),g=vf(n,{relative:o});return V.useCallback(b=>{if(ZL(b,e)){b.preventDefault();let _=t!==void 0?t:Gh(p)===Gh(g),T=()=>d(n,{replace:_,state:r,preventScrollReset:i,relative:o,viewTransition:l,unstable_defaultShouldRevalidate:u});h?V.startTransition(()=>T()):T()}},[p,d,g,t,r,e,n,i,o,l,u,h])}var TP=0,SP=()=>`__${String(++TP)}__`;function wP(){let{router:n}=CR("useSubmit"),{basename:e}=V.useContext(_r),t=FL(),r=n.fetch,i=n.navigate;return V.useCallback(async(o,l={})=>{let{action:u,method:h,encType:d,formData:p,body:g}=nP(o,e);if(l.navigate===!1){let b=l.fetcherKey||SP();await r(b,t,l.action||u,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:p,body:g,formMethod:l.method||h,formEncType:l.encType||d,flushSync:l.flushSync})}else await i(l.action||u,{unstable_defaultShouldRevalidate:l.unstable_defaultShouldRevalidate,preventScrollReset:l.preventScrollReset,formData:p,body:g,formMethod:l.method||h,formEncType:l.encType||d,replace:l.replace,state:l.state,fromRouteId:t,flushSync:l.flushSync,viewTransition:l.viewTransition})},[r,i,e,t])}function AP(n,{relative:e}={}){let{basename:t}=V.useContext(_r),r=V.useContext(ci);Tt(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),o={...vf(n||".",{relative:e})},l=Wi();if(n==null){o.search=l.search;let u=new URLSearchParams(o.search),h=u.getAll("index");if(h.some(p=>p==="")){u.delete("index"),h.filter(g=>g).forEach(g=>u.append("index",g));let p=u.toString();o.search=p?`?${p}`:""}}return(!n||n===".")&&i.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:As([t,o.pathname])),Gh(o)}function CP(n,{relative:e}={}){let t=V.useContext(gR);Tt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=CR("useViewTransitionState"),i=vf(n,{relative:e});if(!t.isTransitioning)return!1;let o=Rs(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=Rs(t.nextLocation.pathname,r)||t.nextLocation.pathname;return em(i.pathname,l)!=null||em(i.pathname,o)!=null}var xP=cR();const RP=lR(xP),kP=()=>{};var z1={};const xR=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},IP=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],l=n[t++],u=n[t++],h=((i&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const o=n[t++],l=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|l&63)}}return e.join("")},RR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const o=n[i],l=i+1<n.length,u=l?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,g=(o&3)<<4|u>>4;let b=(u&15)<<2|d>>6,_=d&63;h||(_=64,l||(b=64)),r.push(t[p],t[g],t[b],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(xR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):IP(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;const d=i<n.length?t[n.charAt(i)]:64;++i;const g=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||u==null||d==null||g==null)throw new NP;const b=o<<2|u>>4;if(r.push(b),d!==64){const _=u<<4&240|d>>2;if(r.push(_),g!==64){const T=d<<6&192|g;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class NP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MP=function(n){const e=xR(n);return RR.encodeByteArray(e,!0)},tm=function(n){return MP(n).replace(/\./g,"")},kR=function(n){try{return RR.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function OP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const DP=()=>OP().__FIREBASE_DEFAULTS__,LP=()=>{if(typeof process>"u"||typeof z1>"u")return;const n=z1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},PP=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&kR(n[1]);return e&&JSON.parse(e)},pg=()=>{try{return kP()||DP()||LP()||PP()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},IR=n=>pg()?.emulatorHosts?.[n],NR=n=>{const e=IR(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},MR=()=>pg()?.config,OR=n=>pg()?.[`_${n}`];class VP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function ea(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function h_(n){return(await fetch(n,{credentials:"include"})).ok}function DR(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[tm(JSON.stringify(t)),tm(JSON.stringify(l)),""].join(".")}const Rh={};function jP(){const n={prod:[],emulator:[]};for(const e of Object.keys(Rh))Rh[e]?n.emulator.push(e):n.prod.push(e);return n}function UP(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let F1=!1;function f_(n,e){if(typeof window>"u"||typeof document>"u"||!ea(window.location.host)||Rh[n]===e||Rh[n]||F1)return;Rh[n]=e;function t(b){return`__firebase__banner__${b}`}const r="__firebase__banner",o=jP().prod.length>0;function l(){const b=document.getElementById(r);b&&b.remove()}function u(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function h(b,_){b.setAttribute("width","24"),b.setAttribute("id",_),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function d(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{F1=!0,l()},b}function p(b,_){b.setAttribute("id",_),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function g(){const b=UP(r),_=t("text"),T=document.getElementById(_)||document.createElement("span"),x=t("learnmore"),A=document.getElementById(x)||document.createElement("a"),R=t("preprendIcon"),M=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const j=b.element;u(j),p(A,x);const Y=d();h(M,R),j.append(M,T,A,Y),document.body.appendChild(j)}o?(T.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function BP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pn())}function zP(){const n=pg()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function FP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function HP(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function qP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $P(){const n=Pn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function GP(){return!zP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KP(){try{return typeof indexedDB=="object"}catch{return!1}}function WP(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}const QP="FirebaseError";class Qi extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=QP,Object.setPrototypeOf(this,Qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_f.prototype.create)}}class _f{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],l=o?YP(o,r):"Error",u=`${this.serviceName}: ${l} (${i}).`;return new Qi(i,u,r)}}function YP(n,e){return n.replace(JP,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const JP=/\{\$([^}]+)}/g;function XP(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ho(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const o=n[i],l=e[i];if(H1(o)&&H1(l)){if(!Ho(o,l))return!1}else if(o!==l)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function H1(n){return n!==null&&typeof n=="object"}function Ef(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function yh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function vh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function ZP(n,e){const t=new eV(n,e);return t.subscribe.bind(t)}class eV{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");tV(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=ab),i.error===void 0&&(i.error=ab),i.complete===void 0&&(i.complete=ab);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tV(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ab(){}function mt(n){return n&&n._delegate?n._delegate:n}class qo{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ua="[DEFAULT]";class nV{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new VP;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iV(e))try{this.getOrInitializeService({instanceIdentifier:Ua})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Ua){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ua){return this.instances.has(e)}getOptions(e=Ua){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&l.resolve(i)}return i}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:rV(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ua){return this.component?this.component.multipleInstances?e:Ua:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function rV(n){return n===Ua?void 0:n}function iV(n){return n.instantiationMode==="EAGER"}class sV{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new nV(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var $e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})($e||($e={}));const oV={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},aV=$e.INFO,lV={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},cV=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=lV[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class d_{constructor(e){this.name=e,this._logLevel=aV,this._logHandler=cV,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oV[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}const uV=(n,e)=>e.some(t=>n instanceof t);let q1,$1;function hV(){return q1||(q1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fV(){return $1||($1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const LR=new WeakMap,t0=new WeakMap,PR=new WeakMap,lb=new WeakMap,p_=new WeakMap;function dV(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",l)},o=()=>{t(No(n.result)),i()},l=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&LR.set(t,n)}).catch(()=>{}),p_.set(e,n),e}function pV(n){if(t0.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",l),n.removeEventListener("abort",l)},o=()=>{t(),i()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",l),n.addEventListener("abort",l)});t0.set(n,e)}let n0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return t0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||PR.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return No(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function mV(n){n0=n(n0)}function gV(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(cb(this),e,...t);return PR.set(r,e.sort?e.sort():[e]),No(r)}:fV().includes(n)?function(...e){return n.apply(cb(this),e),No(LR.get(this))}:function(...e){return No(n.apply(cb(this),e))}}function yV(n){return typeof n=="function"?gV(n):(n instanceof IDBTransaction&&pV(n),uV(n,hV())?new Proxy(n,n0):n)}function No(n){if(n instanceof IDBRequest)return dV(n);if(lb.has(n))return lb.get(n);const e=yV(n);return e!==n&&(lb.set(n,e),p_.set(e,n)),e}const cb=n=>p_.get(n);function vV(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const l=indexedDB.open(n,e),u=No(l);return r&&l.addEventListener("upgradeneeded",h=>{r(No(l.result),h.oldVersion,h.newVersion,No(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const bV=["get","getKey","getAll","getAllKeys","count"],_V=["put","add","delete","clear"],ub=new Map;function G1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ub.get(e))return ub.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=_V.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||bV.includes(t)))return;const o=async function(l,...u){const h=this.transaction(l,i?"readwrite":"readonly");let d=h.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[t](...u),i&&h.done]))[0]};return ub.set(e,o),o}mV(n=>({...n,get:(e,t,r)=>G1(e,t)||n.get(e,t,r),has:(e,t)=>!!G1(e,t)||n.has(e,t)}));class EV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(TV(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function TV(n){return n.getComponent()?.type==="VERSION"}const r0="@firebase/app",K1="0.14.7";const ks=new d_("@firebase/app"),SV="@firebase/app-compat",wV="@firebase/analytics-compat",AV="@firebase/analytics",CV="@firebase/app-check-compat",xV="@firebase/app-check",RV="@firebase/auth",kV="@firebase/auth-compat",IV="@firebase/database",NV="@firebase/data-connect",MV="@firebase/database-compat",OV="@firebase/functions",DV="@firebase/functions-compat",LV="@firebase/installations",PV="@firebase/installations-compat",VV="@firebase/messaging",jV="@firebase/messaging-compat",UV="@firebase/performance",BV="@firebase/performance-compat",zV="@firebase/remote-config",FV="@firebase/remote-config-compat",HV="@firebase/storage",qV="@firebase/storage-compat",$V="@firebase/firestore",GV="@firebase/ai",KV="@firebase/firestore-compat",WV="firebase",QV="12.8.0";const i0="[DEFAULT]",YV={[r0]:"fire-core",[SV]:"fire-core-compat",[AV]:"fire-analytics",[wV]:"fire-analytics-compat",[xV]:"fire-app-check",[CV]:"fire-app-check-compat",[RV]:"fire-auth",[kV]:"fire-auth-compat",[IV]:"fire-rtdb",[NV]:"fire-data-connect",[MV]:"fire-rtdb-compat",[OV]:"fire-fn",[DV]:"fire-fn-compat",[LV]:"fire-iid",[PV]:"fire-iid-compat",[VV]:"fire-fcm",[jV]:"fire-fcm-compat",[UV]:"fire-perf",[BV]:"fire-perf-compat",[zV]:"fire-rc",[FV]:"fire-rc-compat",[HV]:"fire-gcs",[qV]:"fire-gcs-compat",[$V]:"fire-fst",[KV]:"fire-fst-compat",[GV]:"fire-vertex","fire-js":"fire-js",[WV]:"fire-js-all"};const nm=new Map,JV=new Map,s0=new Map;function W1(n,e){try{n.container.addComponent(e)}catch(t){ks.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Za(n){const e=n.name;if(s0.has(e))return ks.debug(`There were multiple attempts to register component ${e}.`),!1;s0.set(e,n);for(const t of nm.values())W1(t,n);for(const t of JV.values())W1(t,n);return!0}function mg(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function jr(n){return n==null?!1:n.settings!==void 0}const XV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mo=new _f("app","Firebase",XV);class ZV{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mo.create("app-deleted",{appName:this._name})}}const hl=QV;function VR(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:i0,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Mo.create("bad-app-name",{appName:String(i)});if(t||(t=MR()),!t)throw Mo.create("no-options");const o=nm.get(i);if(o){if(Ho(t,o.options)&&Ho(r,o.config))return o;throw Mo.create("duplicate-app",{appName:i})}const l=new sV(i);for(const h of s0.values())l.addComponent(h);const u=new ZV(t,r,l);return nm.set(i,u),u}function m_(n=i0){const e=nm.get(n);if(!e&&n===i0&&MR())return VR();if(!e)throw Mo.create("no-app",{appName:n});return e}function Bi(n,e,t){let r=YV[n]??n;t&&(r+=`-${t}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${r}" with version "${e}":`];i&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ks.warn(l.join(" "));return}Za(new qo(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const e3="firebase-heartbeat-database",t3=1,Kh="firebase-heartbeat-store";let hb=null;function jR(){return hb||(hb=vV(e3,t3,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Kh)}catch(t){console.warn(t)}}}}).catch(n=>{throw Mo.create("idb-open",{originalErrorMessage:n.message})})),hb}async function n3(n){try{const t=(await jR()).transaction(Kh),r=await t.objectStore(Kh).get(UR(n));return await t.done,r}catch(e){if(e instanceof Qi)ks.warn(e.message);else{const t=Mo.create("idb-get",{originalErrorMessage:e?.message});ks.warn(t.message)}}}async function Q1(n,e){try{const r=(await jR()).transaction(Kh,"readwrite");await r.objectStore(Kh).put(e,UR(n)),await r.done}catch(t){if(t instanceof Qi)ks.warn(t.message);else{const r=Mo.create("idb-set",{originalErrorMessage:t?.message});ks.warn(r.message)}}}function UR(n){return`${n.name}!${n.options.appId}`}const r3=1024,i3=30;class s3{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new a3(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Y1();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>i3){const i=l3(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ks.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Y1(),{heartbeatsToSend:t,unsentEntries:r}=o3(this._heartbeatsCache.heartbeats),i=tm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return ks.warn(e),""}}}function Y1(){return new Date().toISOString().substring(0,10)}function o3(n,e=r3){const t=[];let r=n.slice();for(const i of n){const o=t.find(l=>l.agent===i.agent);if(o){if(o.dates.push(i.date),J1(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),J1(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class a3{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return KP()?WP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await n3(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Q1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Q1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function J1(n){return tm(JSON.stringify({version:2,heartbeats:n})).length}function l3(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function c3(n){Za(new qo("platform-logger",e=>new EV(e),"PRIVATE")),Za(new qo("heartbeat",e=>new s3(e),"PRIVATE")),Bi(r0,K1,n),Bi(r0,K1,"esm2020"),Bi("fire-js","")}c3("");var X1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Oo,BR;(function(){var n;function e(I,N){function P(){}P.prototype=N.prototype,I.F=N.prototype,I.prototype=new P,I.prototype.constructor=I,I.D=function(B,z,L){for(var D=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)D[ue-2]=arguments[ue];return N.prototype[z].apply(B,D)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,N,P){P||(P=0);const B=Array(16);if(typeof N=="string")for(var z=0;z<16;++z)B[z]=N.charCodeAt(P++)|N.charCodeAt(P++)<<8|N.charCodeAt(P++)<<16|N.charCodeAt(P++)<<24;else for(z=0;z<16;++z)B[z]=N[P++]|N[P++]<<8|N[P++]<<16|N[P++]<<24;N=I.g[0],P=I.g[1],z=I.g[2];let L=I.g[3],D;D=N+(L^P&(z^L))+B[0]+3614090360&4294967295,N=P+(D<<7&4294967295|D>>>25),D=L+(z^N&(P^z))+B[1]+3905402710&4294967295,L=N+(D<<12&4294967295|D>>>20),D=z+(P^L&(N^P))+B[2]+606105819&4294967295,z=L+(D<<17&4294967295|D>>>15),D=P+(N^z&(L^N))+B[3]+3250441966&4294967295,P=z+(D<<22&4294967295|D>>>10),D=N+(L^P&(z^L))+B[4]+4118548399&4294967295,N=P+(D<<7&4294967295|D>>>25),D=L+(z^N&(P^z))+B[5]+1200080426&4294967295,L=N+(D<<12&4294967295|D>>>20),D=z+(P^L&(N^P))+B[6]+2821735955&4294967295,z=L+(D<<17&4294967295|D>>>15),D=P+(N^z&(L^N))+B[7]+4249261313&4294967295,P=z+(D<<22&4294967295|D>>>10),D=N+(L^P&(z^L))+B[8]+1770035416&4294967295,N=P+(D<<7&4294967295|D>>>25),D=L+(z^N&(P^z))+B[9]+2336552879&4294967295,L=N+(D<<12&4294967295|D>>>20),D=z+(P^L&(N^P))+B[10]+4294925233&4294967295,z=L+(D<<17&4294967295|D>>>15),D=P+(N^z&(L^N))+B[11]+2304563134&4294967295,P=z+(D<<22&4294967295|D>>>10),D=N+(L^P&(z^L))+B[12]+1804603682&4294967295,N=P+(D<<7&4294967295|D>>>25),D=L+(z^N&(P^z))+B[13]+4254626195&4294967295,L=N+(D<<12&4294967295|D>>>20),D=z+(P^L&(N^P))+B[14]+2792965006&4294967295,z=L+(D<<17&4294967295|D>>>15),D=P+(N^z&(L^N))+B[15]+1236535329&4294967295,P=z+(D<<22&4294967295|D>>>10),D=N+(z^L&(P^z))+B[1]+4129170786&4294967295,N=P+(D<<5&4294967295|D>>>27),D=L+(P^z&(N^P))+B[6]+3225465664&4294967295,L=N+(D<<9&4294967295|D>>>23),D=z+(N^P&(L^N))+B[11]+643717713&4294967295,z=L+(D<<14&4294967295|D>>>18),D=P+(L^N&(z^L))+B[0]+3921069994&4294967295,P=z+(D<<20&4294967295|D>>>12),D=N+(z^L&(P^z))+B[5]+3593408605&4294967295,N=P+(D<<5&4294967295|D>>>27),D=L+(P^z&(N^P))+B[10]+38016083&4294967295,L=N+(D<<9&4294967295|D>>>23),D=z+(N^P&(L^N))+B[15]+3634488961&4294967295,z=L+(D<<14&4294967295|D>>>18),D=P+(L^N&(z^L))+B[4]+3889429448&4294967295,P=z+(D<<20&4294967295|D>>>12),D=N+(z^L&(P^z))+B[9]+568446438&4294967295,N=P+(D<<5&4294967295|D>>>27),D=L+(P^z&(N^P))+B[14]+3275163606&4294967295,L=N+(D<<9&4294967295|D>>>23),D=z+(N^P&(L^N))+B[3]+4107603335&4294967295,z=L+(D<<14&4294967295|D>>>18),D=P+(L^N&(z^L))+B[8]+1163531501&4294967295,P=z+(D<<20&4294967295|D>>>12),D=N+(z^L&(P^z))+B[13]+2850285829&4294967295,N=P+(D<<5&4294967295|D>>>27),D=L+(P^z&(N^P))+B[2]+4243563512&4294967295,L=N+(D<<9&4294967295|D>>>23),D=z+(N^P&(L^N))+B[7]+1735328473&4294967295,z=L+(D<<14&4294967295|D>>>18),D=P+(L^N&(z^L))+B[12]+2368359562&4294967295,P=z+(D<<20&4294967295|D>>>12),D=N+(P^z^L)+B[5]+4294588738&4294967295,N=P+(D<<4&4294967295|D>>>28),D=L+(N^P^z)+B[8]+2272392833&4294967295,L=N+(D<<11&4294967295|D>>>21),D=z+(L^N^P)+B[11]+1839030562&4294967295,z=L+(D<<16&4294967295|D>>>16),D=P+(z^L^N)+B[14]+4259657740&4294967295,P=z+(D<<23&4294967295|D>>>9),D=N+(P^z^L)+B[1]+2763975236&4294967295,N=P+(D<<4&4294967295|D>>>28),D=L+(N^P^z)+B[4]+1272893353&4294967295,L=N+(D<<11&4294967295|D>>>21),D=z+(L^N^P)+B[7]+4139469664&4294967295,z=L+(D<<16&4294967295|D>>>16),D=P+(z^L^N)+B[10]+3200236656&4294967295,P=z+(D<<23&4294967295|D>>>9),D=N+(P^z^L)+B[13]+681279174&4294967295,N=P+(D<<4&4294967295|D>>>28),D=L+(N^P^z)+B[0]+3936430074&4294967295,L=N+(D<<11&4294967295|D>>>21),D=z+(L^N^P)+B[3]+3572445317&4294967295,z=L+(D<<16&4294967295|D>>>16),D=P+(z^L^N)+B[6]+76029189&4294967295,P=z+(D<<23&4294967295|D>>>9),D=N+(P^z^L)+B[9]+3654602809&4294967295,N=P+(D<<4&4294967295|D>>>28),D=L+(N^P^z)+B[12]+3873151461&4294967295,L=N+(D<<11&4294967295|D>>>21),D=z+(L^N^P)+B[15]+530742520&4294967295,z=L+(D<<16&4294967295|D>>>16),D=P+(z^L^N)+B[2]+3299628645&4294967295,P=z+(D<<23&4294967295|D>>>9),D=N+(z^(P|~L))+B[0]+4096336452&4294967295,N=P+(D<<6&4294967295|D>>>26),D=L+(P^(N|~z))+B[7]+1126891415&4294967295,L=N+(D<<10&4294967295|D>>>22),D=z+(N^(L|~P))+B[14]+2878612391&4294967295,z=L+(D<<15&4294967295|D>>>17),D=P+(L^(z|~N))+B[5]+4237533241&4294967295,P=z+(D<<21&4294967295|D>>>11),D=N+(z^(P|~L))+B[12]+1700485571&4294967295,N=P+(D<<6&4294967295|D>>>26),D=L+(P^(N|~z))+B[3]+2399980690&4294967295,L=N+(D<<10&4294967295|D>>>22),D=z+(N^(L|~P))+B[10]+4293915773&4294967295,z=L+(D<<15&4294967295|D>>>17),D=P+(L^(z|~N))+B[1]+2240044497&4294967295,P=z+(D<<21&4294967295|D>>>11),D=N+(z^(P|~L))+B[8]+1873313359&4294967295,N=P+(D<<6&4294967295|D>>>26),D=L+(P^(N|~z))+B[15]+4264355552&4294967295,L=N+(D<<10&4294967295|D>>>22),D=z+(N^(L|~P))+B[6]+2734768916&4294967295,z=L+(D<<15&4294967295|D>>>17),D=P+(L^(z|~N))+B[13]+1309151649&4294967295,P=z+(D<<21&4294967295|D>>>11),D=N+(z^(P|~L))+B[4]+4149444226&4294967295,N=P+(D<<6&4294967295|D>>>26),D=L+(P^(N|~z))+B[11]+3174756917&4294967295,L=N+(D<<10&4294967295|D>>>22),D=z+(N^(L|~P))+B[2]+718787259&4294967295,z=L+(D<<15&4294967295|D>>>17),D=P+(L^(z|~N))+B[9]+3951481745&4294967295,I.g[0]=I.g[0]+N&4294967295,I.g[1]=I.g[1]+(z+(D<<21&4294967295|D>>>11))&4294967295,I.g[2]=I.g[2]+z&4294967295,I.g[3]=I.g[3]+L&4294967295}r.prototype.v=function(I,N){N===void 0&&(N=I.length);const P=N-this.blockSize,B=this.C;let z=this.h,L=0;for(;L<N;){if(z==0)for(;L<=P;)i(this,I,L),L+=this.blockSize;if(typeof I=="string"){for(;L<N;)if(B[z++]=I.charCodeAt(L++),z==this.blockSize){i(this,B),z=0;break}}else for(;L<N;)if(B[z++]=I[L++],z==this.blockSize){i(this,B),z=0;break}}this.h=z,this.o+=N},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var N=1;N<I.length-8;++N)I[N]=0;N=this.o*8;for(var P=I.length-8;P<I.length;++P)I[P]=N&255,N/=256;for(this.v(I),I=Array(16),N=0,P=0;P<4;++P)for(let B=0;B<32;B+=8)I[N++]=this.g[P]>>>B&255;return I};function o(I,N){var P=u;return Object.prototype.hasOwnProperty.call(P,I)?P[I]:P[I]=N(I)}function l(I,N){this.h=N;const P=[];let B=!0;for(let z=I.length-1;z>=0;z--){const L=I[z]|0;B&&L==N||(P[z]=L,B=!1)}this.g=P}var u={};function h(I){return-128<=I&&I<128?o(I,function(N){return new l([N|0],N<0?-1:0)}):new l([I|0],I<0?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return g;if(I<0)return A(d(-I));const N=[];let P=1;for(let B=0;I>=P;B++)N[B]=I/P|0,P*=4294967296;return new l(N,0)}function p(I,N){if(I.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(I.charAt(0)=="-")return A(p(I.substring(1),N));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=d(Math.pow(N,8));let B=g;for(let L=0;L<I.length;L+=8){var z=Math.min(8,I.length-L);const D=parseInt(I.substring(L,L+z),N);z<8?(z=d(Math.pow(N,z)),B=B.j(z).add(d(D))):(B=B.j(P),B=B.add(d(D)))}return B}var g=h(0),b=h(1),_=h(16777216);n=l.prototype,n.m=function(){if(x(this))return-A(this).m();let I=0,N=1;for(let P=0;P<this.g.length;P++){const B=this.i(P);I+=(B>=0?B:4294967296+B)*N,N*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(T(this))return"0";if(x(this))return"-"+A(this).toString(I);const N=d(Math.pow(I,6));var P=this;let B="";for(;;){const z=Y(P,N).g;P=R(P,z.j(N));let L=((P.g.length>0?P.g[0]:P.h)>>>0).toString(I);if(P=z,T(P))return L+B;for(;L.length<6;)L="0"+L;B=L+B}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function T(I){if(I.h!=0)return!1;for(let N=0;N<I.g.length;N++)if(I.g[N]!=0)return!1;return!0}function x(I){return I.h==-1}n.l=function(I){return I=R(this,I),x(I)?-1:T(I)?0:1};function A(I){const N=I.g.length,P=[];for(let B=0;B<N;B++)P[B]=~I.g[B];return new l(P,~I.h).add(b)}n.abs=function(){return x(this)?A(this):this},n.add=function(I){const N=Math.max(this.g.length,I.g.length),P=[];let B=0;for(let z=0;z<=N;z++){let L=B+(this.i(z)&65535)+(I.i(z)&65535),D=(L>>>16)+(this.i(z)>>>16)+(I.i(z)>>>16);B=D>>>16,L&=65535,D&=65535,P[z]=D<<16|L}return new l(P,P[P.length-1]&-2147483648?-1:0)};function R(I,N){return I.add(A(N))}n.j=function(I){if(T(this)||T(I))return g;if(x(this))return x(I)?A(this).j(A(I)):A(A(this).j(I));if(x(I))return A(this.j(A(I)));if(this.l(_)<0&&I.l(_)<0)return d(this.m()*I.m());const N=this.g.length+I.g.length,P=[];for(var B=0;B<2*N;B++)P[B]=0;for(B=0;B<this.g.length;B++)for(let z=0;z<I.g.length;z++){const L=this.i(B)>>>16,D=this.i(B)&65535,ue=I.i(z)>>>16,ve=I.i(z)&65535;P[2*B+2*z]+=D*ve,M(P,2*B+2*z),P[2*B+2*z+1]+=L*ve,M(P,2*B+2*z+1),P[2*B+2*z+1]+=D*ue,M(P,2*B+2*z+1),P[2*B+2*z+2]+=L*ue,M(P,2*B+2*z+2)}for(I=0;I<N;I++)P[I]=P[2*I+1]<<16|P[2*I];for(I=N;I<2*N;I++)P[I]=0;return new l(P,0)};function M(I,N){for(;(I[N]&65535)!=I[N];)I[N+1]+=I[N]>>>16,I[N]&=65535,N++}function j(I,N){this.g=I,this.h=N}function Y(I,N){if(T(N))throw Error("division by zero");if(T(I))return new j(g,g);if(x(I))return N=Y(A(I),N),new j(A(N.g),A(N.h));if(x(N))return N=Y(I,A(N)),new j(A(N.g),N.h);if(I.g.length>30){if(x(I)||x(N))throw Error("slowDivide_ only works with positive integers.");for(var P=b,B=N;B.l(I)<=0;)P=$(P),B=$(B);var z=G(P,1),L=G(B,1);for(B=G(B,2),P=G(P,2);!T(B);){var D=L.add(B);D.l(I)<=0&&(z=z.add(P),L=D),B=G(B,1),P=G(P,1)}return N=R(I,z.j(N)),new j(z,N)}for(z=g;I.l(N)>=0;){for(P=Math.max(1,Math.floor(I.m()/N.m())),B=Math.ceil(Math.log(P)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),L=d(P),D=L.j(N);x(D)||D.l(I)>0;)P-=B,L=d(P),D=L.j(N);T(L)&&(L=b),z=z.add(L),I=R(I,D)}return new j(z,I)}n.B=function(I){return Y(this,I).h},n.and=function(I){const N=Math.max(this.g.length,I.g.length),P=[];for(let B=0;B<N;B++)P[B]=this.i(B)&I.i(B);return new l(P,this.h&I.h)},n.or=function(I){const N=Math.max(this.g.length,I.g.length),P=[];for(let B=0;B<N;B++)P[B]=this.i(B)|I.i(B);return new l(P,this.h|I.h)},n.xor=function(I){const N=Math.max(this.g.length,I.g.length),P=[];for(let B=0;B<N;B++)P[B]=this.i(B)^I.i(B);return new l(P,this.h^I.h)};function $(I){const N=I.g.length+1,P=[];for(let B=0;B<N;B++)P[B]=I.i(B)<<1|I.i(B-1)>>>31;return new l(P,I.h)}function G(I,N){const P=N>>5;N%=32;const B=I.g.length-P,z=[];for(let L=0;L<B;L++)z[L]=N>0?I.i(L+P)>>>N|I.i(L+P+1)<<32-N:I.i(L+P);return new l(z,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,BR=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=p,Oo=l}).apply(typeof X1<"u"?X1:typeof self<"u"?self:typeof window<"u"?window:{});var dp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var zR,bh,FR,Vp,o0,HR,qR,$R;(function(){var n,e=Object.defineProperty;function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof dp=="object"&&dp];for(var E=0;E<m.length;++E){var C=m[E];if(C&&C.Math==Math)return C}throw Error("Cannot find global object")}var r=t(this);function i(m,E){if(E)e:{var C=r;m=m.split(".");for(var O=0;O<m.length-1;O++){var K=m[O];if(!(K in C))break e;C=C[K]}m=m[m.length-1],O=C[m],E=E(O),E!=O&&E!=null&&e(C,m,{configurable:!0,writable:!0,value:E})}}i("Symbol.dispose",function(m){return m||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(m){return m||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(m){return m||function(E){var C=[],O;for(O in E)Object.prototype.hasOwnProperty.call(E,O)&&C.push([O,E[O]]);return C}});var o=o||{},l=this||self;function u(m){var E=typeof m;return E=="object"&&m!=null||E=="function"}function h(m,E,C){return m.call.apply(m.bind,arguments)}function d(m,E,C){return d=h,d.apply(null,arguments)}function p(m,E){var C=Array.prototype.slice.call(arguments,1);return function(){var O=C.slice();return O.push.apply(O,arguments),m.apply(this,O)}}function g(m,E){function C(){}C.prototype=E.prototype,m.Z=E.prototype,m.prototype=new C,m.prototype.constructor=m,m.Ob=function(O,K,Z){for(var he=Array(arguments.length-2),De=2;De<arguments.length;De++)he[De-2]=arguments[De];return E.prototype[K].apply(O,he)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?m=>m&&AsyncContext.Snapshot.wrap(m):m=>m;function _(m){const E=m.length;if(E>0){const C=Array(E);for(let O=0;O<E;O++)C[O]=m[O];return C}return[]}function T(m,E){for(let O=1;O<arguments.length;O++){const K=arguments[O];var C=typeof K;if(C=C!="object"?C:K?Array.isArray(K)?"array":C:"null",C=="array"||C=="object"&&typeof K.length=="number"){C=m.length||0;const Z=K.length||0;m.length=C+Z;for(let he=0;he<Z;he++)m[C+he]=K[he]}else m.push(K)}}class x{constructor(E,C){this.i=E,this.j=C,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function A(m){l.setTimeout(()=>{throw m},0)}function R(){var m=I;let E=null;return m.g&&(E=m.g,m.g=m.g.next,m.g||(m.h=null),E.next=null),E}class M{constructor(){this.h=this.g=null}add(E,C){const O=j.get();O.set(E,C),this.h?this.h.next=O:this.g=O,this.h=O}}var j=new x(()=>new Y,m=>m.reset());class Y{constructor(){this.next=this.g=this.h=null}set(E,C){this.h=E,this.g=C,this.next=null}reset(){this.next=this.g=this.h=null}}let $,G=!1,I=new M,N=()=>{const m=Promise.resolve(void 0);$=()=>{m.then(P)}};function P(){for(var m;m=R();){try{m.h.call(m.g)}catch(C){A(C)}var E=j;E.j(m),E.h<100&&(E.h++,m.next=E.g,E.g=m)}G=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(m,E){this.type=m,this.g=this.target=E,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var m=!1,E=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const C=()=>{};l.addEventListener("test",C,E),l.removeEventListener("test",C,E)}catch{}return m})();function D(m){return/^[\s\xa0]*$/.test(m)}function ue(m,E){z.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m&&this.init(m,E)}g(ue,z),ue.prototype.init=function(m,E){const C=this.type=m.type,O=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;this.target=m.target||m.srcElement,this.g=E,E=m.relatedTarget,E||(C=="mouseover"?E=m.fromElement:C=="mouseout"&&(E=m.toElement)),this.relatedTarget=E,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=m.pointerType,this.state=m.state,this.i=m,m.defaultPrevented&&ue.Z.h.call(this)},ue.prototype.h=function(){ue.Z.h.call(this);const m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var ve="closure_listenable_"+(Math.random()*1e6|0),J=0;function ne(m,E,C,O,K){this.listener=m,this.proxy=null,this.src=E,this.type=C,this.capture=!!O,this.ha=K,this.key=++J,this.da=this.fa=!1}function pe(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function ke(m,E,C){for(const O in m)E.call(C,m[O],O,m)}function Be(m,E){for(const C in m)E.call(void 0,m[C],C,m)}function F(m){const E={};for(const C in m)E[C]=m[C];return E}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fe(m,E){let C,O;for(let K=1;K<arguments.length;K++){O=arguments[K];for(C in O)m[C]=O[C];for(let Z=0;Z<se.length;Z++)C=se[Z],Object.prototype.hasOwnProperty.call(O,C)&&(m[C]=O[C])}}function ye(m){this.src=m,this.g={},this.h=0}ye.prototype.add=function(m,E,C,O,K){const Z=m.toString();m=this.g[Z],m||(m=this.g[Z]=[],this.h++);const he=Pe(m,E,O,K);return he>-1?(E=m[he],C||(E.fa=!1)):(E=new ne(E,this.src,Z,!!O,K),E.fa=C,m.push(E)),E};function Ie(m,E){const C=E.type;if(C in m.g){var O=m.g[C],K=Array.prototype.indexOf.call(O,E,void 0),Z;(Z=K>=0)&&Array.prototype.splice.call(O,K,1),Z&&(pe(E),m.g[C].length==0&&(delete m.g[C],m.h--))}}function Pe(m,E,C,O){for(let K=0;K<m.length;++K){const Z=m[K];if(!Z.da&&Z.listener==E&&Z.capture==!!C&&Z.ha==O)return K}return-1}var Qe="closure_lm_"+(Math.random()*1e6|0),tn={};function bt(m,E,C,O,K){if(Array.isArray(E)){for(let Z=0;Z<E.length;Z++)bt(m,E[Z],C,O,K);return null}return C=au(C),m&&m[ve]?m.J(E,C,u(O)?!!O.capture:!1,K):aa(m,E,C,!1,O,K)}function aa(m,E,C,O,K,Z){if(!E)throw Error("Invalid event type");const he=u(K)?!!K.capture:!!K;let De=la(m);if(De||(m[Qe]=De=new ye(m)),C=De.add(E,C,O,he,Z),C.proxy)return C;if(O=bl(),C.proxy=O,O.src=m,O.listener=C,m.addEventListener)L||(K=he),K===void 0&&(K=!1),m.addEventListener(E.toString(),O,K);else if(m.attachEvent)m.attachEvent(hi(E.toString()),O);else if(m.addListener&&m.removeListener)m.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return C}function bl(){function m(C){return E.call(m.src,m.listener,C)}const E=su;return m}function _l(m,E,C,O,K){if(Array.isArray(E))for(var Z=0;Z<E.length;Z++)_l(m,E[Z],C,O,K);else O=u(O)?!!O.capture:!!O,C=au(C),m&&m[ve]?(m=m.i,Z=String(E).toString(),Z in m.g&&(E=m.g[Z],C=Pe(E,C,O,K),C>-1&&(pe(E[C]),Array.prototype.splice.call(E,C,1),E.length==0&&(delete m.g[Z],m.h--)))):m&&(m=la(m))&&(E=m.g[E.toString()],m=-1,E&&(m=Pe(E,C,O,K)),(C=m>-1?E[m]:null)&&El(C))}function El(m){if(typeof m!="number"&&m&&!m.da){var E=m.src;if(E&&E[ve])Ie(E.i,m);else{var C=m.type,O=m.proxy;E.removeEventListener?E.removeEventListener(C,O,m.capture):E.detachEvent?E.detachEvent(hi(C),O):E.addListener&&E.removeListener&&E.removeListener(O),(C=la(E))?(Ie(C,m),C.h==0&&(C.src=null,E[Qe]=null)):pe(m)}}}function hi(m){return m in tn?tn[m]:tn[m]="on"+m}function su(m,E){if(m.da)m=!0;else{E=new ue(E,this);const C=m.listener,O=m.ha||m.src;m.fa&&El(m),m=C.call(O,E)}return m}function la(m){return m=m[Qe],m instanceof ye?m:null}var ou="__closure_events_fn_"+(Math.random()*1e9>>>0);function au(m){return typeof m=="function"?m:(m[ou]||(m[ou]=function(E){return m.handleEvent(E)}),m[ou])}function Bt(){B.call(this),this.i=new ye(this),this.M=this,this.G=null}g(Bt,B),Bt.prototype[ve]=!0,Bt.prototype.removeEventListener=function(m,E,C,O){_l(this,m,E,C,O)};function nn(m,E){var C,O=m.G;if(O)for(C=[];O;O=O.G)C.push(O);if(m=m.M,O=E.type||E,typeof E=="string")E=new z(E,m);else if(E instanceof z)E.target=E.target||m;else{var K=E;E=new z(O,m),fe(E,K)}K=!0;let Z,he;if(C)for(he=C.length-1;he>=0;he--)Z=E.g=C[he],K=Ds(Z,O,!0,E)&&K;if(Z=E.g=m,K=Ds(Z,O,!0,E)&&K,K=Ds(Z,O,!1,E)&&K,C)for(he=0;he<C.length;he++)Z=E.g=C[he],K=Ds(Z,O,!1,E)&&K}Bt.prototype.N=function(){if(Bt.Z.N.call(this),this.i){var m=this.i;for(const E in m.g){const C=m.g[E];for(let O=0;O<C.length;O++)pe(C[O]);delete m.g[E],m.h--}}this.G=null},Bt.prototype.J=function(m,E,C,O){return this.i.add(String(m),E,!1,C,O)},Bt.prototype.K=function(m,E,C,O){return this.i.add(String(m),E,!0,C,O)};function Ds(m,E,C,O){if(E=m.i.g[String(E)],!E)return!0;E=E.concat();let K=!0;for(let Z=0;Z<E.length;++Z){const he=E[Z];if(he&&!he.da&&he.capture==C){const De=he.listener,Dt=he.ha||he.src;he.fa&&Ie(m.i,he),K=De.call(Dt,O)!==!1&&K}}return K&&!O.defaultPrevented}function ey(m,E){if(typeof m!="function")if(m&&typeof m.handleEvent=="function")m=d(m.handleEvent,m);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:l.setTimeout(m,E||0)}function Vf(m){m.g=ey(()=>{m.g=null,m.i&&(m.i=!1,Vf(m))},m.l);const E=m.h;m.h=null,m.m.apply(null,E)}class Un extends B{constructor(E,C){super(),this.m=E,this.l=C,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:Vf(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ca(m){B.call(this),this.h=m,this.g={}}g(ca,B);var lu=[];function cu(m){ke(m.g,function(E,C){this.g.hasOwnProperty(C)&&El(E)},m),m.g={}}ca.prototype.N=function(){ca.Z.N.call(this),cu(this)},ca.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ls=l.JSON.stringify,ty=l.JSON.parse,jf=class{stringify(m){return l.JSON.stringify(m,void 0)}parse(m){return l.JSON.parse(m,void 0)}};function Uf(){}function Bf(){}var Hr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function yn(){z.call(this,"d")}g(yn,z);function Tr(){z.call(this,"c")}g(Tr,z);var Ot={},zf=null;function Tl(){return zf=zf||new Bt}Ot.Ia="serverreachability";function Ff(m){z.call(this,Ot.Ia,m)}g(Ff,z);function fi(m){const E=Tl();nn(E,new Ff(E))}Ot.STAT_EVENT="statevent";function ua(m,E){z.call(this,Ot.STAT_EVENT,m),this.stat=E}g(ua,z);function zt(m){const E=Tl();nn(E,new ua(E,m))}Ot.Ja="timingevent";function di(m,E){z.call(this,Ot.Ja,m),this.size=E}g(di,z);function pi(m,E){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){m()},E)}function qr(){this.g=!0}qr.prototype.ua=function(){this.g=!1};function ny(m,E,C,O,K,Z){m.info(function(){if(m.g)if(Z){var he="",De=Z.split("&");for(let et=0;et<De.length;et++){var Dt=De[et].split("=");if(Dt.length>1){const _t=Dt[0];Dt=Dt[1];const Cr=_t.split("_");he=Cr.length>=2&&Cr[1]=="type"?he+(_t+"="+Dt+"&"):he+(_t+"=redacted&")}}}else he=null;else he=Z;return"XMLHTTP REQ ("+O+") [attempt "+K+"]: "+E+`
`+C+`
`+he})}function Hf(m,E,C,O,K,Z,he){m.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+K+"]: "+E+`
`+C+`
`+Z+" "+he})}function mi(m,E,C,O){m.info(function(){return"XMLHTTP TEXT ("+E+"): "+ry(m,C)+(O?" "+O:"")})}function ha(m,E){m.info(function(){return"TIMEOUT: "+E})}qr.prototype.info=function(){};function ry(m,E){if(!m.g)return E;if(!E)return null;try{const Z=JSON.parse(E);if(Z){for(m=0;m<Z.length;m++)if(Array.isArray(Z[m])){var C=Z[m];if(!(C.length<2)){var O=C[1];if(Array.isArray(O)&&!(O.length<1)){var K=O[0];if(K!="noop"&&K!="stop"&&K!="close")for(let he=1;he<O.length;he++)O[he]=""}}}}return Ls(Z)}catch{return E}}var fa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},uu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},hu;function da(){}g(da,Uf),da.prototype.g=function(){return new XMLHttpRequest},hu=new da;function Ji(m){return encodeURIComponent(String(m))}function qf(m){var E=1;m=m.split(":");const C=[];for(;E>0&&m.length;)C.push(m.shift()),E--;return m.length&&C.push(m.join(":")),C}function $r(m,E,C,O){this.j=m,this.i=E,this.l=C,this.S=O||1,this.V=new ca(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Gr}function Gr(){this.i=null,this.g="",this.h=!1}var Ft={},an={};function gi(m,E,C){m.M=1,m.A=pa(qt(E)),m.u=C,m.R=!0,Sl(m,null)}function Sl(m,E){m.F=Date.now(),yi(m),m.B=qt(m.A);var C=m.B,O=m.S;Array.isArray(O)||(O=[String(O)]),xl(C.i,"t",O),m.C=0,C=m.j.L,m.h=new Gr,m.g=sd(m.j,C?E:null,!m.u),m.P>0&&(m.O=new Un(d(m.Y,m,m.g),m.P)),E=m.V,C=m.g,O=m.ba;var K="readystatechange";Array.isArray(K)||(K&&(lu[0]=K.toString()),K=lu);for(let Z=0;Z<K.length;Z++){const he=bt(C,K[Z],O||E.handleEvent,!1,E.h||E);if(!he)break;E.g[he.key]=he}E=m.J?F(m.J):{},m.u?(m.v||(m.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.B,m.v,m.u,E)):(m.v="GET",m.g.ea(m.B,m.v,null,E)),fi(),ny(m.i,m.v,m.B,m.l,m.S,m.u)}$r.prototype.ba=function(m){m=m.target;const E=this.O;E&&Qr(m)==3?E.j():this.Y(m)},$r.prototype.Y=function(m){try{if(m==this.g)e:{const De=Qr(this.g),Dt=this.g.ya(),et=this.g.ca();if(!(De<3)&&(De!=3||this.g&&(this.h.h||this.g.la()||vn(this.g)))){this.K||De!=4||Dt==7||(Dt==8||et<=0?fi(3):fi(2)),vi(this);var E=this.g.ca();this.X=E;var C=iy(this);if(this.o=E==200,Hf(this.i,this.v,this.B,this.l,this.S,De,E),this.o){if(this.U&&!this.L){t:{if(this.g){var O,K=this.g;if((O=K.g?K.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(O)){var Z=O;break t}}Z=null}if(m=Z)mi(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,bi(this,m);else{this.o=!1,this.m=3,zt(12),sr(this),Sr(this);break e}}if(this.R){m=!0;let _t;for(;!this.K&&this.C<C.length;)if(_t=Gf(this,C),_t==an){De==4&&(this.m=4,zt(14),m=!1),mi(this.i,this.l,null,"[Incomplete Response]");break}else if(_t==Ft){this.m=4,zt(15),mi(this.i,this.l,C,"[Invalid Chunk]"),m=!1;break}else mi(this.i,this.l,_t,null),bi(this,_t);if($f(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),De!=4||C.length!=0||this.h.h||(this.m=1,zt(16),m=!1),this.o=this.o&&m,!m)mi(this.i,this.l,C,"[Invalid Chunked Response]"),sr(this),Sr(this);else if(C.length>0&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.aa&&!he.P&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+C.length),Cu(he),he.P=!0,zt(11))}}else mi(this.i,this.l,C,null),bi(this,C);De==4&&sr(this),this.o&&!this.K&&(De==4?td(this.j,this):(this.o=!1,yi(this)))}else Zi(this.g),E==400&&C.indexOf("Unknown SID")>0?(this.m=3,zt(12)):(this.m=0,zt(13)),sr(this),Sr(this)}}}catch{}};function iy(m){if(!$f(m))return m.g.la();const E=vn(m.g);if(E==="")return"";let C="";const O=E.length,K=Qr(m.g)==4;if(!m.h.i){if(typeof TextDecoder>"u")return sr(m),Sr(m),"";m.h.i=new l.TextDecoder}for(let Z=0;Z<O;Z++)m.h.h=!0,C+=m.h.i.decode(E[Z],{stream:!(K&&Z==O-1)});return E.length=0,m.h.g+=C,m.C=0,m.h.g}function $f(m){return m.g?m.v=="GET"&&m.M!=2&&m.j.Aa:!1}function Gf(m,E){var C=m.C,O=E.indexOf(`
`,C);return O==-1?an:(C=Number(E.substring(C,O)),isNaN(C)?Ft:(O+=1,O+C>E.length?an:(E=E.slice(O,O+C),m.C=O+C,E)))}$r.prototype.cancel=function(){this.K=!0,sr(this)};function yi(m){m.T=Date.now()+m.H,wl(m,m.H)}function wl(m,E){if(m.D!=null)throw Error("WatchDog timer not null");m.D=pi(d(m.aa,m),E)}function vi(m){m.D&&(l.clearTimeout(m.D),m.D=null)}$r.prototype.aa=function(){this.D=null;const m=Date.now();m-this.T>=0?(ha(this.i,this.B),this.M!=2&&(fi(),zt(17)),sr(this),this.m=2,Sr(this)):wl(this,this.T-m)};function Sr(m){m.j.I==0||m.K||td(m.j,m)}function sr(m){vi(m);var E=m.O;E&&typeof E.dispose=="function"&&E.dispose(),m.O=null,cu(m.V),m.g&&(E=m.g,m.g=null,E.abort(),E.dispose())}function bi(m,E){try{var C=m.j;if(C.I!=0&&(C.g==m||Ei(C.h,m))){if(!m.L&&Ei(C.h,m)&&C.I==3){try{var O=C.Ba.g.parse(E)}catch{O=null}if(Array.isArray(O)&&O.length==3){var K=O;if(K[0]==0){e:if(!C.v){if(C.g)if(C.g.F+3e3<m.F)Ml(C),Hs(C);else break e;Ea(C),zt(18)}}else C.xa=K[1],0<C.xa-C.K&&K[2]<37500&&C.F&&C.A==0&&!C.C&&(C.C=pi(d(C.Va,C),6e3));_i(C.h)<=1&&C.ta&&(C.ta=void 0)}else xi(C,11)}else if((m.L||C.g==m)&&Ml(C),!D(E))for(K=C.Ba.g.parse(E),E=0;E<K.length;E++){let et=K[E];const _t=et[0];if(!(_t<=C.K))if(C.K=_t,et=et[1],C.I==2)if(et[0]=="c"){C.M=et[1],C.ba=et[2];const Cr=et[3];Cr!=null&&(C.ka=Cr,C.j.info("VER="+C.ka));const Ri=et[4];Ri!=null&&(C.za=Ri,C.j.info("SVER="+C.za));const Yr=et[5];Yr!=null&&typeof Yr=="number"&&Yr>0&&(O=1.5*Yr,C.O=O,C.j.info("backChannelRequestTimeoutMs_="+O)),O=C;const Jr=m.g;if(Jr){const Ta=Jr.g?Jr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ta){var Z=O.h;Z.g||Ta.indexOf("spdy")==-1&&Ta.indexOf("quic")==-1&&Ta.indexOf("h2")==-1||(Z.j=Z.l,Z.g=new Set,Z.h&&(pu(Z,Z.h),Z.h=null))}if(O.G){const Ol=Jr.g?Jr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ol&&(O.wa=Ol,nt(O.J,O.G,Ol))}}C.I=3,C.l&&C.l.ra(),C.aa&&(C.T=Date.now()-m.F,C.j.info("Handshake RTT: "+C.T+"ms")),O=C;var he=m;if(O.na=id(O,O.L?O.ba:null,O.W),he.L){mu(O.h,he);var De=he,Dt=O.O;Dt&&(De.H=Dt),De.D&&(vi(De),yi(De)),O.g=he}else Zf(O);C.i.length>0&&Ci(C)}else et[0]!="stop"&&et[0]!="close"||xi(C,7);else C.I==3&&(et[0]=="stop"||et[0]=="close"?et[0]=="stop"?xi(C,7):wu(C):et[0]!="noop"&&C.l&&C.l.qa(et),C.A=0)}}fi(4)}catch{}}var Ht=class{constructor(m,E){this.g=m,this.map=E}};function fu(m){this.l=m||10,l.PerformanceNavigationTiming?(m=l.performance.getEntriesByType("navigation"),m=m.length>0&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function du(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function _i(m){return m.h?1:m.g?m.g.size:0}function Ei(m,E){return m.h?m.h==E:m.g?m.g.has(E):!1}function pu(m,E){m.g?m.g.add(E):m.h=E}function mu(m,E){m.h&&m.h==E?m.h=null:m.g&&m.g.has(E)&&m.g.delete(E)}fu.prototype.cancel=function(){if(this.i=gu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function gu(m){if(m.h!=null)return m.i.concat(m.h.G);if(m.g!=null&&m.g.size!==0){let E=m.i;for(const C of m.g.values())E=E.concat(C.G);return E}return _(m.i)}var Kf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Al(m,E){if(m){m=m.split("&");for(let C=0;C<m.length;C++){const O=m[C].indexOf("=");let K,Z=null;O>=0?(K=m[C].substring(0,O),Z=m[C].substring(O+1)):K=m[C],E(K,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function or(m){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;m instanceof or?(this.l=m.l,ln(this,m.j),this.o=m.o,this.g=m.g,Ps(this,m.u),this.h=m.h,yu(this,Jf(m.i)),this.m=m.m):m&&(E=String(m).match(Kf))?(this.l=!1,ln(this,E[1]||"",!0),this.o=Ti(E[2]||""),this.g=Ti(E[3]||"",!0),Ps(this,E[4]),this.h=Ti(E[5]||"",!0),yu(this,E[6]||"",!0),this.m=Ti(E[7]||"")):(this.l=!1,this.i=new js(null,this.l))}or.prototype.toString=function(){const m=[];var E=this.j;E&&m.push(ma(E,Cl,!0),":");var C=this.g;return(C||E=="file")&&(m.push("//"),(E=this.o)&&m.push(ma(E,Cl,!0),"@"),m.push(Ji(C).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C=this.u,C!=null&&m.push(":",String(C))),(C=this.h)&&(this.g&&C.charAt(0)!="/"&&m.push("/"),m.push(ma(C,C.charAt(0)=="/"?vu:Wf,!0))),(C=this.i.toString())&&m.push("?",C),(C=this.m)&&m.push("#",ma(C,Qf)),m.join("")},or.prototype.resolve=function(m){const E=qt(this);let C=!!m.j;C?ln(E,m.j):C=!!m.o,C?E.o=m.o:C=!!m.g,C?E.g=m.g:C=m.u!=null;var O=m.h;if(C)Ps(E,m.u);else if(C=!!m.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var K=E.h.lastIndexOf("/");K!=-1&&(O=E.h.slice(0,K+1)+O)}if(K=O,K==".."||K==".")O="";else if(K.indexOf("./")!=-1||K.indexOf("/.")!=-1){O=K.lastIndexOf("/",0)==0,K=K.split("/");const Z=[];for(let he=0;he<K.length;){const De=K[he++];De=="."?O&&he==K.length&&Z.push(""):De==".."?((Z.length>1||Z.length==1&&Z[0]!="")&&Z.pop(),O&&he==K.length&&Z.push("")):(Z.push(De),O=!0)}O=Z.join("/")}else O=K}return C?E.h=O:C=m.i.toString()!=="",C?yu(E,Jf(m.i)):C=!!m.m,C&&(E.m=m.m),E};function qt(m){return new or(m)}function ln(m,E,C){m.j=C?Ti(E,!0):E,m.j&&(m.j=m.j.replace(/:$/,""))}function Ps(m,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);m.u=E}else m.u=null}function yu(m,E,C){E instanceof js?(m.i=E,Rl(m.i,m.l)):(C||(E=ma(E,Vs)),m.i=new js(E,m.l))}function nt(m,E,C){m.i.set(E,C)}function pa(m){return nt(m,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),m}function Ti(m,E){return m?E?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function ma(m,E,C){return typeof m=="string"?(m=encodeURI(m).replace(E,Wn),C&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Wn(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Cl=/[#\/\?@]/g,Wf=/[#\?:]/g,vu=/[#\?]/g,Vs=/[#\?@]/g,Qf=/#/g;function js(m,E){this.h=this.g=null,this.i=m||null,this.j=!!E}function Qn(m){m.g||(m.g=new Map,m.h=0,m.i&&Al(m.i,function(E,C){m.add(decodeURIComponent(E.replace(/\+/g," ")),C)}))}n=js.prototype,n.add=function(m,E){Qn(this),this.i=null,m=Us(this,m);let C=this.g.get(m);return C||this.g.set(m,C=[]),C.push(E),this.h+=1,this};function Yf(m,E){Qn(m),E=Us(m,E),m.g.has(E)&&(m.i=null,m.h-=m.g.get(E).length,m.g.delete(E))}function bu(m,E){return Qn(m),E=Us(m,E),m.g.has(E)}n.forEach=function(m,E){Qn(this),this.g.forEach(function(C,O){C.forEach(function(K){m.call(E,K,O,this)},this)},this)};function _u(m,E){Qn(m);let C=[];if(typeof E=="string")bu(m,E)&&(C=C.concat(m.g.get(Us(m,E))));else for(m=Array.from(m.g.values()),E=0;E<m.length;E++)C=C.concat(m[E]);return C}n.set=function(m,E){return Qn(this),this.i=null,m=Us(this,m),bu(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[E]),this.h+=1,this},n.get=function(m,E){return m?(m=_u(this,m),m.length>0?String(m[0]):E):E};function xl(m,E,C){Yf(m,E),C.length>0&&(m.i=null,m.g.set(Us(m,E),_(C)),m.h+=C.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],E=Array.from(this.g.keys());for(let O=0;O<E.length;O++){var C=E[O];const K=Ji(C);C=_u(this,C);for(let Z=0;Z<C.length;Z++){let he=K;C[Z]!==""&&(he+="="+Ji(C[Z])),m.push(he)}}return this.i=m.join("&")};function Jf(m){const E=new js;return E.i=m.i,m.g&&(E.g=new Map(m.g),E.h=m.h),E}function Us(m,E){return E=String(E),m.j&&(E=E.toLowerCase()),E}function Rl(m,E){E&&!m.j&&(Qn(m),m.i=null,m.g.forEach(function(C,O){const K=O.toLowerCase();O!=K&&(Yf(this,O),xl(this,K,C))},m)),m.j=E}function Kr(m,E){const C=new qr;if(l.Image){const O=new Image;O.onload=p(wr,C,"TestLoadImage: loaded",!0,E,O),O.onerror=p(wr,C,"TestLoadImage: error",!1,E,O),O.onabort=p(wr,C,"TestLoadImage: abort",!1,E,O),O.ontimeout=p(wr,C,"TestLoadImage: timeout",!1,E,O),l.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=m}else E(!1)}function Eu(m,E){const C=new qr,O=new AbortController,K=setTimeout(()=>{O.abort(),wr(C,"TestPingServer: timeout",!1,E)},1e4);fetch(m,{signal:O.signal}).then(Z=>{clearTimeout(K),Z.ok?wr(C,"TestPingServer: ok",!0,E):wr(C,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(K),wr(C,"TestPingServer: error",!1,E)})}function wr(m,E,C,O,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),O(C)}catch{}}function Bs(){this.g=new jf}function Si(m){this.i=m.Sb||null,this.h=m.ab||!1}g(Si,Uf),Si.prototype.g=function(){return new ga(this.i,this.h)};function ga(m,E){Bt.call(this),this.H=m,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}g(ga,Bt),n=ga.prototype,n.open=function(m,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=m,this.D=E,this.readyState=1,Wr(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};m&&(E.body=m),(this.H||l).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,zs(this)),this.readyState=0},n.Pa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Wr(this)),this.g&&(this.readyState=3,Wr(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;kl(this)}else m.text().then(this.Oa.bind(this),this.ga.bind(this))};function kl(m){m.j.read().then(m.Ma.bind(m)).catch(m.ga.bind(m))}n.Ma=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var E=m.value?m.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!m.done}))&&(this.response=this.responseText+=E)}m.done?zs(this):Wr(this),this.readyState==3&&kl(this)}},n.Oa=function(m){this.g&&(this.response=this.responseText=m,zs(this))},n.Na=function(m){this.g&&(this.response=m,zs(this))},n.ga=function(){this.g&&zs(this)};function zs(m){m.readyState=4,m.l=null,m.j=null,m.B=null,Wr(m)}n.setRequestHeader=function(m,E){this.A.append(m,E)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],E=this.h.entries();for(var C=E.next();!C.done;)C=C.value,m.push(C[0]+": "+C[1]),C=E.next();return m.join(`\r
`)};function Wr(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(ga.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Ar(m){let E="";return ke(m,function(C,O){E+=O,E+=":",E+=C,E+=`\r
`}),E}function ya(m,E,C){e:{for(O in C){var O=!1;break e}O=!0}O||(C=Ar(C),typeof m=="string"?C!=null&&Ji(C):nt(m,E,C))}function ot(m){Bt.call(this),this.headers=new Map,this.L=m||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}g(ot,Bt);var wi=/^https?$/i,Tu=["POST","PUT"];n=ot.prototype,n.Fa=function(m){this.H=m},n.ea=function(m,E,C,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);E=E?E.toUpperCase():"GET",this.D=m,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():hu.g(),this.g.onreadystatechange=b(d(this.Ca,this));try{this.B=!0,this.g.open(E,String(m),!0),this.B=!1}catch(Z){va(this,Z);return}if(m=C||"",C=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var K in O)C.set(K,O[K]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const Z of O.keys())C.set(Z,O.get(Z));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(C.keys()).find(Z=>Z.toLowerCase()=="content-type"),K=l.FormData&&m instanceof l.FormData,!(Array.prototype.indexOf.call(Tu,E,void 0)>=0)||O||K||C.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Z,he]of C)this.g.setRequestHeader(Z,he);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(m),this.v=!1}catch(Z){va(this,Z)}};function va(m,E){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=E,m.o=5,Su(m),Xi(m)}function Su(m){m.A||(m.A=!0,nn(m,"complete"),nn(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=m||7,nn(this,"complete"),nn(this,"abort"),Xi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xi(this,!0)),ot.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ba(this):this.Xa())},n.Xa=function(){ba(this)};function ba(m){if(m.h&&typeof o<"u"){if(m.v&&Qr(m)==4)setTimeout(m.Ca.bind(m),0);else if(nn(m,"readystatechange"),Qr(m)==4){m.h=!1;try{const Z=m.ca();e:switch(Z){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var C;if(!(C=E)){var O;if(O=Z===0){let he=String(m.D).match(Kf)[1]||null;!he&&l.self&&l.self.location&&(he=l.self.location.protocol.slice(0,-1)),O=!wi.test(he?he.toLowerCase():"")}C=O}if(C)nn(m,"complete"),nn(m,"success");else{m.o=6;try{var K=Qr(m)>2?m.g.statusText:""}catch{K=""}m.l=K+" ["+m.ca()+"]",Su(m)}}finally{Xi(m)}}}}function Xi(m,E){if(m.g){m.m&&(clearTimeout(m.m),m.m=null);const C=m.g;m.g=null,E||nn(m,"ready");try{C.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Qr(m){return m.g?m.g.readyState:0}n.ca=function(){try{return Qr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(m){if(this.g){var E=this.g.responseText;return m&&E.indexOf(m)==0&&(E=E.substring(m.length)),ty(E)}};function vn(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.F){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function Zi(m){const E={};m=(m.g&&Qr(m)>=2&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<m.length;O++){if(D(m[O]))continue;var C=qf(m[O]);const K=C[0];if(C=C[1],typeof C!="string")continue;C=C.trim();const Z=E[K]||[];E[K]=Z,Z.push(C)}Be(E,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ai(m,E,C){return C&&C.internalChannelParams&&C.internalChannelParams[m]||E}function Fs(m){this.za=0,this.i=[],this.j=new qr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ai("failFast",!1,m),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ai("baseRetryDelayMs",5e3,m),this.Za=Ai("retryDelaySeedMs",1e4,m),this.Ta=Ai("forwardChannelMaxRetries",2,m),this.va=Ai("forwardChannelRequestTimeoutMs",2e4,m),this.ma=m&&m.xmlHttpFactory||void 0,this.Ua=m&&m.Rb||void 0,this.Aa=m&&m.useFetchStreams||!1,this.O=void 0,this.L=m&&m.supportsCrossDomainXhr||!1,this.M="",this.h=new fu(m&&m.concurrentRequestLimit),this.Ba=new Bs,this.S=m&&m.fastHandshake||!1,this.R=m&&m.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=m&&m.Pb||!1,m&&m.ua&&this.j.ua(),m&&m.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&m&&m.detectBufferingProxy||!1,this.ia=void 0,m&&m.longPollingTimeout&&m.longPollingTimeout>0&&(this.ia=m.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Fs.prototype,n.ka=8,n.I=1,n.connect=function(m,E,C,O){zt(0),this.W=m,this.H=E||{},C&&O!==void 0&&(this.H.OSID=C,this.H.OAID=O),this.F=this.X,this.J=id(this,null,this.W),Ci(this)};function wu(m){if(Il(m),m.I==3){var E=m.V++,C=qt(m.J);if(nt(C,"SID",m.M),nt(C,"RID",E),nt(C,"TYPE","terminate"),_a(m,C),E=new $r(m,m.j,E),E.M=2,E.A=pa(qt(C)),C=!1,l.navigator&&l.navigator.sendBeacon)try{C=l.navigator.sendBeacon(E.A.toString(),"")}catch{}!C&&l.Image&&(new Image().src=E.A,C=!0),C||(E.g=sd(E.j,null),E.g.ea(E.A)),E.F=Date.now(),yi(E)}rd(m)}function Hs(m){m.g&&(Cu(m),m.g.cancel(),m.g=null)}function Il(m){Hs(m),m.v&&(l.clearTimeout(m.v),m.v=null),Ml(m),m.h.cancel(),m.m&&(typeof m.m=="number"&&l.clearTimeout(m.m),m.m=null)}function Ci(m){if(!du(m.h)&&!m.m){m.m=!0;var E=m.Ea;$||N(),G||($(),G=!0),I.add(E,m),m.D=0}}function Nl(m,E){return _i(m.h)>=m.h.j-(m.m?1:0)?!1:m.m?(m.i=E.G.concat(m.i),!0):m.I==1||m.I==2||m.D>=(m.Sa?0:m.Ta)?!1:(m.m=pi(d(m.Ea,m,E),nd(m,m.D)),m.D++,!0)}n.Ea=function(m){if(this.m)if(this.m=null,this.I==1){if(!m){this.V=Math.floor(Math.random()*1e5),m=this.V++;const K=new $r(this,this.j,m);let Z=this.o;if(this.U&&(Z?(Z=F(Z),fe(Z,this.U)):Z=this.U),this.u!==null||this.R||(K.J=Z,Z=null),this.S)e:{for(var E=0,C=0;C<this.i.length;C++){t:{var O=this.i[C];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(E+=O,E>4096){E=C;break e}if(E===4096||C===this.i.length-1){E=C+1;break e}}E=1e3}else E=1e3;E=Xf(this,K,E),C=qt(this.J),nt(C,"RID",m),nt(C,"CVER",22),this.G&&nt(C,"X-HTTP-Session-Id",this.G),_a(this,C),Z&&(this.R?E="headers="+Ji(Ar(Z))+"&"+E:this.u&&ya(C,this.u,Z)),pu(this.h,K),this.Ra&&nt(C,"TYPE","init"),this.S?(nt(C,"$req",E),nt(C,"SID","null"),K.U=!0,gi(K,C,null)):gi(K,C,E),this.I=2}}else this.I==3&&(m?Au(this,m):this.i.length==0||du(this.h)||Au(this))};function Au(m,E){var C;E?C=E.l:C=m.V++;const O=qt(m.J);nt(O,"SID",m.M),nt(O,"RID",C),nt(O,"AID",m.K),_a(m,O),m.u&&m.o&&ya(O,m.u,m.o),C=new $r(m,m.j,C,m.D+1),m.u===null&&(C.J=m.o),E&&(m.i=E.G.concat(m.i)),E=Xf(m,C,1e3),C.H=Math.round(m.va*.5)+Math.round(m.va*.5*Math.random()),pu(m.h,C),gi(C,O,E)}function _a(m,E){m.H&&ke(m.H,function(C,O){nt(E,O,C)}),m.l&&ke({},function(C,O){nt(E,O,C)})}function Xf(m,E,C){C=Math.min(m.i.length,C);const O=m.l?d(m.l.Ka,m.l,m):null;e:{var K=m.i;let De=-1;for(;;){const Dt=["count="+C];De==-1?C>0?(De=K[0].g,Dt.push("ofs="+De)):De=0:Dt.push("ofs="+De);let et=!0;for(let _t=0;_t<C;_t++){var Z=K[_t].g;const Cr=K[_t].map;if(Z-=De,Z<0)De=Math.max(0,K[_t].g-100),et=!1;else try{Z="req"+Z+"_"||"";try{var he=Cr instanceof Map?Cr:Object.entries(Cr);for(const[Ri,Yr]of he){let Jr=Yr;u(Yr)&&(Jr=Ls(Yr)),Dt.push(Z+Ri+"="+encodeURIComponent(Jr))}}catch(Ri){throw Dt.push(Z+"type="+encodeURIComponent("_badmap")),Ri}}catch{O&&O(Cr)}}if(et){he=Dt.join("&");break e}}he=void 0}return m=m.i.splice(0,C),E.G=m,he}function Zf(m){if(!m.g&&!m.v){m.Y=1;var E=m.Da;$||N(),G||($(),G=!0),I.add(E,m),m.A=0}}function Ea(m){return m.g||m.v||m.A>=3?!1:(m.Y++,m.v=pi(d(m.Da,m),nd(m,m.A)),m.A++,!0)}n.Da=function(){if(this.v=null,ed(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var m=4*this.T;this.j.info("BP detection timer enabled: "+m),this.B=pi(d(this.Wa,this),m)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,zt(10),Hs(this),ed(this))};function Cu(m){m.B!=null&&(l.clearTimeout(m.B),m.B=null)}function ed(m){m.g=new $r(m,m.j,"rpc",m.Y),m.u===null&&(m.g.J=m.o),m.g.P=0;var E=qt(m.na);nt(E,"RID","rpc"),nt(E,"SID",m.M),nt(E,"AID",m.K),nt(E,"CI",m.F?"0":"1"),!m.F&&m.ia&&nt(E,"TO",m.ia),nt(E,"TYPE","xmlhttp"),_a(m,E),m.u&&m.o&&ya(E,m.u,m.o),m.O&&(m.g.H=m.O);var C=m.g;m=m.ba,C.M=1,C.A=pa(qt(E)),C.u=null,C.R=!0,Sl(C,m)}n.Va=function(){this.C!=null&&(this.C=null,Hs(this),Ea(this),zt(19))};function Ml(m){m.C!=null&&(l.clearTimeout(m.C),m.C=null)}function td(m,E){var C=null;if(m.g==E){Ml(m),Cu(m),m.g=null;var O=2}else if(Ei(m.h,E))C=E.G,mu(m.h,E),O=1;else return;if(m.I!=0){if(E.o)if(O==1){C=E.u?E.u.length:0,E=Date.now()-E.F;var K=m.D;O=Tl(),nn(O,new di(O,C)),Ci(m)}else Zf(m);else if(K=E.m,K==3||K==0&&E.X>0||!(O==1&&Nl(m,E)||O==2&&Ea(m)))switch(C&&C.length>0&&(E=m.h,E.i=E.i.concat(C)),K){case 1:xi(m,5);break;case 4:xi(m,10);break;case 3:xi(m,6);break;default:xi(m,2)}}}function nd(m,E){let C=m.Qa+Math.floor(Math.random()*m.Za);return m.isActive()||(C*=2),C*E}function xi(m,E){if(m.j.info("Error code "+E),E==2){var C=d(m.bb,m),O=m.Ua;const K=!O;O=new or(O||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ln(O,"https"),pa(O),K?Kr(O.toString(),C):Eu(O.toString(),C)}else zt(2);m.I=0,m.l&&m.l.pa(E),rd(m),Il(m)}n.bb=function(m){m?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function rd(m){if(m.I=0,m.ja=[],m.l){const E=gu(m.h);(E.length!=0||m.i.length!=0)&&(T(m.ja,E),T(m.ja,m.i),m.h.i.length=0,_(m.i),m.i.length=0),m.l.oa()}}function id(m,E,C){var O=C instanceof or?qt(C):new or(C);if(O.g!="")E&&(O.g=E+"."+O.g),Ps(O,O.u);else{var K=l.location;O=K.protocol,E=E?E+"."+K.hostname:K.hostname,K=+K.port;const Z=new or(null);O&&ln(Z,O),E&&(Z.g=E),K&&Ps(Z,K),C&&(Z.h=C),O=Z}return C=m.G,E=m.wa,C&&E&&nt(O,C,E),nt(O,"VER",m.ka),_a(m,O),O}function sd(m,E,C){if(E&&!m.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=m.Aa&&!m.ma?new ot(new Si({ab:C})):new ot(m.ma),E.Fa(m.L),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function od(){}n=od.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function qs(){}qs.prototype.g=function(m,E){return new Bn(m,E)};function Bn(m,E){Bt.call(this),this.g=new Fs(E),this.l=m,this.h=E&&E.messageUrlParams||null,m=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(m?m["X-WebChannel-Content-Type"]=E.messageContentType:m={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(m?m["X-WebChannel-Client-Profile"]=E.sa:m={"X-WebChannel-Client-Profile":E.sa}),this.g.U=m,(m=E&&E.Qb)&&!D(m)&&(this.g.u=m),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!D(E)&&(this.g.G=E,m=this.h,m!==null&&E in m&&(m=this.h,E in m&&delete m[E])),this.j=new es(this)}g(Bn,Bt),Bn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Bn.prototype.close=function(){wu(this.g)},Bn.prototype.o=function(m){var E=this.g;if(typeof m=="string"){var C={};C.__data__=m,m=C}else this.v&&(C={},C.__data__=Ls(m),m=C);E.i.push(new Ht(E.Ya++,m)),E.I==3&&Ci(E)},Bn.prototype.N=function(){this.g.l=null,delete this.j,wu(this.g),delete this.g,Bn.Z.N.call(this)};function ad(m){yn.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var E=m.__sm__;if(E){e:{for(const C in E){m=C;break e}m=void 0}(this.i=m)&&(m=this.i,E=E!==null&&m in E?E[m]:void 0),this.data=E}else this.data=m}g(ad,yn);function ld(){Tr.call(this),this.status=1}g(ld,Tr);function es(m){this.g=m}g(es,od),es.prototype.ra=function(){nn(this.g,"a")},es.prototype.qa=function(m){nn(this.g,new ad(m))},es.prototype.pa=function(m){nn(this.g,new ld)},es.prototype.oa=function(){nn(this.g,"b")},qs.prototype.createWebChannel=qs.prototype.g,Bn.prototype.send=Bn.prototype.o,Bn.prototype.open=Bn.prototype.m,Bn.prototype.close=Bn.prototype.close,$R=function(){return new qs},qR=function(){return Tl()},HR=Ot,o0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},fa.NO_ERROR=0,fa.TIMEOUT=8,fa.HTTP_ERROR=6,Vp=fa,uu.COMPLETE="complete",FR=uu,Bf.EventType=Hr,Hr.OPEN="a",Hr.CLOSE="b",Hr.ERROR="c",Hr.MESSAGE="d",Bt.prototype.listen=Bt.prototype.J,bh=Bf,ot.prototype.listenOnce=ot.prototype.K,ot.prototype.getLastError=ot.prototype.Ha,ot.prototype.getLastErrorCode=ot.prototype.ya,ot.prototype.getStatus=ot.prototype.ca,ot.prototype.getResponseJson=ot.prototype.La,ot.prototype.getResponseText=ot.prototype.la,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Fa,zR=ot}).apply(typeof dp<"u"?dp:typeof self<"u"?self:typeof window<"u"?window:{});class Ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ln.UNAUTHENTICATED=new Ln(null),Ln.GOOGLE_CREDENTIALS=new Ln("google-credentials-uid"),Ln.FIRST_PARTY=new Ln("first-party-uid"),Ln.MOCK_USER=new Ln("mock-user");let Yc="12.8.0";function u3(n){Yc=n}const el=new d_("@firebase/firestore");function hc(){return el.logLevel}function ge(n,...e){if(el.logLevel<=$e.DEBUG){const t=e.map(g_);el.debug(`Firestore (${Yc}): ${n}`,...t)}}function Is(n,...e){if(el.logLevel<=$e.ERROR){const t=e.map(g_);el.error(`Firestore (${Yc}): ${n}`,...t)}}function kc(n,...e){if(el.logLevel<=$e.WARN){const t=e.map(g_);el.warn(`Firestore (${Yc}): ${n}`,...t)}}function g_(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function Ae(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,GR(n,r,t)}function GR(n,e,t){let r=`FIRESTORE (${Yc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Is(r),new Error(r)}function Je(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||GR(e,i,r)}function Me(n,e){return n}const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class de extends Qi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Do{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class KR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class h3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ln.UNAUTHENTICATED)))}shutdown(){}}class f3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class d3{constructor(e){this.t=e,this.currentUser=Ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Je(this.o===void 0,42304);let r=this.i;const i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let o=new Do;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Do,e.enqueueRetryable((()=>i(this.currentUser)))};const l=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await i(this.currentUser)}))},u=h=>{ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Do)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Je(typeof r.accessToken=="string",31837,{l:r}),new KR(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Je(e===null||typeof e=="string",2055,{h:e}),new Ln(e)}}class p3{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ln.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class m3{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new p3(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ln.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Z1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class g3{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,jr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Je(this.o===void 0,3512);const r=o=>{o.error!=null&&ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,ge("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const i=o=>{ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>i(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Z1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Je(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Z1(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function y3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class y_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=y3(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}}function Ge(n,e){return n<e?-1:n>e?1:0}function a0(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const i=n.charAt(r),o=e.charAt(r);if(i!==o)return fb(i)===fb(o)?Ge(i,o):fb(i)?1:-1}return Ge(n.length,e.length)}const v3=55296,b3=57343;function fb(n){const e=n.charCodeAt(0);return e>=v3&&e<=b3}function Ic(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}const eA="__name__";class ji{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ae(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ae(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return ji.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ji?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const o=ji.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return Ge(e.length,t.length)}static compareSegments(e,t){const r=ji.isNumericId(e),i=ji.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?ji.extractNumericId(e).compare(ji.extractNumericId(t)):a0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Oo.fromString(e.substring(4,e.length-2))}}class ut extends ji{construct(e,t,r){return new ut(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new de(ie.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new ut(t)}static emptyPath(){return new ut([])}}const _3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends ji{construct(e,t,r){return new xn(e,t,r)}static isValidIdentifier(e){return _3.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===eA}static keyField(){return new xn([eA])}static fromServerFormat(e){const t=[];let r="",i=0;const o=()=>{if(r.length===0)throw new de(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new de(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new de(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else u==="`"?(l=!l,i++):u!=="."||l?(r+=u,i++):(o(),i++)}if(o(),l)throw new de(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xn(t)}static emptyPath(){return new xn([])}}class Te{constructor(e){this.path=e}static fromPath(e){return new Te(ut.fromString(e))}static fromName(e){return new Te(ut.fromString(e).popFirst(5))}static empty(){return new Te(ut.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ut.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ut.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Te(new ut(e.slice()))}}function WR(n,e,t){if(!t)throw new de(ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function E3(n,e,t,r){if(e===!0&&r===!0)throw new de(ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function tA(n){if(!Te.isDocumentKey(n))throw new de(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function nA(n){if(Te.isDocumentKey(n))throw new de(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function QR(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function gg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ae(12329,{type:typeof n})}function Lo(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new de(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=gg(n);throw new de(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Jt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Tf(n,e){if(!QR(n))throw new de(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(i&&typeof l!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&l!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new de(ie.INVALID_ARGUMENT,t);return!0}const rA=-62135596800,iA=1e6;class pt{static now(){return pt.fromMillis(Date.now())}static fromDate(e){return pt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*iA);return new pt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<rA)throw new de(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/iA}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:pt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Tf(e,pt._jsonSchema))return new pt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-rA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}pt._jsonSchemaVersion="firestore/timestamp/1.0",pt._jsonSchema={type:Jt("string",pt._jsonSchemaVersion),seconds:Jt("number"),nanoseconds:Jt("number")};class xe{static fromTimestamp(e){return new xe(e)}static min(){return new xe(new pt(0,0))}static max(){return new xe(new pt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Wh=-1;function T3(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=xe.fromTimestamp(r===1e9?new pt(t+1,0):new pt(t,r));return new $o(i,Te.empty(),e)}function S3(n){return new $o(n.readTime,n.key,Wh)}class $o{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new $o(xe.min(),Te.empty(),Wh)}static max(){return new $o(xe.max(),Te.empty(),Wh)}}function w3(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Te.comparator(n.documentKey,e.documentKey),t!==0?t:Ge(n.largestBatchId,e.largestBatchId))}const A3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class C3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Jc(n){if(n.code!==ie.FAILED_PRECONDITION||n.message!==A3)throw n;ge("LocalStore","Unexpectedly lost primary lease")}class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,r)=>{t(e)}))}static reject(e){return new ae(((t,r)=>{r(e)}))}static waitFor(e){return new ae(((t,r)=>{let i=0,o=0,l=!1;e.forEach((u=>{++i,u.next((()=>{++o,l&&o===i&&t()}),(h=>r(h)))})),l=!0,o===i&&t()}))}static or(e){let t=ae.resolve(!1);for(const r of e)t=t.next((i=>i?ae.resolve(i):r()));return t}static forEach(e,t){const r=[];return e.forEach(((i,o)=>{r.push(t.call(this,i,o))})),this.waitFor(r)}static mapArray(e,t){return new ae(((r,i)=>{const o=e.length,l=new Array(o);let u=0;for(let h=0;h<o;h++){const d=h;t(e[d]).next((p=>{l[d]=p,++u,u===o&&r(l)}),(p=>i(p)))}}))}static doWhile(e,t){return new ae(((r,i)=>{const o=()=>{e()===!0?t().next((()=>{o()}),i):r()};o()}))}}function x3(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Xc(n){return n.name==="IndexedDbTransactionError"}class yg{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}yg.ce=-1;const v_=-1;function Sf(n){return n==null}function rm(n){return n===0&&1/n==-1/0}function R3(n){return typeof n=="number"&&Number.isInteger(n)&&!rm(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const YR="";function k3(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=sA(e)),e=I3(n.get(t),e);return sA(e)}function I3(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const o=n.charAt(i);switch(o){case"\0":t+="";break;case YR:t+="";break;default:t+=o}}return t}function sA(n){return n+YR+""}function oA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ta(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function JR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class wt{constructor(e,t){this.comparator=e,this.root=t||wn.EMPTY}insert(e,t){return new wt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,wn.BLACK,null,null))}remove(e){return new wt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pp(this.root,e,this.comparator,!1)}getReverseIterator(){return new pp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pp(this.root,e,this.comparator,!0)}}class pp{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wn{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??wn.RED,this.left=i??wn.EMPTY,this.right=o??wn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new wn(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return wn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return wn.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ae(27949);return e+(this.isRed()?0:1)}}wn.EMPTY=null,wn.RED=!0,wn.BLACK=!1;wn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae(57766)}get value(){throw Ae(16141)}get color(){throw Ae(16727)}get left(){throw Ae(29726)}get right(){throw Ae(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new wn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class sn{constructor(e){this.comparator=e,this.data=new wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new aA(this.data.getIterator())}getIteratorFrom(e){return new aA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof sn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new sn(this.comparator);return t.data=e,t}}class aA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class gr{constructor(e){this.fields=e,e.sort(xn.comparator)}static empty(){return new gr([])}unionWith(e){let t=new sn(xn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new gr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ic(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class XR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Nn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new XR("Invalid base64 string: "+o):o}})(e);return new Nn(t)}static fromUint8Array(e){const t=(function(i){let o="";for(let l=0;l<i.length;++l)o+=String.fromCharCode(i[l]);return o})(e);return new Nn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Nn.EMPTY_BYTE_STRING=new Nn("");const N3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Go(n){if(Je(!!n,39018),typeof n=="string"){let e=0;const t=N3.exec(n);if(Je(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ko(n){return typeof n=="string"?Nn.fromBase64String(n):Nn.fromUint8Array(n)}const ZR="server_timestamp",ek="__type__",tk="__previous_value__",nk="__local_write_time__";function b_(n){return(n?.mapValue?.fields||{})[ek]?.stringValue===ZR}function vg(n){const e=n.mapValue.fields[tk];return b_(e)?vg(e):e}function Qh(n){const e=Go(n.mapValue.fields[nk].timestampValue);return new pt(e.seconds,e.nanos)}class M3{constructor(e,t,r,i,o,l,u,h,d,p,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p,this.apiKey=g}}const im="(default)";class Yh{constructor(e,t){this.projectId=e,this.database=t||im}static empty(){return new Yh("","")}get isDefaultDatabase(){return this.database===im}isEqual(e){return e instanceof Yh&&e.projectId===this.projectId&&e.database===this.database}}function O3(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new de(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yh(n.options.projectId,e)}const rk="__type__",D3="__max__",mp={mapValue:{}},ik="__vector__",sm="value";function Wo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?b_(n)?4:P3(n)?9007199254740991:L3(n)?10:11:Ae(28295,{value:n})}function $i(n,e){if(n===e)return!0;const t=Wo(n);if(t!==Wo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Qh(n).isEqual(Qh(e));case 3:return(function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const l=Go(i.timestampValue),u=Go(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,o){return Ko(i.bytesValue).isEqual(Ko(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,o){return Vt(i.geoPointValue.latitude)===Vt(o.geoPointValue.latitude)&&Vt(i.geoPointValue.longitude)===Vt(o.geoPointValue.longitude)})(n,e);case 2:return(function(i,o){if("integerValue"in i&&"integerValue"in o)return Vt(i.integerValue)===Vt(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const l=Vt(i.doubleValue),u=Vt(o.doubleValue);return l===u?rm(l)===rm(u):isNaN(l)&&isNaN(u)}return!1})(n,e);case 9:return Ic(n.arrayValue.values||[],e.arrayValue.values||[],$i);case 10:case 11:return(function(i,o){const l=i.mapValue.fields||{},u=o.mapValue.fields||{};if(oA(l)!==oA(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!$i(l[h],u[h])))return!1;return!0})(n,e);default:return Ae(52216,{left:n})}}function Jh(n,e){return(n.values||[]).find((t=>$i(t,e)))!==void 0}function Nc(n,e){if(n===e)return 0;const t=Wo(n),r=Wo(e);if(t!==r)return Ge(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ge(n.booleanValue,e.booleanValue);case 2:return(function(o,l){const u=Vt(o.integerValue||o.doubleValue),h=Vt(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(n,e);case 3:return lA(n.timestampValue,e.timestampValue);case 4:return lA(Qh(n),Qh(e));case 5:return a0(n.stringValue,e.stringValue);case 6:return(function(o,l){const u=Ko(o),h=Ko(l);return u.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,l){const u=o.split("/"),h=l.split("/");for(let d=0;d<u.length&&d<h.length;d++){const p=Ge(u[d],h[d]);if(p!==0)return p}return Ge(u.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,l){const u=Ge(Vt(o.latitude),Vt(l.latitude));return u!==0?u:Ge(Vt(o.longitude),Vt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return cA(n.arrayValue,e.arrayValue);case 10:return(function(o,l){const u=o.fields||{},h=l.fields||{},d=u[sm]?.arrayValue,p=h[sm]?.arrayValue,g=Ge(d?.values?.length||0,p?.values?.length||0);return g!==0?g:cA(d,p)})(n.mapValue,e.mapValue);case 11:return(function(o,l){if(o===mp.mapValue&&l===mp.mapValue)return 0;if(o===mp.mapValue)return 1;if(l===mp.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),d=l.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let g=0;g<h.length&&g<p.length;++g){const b=a0(h[g],p[g]);if(b!==0)return b;const _=Nc(u[h[g]],d[p[g]]);if(_!==0)return _}return Ge(h.length,p.length)})(n.mapValue,e.mapValue);default:throw Ae(23264,{he:t})}}function lA(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ge(n,e);const t=Go(n),r=Go(e),i=Ge(t.seconds,r.seconds);return i!==0?i:Ge(t.nanos,r.nanos)}function cA(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const o=Nc(t[i],r[i]);if(o)return o}return Ge(t.length,r.length)}function Mc(n){return l0(n)}function l0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Go(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ko(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Te.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(const o of t.values||[])i?i=!1:r+=",",r+=l0(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const l of r)o?o=!1:i+=",",i+=`${l}:${l0(t.fields[l])}`;return i+"}"})(n.mapValue):Ae(61005,{value:n})}function jp(n){switch(Wo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=vg(n);return e?16+jp(e):16;case 5:return 2*n.stringValue.length;case 6:return Ko(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,o)=>i+jp(o)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return ta(r.fields,((o,l)=>{i+=o.length+jp(l)})),i})(n.mapValue);default:throw Ae(13486,{value:n})}}function uA(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function c0(n){return!!n&&"integerValue"in n}function __(n){return!!n&&"arrayValue"in n}function hA(n){return!!n&&"nullValue"in n}function fA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Up(n){return!!n&&"mapValue"in n}function L3(n){return(n?.mapValue?.fields||{})[rk]?.stringValue===ik}function kh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ta(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=kh(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=kh(n.arrayValue.values[t]);return e}return{...n}}function P3(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===D3}class Hn{constructor(e){this.value=e}static empty(){return new Hn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Up(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=kh(t)}setAll(e){let t=xn.emptyPath(),r={},i=[];e.forEach(((l,u)=>{if(!t.isImmediateParentOf(u)){const h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=u.popLast()}l?r[u.lastSegment()]=kh(l):i.push(u.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){const t=this.field(e.popLast());Up(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return $i(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Up(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ta(t,((i,o)=>e[i]=o));for(const i of r)delete e[i]}clone(){return new Hn(kh(this.value))}}function sk(n){const e=[];return ta(n.fields,((t,r)=>{const i=new xn([t]);if(Up(r)){const o=sk(r.mapValue).fields;if(o.length===0)e.push(i);else for(const l of o)e.push(i.child(l))}else e.push(i)})),new gr(e)}class hn{constructor(e,t,r,i,o,l,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new hn(e,0,xe.min(),xe.min(),xe.min(),Hn.empty(),0)}static newFoundDocument(e,t,r,i){return new hn(e,1,t,xe.min(),r,i,0)}static newNoDocument(e,t){return new hn(e,2,t,xe.min(),xe.min(),Hn.empty(),0)}static newUnknownDocument(e,t){return new hn(e,3,t,xe.min(),xe.min(),Hn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Hn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Hn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof hn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class om{constructor(e,t){this.position=e,this.inclusive=t}}function dA(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const o=e[i],l=n.position[i];if(o.field.isKeyField()?r=Te.comparator(Te.fromName(l.referenceValue),t.key):r=Nc(l,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function pA(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!$i(n.position[t],e.position[t]))return!1;return!0}class Xh{constructor(e,t="asc"){this.field=e,this.dir=t}}function V3(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class ok{}class Yt extends ok{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new U3(e,t,r):t==="array-contains"?new F3(e,r):t==="in"?new H3(e,r):t==="not-in"?new q3(e,r):t==="array-contains-any"?new $3(e,r):new Yt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new B3(e,r):new z3(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Nc(t,this.value)):t!==null&&Wo(this.value)===Wo(t)&&this.matchesComparison(Nc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ai extends ok{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ai(e,t)}matches(e){return ak(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ak(n){return n.op==="and"}function lk(n){return j3(n)&&ak(n)}function j3(n){for(const e of n.filters)if(e instanceof ai)return!1;return!0}function u0(n){if(n instanceof Yt)return n.field.canonicalString()+n.op.toString()+Mc(n.value);if(lk(n))return n.filters.map((e=>u0(e))).join(",");{const e=n.filters.map((t=>u0(t))).join(",");return`${n.op}(${e})`}}function ck(n,e){return n instanceof Yt?(function(r,i){return i instanceof Yt&&r.op===i.op&&r.field.isEqual(i.field)&&$i(r.value,i.value)})(n,e):n instanceof ai?(function(r,i){return i instanceof ai&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((o,l,u)=>o&&ck(l,i.filters[u])),!0):!1})(n,e):void Ae(19439)}function uk(n){return n instanceof Yt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Mc(t.value)}`})(n):n instanceof ai?(function(t){return t.op.toString()+" {"+t.getFilters().map(uk).join(" ,")+"}"})(n):"Filter"}class U3 extends Yt{constructor(e,t,r){super(e,t,r),this.key=Te.fromName(r.referenceValue)}matches(e){const t=Te.comparator(e.key,this.key);return this.matchesComparison(t)}}class B3 extends Yt{constructor(e,t){super(e,"in",t),this.keys=hk("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class z3 extends Yt{constructor(e,t){super(e,"not-in",t),this.keys=hk("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function hk(n,e){return(e.arrayValue?.values||[]).map((t=>Te.fromName(t.referenceValue)))}class F3 extends Yt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return __(t)&&Jh(t.arrayValue,this.value)}}class H3 extends Yt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Jh(this.value.arrayValue,t)}}class q3 extends Yt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Jh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Jh(this.value.arrayValue,t)}}class $3 extends Yt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!__(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Jh(this.value.arrayValue,r)))}}class G3{constructor(e,t=null,r=[],i=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=l,this.endAt=u,this.Te=null}}function mA(n,e=null,t=[],r=[],i=null,o=null,l=null){return new G3(n,e,t,r,i,o,l)}function E_(n){const e=Me(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>u0(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),Sf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Mc(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Mc(r))).join(",")),e.Te=t}return e.Te}function T_(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!V3(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ck(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!pA(n.startAt,e.startAt)&&pA(n.endAt,e.endAt)}function h0(n){return Te.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Zc{constructor(e,t=null,r=[],i=[],o=null,l="F",u=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function K3(n,e,t,r,i,o,l,u){return new Zc(n,e,t,r,i,o,l,u)}function S_(n){return new Zc(n)}function gA(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function W3(n){return Te.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function fk(n){return n.collectionGroup!==null}function Ih(n){const e=Me(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new sn(xn.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Xh(o,r))})),t.has(xn.keyField().canonicalString())||e.Ie.push(new Xh(xn.keyField(),r))}return e.Ie}function zi(n){const e=Me(n);return e.Ee||(e.Ee=Q3(e,Ih(n))),e.Ee}function Q3(n,e){if(n.limitType==="F")return mA(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{const o=i.dir==="desc"?"asc":"desc";return new Xh(i.field,o)}));const t=n.endAt?new om(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new om(n.startAt.position,n.startAt.inclusive):null;return mA(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function f0(n,e){const t=n.filters.concat([e]);return new Zc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Y3(n,e){const t=n.explicitOrderBy.concat([e]);return new Zc(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}function d0(n,e,t){return new Zc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function bg(n,e){return T_(zi(n),zi(e))&&n.limitType===e.limitType}function dk(n){return`${E_(zi(n))}|lt:${n.limitType}`}function fc(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>uk(i))).join(", ")}]`),Sf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>Mc(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>Mc(i))).join(",")),`Target(${r})`})(zi(n))}; limitType=${n.limitType})`}function _g(n,e){return e.isFoundDocument()&&(function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):Te.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,i){for(const o of Ih(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(l,u,h){const d=dA(l,u,h);return l.inclusive?d<=0:d<0})(r.startAt,Ih(r),i)||r.endAt&&!(function(l,u,h){const d=dA(l,u,h);return l.inclusive?d>=0:d>0})(r.endAt,Ih(r),i))})(n,e)}function J3(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pk(n){return(e,t)=>{let r=!1;for(const i of Ih(n)){const o=X3(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function X3(n,e,t){const r=n.field.isKeyField()?Te.comparator(e.key,t.key):(function(o,l,u){const h=l.data.field(o),d=u.data.field(o);return h!==null&&d!==null?Nc(h,d):Ae(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ae(19790,{direction:n.dir})}}class fl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ta(this.inner,((t,r)=>{for(const[i,o]of r)e(i,o)}))}isEmpty(){return JR(this.inner)}size(){return this.innerSize}}const Z3=new wt(Te.comparator);function Ns(){return Z3}const mk=new wt(Te.comparator);function _h(...n){let e=mk;for(const t of n)e=e.insert(t.key,t);return e}function gk(n){let e=mk;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function za(){return Nh()}function yk(){return Nh()}function Nh(){return new fl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const e4=new wt(Te.comparator),t4=new sn(Te.comparator);function Ke(...n){let e=t4;for(const t of n)e=e.add(t);return e}const n4=new sn(Ge);function r4(){return n4}function w_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rm(e)?"-0":e}}function vk(n){return{integerValue:""+n}}function i4(n,e){return R3(e)?vk(e):w_(n,e)}class Eg{constructor(){this._=void 0}}function s4(n,e,t){return n instanceof Zh?(function(i,o){const l={fields:{[ek]:{stringValue:ZR},[nk]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&b_(o)&&(o=vg(o)),o&&(l.fields[tk]=o),{mapValue:l}})(t,e):n instanceof Oc?_k(n,e):n instanceof ef?Ek(n,e):(function(i,o){const l=bk(i,o),u=yA(l)+yA(i.Ae);return c0(l)&&c0(i.Ae)?vk(u):w_(i.serializer,u)})(n,e)}function o4(n,e,t){return n instanceof Oc?_k(n,e):n instanceof ef?Ek(n,e):t}function bk(n,e){return n instanceof am?(function(r){return c0(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class Zh extends Eg{}class Oc extends Eg{constructor(e){super(),this.elements=e}}function _k(n,e){const t=Tk(e);for(const r of n.elements)t.some((i=>$i(i,r)))||t.push(r);return{arrayValue:{values:t}}}class ef extends Eg{constructor(e){super(),this.elements=e}}function Ek(n,e){let t=Tk(e);for(const r of n.elements)t=t.filter((i=>!$i(i,r)));return{arrayValue:{values:t}}}class am extends Eg{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function yA(n){return Vt(n.integerValue||n.doubleValue)}function Tk(n){return __(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Sk{constructor(e,t){this.field=e,this.transform=t}}function a4(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Oc&&i instanceof Oc||r instanceof ef&&i instanceof ef?Ic(r.elements,i.elements,$i):r instanceof am&&i instanceof am?$i(r.Ae,i.Ae):r instanceof Zh&&i instanceof Zh})(n.transform,e.transform)}class l4{constructor(e,t){this.version=e,this.transformResults=t}}class qn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new qn}static exists(e){return new qn(void 0,e)}static updateTime(e){return new qn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Tg{}function wk(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new A_(n.key,qn.none()):new wf(n.key,n.data,qn.none());{const t=n.data,r=Hn.empty();let i=new sn(xn.comparator);for(let o of e.fields)if(!i.has(o)){let l=t.field(o);l===null&&o.length>1&&(o=o.popLast(),l=t.field(o)),l===null?r.delete(o):r.set(o,l),i=i.add(o)}return new na(n.key,r,new gr(i.toArray()),qn.none())}}function c4(n,e,t){n instanceof wf?(function(i,o,l){const u=i.value.clone(),h=bA(i.fieldTransforms,o,l.transformResults);u.setAll(h),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(n,e,t):n instanceof na?(function(i,o,l){if(!Bp(i.precondition,o))return void o.convertToUnknownDocument(l.version);const u=bA(i.fieldTransforms,o,l.transformResults),h=o.data;h.setAll(Ak(i)),h.setAll(u),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(n,e,t):(function(i,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Mh(n,e,t,r){return n instanceof wf?(function(o,l,u,h){if(!Bp(o.precondition,l))return u;const d=o.value.clone(),p=_A(o.fieldTransforms,h,l);return d.setAll(p),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof na?(function(o,l,u,h){if(!Bp(o.precondition,l))return u;const d=_A(o.fieldTransforms,h,l),p=l.data;return p.setAll(Ak(o)),p.setAll(d),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((g=>g.field)))})(n,e,t,r):(function(o,l,u){return Bp(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(n,e,t)}function u4(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),o=bk(r.transform,i||null);o!=null&&(t===null&&(t=Hn.empty()),t.set(r.field,o))}return t||null}function vA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ic(r,i,((o,l)=>a4(o,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class wf extends Tg{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class na extends Tg{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Ak(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function bA(n,e,t){const r=new Map;Je(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let i=0;i<t.length;i++){const o=n[i],l=o.transform,u=e.data.field(o.field);r.set(o.field,o4(l,u,t[i]))}return r}function _A(n,e,t){const r=new Map;for(const i of n){const o=i.transform,l=t.data.field(i.field);r.set(i.field,s4(o,l,e))}return r}class A_ extends Tg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ck extends Tg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class h4{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&c4(o,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Mh(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Mh(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=yk();return this.mutations.forEach((i=>{const o=e.get(i.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=t.has(i.key)?null:u;const h=wk(l,u);h!==null&&r.set(i.key,h),l.isValidDocument()||l.convertToNoDocument(xe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ke())}isEqual(e){return this.batchId===e.batchId&&Ic(this.mutations,e.mutations,((t,r)=>vA(t,r)))&&Ic(this.baseMutations,e.baseMutations,((t,r)=>vA(t,r)))}}class C_{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Je(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return e4})();const o=e.mutations;for(let l=0;l<o.length;l++)i=i.insert(o[l].key,r[l].version);return new C_(e,t,r,i)}}class f4{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class d4{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qt,Ye;function xk(n){switch(n){case ie.OK:return Ae(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Ae(15467,{code:n})}}function Rk(n){if(n===void 0)return Is("GRPC error has no .code"),ie.UNKNOWN;switch(n){case Qt.OK:return ie.OK;case Qt.CANCELLED:return ie.CANCELLED;case Qt.UNKNOWN:return ie.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return ie.INTERNAL;case Qt.UNAVAILABLE:return ie.UNAVAILABLE;case Qt.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case Qt.NOT_FOUND:return ie.NOT_FOUND;case Qt.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case Qt.ABORTED:return ie.ABORTED;case Qt.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case Qt.DATA_LOSS:return ie.DATA_LOSS;default:return Ae(39323,{code:n})}}(Ye=Qt||(Qt={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";function p4(){return new TextEncoder}const m4=new Oo([4294967295,4294967295],0);function EA(n){const e=p4().encode(n),t=new BR;return t.update(e),new Uint8Array(t.digest())}function TA(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Oo([t,r],0),new Oo([i,o],0)]}class x_{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Eh(`Invalid padding: ${t}`);if(r<0)throw new Eh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Eh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Eh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Oo.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Oo.fromNumber(r)));return i.compare(m4)===1&&(i=new Oo([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=EA(e),[r,i]=TA(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(r,i,o);if(!this.we(l))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new x_(o,i,t);return r.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const t=EA(e),[r,i]=TA(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(r,i,o);this.be(l)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Eh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Sg{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Af.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Sg(xe.min(),i,new wt(Ge),Ns(),Ke())}}class Af{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Af(r,t,Ke(),Ke(),Ke())}}class zp{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=i}}class kk{constructor(e,t){this.targetId=e,this.Ce=t}}class Ik{constructor(e,t,r=Nn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class SA{constructor(){this.ve=0,this.Fe=wA(),this.Me=Nn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ke(),t=Ke(),r=Ke();return this.Fe.forEach(((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Ae(38017,{changeType:o})}})),new Af(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=wA()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Je(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class g4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ns(),this.He=gp(),this.Je=gp(),this.Ze=new wt(Ge)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Ae(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){const o=i.target;if(h0(o))if(r===0){const l=new Te(o.path);this.et(t,l,hn.newNoDocument(l,xe.min()))}else Je(r===1,20013,{expectedCount:r});else{const l=this._t(t);if(l!==r){const u=this.ut(e),h=u?this.ct(u,e,l):1;if(h!==0){this.it(t);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,d)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t;let l,u;try{l=Ko(r).toUint8Array()}catch(h){if(h instanceof XR)return kc("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new x_(l,i,o)}catch(h){return kc(h instanceof Eh?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let i=0;return r.forEach((o=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.et(t,o,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((o,l)=>{const u=this.ot(l);if(u){if(o.current&&h0(u.target)){const h=new Te(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,hn.newNoDocument(h,e))}o.Be&&(t.set(l,o.ke()),o.Ke())}}));let r=Ke();this.Je.forEach(((o,l)=>{let u=!0;l.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(r=r.add(o))})),this.je.forEach(((o,l)=>l.setReadTime(e)));const i=new Sg(e,t,this.Ze,this.je,r);return this.je=Ns(),this.He=gp(),this.Je=gp(),this.Ze=new wt(Ge),i}Ye(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.qe(t,1):i.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new SA,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new sn(Ge),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new sn(Ge),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ge("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new SA),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function gp(){return new wt(Te.comparator)}function wA(){return new wt(Te.comparator)}const y4={asc:"ASCENDING",desc:"DESCENDING"},v4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},b4={and:"AND",or:"OR"};class _4{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function p0(n,e){return n.useProto3Json||Sf(e)?e:{value:e}}function lm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Nk(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function E4(n,e){return lm(n,e.toTimestamp())}function vr(n){return Je(!!n,49232),xe.fromTimestamp((function(t){const r=Go(t);return new pt(r.seconds,r.nanos)})(n))}function R_(n,e){return m0(n,e).canonicalString()}function m0(n,e){const t=(function(i){return new ut(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Mk(n){const e=ut.fromString(n);return Je(jk(e),10190,{key:e.toString()}),e}function cm(n,e){return R_(n.databaseId,e.path)}function Oh(n,e){const t=Mk(e);if(t.get(1)!==n.databaseId.projectId)throw new de(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new de(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Te(Dk(t))}function Ok(n,e){return R_(n.databaseId,e)}function T4(n){const e=Mk(n);return e.length===4?ut.emptyPath():Dk(e)}function g0(n){return new ut(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Dk(n){return Je(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function AA(n,e,t){return{name:cm(n,e),fields:t.value.mapValue.fields}}function S4(n,e){return"found"in e?(function(r,i){Je(!!i.found,43571),i.found.name,i.found.updateTime;const o=Oh(r,i.found.name),l=vr(i.found.updateTime),u=i.found.createTime?vr(i.found.createTime):xe.min(),h=new Hn({mapValue:{fields:i.found.fields}});return hn.newFoundDocument(o,l,u,h)})(n,e):"missing"in e?(function(r,i){Je(!!i.missing,3894),Je(!!i.readTime,22933);const o=Oh(r,i.missing),l=vr(i.readTime);return hn.newNoDocument(o,l)})(n,e):Ae(7234,{result:e})}function w4(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Ae(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=(function(d,p){return d.useProto3Json?(Je(p===void 0||typeof p=="string",58123),Nn.fromBase64String(p||"")):(Je(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Nn.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(d){const p=d.code===void 0?ie.UNKNOWN:Rk(d.code);return new de(p,d.message||"")})(l);t=new Ik(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Oh(n,r.document.name),o=vr(r.document.updateTime),l=r.document.createTime?vr(r.document.createTime):xe.min(),u=new Hn({mapValue:{fields:r.document.fields}}),h=hn.newFoundDocument(i,o,l,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new zp(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Oh(n,r.document),o=r.readTime?vr(r.readTime):xe.min(),l=hn.newNoDocument(i,o),u=r.removedTargetIds||[];t=new zp([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Oh(n,r.document),o=r.removedTargetIds||[];t=new zp([],o,i,null)}else{if(!("filter"in e))return Ae(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,l=new d4(i,o),u=r.targetId;t=new kk(u,l)}}return t}function Lk(n,e){let t;if(e instanceof wf)t={update:AA(n,e.key,e.value)};else if(e instanceof A_)t={delete:cm(n,e.key)};else if(e instanceof na)t={update:AA(n,e.key,e.data),updateMask:O4(e.fieldMask)};else{if(!(e instanceof Ck))return Ae(16599,{dt:e.type});t={verify:cm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(o,l){const u=l.transform;if(u instanceof Zh)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Oc)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof ef)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof am)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw Ae(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,o){return o.updateTime!==void 0?{updateTime:E4(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ae(27497)})(n,e.precondition)),t}function A4(n,e){return n&&n.length>0?(Je(e!==void 0,14353),n.map((t=>(function(i,o){let l=i.updateTime?vr(i.updateTime):vr(o);return l.isEqual(xe.min())&&(l=vr(o)),new l4(l,i.transformResults||[])})(t,e)))):[]}function C4(n,e){return{documents:[Ok(n,e.path)]}}function x4(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Ok(n,i);const o=(function(d){if(d.length!==0)return Vk(ai.create(d,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const l=(function(d){if(d.length!==0)return d.map((p=>(function(b){return{field:dc(b.field),direction:I4(b.dir)}})(p)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const u=p0(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function R4(n){let e=T4(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Je(r===1,65062);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=(function(g){const b=Pk(g);return b instanceof ai&&lk(b)?b.getFilters():[b]})(t.where));let l=[];t.orderBy&&(l=(function(g){return g.map((b=>(function(T){return new Xh(pc(T.field),(function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(b)))})(t.orderBy));let u=null;t.limit&&(u=(function(g){let b;return b=typeof g=="object"?g.value:g,Sf(b)?null:b})(t.limit));let h=null;t.startAt&&(h=(function(g){const b=!!g.before,_=g.values||[];return new om(_,b)})(t.startAt));let d=null;return t.endAt&&(d=(function(g){const b=!g.before,_=g.values||[];return new om(_,b)})(t.endAt)),K3(e,i,l,o,u,"F",h,d)}function k4(n,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Pk(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=pc(t.unaryFilter.field);return Yt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=pc(t.unaryFilter.field);return Yt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=pc(t.unaryFilter.field);return Yt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=pc(t.unaryFilter.field);return Yt.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ae(61313);default:return Ae(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Yt.create(pc(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ae(58110);default:return Ae(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ai.create(t.compositeFilter.filters.map((r=>Pk(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ae(1026)}})(t.compositeFilter.op))})(n):Ae(30097,{filter:n})}function I4(n){return y4[n]}function N4(n){return v4[n]}function M4(n){return b4[n]}function dc(n){return{fieldPath:n.canonicalString()}}function pc(n){return xn.fromServerFormat(n.fieldPath)}function Vk(n){return n instanceof Yt?(function(t){if(t.op==="=="){if(fA(t.value))return{unaryFilter:{field:dc(t.field),op:"IS_NAN"}};if(hA(t.value))return{unaryFilter:{field:dc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(fA(t.value))return{unaryFilter:{field:dc(t.field),op:"IS_NOT_NAN"}};if(hA(t.value))return{unaryFilter:{field:dc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:dc(t.field),op:N4(t.op),value:t.value}}})(n):n instanceof ai?(function(t){const r=t.getFilters().map((i=>Vk(i)));return r.length===1?r[0]:{compositeFilter:{op:M4(t.op),filters:r}}})(n):Ae(54877,{filter:n})}function O4(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function jk(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function Uk(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}class xo{constructor(e,t,r,i,o=xe.min(),l=xe.min(),u=Nn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new xo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new xo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new xo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class D4{constructor(e){this.yt=e}}function L4(n){const e=R4({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?d0(e,e.limit,"L"):e}class P4{constructor(){this.Sn=new V4}addToCollectionParentIndex(e,t){return this.Sn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve($o.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve($o.min())}updateCollectionGroup(e,t,r){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class V4{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new sn(ut.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new sn(ut.comparator)).toArray()}}const CA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Bk=41943040;class nr{static withCacheSize(e){return new nr(e,nr.DEFAULT_COLLECTION_PERCENTILE,nr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}nr.DEFAULT_COLLECTION_PERCENTILE=10,nr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nr.DEFAULT=new nr(Bk,nr.DEFAULT_COLLECTION_PERCENTILE,nr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nr.DISABLED=new nr(-1,0,0);class Dc{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Dc(0)}static ar(){return new Dc(-1)}}const xA="LruGarbageCollector",j4=1048576;function RA([n,e],[t,r]){const i=Ge(n,t);return i===0?Ge(e,r):i}class U4{constructor(e){this.Pr=e,this.buffer=new sn(RA),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();RA(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class B4{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ge(xA,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Xc(t)?ge(xA,"Ignoring IndexedDB error during garbage collection: ",t):await Jc(t)}await this.Ar(3e5)}))}}class z4{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(yg.ce);const r=new U4(t);return this.Vr.forEachTarget(e,(i=>r.Er(i.sequenceNumber))).next((()=>this.Vr.mr(e,(i=>r.Er(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ge("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(CA)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),CA):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,i,o,l,u,h,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((g=>(g>this.params.maximumSequenceNumbersToCollect?(ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,l=Date.now(),this.nthSequenceNumber(e,i)))).next((g=>(r=g,u=Date.now(),this.removeTargets(e,r,t)))).next((g=>(o=g,h=Date.now(),this.removeOrphanedDocuments(e,r)))).next((g=>(d=Date.now(),hc()<=$e.DEBUG&&ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${i} in `+(u-l)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${g} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:g}))))}}function F4(n,e){return new z4(n,e)}class H4{constructor(){this.changes=new fl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,hn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ae.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class q4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class $4{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Mh(r.mutation,i,gr.empty(),pt.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Ke()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Ke()){const i=za();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((o=>{let l=_h();return o.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=za();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Ke())))}populateOverlays(e,t,r){const i=[];return r.forEach((o=>{t.has(o)||i.push(o)})),this.documentOverlayCache.getOverlays(e,i).next((o=>{o.forEach(((l,u)=>{t.set(l,u)}))}))}computeViews(e,t,r,i){let o=Ns();const l=Nh(),u=(function(){return Nh()})();return t.forEach(((h,d)=>{const p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof na)?o=o.insert(d.key,d):p!==void 0?(l.set(d.key,p.mutation.getFieldMask()),Mh(p.mutation,d,p.mutation.getFieldMask(),pt.now())):l.set(d.key,gr.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((d,p)=>l.set(d,p))),t.forEach(((d,p)=>u.set(d,new q4(p,l.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,t){const r=Nh();let i=new wt(((l,u)=>l-u)),o=Ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const u of l)u.keys().forEach((h=>{const d=t.get(h);if(d===null)return;let p=r.get(h)||gr.empty();p=u.applyToLocalView(d,p),r.set(h,p);const g=(i.get(u.batchId)||Ke()).add(h);i=i.insert(u.batchId,g)}))})).next((()=>{const l=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),d=h.key,p=h.value,g=yk();p.forEach((b=>{if(!o.has(b)){const _=wk(t.get(b),r.get(b));_!==null&&g.set(b,_),o=o.add(b)}})),l.push(this.documentOverlayCache.saveOverlays(e,d,g))}return ae.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return W3(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):fk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((o=>{const l=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):ae.resolve(za());let u=Wh,h=o;return l.next((d=>ae.forEach(d,((p,g)=>(u<g.largestBatchId&&(u=g.largestBatchId),o.get(p)?ae.resolve():this.remoteDocumentCache.getEntry(e,p).next((b=>{h=h.insert(p,b)}))))).next((()=>this.populateOverlays(e,d,o))).next((()=>this.computeViews(e,h,d,Ke()))).next((p=>({batchId:u,changes:gk(p)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Te(t)).next((r=>{let i=_h();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const o=t.collectionGroup;let l=_h();return this.indexManager.getCollectionParents(e,o).next((u=>ae.forEach(u,(h=>{const d=(function(g,b){return new Zc(b,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next((p=>{p.forEach(((g,b)=>{l=l.insert(g,b)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i)))).next((l=>{o.forEach(((h,d)=>{const p=d.getKey();l.get(p)===null&&(l=l.insert(p,hn.newInvalidDocument(p)))}));let u=_h();return l.forEach(((h,d)=>{const p=o.get(h);p!==void 0&&Mh(p.mutation,d,gr.empty(),pt.now()),_g(t,d)&&(u=u.insert(h,d))})),u}))}}class G4{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ae.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:vr(i.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(i){return{name:i.name,query:L4(i.bundledQuery),readTime:vr(i.readTime)}})(t)),ae.resolve()}}class K4{constructor(){this.overlays=new wt(Te.comparator),this.Lr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const r=za();return ae.forEach(t,(i=>this.getOverlay(e,i).next((o=>{o!==null&&r.set(i,o)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,o)=>{this.bt(e,t,o)})),ae.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Lr.get(r);return i!==void 0&&(i.forEach((o=>this.overlays=this.overlays.remove(o))),this.Lr.delete(r)),ae.resolve()}getOverlaysForCollection(e,t,r){const i=za(),o=t.length+1,l=new Te(t.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return ae.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new wt(((d,p)=>d-p));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=za(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const u=za(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,p)=>u.set(d,p))),!(u.size()>=i)););return ae.resolve(u)}bt(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const l=this.Lr.get(i.largestBatchId).delete(r.key);this.Lr.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new f4(t,r));let o=this.Lr.get(t);o===void 0&&(o=Ke(),this.Lr.set(t,o)),this.Lr.set(t,o.add(r.key))}}class W4{constructor(){this.sessionToken=Nn.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}class k_{constructor(){this.kr=new sn(un.Kr),this.qr=new sn(un.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const r=new un(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new un(e,t))}Qr(e,t){e.forEach((r=>this.removeReference(r,t)))}Gr(e){const t=new Te(new ut([])),r=new un(t,e),i=new un(t,e+1),o=[];return this.qr.forEachInRange([r,i],(l=>{this.Wr(l),o.push(l.key)})),o}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Te(new ut([])),r=new un(t,e),i=new un(t,e+1);let o=Ke();return this.qr.forEachInRange([r,i],(l=>{o=o.add(l.key)})),o}containsKey(e){const t=new un(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class un{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Te.comparator(e.key,t.key)||Ge(e.Hr,t.Hr)}static Ur(e,t){return Ge(e.Hr,t.Hr)||Te.comparator(e.key,t.key)}}class Q4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new sn(un.Kr)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const o=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new h4(o,t,r,i);this.mutationQueue.push(l);for(const u of i)this.Jr=this.Jr.add(new un(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ae.resolve(l)}lookupMutationBatch(e,t){return ae.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.Xr(r),o=i<0?0:i;return ae.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?v_:this.Yn-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new un(t,0),i=new un(t,Number.POSITIVE_INFINITY),o=[];return this.Jr.forEachInRange([r,i],(l=>{const u=this.Zr(l.Hr);o.push(u)})),ae.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new sn(Ge);return t.forEach((i=>{const o=new un(i,0),l=new un(i,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([o,l],(u=>{r=r.add(u.Hr)}))})),ae.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let o=r;Te.isDocumentKey(o)||(o=o.child(""));const l=new un(new Te(o),0);let u=new sn(Ge);return this.Jr.forEachWhile((h=>{const d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.Hr)),!0)}),l),ae.resolve(this.Yr(u))}Yr(e){const t=[];return e.forEach((r=>{const i=this.Zr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Je(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return ae.forEach(t.mutations,(i=>{const o=new un(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,t){const r=new un(t,0),i=this.Jr.firstAfterOrEqual(r);return ae.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Y4{constructor(e){this.ti=e,this.docs=(function(){return new wt(Te.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),o=i?i.size:0,l=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ae.resolve(r?r.document.mutableCopy():hn.newInvalidDocument(t))}getEntries(e,t){let r=Ns();return t.forEach((i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():hn.newInvalidDocument(i))})),ae.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Ns();const l=t.path,u=new Te(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:d,value:{document:p}}=h.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||w3(S3(p),r)<=0||(i.has(p.key)||_g(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return ae.resolve(o)}getAllFromCollectionGroup(e,t,r,i){Ae(9500)}ni(e,t){return ae.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new J4(this)}getSize(e){return ae.resolve(this.size)}}class J4 extends H4{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Mr.addEntry(e,i)):this.Mr.removeEntry(r)})),ae.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class X4{constructor(e){this.persistence=e,this.ri=new fl((t=>E_(t)),T_),this.lastRemoteSnapshotVersion=xe.min(),this.highestTargetId=0,this.ii=0,this.si=new k_,this.targetCount=0,this.oi=Dc._r()}forEachTarget(e,t){return this.ri.forEach(((r,i)=>t(i))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),ae.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Dc(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.lr(t),ae.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,r){let i=0;const o=[];return this.ri.forEach(((l,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ri.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),ae.waitFor(o).next((()=>i))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const r=this.ri.get(t)||null;return ae.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),ae.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach((l=>{o.push(i.markPotentiallyOrphaned(e,l))})),ae.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const r=this.si.jr(t);return ae.resolve(r)}containsKey(e,t){return ae.resolve(this.si.containsKey(t))}}class zk{constructor(e,t){this._i={},this.overlays={},this.ai=new yg(0),this.ui=!1,this.ui=!0,this.ci=new W4,this.referenceDelegate=e(this),this.li=new X4(this),this.indexManager=new P4,this.remoteDocumentCache=(function(i){return new Y4(i)})((r=>this.referenceDelegate.hi(r))),this.serializer=new D4(t),this.Pi=new G4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new K4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new Q4(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){ge("MemoryPersistence","Starting transaction:",e);const i=new Z4(this.ai.next());return this.referenceDelegate.Ti(),r(i).next((o=>this.referenceDelegate.Ii(i).next((()=>o)))).toPromise().then((o=>(i.raiseOnCommittedEvent(),o)))}Ei(e,t){return ae.or(Object.values(this._i).map((r=>()=>r.containsKey(e,t))))}}class Z4 extends C3{constructor(e){super(),this.currentSequenceNumber=e}}class I_{constructor(e){this.persistence=e,this.Ri=new k_,this.Ai=null}static Vi(e){return new I_(e)}get di(){if(this.Ai)return this.Ai;throw Ae(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),ae.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((i=>this.di.add(i.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((o=>this.di.add(o.toString())))})).next((()=>r.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.di,(r=>{const i=Te.fromPath(r);return this.mi(e,i).next((o=>{o||t.removeEntry(i,xe.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return ae.or([()=>ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class um{constructor(e,t){this.persistence=e,this.fi=new fl((r=>k3(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=F4(this,t)}static Vi(e,t){return new um(e,t)}Ti(){}Ii(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}mr(e,t){return ae.forEach(this.fi,((r,i)=>this.wr(e,r,i).next((o=>o?ae.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ni(e,(l=>this.wr(e,l,t).next((u=>{u||(r++,o.removeEntry(l,xe.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ae.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=jp(e.data.value)),t}wr(e,t,r){return ae.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.fi.get(t);return ae.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class N_{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=i}static Es(e,t){let r=Ke(),i=Ke();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new N_(e,t.fromCache,r,i)}}class ej{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class tj{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return GP()?8:x3(Pn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){const o={result:null};return this.gs(e,t).next((l=>{o.result=l})).next((()=>{if(!o.result)return this.ps(e,t,i,r).next((l=>{o.result=l}))})).next((()=>{if(o.result)return;const l=new ej;return this.ys(e,t,l).next((u=>{if(o.result=u,this.As)return this.ws(e,t,l,u.size)}))})).next((()=>o.result))}ws(e,t,r,i){return r.documentReadCount<this.Vs?(hc()<=$e.DEBUG&&ge("QueryEngine","SDK will not create cache indexes for query:",fc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ae.resolve()):(hc()<=$e.DEBUG&&ge("QueryEngine","Query:",fc(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ds*i?(hc()<=$e.DEBUG&&ge("QueryEngine","The SDK decides to create cache indexes for query:",fc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zi(t))):ae.resolve())}gs(e,t){if(gA(t))return ae.resolve(null);let r=zi(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=d0(t,null,"F"),r=zi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const l=Ke(...o);return this.fs.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,r).next((h=>{const d=this.bs(t,u);return this.Ss(t,d,l,h.readTime)?this.gs(e,d0(t,null,"F")):this.Ds(e,d,t,h)}))))})))))}ps(e,t,r,i){return gA(t)||i.isEqual(xe.min())?ae.resolve(null):this.fs.getDocuments(e,r).next((o=>{const l=this.bs(t,o);return this.Ss(t,l,r,i)?ae.resolve(null):(hc()<=$e.DEBUG&&ge("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fc(t)),this.Ds(e,l,t,T3(i,Wh)).next((u=>u)))}))}bs(e,t){let r=new sn(pk(e));return t.forEach(((i,o)=>{_g(e,o)&&(r=r.add(o))})),r}Ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ys(e,t,r){return hc()<=$e.DEBUG&&ge("QueryEngine","Using full collection scan to execute query:",fc(t)),this.fs.getDocumentsMatchingQuery(e,t,$o.min(),r)}Ds(e,t,r,i){return this.fs.getDocumentsMatchingQuery(e,r,i).next((o=>(t.forEach((l=>{o=o.insert(l.key,l)})),o)))}}const M_="LocalStore",nj=3e8;class rj{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.vs=new wt(Ge),this.Fs=new fl((o=>E_(o)),T_),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new $4(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function ij(n,e,t,r){return new rj(n,e,t,r)}async function Fk(n,e){const t=Me(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((o=>(i=o,t.Os(e),t.mutationQueue.getAllMutationBatches(r)))).next((o=>{const l=[],u=[];let h=Ke();for(const d of i){l.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}for(const d of o){u.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next((d=>({Ns:d,removedBatchIds:l,addedBatchIds:u})))}))}))}function sj(n,e){const t=Me(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const i=e.batch.keys(),o=t.xs.newChangeBuffer({trackRemovals:!0});return(function(u,h,d,p){const g=d.batch,b=g.keys();let _=ae.resolve();return b.forEach((T=>{_=_.next((()=>p.getEntry(h,T))).next((x=>{const A=d.docVersions.get(T);Je(A!==null,48541),x.version.compareTo(A)<0&&(g.applyToRemoteDocument(x,d),x.isValidDocument()&&(x.setReadTime(d.commitVersion),p.addEntry(x)))}))})),_.next((()=>u.mutationQueue.removeMutationBatch(h,g)))})(t,r,e,o).next((()=>o.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(u){let h=Ke();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function Hk(n){const e=Me(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function oj(n,e){const t=Me(n),r=e.snapshotVersion;let i=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const l=t.xs.newChangeBuffer({trackRemovals:!0});i=t.vs;const u=[];e.targetChanges.forEach(((p,g)=>{const b=i.get(g);if(!b)return;u.push(t.li.removeMatchingKeys(o,p.removedDocuments,g).next((()=>t.li.addMatchingKeys(o,p.addedDocuments,g))));let _=b.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(g)!==null?_=_.withResumeToken(Nn.EMPTY_BYTE_STRING,xe.min()).withLastLimboFreeSnapshotVersion(xe.min()):p.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(p.resumeToken,r)),i=i.insert(g,_),(function(x,A,R){return x.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=nj?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0})(b,_,p)&&u.push(t.li.updateTargetData(o,_))}));let h=Ns(),d=Ke();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))})),u.push(aj(o,l,e.documentUpdates).next((p=>{h=p.Bs,d=p.Ls}))),!r.isEqual(xe.min())){const p=t.li.getLastRemoteSnapshotVersion(o).next((g=>t.li.setTargetsMetadata(o,o.currentSequenceNumber,r)));u.push(p)}return ae.waitFor(u).next((()=>l.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,h,d))).next((()=>h))})).then((o=>(t.vs=i,o)))}function aj(n,e,t){let r=Ke(),i=Ke();return t.forEach((o=>r=r.add(o))),e.getEntries(n,r).next((o=>{let l=Ns();return t.forEach(((u,h)=>{const d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(xe.min())?(e.removeEntry(u,h.readTime),l=l.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),l=l.insert(u,h)):ge(M_,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)})),{Bs:l,Ls:i}}))}function lj(n,e){const t=Me(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=v_),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function cj(n,e){const t=Me(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.li.getTargetData(r,e).next((o=>o?(i=o,ae.resolve(i)):t.li.allocateTargetId(r).next((l=>(i=new xo(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,i).next((()=>i)))))))})).then((r=>{const i=t.vs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r}))}async function y0(n,e,t){const r=Me(n),i=r.vs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,(l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Xc(l))throw l;ge(M_,`Failed to update sequence numbers for target ${e}: ${l}`)}r.vs=r.vs.remove(e),r.Fs.delete(i.target)}function kA(n,e,t){const r=Me(n);let i=xe.min(),o=Ke();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,d,p){const g=Me(h),b=g.Fs.get(p);return b!==void 0?ae.resolve(g.vs.get(b)):g.li.getTargetData(d,p)})(r,l,zi(e)).next((u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(l,u.targetId).next((h=>{o=h}))})).next((()=>r.Cs.getDocumentsMatchingQuery(l,e,t?i:xe.min(),t?o:Ke()))).next((u=>(uj(r,J3(e),u),{documents:u,ks:o})))))}function uj(n,e,t){let r=n.Ms.get(e)||xe.min();t.forEach(((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),n.Ms.set(e,r)}class IA{constructor(){this.activeTargetIds=r4()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hj{constructor(){this.vo=new IA,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new IA,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class fj{Mo(e){}shutdown(){}}const NA="ConnectivityMonitor";class MA{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ge(NA,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ge(NA,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let yp=null;function v0(){return yp===null?yp=(function(){return 268435456+Math.round(2147483648*Math.random())})():yp++,"0x"+yp.toString(16)}const db="RestConnection",dj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class pj{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.$o=this.databaseId.database===im?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){const l=v0(),u=this.Qo(e,t.toUriEncodedString());ge(db,`Sending RPC '${e}' ${l}:`,u,r);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(h,i,o);const{host:d}=new URL(u),p=ea(d);return this.zo(e,u,h,r,p).then((g=>(ge(db,`Received RPC '${e}' ${l}: `,g),g)),(g=>{throw kc(db,`RPC '${e}' ${l} failed with error: `,g,"url: ",u,"request:",r),g}))}jo(e,t,r,i,o,l){return this.Wo(e,t,r,i,o)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Yc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,o)=>e[o]=i)),r&&r.headers.forEach(((i,o)=>e[o]=i))}Qo(e,t){const r=dj[e];let i=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}class mj{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const On="WebChannelConnection",fh=(n,e,t)=>{n.listen(e,(r=>{try{t(r)}catch(i){setTimeout((()=>{throw i}),0)}}))};class Ec extends pj{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Ec.c_){const e=qR();fh(e,HR.STAT_EVENT,(t=>{t.stat===o0.PROXY?ge(On,"STAT_EVENT: detected buffering proxy"):t.stat===o0.NOPROXY&&ge(On,"STAT_EVENT: detected no buffering proxy")})),Ec.c_=!0}}zo(e,t,r,i,o){const l=v0();return new Promise(((u,h)=>{const d=new zR;d.setWithCredentials(!0),d.listenOnce(FR.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Vp.NO_ERROR:const g=d.getResponseJson();ge(On,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(g)),u(g);break;case Vp.TIMEOUT:ge(On,`RPC '${e}' ${l} timed out`),h(new de(ie.DEADLINE_EXCEEDED,"Request time out"));break;case Vp.HTTP_ERROR:const b=d.getStatus();if(ge(On,`RPC '${e}' ${l} failed with status:`,b,"response text:",d.getResponseText()),b>0){let _=d.getResponseJson();Array.isArray(_)&&(_=_[0]);const T=_?.error;if(T&&T.status&&T.message){const x=(function(R){const M=R.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(M)>=0?M:ie.UNKNOWN})(T.status);h(new de(x,T.message))}else h(new de(ie.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new de(ie.UNAVAILABLE,"Connection failed."));break;default:Ae(9055,{l_:e,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ge(On,`RPC '${e}' ${l} completed.`)}}));const p=JSON.stringify(i);ge(On,`RPC '${e}' ${l} sending request:`,i),d.send(t,"POST",p,r,15)}))}T_(e,t,r){const i=v0(),o=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=this.createWebChannelTransport(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Go(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;const d=o.join("");ge(On,`Creating RPC '${e}' stream ${i}: ${d}`,u);const p=l.createWebChannel(d,u);this.I_(p);let g=!1,b=!1;const _=new mj({Ho:T=>{b?ge(On,`Not sending because RPC '${e}' stream ${i} is closed:`,T):(g||(ge(On,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),ge(On,`RPC '${e}' stream ${i} sending:`,T),p.send(T))},Jo:()=>p.close()});return fh(p,bh.EventType.OPEN,(()=>{b||(ge(On,`RPC '${e}' stream ${i} transport opened.`),_.i_())})),fh(p,bh.EventType.CLOSE,(()=>{b||(b=!0,ge(On,`RPC '${e}' stream ${i} transport closed`),_.o_(),this.E_(p))})),fh(p,bh.EventType.ERROR,(T=>{b||(b=!0,kc(On,`RPC '${e}' stream ${i} transport errored. Name:`,T.name,"Message:",T.message),_.o_(new de(ie.UNAVAILABLE,"The operation could not be completed")))})),fh(p,bh.EventType.MESSAGE,(T=>{if(!b){const x=T.data[0];Je(!!x,16349);const A=x,R=A?.error||A[0]?.error;if(R){ge(On,`RPC '${e}' stream ${i} received error:`,R);const M=R.status;let j=(function(G){const I=Qt[G];if(I!==void 0)return Rk(I)})(M),Y=R.message;j===void 0&&(j=ie.INTERNAL,Y="Unknown error status: "+M+" with message "+R.message),b=!0,_.o_(new de(j,Y)),p.close()}else ge(On,`RPC '${e}' stream ${i} received:`,x),_.__(x)}})),Ec.u_(),setTimeout((()=>{_.s_()}),0),_}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return $R()}}function gj(n){return new Ec(n)}function pb(){return typeof document<"u"?document:null}function wg(n){return new _4(n,!0)}Ec.c_=!1;class O_{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=i,this.V_=o,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&ge("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const OA="PersistentStream";class qk{constructor(e,t,r,i,o,l,u,h){this.Ci=e,this.b_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new O_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Is(t.toString()),Is("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{const i=new de(ie.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){const r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.H_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ge(OA,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ge(OA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class yj extends qk{constructor(e,t,r,i,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=w4(this.serializer,e),r=(function(o){if(!("targetChange"in o))return xe.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?xe.min():l.readTime?vr(l.readTime):xe.min()})(e);return this.listener.J_(t,r)}Z_(e){const t={};t.database=g0(this.serializer),t.addTarget=(function(o,l){let u;const h=l.target;if(u=h0(h)?{documents:C4(o,h)}:{query:x4(o,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=Nk(o,l.resumeToken);const d=p0(o,l.expectedCount);d!==null&&(u.expectedCount=d)}else if(l.snapshotVersion.compareTo(xe.min())>0){u.readTime=lm(o,l.snapshotVersion.toTimestamp());const d=p0(o,l.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const r=k4(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){const t={};t.database=g0(this.serializer),t.removeTarget=e,this.K_(t)}}class vj extends qk{constructor(e,t,r,i,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.serializer=o}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Je(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Je(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Je(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=A4(e.writeResults,e.commitTime),r=vr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=g0(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Lk(this.serializer,r)))};this.K_(t)}}class bj{}class _j extends bj{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new de(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Wo(e,m0(t,r),i,o,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new de(ie.UNKNOWN,o.toString())}))}jo(e,t,r,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.jo(e,m0(t,r),i,l,u,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new de(ie.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function Ej(n,e,t,r){return new _j(n,e,t,r)}class Tj{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Is(t),this.aa=!1):ge("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const tl="RemoteStore";class Sj{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=o,this.Aa.Mo((l=>{r.enqueueAndForget((async()=>{dl(this)&&(ge(tl,"Restarting streams for network reachability change."),await(async function(h){const d=Me(h);d.Ea.add(4),await Cf(d),d.Va.set("Unknown"),d.Ea.delete(4),await Ag(d)})(this))}))})),this.Va=new Tj(r,i)}}async function Ag(n){if(dl(n))for(const e of n.Ra)await e(!0)}async function Cf(n){for(const e of n.Ra)await e(!1)}function $k(n,e){const t=Me(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),V_(t)?P_(t):eu(t).O_()&&L_(t,e))}function D_(n,e){const t=Me(n),r=eu(t);t.Ia.delete(e),r.O_()&&Gk(t,e),t.Ia.size===0&&(r.O_()?r.L_():dl(t)&&t.Va.set("Unknown"))}function L_(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}eu(n).Z_(e)}function Gk(n,e){n.da.$e(e),eu(n).X_(e)}function P_(n){n.da=new g4({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),eu(n).start(),n.Va.ua()}function V_(n){return dl(n)&&!eu(n).x_()&&n.Ia.size>0}function dl(n){return Me(n).Ea.size===0}function Kk(n){n.da=void 0}async function wj(n){n.Va.set("Online")}async function Aj(n){n.Ia.forEach(((e,t)=>{L_(n,e)}))}async function Cj(n,e){Kk(n),V_(n)?(n.Va.ha(e),P_(n)):n.Va.set("Unknown")}async function xj(n,e,t){if(n.Va.set("Online"),e instanceof Ik&&e.state===2&&e.cause)try{await(async function(i,o){const l=o.cause;for(const u of o.targetIds)i.Ia.has(u)&&(await i.remoteSyncer.rejectListen(u,l),i.Ia.delete(u),i.da.removeTarget(u))})(n,e)}catch(r){ge(tl,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await hm(n,r)}else if(e instanceof zp?n.da.Xe(e):e instanceof kk?n.da.st(e):n.da.tt(e),!t.isEqual(xe.min()))try{const r=await Hk(n.localStore);t.compareTo(r)>=0&&await(function(o,l){const u=o.da.Tt(l);return u.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const p=o.Ia.get(d);p&&o.Ia.set(d,p.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,d)=>{const p=o.Ia.get(h);if(!p)return;o.Ia.set(h,p.withResumeToken(Nn.EMPTY_BYTE_STRING,p.snapshotVersion)),Gk(o,h);const g=new xo(p.target,h,d,p.sequenceNumber);L_(o,g)})),o.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(r){ge(tl,"Failed to raise snapshot:",r),await hm(n,r)}}async function hm(n,e,t){if(!Xc(e))throw e;n.Ea.add(1),await Cf(n),n.Va.set("Offline"),t||(t=()=>Hk(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ge(tl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Ag(n)}))}function Wk(n,e){return e().catch((t=>hm(n,t,e)))}async function Cg(n){const e=Me(n),t=Qo(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:v_;for(;Rj(e);)try{const i=await lj(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,kj(e,i)}catch(i){await hm(e,i)}Qk(e)&&Yk(e)}function Rj(n){return dl(n)&&n.Ta.length<10}function kj(n,e){n.Ta.push(e);const t=Qo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function Qk(n){return dl(n)&&!Qo(n).x_()&&n.Ta.length>0}function Yk(n){Qo(n).start()}async function Ij(n){Qo(n).ra()}async function Nj(n){const e=Qo(n);for(const t of n.Ta)e.ea(t.mutations)}async function Mj(n,e,t){const r=n.Ta.shift(),i=C_.from(r,e,t);await Wk(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await Cg(n)}async function Oj(n,e){e&&Qo(n).Y_&&await(async function(r,i){if((function(l){return xk(l)&&l!==ie.ABORTED})(i.code)){const o=r.Ta.shift();Qo(r).B_(),await Wk(r,(()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i))),await Cg(r)}})(n,e),Qk(n)&&Yk(n)}async function DA(n,e){const t=Me(n);t.asyncQueue.verifyOperationInProgress(),ge(tl,"RemoteStore received new credentials");const r=dl(t);t.Ea.add(3),await Cf(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Ag(t)}async function Dj(n,e){const t=Me(n);e?(t.Ea.delete(2),await Ag(t)):e||(t.Ea.add(2),await Cf(t),t.Va.set("Unknown"))}function eu(n){return n.ma||(n.ma=(function(t,r,i){const o=Me(t);return o.sa(),new yj(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:wj.bind(null,n),Yo:Aj.bind(null,n),t_:Cj.bind(null,n),J_:xj.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),V_(n)?P_(n):n.Va.set("Unknown")):(await n.ma.stop(),Kk(n))}))),n.ma}function Qo(n){return n.fa||(n.fa=(function(t,r,i){const o=Me(t);return o.sa(),new vj(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:Ij.bind(null,n),t_:Oj.bind(null,n),ta:Nj.bind(null,n),na:Mj.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Cg(n)):(await n.fa.stop(),n.Ta.length>0&&(ge(tl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class j_{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Do,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){const l=Date.now()+r,u=new j_(e,t,l,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function U_(n,e){if(Is("AsyncQueue",`${e}: ${n}`),Xc(n))return new de(ie.UNAVAILABLE,`${e}: ${n}`);throw n}class Tc{static emptySet(e){return new Tc(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Te.comparator(t.key,r.key):(t,r)=>Te.comparator(t.key,r.key),this.keyedMap=_h(),this.sortedSet=new wt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Tc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Tc;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class LA{constructor(){this.ga=new wt(Te.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ae(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Lc{constructor(e,t,r,i,o,l,u,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){const l=[];return t.forEach((u=>{l.push({type:0,doc:u})})),new Lc(e,t,Tc.emptySet(t),l,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Lj{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class Pj{constructor(){this.queries=PA(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=Me(t),o=i.queries;i.queries=PA(),o.forEach(((l,u)=>{for(const h of u.ba)h.onError(r)}))})(this,new de(ie.ABORTED,"Firestore shutting down"))}}function PA(){return new fl((n=>dk(n)),bg)}async function Vj(n,e){const t=Me(n);let r=3;const i=e.query;let o=t.queries.get(i);o?!o.Sa()&&e.Da()&&(r=2):(o=new Lj,r=e.Da()?0:1);try{switch(r){case 0:o.wa=await t.onListen(i,!0);break;case 1:o.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(l){const u=U_(l,`Initialization of query '${fc(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,o),o.ba.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&B_(t)}async function jj(n,e){const t=Me(n),r=e.query;let i=3;const o=t.queries.get(r);if(o){const l=o.ba.indexOf(e);l>=0&&(o.ba.splice(l,1),o.ba.length===0?i=e.Da()?0:1:!o.Sa()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Uj(n,e){const t=Me(n);let r=!1;for(const i of e){const o=i.query,l=t.queries.get(o);if(l){for(const u of l.ba)u.Fa(i)&&(r=!0);l.wa=i}}r&&B_(t)}function Bj(n,e,t){const r=Me(n),i=r.queries.get(e);if(i)for(const o of i.ba)o.onError(t);r.queries.delete(e)}function B_(n){n.Ca.forEach((e=>{e.next()}))}var b0,VA;(VA=b0||(b0={})).Ma="default",VA.Cache="cache";class zj{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Lc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Lc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==b0.Cache}}class Jk{constructor(e){this.key=e}}class Xk{constructor(e){this.key=e}}class Fj{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ke(),this.mutatedKeys=Ke(),this.eu=pk(e),this.tu=new Tc(this.eu)}get nu(){return this.Za}ru(e,t){const r=t?t.iu:new LA,i=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,l=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((p,g)=>{const b=i.get(p),_=_g(this.query,g)?g:null,T=!!b&&this.mutatedKeys.has(b.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let A=!1;b&&_?b.data.isEqual(_.data)?T!==x&&(r.track({type:3,doc:_}),A=!0):this.su(b,_)||(r.track({type:2,doc:_}),A=!0,(h&&this.eu(_,h)>0||d&&this.eu(_,d)<0)&&(u=!0)):!b&&_?(r.track({type:0,doc:_}),A=!0):b&&!_&&(r.track({type:1,doc:b}),A=!0,(h||d)&&(u=!0)),A&&(_?(l=l.add(_),o=x?o.add(p):o.delete(p)):(l=l.delete(p),o=o.delete(p)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{tu:l,iu:r,Ss:u,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((p,g)=>(function(_,T){const x=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae(20277,{Vt:A})}};return x(_)-x(T)})(p.type,g.type)||this.eu(p.doc,g.doc))),this.ou(r),i=i??!1;const u=t&&!i?this._u():[],h=this.Ya.size===0&&this.current&&!i?1:0,d=h!==this.Xa;return this.Xa=h,l.length!==0||d?{snapshot:new Lc(this.query,e.tu,o,l,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new LA,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Ke(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const t=[];return e.forEach((r=>{this.Ya.has(r)||t.push(new Xk(r))})),this.Ya.forEach((r=>{e.has(r)||t.push(new Jk(r))})),t}cu(e){this.Za=e.ks,this.Ya=Ke();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Lc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const z_="SyncEngine";class Hj{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class qj{constructor(e){this.key=e,this.hu=!1}}class $j{constructor(e,t,r,i,o,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new fl((u=>dk(u)),bg),this.Iu=new Map,this.Eu=new Set,this.Ru=new wt(Te.comparator),this.Au=new Map,this.Vu=new k_,this.du={},this.mu=new Map,this.fu=Dc.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Gj(n,e,t=!0){const r=iI(n);let i;const o=r.Tu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.lu()):i=await Zk(r,e,t,!0),i}async function Kj(n,e){const t=iI(n);await Zk(t,e,!0,!1)}async function Zk(n,e,t,r){const i=await cj(n.localStore,zi(e)),o=i.targetId,l=n.sharedClientState.addLocalQueryTarget(o,t);let u;return r&&(u=await Wj(n,e,o,l==="current",i.resumeToken)),n.isPrimaryClient&&t&&$k(n.remoteStore,i),u}async function Wj(n,e,t,r,i){n.pu=(g,b,_)=>(async function(x,A,R,M){let j=A.view.ru(R);j.Ss&&(j=await kA(x.localStore,A.query,!1).then((({documents:I})=>A.view.ru(I,j))));const Y=M&&M.targetChanges.get(A.targetId),$=M&&M.targetMismatches.get(A.targetId)!=null,G=A.view.applyChanges(j,x.isPrimaryClient,Y,$);return UA(x,A.targetId,G.au),G.snapshot})(n,g,b,_);const o=await kA(n.localStore,e,!0),l=new Fj(e,o.ks),u=l.ru(o.documents),h=Af.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=l.applyChanges(u,n.isPrimaryClient,h);UA(n,t,d.au);const p=new Hj(e,t,l);return n.Tu.set(e,p),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function Qj(n,e,t){const r=Me(n),i=r.Tu.get(e),o=r.Iu.get(i.targetId);if(o.length>1)return r.Iu.set(i.targetId,o.filter((l=>!bg(l,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await y0(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&D_(r.remoteStore,i.targetId),_0(r,i.targetId)})).catch(Jc)):(_0(r,i.targetId),await y0(r.localStore,i.targetId,!0))}async function Yj(n,e){const t=Me(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),D_(t.remoteStore,r.targetId))}async function Jj(n,e,t){const r=iU(n);try{const i=await(function(l,u){const h=Me(l),d=pt.now(),p=u.reduce(((_,T)=>_.add(T.key)),Ke());let g,b;return h.persistence.runTransaction("Locally write mutations","readwrite",(_=>{let T=Ns(),x=Ke();return h.xs.getEntries(_,p).next((A=>{T=A,T.forEach(((R,M)=>{M.isValidDocument()||(x=x.add(R))}))})).next((()=>h.localDocuments.getOverlayedDocuments(_,T))).next((A=>{g=A;const R=[];for(const M of u){const j=u4(M,g.get(M.key).overlayedDocument);j!=null&&R.push(new na(M.key,j,sk(j.value.mapValue),qn.exists(!0)))}return h.mutationQueue.addMutationBatch(_,d,R,u)})).next((A=>{b=A;const R=A.applyToLocalDocumentSet(g,x);return h.documentOverlayCache.saveOverlays(_,A.batchId,R)}))})).then((()=>({batchId:b.batchId,changes:gk(g)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(l,u,h){let d=l.du[l.currentUser.toKey()];d||(d=new wt(Ge)),d=d.insert(u,h),l.du[l.currentUser.toKey()]=d})(r,i.batchId,t),await xf(r,i.changes),await Cg(r.remoteStore)}catch(i){const o=U_(i,"Failed to persist write");t.reject(o)}}async function eI(n,e){const t=Me(n);try{const r=await oj(t.localStore,e);e.targetChanges.forEach(((i,o)=>{const l=t.Au.get(o);l&&(Je(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?l.hu=!0:i.modifiedDocuments.size>0?Je(l.hu,14607):i.removedDocuments.size>0&&(Je(l.hu,42227),l.hu=!1))})),await xf(t,r,e)}catch(r){await Jc(r)}}function jA(n,e,t){const r=Me(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Tu.forEach(((o,l)=>{const u=l.view.va(e);u.snapshot&&i.push(u.snapshot)})),(function(l,u){const h=Me(l);h.onlineState=u;let d=!1;h.queries.forEach(((p,g)=>{for(const b of g.ba)b.va(u)&&(d=!0)})),d&&B_(h)})(r.eventManager,e),i.length&&r.Pu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Xj(n,e,t){const r=Me(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Au.get(e),o=i&&i.key;if(o){let l=new wt(Te.comparator);l=l.insert(o,hn.newNoDocument(o,xe.min()));const u=Ke().add(o),h=new Sg(xe.min(),new Map,new wt(Ge),l,u);await eI(r,h),r.Ru=r.Ru.remove(o),r.Au.delete(e),F_(r)}else await y0(r.localStore,e,!1).then((()=>_0(r,e,t))).catch(Jc)}async function Zj(n,e){const t=Me(n),r=e.batch.batchId;try{const i=await sj(t.localStore,e);nI(t,r,null),tI(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await xf(t,i)}catch(i){await Jc(i)}}async function eU(n,e,t){const r=Me(n);try{const i=await(function(l,u){const h=Me(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next((g=>(Je(g!==null,37113),p=g.keys(),h.mutationQueue.removeMutationBatch(d,g)))).next((()=>h.mutationQueue.performConsistencyCheck(d))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>h.localDocuments.getDocuments(d,p)))}))})(r.localStore,e);nI(r,e,t),tI(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await xf(r,i)}catch(i){await Jc(i)}}function tI(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function nI(n,e,t){const r=Me(n);let i=r.du[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.du[r.currentUser.toKey()]=i}}function _0(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((r=>{n.Vu.containsKey(r)||rI(n,r)}))}function rI(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(D_(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),F_(n))}function UA(n,e,t){for(const r of t)r instanceof Jk?(n.Vu.addReference(r.key,e),tU(n,r)):r instanceof Xk?(ge(z_,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||rI(n,r.key)):Ae(19791,{wu:r})}function tU(n,e){const t=e.key,r=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(r)||(ge(z_,"New document in limbo: "+t),n.Eu.add(r),F_(n))}function F_(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Te(ut.fromString(e)),r=n.fu.next();n.Au.set(r,new qj(t)),n.Ru=n.Ru.insert(t,r),$k(n.remoteStore,new xo(zi(S_(t.path)),r,"TargetPurposeLimboResolution",yg.ce))}}async function xf(n,e,t){const r=Me(n),i=[],o=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach(((u,h)=>{l.push(r.pu(h,e,t).then((d=>{if((d||t)&&r.isPrimaryClient){const p=d?!d.fromCache:t?.targetChanges.get(h.targetId)?.current;r.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(d){i.push(d);const p=N_.Es(h.targetId,d);o.push(p)}})))})),await Promise.all(l),r.Pu.J_(i),await(async function(h,d){const p=Me(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(g=>ae.forEach(d,(b=>ae.forEach(b.Ts,(_=>p.persistence.referenceDelegate.addReference(g,b.targetId,_))).next((()=>ae.forEach(b.Is,(_=>p.persistence.referenceDelegate.removeReference(g,b.targetId,_)))))))))}catch(g){if(!Xc(g))throw g;ge(M_,"Failed to update sequence numbers: "+g)}for(const g of d){const b=g.targetId;if(!g.fromCache){const _=p.vs.get(b),T=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(T);p.vs=p.vs.insert(b,x)}}})(r.localStore,o))}async function nU(n,e){const t=Me(n);if(!t.currentUser.isEqual(e)){ge(z_,"User change. New user:",e.toKey());const r=await Fk(t.localStore,e);t.currentUser=e,(function(o,l){o.mu.forEach((u=>{u.forEach((h=>{h.reject(new de(ie.CANCELLED,l))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await xf(t,r.Ns)}}function rU(n,e){const t=Me(n),r=t.Au.get(e);if(r&&r.hu)return Ke().add(r.key);{let i=Ke();const o=t.Iu.get(e);if(!o)return i;for(const l of o){const u=t.Tu.get(l);i=i.unionWith(u.view.nu)}return i}}function iI(n){const e=Me(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=eI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Xj.bind(null,e),e.Pu.J_=Uj.bind(null,e.eventManager),e.Pu.yu=Bj.bind(null,e.eventManager),e}function iU(n){const e=Me(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Zj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eU.bind(null,e),e}class fm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wg(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return ij(this.persistence,new tj,e.initialUser,this.serializer)}Cu(e){return new zk(I_.Vi,this.serializer)}Du(e){return new hj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fm.provider={build:()=>new fm};class sU extends fm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Je(this.persistence.referenceDelegate instanceof um,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new B4(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?nr.withCacheSize(this.cacheSizeBytes):nr.DEFAULT;return new zk((r=>um.Vi(r,t)),this.serializer)}}class E0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>jA(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=nU.bind(null,this.syncEngine),await Dj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Pj})()}createDatastore(e){const t=wg(e.databaseInfo.databaseId),r=gj(e.databaseInfo);return Ej(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,o,l,u){return new Sj(r,i,o,l,u)})(this.localStore,this.datastore,e.asyncQueue,(t=>jA(this.syncEngine,t,0)),(function(){return MA.v()?new MA:new fj})())}createSyncEngine(e,t){return(function(i,o,l,u,h,d,p){const g=new $j(i,o,l,u,h,d);return p&&(g.gu=!0),g})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=Me(t);ge(tl,"RemoteStore shutting down."),r.Ea.add(5),await Cf(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}E0.provider={build:()=>new E0};class oU{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Is("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}let aU=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new de(ie.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(i,o){const l=Me(i),u={documents:o.map((g=>cm(l.serializer,g)))},h=await l.jo("BatchGetDocuments",l.serializer.databaseId,ut.emptyPath(),u,o.length),d=new Map;h.forEach((g=>{const b=S4(l.serializer,g);d.set(b.key.toString(),b)}));const p=[];return o.forEach((g=>{const b=d.get(g.toString());Je(!!b,55234,{key:g}),p.push(b)})),p})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new A_(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const i=Te.fromPath(r);this.mutations.push(new Ck(i,this.precondition(i)))})),await(async function(r,i){const o=Me(r),l={writes:i.map((u=>Lk(o.serializer,u)))};await o.Wo("Commit",o.serializer.databaseId,ut.emptyPath(),l)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ae(50498,{Gu:e.constructor.name});t=xe.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new de(ie.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(xe.min())?qn.exists(!1):qn.updateTime(t):qn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(xe.min()))throw new de(ie.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qn.updateTime(t)}return qn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class lU{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.zu=r.maxAttempts,this.M_=new O_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new aU(this.datastore),t=this.Ju(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((i=>{this.Zu(i)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(e){try{const t=this.updateFunction(e);return!Sf(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!xk(t)}return!1}}const Yo="FirestoreClient";class cU{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=i,this.user=Ln.UNAUTHENTICATED,this.clientId=y_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async l=>{ge(Yo,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(ge(Yo,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Do;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=U_(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function mb(n,e){n.asyncQueue.verifyOperationInProgress(),ge(Yo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await Fk(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function BA(n,e){n.asyncQueue.verifyOperationInProgress();const t=await uU(n);ge(Yo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>DA(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>DA(e.remoteStore,i))),n._onlineComponents=e}async function uU(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ge(Yo,"Using user provided OfflineComponentProvider");try{await mb(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===ie.FAILED_PRECONDITION||i.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;kc("Error using user provided cache. Falling back to memory cache: "+t),await mb(n,new fm)}}else ge(Yo,"Using default OfflineComponentProvider"),await mb(n,new sU(void 0));return n._offlineComponents}async function H_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ge(Yo,"Using user provided OnlineComponentProvider"),await BA(n,n._uninitializedComponentsProvider._online)):(ge(Yo,"Using default OnlineComponentProvider"),await BA(n,new E0))),n._onlineComponents}function hU(n){return H_(n).then((e=>e.syncEngine))}function fU(n){return H_(n).then((e=>e.datastore))}async function zA(n){const e=await H_(n),t=e.eventManager;return t.onListen=Gj.bind(null,e.syncEngine),t.onUnlisten=Qj.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Kj.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Yj.bind(null,e.syncEngine),t}function dU(n,e,t,r){const i=new oU(r),o=new zj(e,i,t);return n.asyncQueue.enqueueAndForget((async()=>Vj(await zA(n),o))),()=>{i.Nu(),n.asyncQueue.enqueueAndForget((async()=>jj(await zA(n),o)))}}function pU(n,e){const t=new Do;return n.asyncQueue.enqueueAndForget((async()=>Jj(await hU(n),e,t))),t.promise}function mU(n,e,t){const r=new Do;return n.asyncQueue.enqueueAndForget((async()=>{const i=await fU(n);new lU(n.asyncQueue,i,t,e,r).ju()})),r.promise}function sI(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const gU="ComponentProvider",FA=new Map;function yU(n,e,t,r,i){return new M3(n,e,t,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,sI(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator,r)}const oI="firestore.googleapis.com",HA=!0;class qA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new de(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=oI,this.ssl=HA}else this.host=e.host,this.ssl=e.ssl??HA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Bk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<j4)throw new de(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}E3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sI(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new de(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new de(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new de(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class xg{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new h3;switch(r.type){case"firstParty":return new m3(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new de(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=FA.get(t);r&&(ge(gU,"Removing Datastore"),FA.delete(t),r.terminate())})(this),Promise.resolve()}}function vU(n,e,t,r={}){n=Lo(n,xg);const i=ea(e),o=n._getSettings(),l={...o,emulatorOptions:n._getEmulatorOptions()},u=`${e}:${t}`;i&&(h_(`https://${u}`),f_("Firestore",!0)),o.host!==oI&&o.host!==u&&kc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:u,ssl:i,emulatorOptions:r};if(!Ho(h,l)&&(n._setSettings(h),r.mockUserToken)){let d,p;if(typeof r.mockUserToken=="string")d=r.mockUserToken,p=Ln.MOCK_USER;else{d=DR(r.mockUserToken,n._app?.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new de(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Ln(g)}n._authCredentials=new f3(new KR(d,p))}}class pl{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new pl(this.firestore,e,this._query)}}class jt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Po(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jt(this.firestore,e,this._key)}toJSON(){return{type:jt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Tf(t,jt._jsonSchema))return new jt(e,r||null,new Te(ut.fromString(t.referencePath)))}}jt._jsonSchemaVersion="firestore/documentReference/1.0",jt._jsonSchema={type:Jt("string",jt._jsonSchemaVersion),referencePath:Jt("string")};class Po extends pl{constructor(e,t,r){super(e,t,S_(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jt(this.firestore,null,new Te(e))}withConverter(e){return new Po(this.firestore,e,this._path)}}function It(n,e,...t){if(n=mt(n),WR("collection","path",e),n instanceof xg){const r=ut.fromString(e,...t);return nA(r),new Po(n,null,r)}{if(!(n instanceof jt||n instanceof Po))throw new de(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ut.fromString(e,...t));return nA(r),new Po(n.firestore,null,r)}}function Pc(n,e,...t){if(n=mt(n),arguments.length===1&&(e=y_.newId()),WR("doc","path",e),n instanceof xg){const r=ut.fromString(e,...t);return tA(r),new jt(n,null,new Te(r))}{if(!(n instanceof jt||n instanceof Po))throw new de(ie.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ut.fromString(e,...t));return tA(r),new jt(n.firestore,n instanceof Po?n.converter:null,new Te(r))}}const $A="AsyncQueue";class GA{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new O_(this,"async_queue_retry"),this._c=()=>{const r=pb();r&&ge($A,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=pb();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=pb();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Do;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Xc(e))throw e;ge($A,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Is("INTERNAL UNHANDLED ERROR: ",KA(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=j_.createAndSchedule(this,e,t,r,(o=>this.hc(o)));return this.tc.push(i),i}uc(){this.nc&&Ae(47125,{Pc:KA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function KA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Vc extends xg{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new GA,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new GA(e),this._firestoreClient=void 0,await e}}}function bU(n,e){const t=typeof n=="object"?n:m_(),r=typeof n=="string"?n:im,i=mg(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const o=NR("firestore");o&&vU(i,...o)}return i}function q_(n){if(n._terminated)throw new de(ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||_U(n),n._firestoreClient}function _U(n){const e=n._freezeSettings(),t=yU(n._databaseId,n._app?.options.appId||"",n._persistenceKey,n._app?.options.apiKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new cU(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){const o=i?._online.build();return{_offline:i?._offline.build(o),_online:o}})(n._componentsProvider))}class pr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pr(Nn.fromBase64String(e))}catch(t){throw new de(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new pr(Nn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:pr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Tf(e,pr._jsonSchema))return pr.fromBase64String(e.bytes)}}pr._jsonSchemaVersion="firestore/bytes/1.0",pr._jsonSchema={type:Jt("string",pr._jsonSchemaVersion),bytes:Jt("string")};class Rg{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Rf{constructor(e){this._methodName=e}}class Fi{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Fi._jsonSchemaVersion}}static fromJSON(e){if(Tf(e,Fi._jsonSchema))return new Fi(e.latitude,e.longitude)}}Fi._jsonSchemaVersion="firestore/geoPoint/1.0",Fi._jsonSchema={type:Jt("string",Fi._jsonSchemaVersion),latitude:Jt("number"),longitude:Jt("number")};class ii{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ii._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Tf(e,ii._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ii(e.vectorValues);throw new de(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ii._jsonSchemaVersion="firestore/vectorValue/1.0",ii._jsonSchema={type:Jt("string",ii._jsonSchemaVersion),vectorValues:Jt("object")};const EU=/^__.*__$/;class TU{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new na(e,this.data,this.fieldMask,t,this.fieldTransforms):new wf(e,this.data,t,this.fieldTransforms)}}class aI{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new na(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function lI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ae(40011,{dataSource:n})}}class kg{constructor(e,t,r,i,o,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.validatePath(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new kg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return dm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(lI(this.dataSource)&&EU.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class SU{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||wg(e)}createContext(e,t,r,i=!1){return new kg({dataSource:e,methodName:t,targetDoc:r,path:xn.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ig(n){const e=n._freezeSettings(),t=wg(n._databaseId);return new SU(n._databaseId,!!e.ignoreUndefinedProperties,t)}function cI(n,e,t,r,i,o={}){const l=n.createContext(o.merge||o.mergeFields?2:0,e,t,i);K_("Data must be an object, but it was:",l,r);const u=fI(r,l);let h,d;if(o.merge)h=new gr(l.fieldMask),d=l.fieldTransforms;else if(o.mergeFields){const p=[];for(const g of o.mergeFields){const b=nl(e,g,t);if(!l.contains(b))throw new de(ie.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);mI(p,b)||p.push(b)}h=new gr(p),d=l.fieldTransforms.filter((g=>h.covers(g.field)))}else h=null,d=l.fieldTransforms;return new TU(new Hn(u),h,d)}class Ng extends Rf{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ng}}function wU(n,e,t){return new kg({dataSource:3,targetDoc:e.settings.targetDoc,methodName:n._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class $_ extends Rf{_toFieldTransform(e){return new Sk(e.path,new Zh)}isEqual(e){return e instanceof $_}}class G_ extends Rf{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=wU(this,e,!0),r=this.Ac.map((o=>tu(o,t))),i=new Oc(r);return new Sk(e.path,i)}isEqual(e){return e instanceof G_&&Ho(this.Ac,e.Ac)}}function uI(n,e,t,r){const i=n.createContext(1,e,t);K_("Data must be an object, but it was:",i,r);const o=[],l=Hn.empty();ta(r,((h,d)=>{const p=pI(e,h,t);d=mt(d);const g=i.childContextForFieldPath(p);if(d instanceof Ng)o.push(p);else{const b=tu(d,g);b!=null&&(o.push(p),l.set(p,b))}}));const u=new gr(o);return new aI(l,u,i.fieldTransforms)}function hI(n,e,t,r,i,o){const l=n.createContext(1,e,t),u=[nl(e,r,t)],h=[i];if(o.length%2!=0)throw new de(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<o.length;b+=2)u.push(nl(e,o[b])),h.push(o[b+1]);const d=[],p=Hn.empty();for(let b=u.length-1;b>=0;--b)if(!mI(d,u[b])){const _=u[b];let T=h[b];T=mt(T);const x=l.childContextForFieldPath(_);if(T instanceof Ng)d.push(_);else{const A=tu(T,x);A!=null&&(d.push(_),p.set(_,A))}}const g=new gr(d);return new aI(p,g,l.fieldTransforms)}function AU(n,e,t,r=!1){return tu(t,n.createContext(r?4:3,e))}function tu(n,e){if(dI(n=mt(n)))return K_("Unsupported field value:",e,n),fI(n,e);if(n instanceof Rf)return(function(r,i){if(!lI(i.dataSource))throw i.createError(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.createError(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,i){const o=[];let l=0;for(const u of r){let h=tu(u,i.childContextForArray(l));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),l++}return{arrayValue:{values:o}}})(n,e)}return(function(r,i){if((r=mt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return i4(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=pt.fromDate(r);return{timestampValue:lm(i.serializer,o)}}if(r instanceof pt){const o=new pt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lm(i.serializer,o)}}if(r instanceof Fi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof pr)return{bytesValue:Nk(i.serializer,r._byteString)};if(r instanceof jt){const o=i.databaseId,l=r.firestore._databaseId;if(!l.isEqual(o))throw i.createError(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:R_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ii)return(function(l,u){const h=l instanceof ii?l.toArray():l;return{mapValue:{fields:{[rk]:{stringValue:ik},[sm]:{arrayValue:{values:h.map((p=>{if(typeof p!="number")throw u.createError("VectorValues must only contain numeric values.");return w_(u.serializer,p)}))}}}}}})(r,i);if(Uk(r))return r._toProto(i.serializer);throw i.createError(`Unsupported field value: ${gg(r)}`)})(n,e)}function fI(n,e){const t={};return JR(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ta(n,((r,i)=>{const o=tu(i,e.childContextForField(r));o!=null&&(t[r]=o)})),{mapValue:{fields:t}}}function dI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof pt||n instanceof Fi||n instanceof pr||n instanceof jt||n instanceof Rf||n instanceof ii||Uk(n))}function K_(n,e,t){if(!dI(t)||!QR(t)){const r=gg(t);throw r==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+r)}}function nl(n,e,t){if((e=mt(e))instanceof Rg)return e._internalPath;if(typeof e=="string")return pI(n,e);throw dm("Field path arguments must be of type string or ",n,!1,void 0,t)}const CU=new RegExp("[~\\*/\\[\\]]");function pI(n,e,t){if(e.search(CU)>=0)throw dm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Rg(...e.split("."))._internalPath}catch{throw dm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function dm(n,e,t,r,i){const o=r&&!r.isEmpty(),l=i!==void 0;let u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||l)&&(h+=" (found",o&&(h+=` in field ${r}`),l&&(h+=` in document ${i}`),h+=")"),new de(ie.INVALID_ARGUMENT,u+n+h)}function mI(n,e){return n.some((t=>t.isEqual(e)))}class gI{convertValue(e,t="none"){switch(Wo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ko(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ta(e,((i,o)=>{r[i]=this.convertValue(o,t)})),r}convertVectorValue(e){const t=e.fields?.[sm].arrayValue?.values?.map((r=>Vt(r.doubleValue)));return new ii(t)}convertGeoPoint(e){return new Fi(Vt(e.latitude),Vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=vg(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Qh(e));default:return null}}convertTimestamp(e){const t=Go(e);return new pt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ut.fromString(e);Je(jk(r),9688,{name:e});const i=new Yh(r.get(1),r.get(3)),o=new Te(r.popFirst(5));return i.isEqual(t)||Is(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}class W_ extends gI{constructor(e){super(),this.firestore=e}convertBytes(e){return new pr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}function Mg(){return new $_("serverTimestamp")}function xU(...n){return new G_("arrayUnion",n)}const WA="@firebase/firestore",QA="4.10.0";function YA(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const o of r)if(o in i&&typeof i[o]=="function")return!0;return!1})(n,["next","error","complete"])}class pm{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new RU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(nl("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class RU extends pm{data(){return super.data()}}function kU(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new de(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Q_{}class yI extends Q_{}function dn(n,e,...t){let r=[];e instanceof Q_&&r.push(e),r=r.concat(t),(function(o){const l=o.filter((h=>h instanceof Y_)).length,u=o.filter((h=>h instanceof Og)).length;if(l>1||l>0&&u>0)throw new de(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const i of r)n=i._apply(n);return n}class Og extends yI{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Og(e,t,r)}_apply(e){const t=this._parse(e);return vI(e._query,t),new pl(e.firestore,e.converter,f0(e._query,t))}_parse(e){const t=Ig(e.firestore);return(function(o,l,u,h,d,p,g){let b;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new de(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){XA(g,p);const T=[];for(const x of g)T.push(JA(h,o,x));b={arrayValue:{values:T}}}else b=JA(h,o,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||XA(g,p),b=AU(u,l,g,p==="in"||p==="not-in");return Yt.create(d,p,b)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Fp(n,e,t){const r=e,i=nl("where",n);return Og._create(i,r,t)}class Y_ extends Q_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Y_(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:ai.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(i,o){let l=i;const u=o.getFlattenedFilters();for(const h of u)vI(l,h),l=f0(l,h)})(e._query,t),new pl(e.firestore,e.converter,f0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class J_ extends yI{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new J_(e,t)}_apply(e){const t=(function(i,o,l){if(i.startAt!==null)throw new de(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new de(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xh(o,l)})(e._query,this._field,this._direction);return new pl(e.firestore,e.converter,Y3(e._query,t))}}function si(n,e="asc"){const t=e,r=nl("orderBy",n);return J_._create(r,t)}function JA(n,e,t){if(typeof(t=mt(t))=="string"){if(t==="")throw new de(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fk(e)&&t.indexOf("/")!==-1)throw new de(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ut.fromString(t));if(!Te.isDocumentKey(r))throw new de(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return uA(n,new Te(r))}if(t instanceof jt)return uA(n,t._key);throw new de(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gg(t)}.`)}function XA(n,e){if(!Array.isArray(n)||n.length===0)throw new de(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vI(n,e){const t=(function(i,o){for(const l of i)for(const u of l.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new de(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function bI(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class IU extends gI{constructor(e){super(),this.firestore=e}convertBytes(e){return new pr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}class vc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vo extends pm{constructor(e,t,r,i,o,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Hp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(nl("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new de(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Vo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Vo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vo._jsonSchema={type:Jt("string",Vo._jsonSchemaVersion),bundleSource:Jt("string","DocumentSnapshot"),bundleName:Jt("string"),bundle:Jt("string")};class Hp extends Vo{data(e={}){return super.data(e)}}class Sc{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new vc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Hp(this._firestore,this._userDataWriter,r.key,r,new vc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,o){if(i._snapshot.oldDocs.isEmpty()){let l=0;return i._snapshot.docChanges.map((u=>{const h=new Hp(i._firestore,i._userDataWriter,u.doc.key,u.doc,new vc(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const h=new Hp(i._firestore,i._userDataWriter,u.doc.key,u.doc,new vc(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,p=-1;return u.type!==0&&(d=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),p=l.indexOf(u.doc.key)),{type:NU(u.type),doc:h,oldIndex:d,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new de(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Sc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=y_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],i=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function NU(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae(61501,{type:n})}}Sc._jsonSchemaVersion="firestore/querySnapshot/1.0",Sc._jsonSchema={type:Jt("string",Sc._jsonSchemaVersion),bundleSource:Jt("string","QuerySnapshot"),bundleName:Jt("string"),bundle:Jt("string")};const MU={maxAttempts:5};function Th(n,e){if((n=mt(n)).firestore!==e)throw new de(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class OU{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ig(e)}get(e){const t=Th(e,this._firestore),r=new IU(this._firestore);return this._transaction.lookup([t._key]).then((i=>{if(!i||i.length!==1)return Ae(24041);const o=i[0];if(o.isFoundDocument())return new pm(this._firestore,r,o.key,o,t.converter);if(o.isNoDocument())return new pm(this._firestore,r,t._key,null,t.converter);throw Ae(18433,{doc:o})}))}set(e,t,r){const i=Th(e,this._firestore),o=bI(i.converter,t,r),l=cI(this._dataReader,"Transaction.set",i._key,o,i.converter!==null,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const o=Th(e,this._firestore);let l;return l=typeof(t=mt(t))=="string"||t instanceof Rg?hI(this._dataReader,"Transaction.update",o._key,t,r,i):uI(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,l),this}delete(e){const t=Th(e,this._firestore);return this._transaction.delete(t._key),this}}let DU=class extends OU{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Th(e,this._firestore),r=new W_(this._firestore);return super.get(e).then((i=>new Vo(this._firestore,r,t._key,i._document,new vc(!1,!1),t.converter)))}};function LU(n,e,t){n=Lo(n,Vc);const r={...MU,...t};(function(l){if(l.maxAttempts<1)throw new de(ie.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const i=q_(n);return mU(i,(o=>e(new DU(n,o))),r)}function X_(n,e,t,...r){n=Lo(n,jt);const i=Lo(n.firestore,Vc),o=Ig(i);let l;return l=typeof(e=mt(e))=="string"||e instanceof Rg?hI(o,"updateDoc",n._key,e,t,r):uI(o,"updateDoc",n._key,e),EI(i,[l.toMutation(n._key,qn.exists(!0))])}function Dg(n,e){const t=Lo(n.firestore,Vc),r=Pc(n),i=bI(n.converter,e),o=Ig(n.firestore);return EI(t,[cI(o,"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,qn.exists(!1))]).then((()=>r))}function _I(n,...e){n=mt(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||YA(e[r])||(t=e[r++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(YA(e[r])){const d=e[r];e[r]=d.next?.bind(d),e[r+1]=d.error?.bind(d),e[r+2]=d.complete?.bind(d)}let o,l,u;if(n instanceof jt)l=Lo(n.firestore,Vc),u=S_(n._key.path),o={next:d=>{e[r]&&e[r](PU(l,n,d))},error:e[r+1],complete:e[r+2]};else{const d=Lo(n,pl);l=Lo(d.firestore,Vc),u=d._query;const p=new W_(l);o={next:g=>{e[r]&&e[r](new Sc(l,p,d,g))},error:e[r+1],complete:e[r+2]},kU(n._query)}const h=q_(l);return dU(h,u,i,o)}function EI(n,e){const t=q_(n);return pU(t,e)}function PU(n,e,t){const r=t.docs.get(e._key),i=new W_(n);return new Vo(n,i,e._key,r,new vc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){u3(hl),Za(new qo("firestore",((r,{instanceIdentifier:i,options:o})=>{const l=r.getProvider("app").getImmediate(),u=new Vc(new d3(r.getProvider("auth-internal")),new g3(l,r.getProvider("app-check-internal")),O3(l,i),l);return o={useFetchStreams:t,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),Bi(WA,QA,e),Bi(WA,QA,"esm2020")})();function TI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VU=TI,SI=new _f("auth","Firebase",TI());const mm=new d_("@firebase/auth");function jU(n,...e){mm.logLevel<=$e.WARN&&mm.warn(`Auth (${hl}): ${n}`,...e)}function qp(n,...e){mm.logLevel<=$e.ERROR&&mm.error(`Auth (${hl}): ${n}`,...e)}function li(n,...e){throw Z_(n,...e)}function Hi(n,...e){return Z_(n,...e)}function wI(n,e,t){const r={...VU(),[e]:t};return new _f("auth","Firebase",r).create(e,{appName:n.name})}function jo(n){return wI(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Z_(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return SI.create(n,...e)}function Re(n,e,...t){if(!n)throw Z_(e,...t)}function Ts(n){const e="INTERNAL ASSERTION FAILED: "+n;throw qp(e),new Error(e)}function Ms(n,e){n||Ts(e)}function T0(){return typeof self<"u"&&self.location?.href||""}function UU(){return ZA()==="http:"||ZA()==="https:"}function ZA(){return typeof self<"u"&&self.location?.protocol||null}function BU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(UU()||HP()||"connection"in navigator)?navigator.onLine:!0}function zU(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class kf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ms(t>e,"Short delay should be less than long delay!"),this.isMobile=BP()||qP()}get(){return BU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function eE(n,e){Ms(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class AI{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ts("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ts("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ts("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const FU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const HU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qU=new kf(3e4,6e4);function ra(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Yi(n,e,t,r,i={}){return CI(n,i,async()=>{let o={},l={};r&&(e==="GET"?l=r:o={body:JSON.stringify(r)});const u=Ef({key:n.config.apiKey,...l}).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const d={method:e,headers:h,...o};return FP()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&ea(n.emulatorConfig.host)&&(d.credentials="include"),AI.fetch()(await xI(n,n.config.apiHost,t,u),d)})}async function CI(n,e,t){n._canInitEmulator=!1;const r={...FU,...e};try{const i=new GU(n),o=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw vp(n,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const u=o.ok?l.errorMessage:l.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw vp(n,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw vp(n,"email-already-in-use",l);if(h==="USER_DISABLED")throw vp(n,"user-disabled",l);const p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw wI(n,p,d);li(n,p)}}catch(i){if(i instanceof Qi)throw i;li(n,"network-request-failed",{message:String(i)})}}async function Lg(n,e,t,r,i={}){const o=await Yi(n,e,t,r,i);return"mfaPendingCredential"in o&&li(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function xI(n,e,t,r){const i=`${e}${t}?${r}`,o=n,l=o.config.emulator?eE(n.config,i):`${n.config.apiScheme}://${i}`;return HU.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function $U(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Hi(this.auth,"network-request-failed")),qU.get())})}}function vp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=Hi(n,e,r);return i.customData._tokenResponse=t,i}function eC(n){return n!==void 0&&n.enterprise!==void 0}class KU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return $U(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function WU(n,e){return Yi(n,"GET","/v2/recaptchaConfig",ra(n,e))}async function QU(n,e){return Yi(n,"POST","/v1/accounts:delete",e)}async function gm(n,e){return Yi(n,"POST","/v1/accounts:lookup",e)}function Dh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function YU(n,e=!1){const t=mt(n),r=await t.getIdToken(e),i=tE(r);Re(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,l=o?.sign_in_provider;return{claims:i,token:r,authTime:Dh(gb(i.auth_time)),issuedAtTime:Dh(gb(i.iat)),expirationTime:Dh(gb(i.exp)),signInProvider:l||null,signInSecondFactor:o?.sign_in_second_factor||null}}function gb(n){return Number(n)*1e3}function tE(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return qp("JWT malformed, contained fewer than 3 sections"),null;try{const i=kR(t);return i?JSON.parse(i):(qp("Failed to decode base64 JWT payload"),null)}catch(i){return qp("Caught error parsing JWT payload as JSON",i?.toString()),null}}function tC(n){const e=tE(n);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function jc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Qi&&JU(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function JU({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class XU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class S0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Dh(this.lastLoginAt),this.creationTime=Dh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ym(n){const e=n.auth,t=await n.getIdToken(),r=await jc(n,gm(e,{idToken:t}));Re(r?.users.length,e,"internal-error");const i=r.users[0];n._notifyReloadListener(i);const o=i.providerUserInfo?.length?RI(i.providerUserInfo):[],l=eB(n.providerData,o),u=n.isAnonymous,h=!(n.email&&i.passwordHash)&&!l?.length,d=u?h:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new S0(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(n,p)}async function ZU(n){const e=mt(n);await ym(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function eB(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function RI(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function tB(n,e){const t=await CI(n,{},async()=>{const r=Ef({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,l=await xI(n,i,"/v1/token",`key=${o}`),u=await n._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:r};return n.emulatorConfig&&ea(n.emulatorConfig.host)&&(h.credentials="include"),AI.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function nB(n,e){return Yi(n,"POST","/v2/accounts:revokeToken",ra(n,e))}class wc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const t=tC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:o}=await tB(e,t);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:o}=t,l=new wc;return r&&(Re(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),i&&(Re(typeof i=="string","internal-error",{appName:e}),l.accessToken=i),o&&(Re(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wc,this.toJSON())}_performRefresh(){return Ts("not implemented")}}function po(n,e){Re(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ni{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new XU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new S0(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await jc(this,this.stsTokenManager.getToken(this.auth,e));return Re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return YU(this,e)}reload(){return ZU(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ni({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ym(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(jr(this.auth.app))return Promise.reject(jo(this.auth));const e=await this.getIdToken();return await jc(this,QU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,i=t.email??void 0,o=t.phoneNumber??void 0,l=t.photoURL??void 0,u=t.tenantId??void 0,h=t._redirectEventId??void 0,d=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:g,emailVerified:b,isAnonymous:_,providerData:T,stsTokenManager:x}=t;Re(g&&x,e,"internal-error");const A=wc.fromJSON(this.name,x);Re(typeof g=="string",e,"internal-error"),po(r,e.name),po(i,e.name),Re(typeof b=="boolean",e,"internal-error"),Re(typeof _=="boolean",e,"internal-error"),po(o,e.name),po(l,e.name),po(u,e.name),po(h,e.name),po(d,e.name),po(p,e.name);const R=new ni({uid:g,auth:e,email:i,emailVerified:b,displayName:r,isAnonymous:_,photoURL:l,phoneNumber:o,tenantId:u,stsTokenManager:A,createdAt:d,lastLoginAt:p});return T&&Array.isArray(T)&&(R.providerData=T.map(M=>({...M}))),h&&(R._redirectEventId=h),R}static async _fromIdTokenResponse(e,t,r=!1){const i=new wc;i.updateFromServerResponse(t);const o=new ni({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await ym(o),o}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];Re(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?RI(i.providerUserInfo):[],l=!(i.email&&i.passwordHash)&&!o?.length,u=new wc;u.updateFromIdToken(r);const h=new ni({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:l}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new S0(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h}}const nC=new Map;function Ss(n){Ms(n instanceof Function,"Expected a class definition");let e=nC.get(n);return e?(Ms(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,nC.set(n,e),e)}class kI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}kI.type="NONE";const rC=kI;function $p(n,e,t){return`firebase:${n}:${e}:${t}`}class Ac{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=$p(this.userKey,i.apiKey,o),this.fullPersistenceKey=$p("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await gm(this.auth,{idToken:e}).catch(()=>{});return t?ni._fromGetAccountInfoResponse(this.auth,t,e):null}return ni._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ac(Ss(rC),e,r);const i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=i[0]||Ss(rC);const l=$p(r,e.config.apiKey,e.name);let u=null;for(const d of t)try{const p=await d._get(l);if(p){let g;if(typeof p=="string"){const b=await gm(e,{idToken:p}).catch(()=>{});if(!b)break;g=await ni._fromGetAccountInfoResponse(e,b,p)}else g=ni._fromJSON(e,p);d!==o&&(u=g),o=d;break}}catch{}const h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Ac(o,e,r):(o=h[0],u&&await o._set(l,u.toJSON()),await Promise.all(t.map(async d=>{if(d!==o)try{await d._remove(l)}catch{}})),new Ac(o,e,r))}}function iC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(OI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(II(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(LI(e))return"Blackberry";if(PI(e))return"Webos";if(NI(e))return"Safari";if((e.includes("chrome/")||MI(e))&&!e.includes("edge/"))return"Chrome";if(DI(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function II(n=Pn()){return/firefox\//i.test(n)}function NI(n=Pn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function MI(n=Pn()){return/crios\//i.test(n)}function OI(n=Pn()){return/iemobile/i.test(n)}function DI(n=Pn()){return/android/i.test(n)}function LI(n=Pn()){return/blackberry/i.test(n)}function PI(n=Pn()){return/webos/i.test(n)}function nE(n=Pn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function rB(n=Pn()){return nE(n)&&!!window.navigator?.standalone}function iB(){return $P()&&document.documentMode===10}function VI(n=Pn()){return nE(n)||DI(n)||PI(n)||LI(n)||/windows phone/i.test(n)||OI(n)}function jI(n,e=[]){let t;switch(n){case"Browser":t=iC(Pn());break;case"Worker":t=`${iC(Pn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${hl}/${r}`}class sB{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=o=>new Promise((l,u)=>{try{const h=e(o);l(h)}catch(h){u(h)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function oB(n,e={}){return Yi(n,"GET","/v2/passwordPolicy",ra(n,e))}const aB=6;class lB{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??aB,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class cB{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sC(this),this.idTokenSubscription=new sC(this),this.beforeStateQueue=new sB(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=SI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ss(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ac.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await gm(this,{idToken:e}),r=await ni._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(jr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,l=r?._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&u?.user&&(r=u.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ym(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(jr(this.app))return Promise.reject(jo(this));const t=e?mt(e):null;return t&&Re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return jr(this.app)?Promise.reject(jo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return jr(this.app)?Promise.reject(jo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ss(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await oB(this),t=new lB(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new _f("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await nB(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ss(e)||this._popupRedirectResolver;Re(t,this,"argument-error"),this.redirectPersistenceManager=await Ac.create(this,[Ss(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(u,this,"internal-error"),u.then(()=>{l||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,i);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=jI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&jU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ml(n){return mt(n)}class sC{constructor(e){this.auth=e,this.observer=null,this.addObserver=ZP(t=>this.observer=t)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Pg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uB(n){Pg=n}function UI(n){return Pg.loadJS(n)}function hB(){return Pg.recaptchaEnterpriseScript}function fB(){return Pg.gapiScript}function dB(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class pB{constructor(){this.enterprise=new mB}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class mB{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const gB="recaptcha-enterprise",BI="NO_RECAPTCHA";class yB{constructor(e){this.type=gB,this.auth=ml(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,u)=>{WU(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new KU(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,l(d.siteKey)}}).catch(h=>{u(h)})})}function i(o,l,u){const h=window.grecaptcha;eC(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{l(d)}).catch(()=>{l(BI)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new pB().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{r(this.auth).then(u=>{if(!t&&eC(window.grecaptcha))i(u,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let h=hB();h.length!==0&&(h+=u),UI(h).then(()=>{i(u,o,l)}).catch(d=>{l(d)})}}).catch(u=>{l(u)})})}}async function oC(n,e,t,r=!1,i=!1){const o=new yB(n);let l;if(i)l=BI;else try{l=await o.verify(t)}catch{l=await o.verify(t,!0)}const u={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return r?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function w0(n,e,t,r,i){if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await oC(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await oC(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(o)})}function vB(n,e){const t=mg(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),o=t.getOptions();if(Ho(o,e??{}))return i;li(i,"already-initialized")}return t.initialize({options:e})}function bB(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ss);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function _B(n,e,t){const r=ml(n);Re(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,o=zI(e),{host:l,port:u}=EB(e),h=u===null?"":`:${u}`,d={url:`${o}//${l}${h}/`},p=Object.freeze({host:l,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Re(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Re(Ho(d,r.config.emulator)&&Ho(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,ea(l)?(h_(`${o}//${l}${h}`),f_("Auth",!0)):TB()}function zI(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function EB(n){const e=zI(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:aC(r.substr(o.length+1))}}else{const[o,l]=r.split(":");return{host:o,port:aC(l)}}}function aC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function TB(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class rE{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ts("not implemented")}_getIdTokenResponse(e){return Ts("not implemented")}_linkToIdToken(e,t){return Ts("not implemented")}_getReauthenticationResolver(e){return Ts("not implemented")}}async function SB(n,e){return Yi(n,"POST","/v1/accounts:signUp",e)}async function wB(n,e){return Lg(n,"POST","/v1/accounts:signInWithPassword",ra(n,e))}async function AB(n,e){return Yi(n,"POST","/v1/accounts:sendOobCode",ra(n,e))}async function CB(n,e){return AB(n,e)}async function xB(n,e){return Lg(n,"POST","/v1/accounts:signInWithEmailLink",ra(n,e))}async function RB(n,e){return Lg(n,"POST","/v1/accounts:signInWithEmailLink",ra(n,e))}class tf extends rE{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new tf(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new tf(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return w0(e,t,"signInWithPassword",wB);case"emailLink":return xB(e,{email:this._email,oobCode:this._password});default:li(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return w0(e,r,"signUpPassword",SB);case"emailLink":return RB(e,{idToken:t,email:this._email,oobCode:this._password});default:li(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Cc(n,e){return Lg(n,"POST","/v1/accounts:signInWithIdp",ra(n,e))}const kB="http://localhost";class rl extends rE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new rl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):li("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...o}=t;if(!r||!i)return null;const l=new rl(r,i);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Cc(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Cc(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Cc(e,t)}buildRequest(){const e={requestUri:kB,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ef(t)}return e}}function IB(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function NB(n){const e=yh(vh(n)).link,t=e?yh(vh(e)).deep_link_id:null,r=yh(vh(n)).deep_link_id;return(r?yh(vh(r)).link:null)||r||t||e||n}class iE{constructor(e){const t=yh(vh(e)),r=t.apiKey??null,i=t.oobCode??null,o=IB(t.mode??null);Re(r&&i&&o,"argument-error"),this.apiKey=r,this.operation=o,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=NB(e);try{return new iE(t)}catch{return null}}}class nu{constructor(){this.providerId=nu.PROVIDER_ID}static credential(e,t){return tf._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=iE.parseLink(t);return Re(r,"argument-error"),tf._fromEmailAndCode(e,r.code,r.tenantId)}}nu.PROVIDER_ID="password";nu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";nu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class FI{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class If extends FI{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class _o extends If{constructor(){super("facebook.com")}static credential(e){return rl._fromParams({providerId:_o.PROVIDER_ID,signInMethod:_o.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _o.credentialFromTaggedObject(e)}static credentialFromError(e){return _o.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _o.credential(e.oauthAccessToken)}catch{return null}}}_o.FACEBOOK_SIGN_IN_METHOD="facebook.com";_o.PROVIDER_ID="facebook.com";class Eo extends If{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return rl._fromParams({providerId:Eo.PROVIDER_ID,signInMethod:Eo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Eo.credentialFromTaggedObject(e)}static credentialFromError(e){return Eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Eo.credential(t,r)}catch{return null}}}Eo.GOOGLE_SIGN_IN_METHOD="google.com";Eo.PROVIDER_ID="google.com";class To extends If{constructor(){super("github.com")}static credential(e){return rl._fromParams({providerId:To.PROVIDER_ID,signInMethod:To.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return To.credentialFromTaggedObject(e)}static credentialFromError(e){return To.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return To.credential(e.oauthAccessToken)}catch{return null}}}To.GITHUB_SIGN_IN_METHOD="github.com";To.PROVIDER_ID="github.com";class So extends If{constructor(){super("twitter.com")}static credential(e,t){return rl._fromParams({providerId:So.PROVIDER_ID,signInMethod:So.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return So.credentialFromTaggedObject(e)}static credentialFromError(e){return So.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return So.credential(t,r)}catch{return null}}}So.TWITTER_SIGN_IN_METHOD="twitter.com";So.PROVIDER_ID="twitter.com";class Uc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const o=await ni._fromIdTokenResponse(e,r,i),l=lC(r);return new Uc({user:o,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=lC(r);return new Uc({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function lC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class vm extends Qi{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,vm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new vm(e,t,r,i)}}function HI(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?vm._fromErrorAndOperation(n,o,e,r):o})}async function MB(n,e,t=!1){const r=await jc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Uc._forOperation(n,"link",r)}async function OB(n,e,t=!1){const{auth:r}=n;if(jr(r.app))return Promise.reject(jo(r));const i="reauthenticate";try{const o=await jc(n,HI(r,i,e,n),t);Re(o.idToken,r,"internal-error");const l=tE(o.idToken);Re(l,r,"internal-error");const{sub:u}=l;return Re(n.uid===u,r,"user-mismatch"),Uc._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&li(r,"user-mismatch"),o}}async function qI(n,e,t=!1){if(jr(n.app))return Promise.reject(jo(n));const r="signIn",i=await HI(n,r,e),o=await Uc._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(o.user),o}async function DB(n,e){return qI(ml(n),e)}async function LB(n){const e=ml(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function PB(n,e,t){const r=ml(n);await w0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",CB)}function VB(n,e,t){return jr(n.app)?Promise.reject(jo(n)):DB(mt(n),nu.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&LB(n),r})}async function jB(n,e){return Yi(n,"POST","/v1/accounts:update",e)}async function UB(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=mt(n),o={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await jc(r,jB(r.auth,o));r.displayName=l.displayName||null,r.photoURL=l.photoUrl||null;const u=r.providerData.find(({providerId:h})=>h==="password");u&&(u.displayName=r.displayName,u.photoURL=r.photoURL),await r._updateTokensIfNecessary(l)}function BB(n,e,t,r){return mt(n).onIdTokenChanged(e,t,r)}function zB(n,e,t){return mt(n).beforeAuthStateChanged(e,t)}function FB(n,e,t,r){return mt(n).onAuthStateChanged(e,t,r)}function HB(n){return mt(n).signOut()}const bm="__sak";class $I{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(bm,"1"),this.storage.removeItem(bm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const qB=1e3,$B=10;class GI extends $I{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=VI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,u,h)=>{this.notifyListeners(l,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},o=this.storage.getItem(r);iB()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,$B):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},qB)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}GI.type="LOCAL";const GB=GI;class KI extends $I{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}KI.type="SESSION";const WI=KI;function KB(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Vg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new Vg(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:o}=t.data,l=this.handlersMap[i];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const u=Array.from(l).map(async d=>d(t.origin,o)),h=await KB(u);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Vg.receivers=[];function sE(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class WB{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,l;return new Promise((u,h)=>{const d=sE("",20);i.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},r);l={messageChannel:i,onMessage(g){const b=g;if(b.data.eventId===d)switch(b.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(b.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),i.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function qi(){return window}function QB(n){qi().location.href=n}function QI(){return typeof qi().WorkerGlobalScope<"u"&&typeof qi().importScripts=="function"}async function YB(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JB(){return navigator?.serviceWorker?.controller||null}function XB(){return QI()?self:null}const YI="firebaseLocalStorageDb",ZB=1,_m="firebaseLocalStorage",JI="fbase_key";class Nf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function jg(n,e){return n.transaction([_m],e?"readwrite":"readonly").objectStore(_m)}function ez(){const n=indexedDB.deleteDatabase(YI);return new Nf(n).toPromise()}function A0(){const n=indexedDB.open(YI,ZB);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(_m,{keyPath:JI})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(_m)?e(r):(r.close(),await ez(),e(await A0()))})})}async function cC(n,e,t){const r=jg(n,!0).put({[JI]:e,value:t});return new Nf(r).toPromise()}async function tz(n,e){const t=jg(n,!1).get(e),r=await new Nf(t).toPromise();return r===void 0?null:r.value}function uC(n,e){const t=jg(n,!0).delete(e);return new Nf(t).toPromise()}const nz=800,rz=3;class XI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await A0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>rz)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return QI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vg._getInstance(XB()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await YB(),!this.activeServiceWorker)return;this.sender=new WB(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||JB()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await A0();return await cC(e,bm,"1"),await uC(e,bm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>cC(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>tz(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>uC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=jg(i,!1).getAll();return new Nf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}XI.type="LOCAL";const iz=XI;new kf(3e4,6e4);function sz(n,e){return e?Ss(e):(Re(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class oE extends rE{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Cc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Cc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Cc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function oz(n){return qI(n.auth,new oE(n),n.bypassAuthState)}function az(n){const{auth:e,user:t}=n;return Re(t,e,"internal-error"),OB(t,new oE(n),n.bypassAuthState)}async function lz(n){const{auth:e,user:t}=n;return Re(t,e,"internal-error"),MB(t,new oE(n),n.bypassAuthState)}class ZI{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:l,type:u}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return oz;case"linkViaPopup":case"linkViaRedirect":return lz;case"reauthViaPopup":case"reauthViaRedirect":return az;default:li(this.auth,"internal-error")}}resolve(e){Ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ms(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const cz=new kf(2e3,1e4);class bc extends ZI{constructor(e,t,r,i,o){super(e,t,i,o),this.provider=r,this.authWindow=null,this.pollId=null,bc.currentPopupAction&&bc.currentPopupAction.cancel(),bc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){Ms(this.filter.length===1,"Popup operations only handle one event");const e=sE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Hi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Hi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,bc.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cz.get())};e()}}bc.currentPopupAction=null;const uz="pendingRedirect",Gp=new Map;class hz extends ZI{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Gp.get(this.auth._key());if(!e){try{const r=await fz(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Gp.set(this.auth._key(),e)}return this.bypassAuthState||Gp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function fz(n,e){const t=mz(e),r=pz(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function dz(n,e){Gp.set(n._key(),e)}function pz(n){return Ss(n._redirectPersistence)}function mz(n){return $p(uz,n.config.apiKey,n.name)}async function gz(n,e,t=!1){if(jr(n.app))return Promise.reject(jo(n));const r=ml(n),i=sz(r,e),l=await new hz(r,i,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}const yz=600*1e3;class vz{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!bz(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!eN(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Hi(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=yz&&this.cachedEventUids.clear(),this.cachedEventUids.has(hC(e))}saveEventToCache(e){this.cachedEventUids.add(hC(e)),this.lastProcessedEventTime=Date.now()}}function hC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function eN({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function bz(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eN(n);default:return!1}}async function _z(n,e={}){return Yi(n,"GET","/v1/projects",e)}const Ez=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Tz=/^https?/;async function Sz(n){if(n.config.emulator)return;const{authorizedDomains:e}=await _z(n);for(const t of e)try{if(wz(t))return}catch{}li(n,"unauthorized-domain")}function wz(n){const e=T0(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!Tz.test(t))return!1;if(Ez.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Az=new kf(3e4,6e4);function fC(){const n=qi().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Cz(n){return new Promise((e,t)=>{function r(){fC(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fC(),t(Hi(n,"network-request-failed"))},timeout:Az.get()})}if(qi().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(qi().gapi?.load)r();else{const i=dB("iframefcb");return qi()[i]=()=>{gapi.load?r():t(Hi(n,"network-request-failed"))},UI(`${fB()}?onload=${i}`).catch(o=>t(o))}}).catch(e=>{throw Kp=null,e})}let Kp=null;function xz(n){return Kp=Kp||Cz(n),Kp}const Rz=new kf(5e3,15e3),kz="__/auth/iframe",Iz="emulator/auth/iframe",Nz={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Mz=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Oz(n){const e=n.config;Re(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?eE(e,Iz):`https://${n.config.authDomain}/${kz}`,r={apiKey:e.apiKey,appName:n.name,v:hl},i=Mz.get(n.config.apiHost);i&&(r.eid=i);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Ef(r).slice(1)}`}async function Dz(n){const e=await xz(n),t=qi().gapi;return Re(t,n,"internal-error"),e.open({where:document.body,url:Oz(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Nz,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const l=Hi(n,"network-request-failed"),u=qi().setTimeout(()=>{o(l)},Rz.get());function h(){qi().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(l)})}))}const Lz={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Pz=500,Vz=600,jz="_blank",Uz="http://localhost";class dC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Bz(n,e,t,r=Pz,i=Vz){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let u="";const h={...Lz,width:r.toString(),height:i.toString(),top:o,left:l},d=Pn().toLowerCase();t&&(u=MI(d)?jz:t),II(d)&&(e=e||Uz,h.scrollbars="yes");const p=Object.entries(h).reduce((b,[_,T])=>`${b}${_}=${T},`,"");if(rB(d)&&u!=="_self")return zz(e||"",u),new dC(null);const g=window.open(e||"",u,p);Re(g,n,"popup-blocked");try{g.focus()}catch{}return new dC(g)}function zz(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Fz="__/auth/handler",Hz="emulator/auth/handler",qz=encodeURIComponent("fac");async function pC(n,e,t,r,i,o){Re(n.config.authDomain,n,"auth-domain-config-required"),Re(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:hl,eventId:i};if(e instanceof FI){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",XP(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,g]of Object.entries({}))l[p]=g}if(e instanceof If){const p=e.getScopes().filter(g=>g!=="");p.length>0&&(l.scopes=p.join(","))}n.tenantId&&(l.tid=n.tenantId);const u=l;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const h=await n._getAppCheckToken(),d=h?`#${qz}=${encodeURIComponent(h)}`:"";return`${$z(n)}?${Ef(u).slice(1)}${d}`}function $z({config:n}){return n.emulator?eE(n,Hz):`https://${n.authDomain}/${Fz}`}const yb="webStorageSupport";class Gz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=WI,this._completeRedirectFn=gz,this._overrideRedirectResult=dz}async _openPopup(e,t,r,i){Ms(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await pC(e,t,r,T0(),i);return Bz(e,o,sE())}async _openRedirect(e,t,r,i){await this._originValidation(e);const o=await pC(e,t,r,T0(),i);return QB(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(Ms(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Dz(e),r=new vz(e);return t.register("authEvent",i=>(Re(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(yb,{type:yb},i=>{const o=i?.[0]?.[yb];o!==void 0&&t(!!o),li(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Sz(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return VI()||NI()||nE()}}const Kz=Gz;var mC="@firebase/auth",gC="1.12.0";class Wz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Qz(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Yz(n){Za(new qo("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=r.options;Re(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:l,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:jI(n)},d=new cB(r,i,o,h);return bB(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Za(new qo("auth-internal",e=>{const t=ml(e.getProvider("auth").getImmediate());return(r=>new Wz(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Bi(mC,gC,Qz(n)),Bi(mC,gC,"esm2020")}const Jz=300,Xz=OR("authIdTokenMaxAge")||Jz;let yC=null;const Zz=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Xz)return;const i=t?.token;yC!==i&&(yC=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function e6(n=m_()){const e=mg(n,"auth");if(e.isInitialized())return e.getImmediate();const t=vB(n,{popupRedirectResolver:Kz,persistence:[iz,GB,WI]}),r=OR("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const l=Zz(o.toString());zB(t,l,()=>l(t.currentUser)),BB(t,u=>l(u))}}const i=IR("auth");return i&&_B(t,`http://${i}`),t}function t6(){return document.getElementsByTagName("head")?.[0]??document}uB({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const o=Hi("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",t6().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Yz("Browser");var n6="firebase",r6="12.8.0";Bi(n6,r6,"app");const tN="firebasestorage.googleapis.com",nN="storageBucket",i6=120*1e3,s6=600*1e3;class Mt extends Qi{constructor(e,t,r=0){super(vb(e),`Firebase Storage: ${t} (${vb(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Mt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return vb(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Nt;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Nt||(Nt={}));function vb(n){return"storage/"+n}function aE(){const n="An unknown error occurred, please check the error payload for server response.";return new Mt(Nt.UNKNOWN,n)}function o6(n){return new Mt(Nt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function a6(n){return new Mt(Nt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function l6(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Mt(Nt.UNAUTHENTICATED,n)}function c6(){return new Mt(Nt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function u6(n){return new Mt(Nt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function h6(){return new Mt(Nt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function f6(){return new Mt(Nt.CANCELED,"User canceled the upload/download.")}function d6(n){return new Mt(Nt.INVALID_URL,"Invalid URL '"+n+"'.")}function p6(n){return new Mt(Nt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function m6(){return new Mt(Nt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+nN+"' property when initializing the app?")}function g6(){return new Mt(Nt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function y6(){return new Mt(Nt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function v6(n){return new Mt(Nt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function C0(n){return new Mt(Nt.INVALID_ARGUMENT,n)}function rN(){return new Mt(Nt.APP_DELETED,"The Firebase app was deleted.")}function b6(n){return new Mt(Nt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Lh(n,e){return new Mt(Nt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function dh(n){throw new Mt(Nt.INTERNAL_ERROR,"Internal error: "+n)}class yr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=yr.makeFromUrl(e,t)}catch{return new yr(e,"")}if(r.path==="")return r;throw p6(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(Y){Y.path.charAt(Y.path.length-1)==="/"&&(Y.path_=Y.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+i+l,"i"),h={bucket:1,path:3};function d(Y){Y.path_=decodeURIComponent(Y.path)}const p="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),b="(/([^?#]*).*)?$",_=new RegExp(`^https?://${g}/${p}/b/${i}/o${b}`,"i"),T={bucket:1,path:3},x=t===tN?"(?:storage.googleapis.com|storage.cloud.google.com)":t,A="([^?#]*)",R=new RegExp(`^https?://${x}/${i}/${A}`,"i"),j=[{regex:u,indices:h,postModify:o},{regex:_,indices:T,postModify:d},{regex:R,indices:{bucket:1,path:2},postModify:d}];for(let Y=0;Y<j.length;Y++){const $=j[Y],G=$.regex.exec(e);if(G){const I=G[$.indices.bucket];let N=G[$.indices.path];N||(N=""),r=new yr(I,N),$.postModify(r);break}}if(r==null)throw d6(e);return r}}class _6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function E6(n,e,t){let r=1,i=null,o=null,l=!1,u=0;function h(){return u===2}let d=!1;function p(...A){d||(d=!0,e.apply(null,A))}function g(A){i=setTimeout(()=>{i=null,n(_,h())},A)}function b(){o&&clearTimeout(o)}function _(A,...R){if(d){b();return}if(A){b(),p.call(null,A,...R);return}if(h()||l){b(),p.call(null,A,...R);return}r<64&&(r*=2);let j;u===1?(u=2,j=0):j=(r+Math.random())*1e3,g(j)}let T=!1;function x(A){T||(T=!0,b(),!d&&(i!==null?(A||(u=2),clearTimeout(i),g(0)):A||(u=1)))}return g(0),o=setTimeout(()=>{l=!0,x(!0)},t),x}function T6(n){n(!1)}function S6(n){return n!==void 0}function w6(n){return typeof n=="object"&&!Array.isArray(n)}function lE(n){return typeof n=="string"||n instanceof String}function vC(n){return cE()&&n instanceof Blob}function cE(){return typeof Blob<"u"}function bC(n,e,t,r){if(r<e)throw C0(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw C0(`Invalid value for '${n}'. Expected ${t} or less.`)}function uE(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function iN(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Ga;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Ga||(Ga={}));function A6(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}class C6{constructor(e,t,r,i,o,l,u,h,d,p,g,b=!0,_=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=h,this.timeout_=d,this.progressCallback_=p,this.connectionFactory_=g,this.retry=b,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,x)=>{this.resolve_=T,this.reject_=x,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new bp(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=u=>{const h=u.loaded,d=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,d)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const u=o.getErrorCode()===Ga.NO_ERROR,h=o.getStatus();if(!u||A6(h,this.additionalRetryCodes_)&&this.retry){const p=o.getErrorCode()===Ga.ABORT;r(!1,new bp(!1,null,p));return}const d=this.successCodes_.indexOf(h)!==-1;r(!0,new bp(d,o))})},t=(r,i)=>{const o=this.resolve_,l=this.reject_,u=i.connection;if(i.wasSuccessCode)try{const h=this.callback_(u,u.getResponse());S6(h)?o(h):o()}catch(h){l(h)}else if(u!==null){const h=aE();h.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,h)):l(h)}else if(i.canceled){const h=this.appDelete_?rN():f6();l(h)}else{const h=h6();l(h)}};this.canceled_?t(!1,new bp(!1,null,!0)):this.backoffId_=E6(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&T6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class bp{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function x6(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function R6(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function k6(n,e){e&&(n["X-Firebase-GMPID"]=e)}function I6(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function N6(n,e,t,r,i,o,l=!0,u=!1){const h=iN(n.urlParams),d=n.url+h,p=Object.assign({},n.headers);return k6(p,e),x6(p,t),R6(p,o),I6(p,r),new C6(d,n.method,p,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,l,u)}function M6(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function O6(...n){const e=M6();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(cE())return new Blob(n);throw new Mt(Nt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function D6(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function L6(n){if(typeof atob>"u")throw v6("base-64");return atob(n)}const Ui={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class bb{constructor(e,t){this.data=e,this.contentType=t||null}}function P6(n,e){switch(n){case Ui.RAW:return new bb(sN(e));case Ui.BASE64:case Ui.BASE64URL:return new bb(oN(n,e));case Ui.DATA_URL:return new bb(j6(e),U6(e))}throw aE()}function sN(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const o=r,l=n.charCodeAt(++t);r=65536|(o&1023)<<10|l&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function V6(n){let e;try{e=decodeURIComponent(n)}catch{throw Lh(Ui.DATA_URL,"Malformed data URL.")}return sN(e)}function oN(n,e){switch(n){case Ui.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw Lh(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case Ui.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw Lh(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=L6(e)}catch(i){throw i.message.includes("polyfill")?i:Lh(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class aN{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Lh(Ui.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=B6(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function j6(n){const e=new aN(n);return e.base64?oN(Ui.BASE64,e.rest):V6(e.rest)}function U6(n){return new aN(n).contentType}function B6(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}class wo{constructor(e,t){let r=0,i="";vC(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(vC(this.data_)){const r=this.data_,i=D6(r,e,t);return i===null?null:new wo(i)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new wo(r,!0)}}static getBlob(...e){if(cE()){const t=e.map(r=>r instanceof wo?r.data_:r);return new wo(O6.apply(null,t))}else{const t=e.map(l=>lE(l)?P6(Ui.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const i=new Uint8Array(r);let o=0;return t.forEach(l=>{for(let u=0;u<l.length;u++)i[o++]=l[u]}),new wo(i,!0)}}uploadData(){return this.data_}}function lN(n){let e;try{e=JSON.parse(n)}catch{return null}return w6(e)?e:null}function z6(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function F6(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function cN(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function H6(n,e){return e}let Fn=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||H6}},_p=null;function q6(n){return!lE(n)||n.length<2?n:cN(n)}function uN(){if(_p)return _p;const n=[];n.push(new Fn("bucket")),n.push(new Fn("generation")),n.push(new Fn("metageneration")),n.push(new Fn("name","fullPath",!0));function e(o,l){return q6(l)}const t=new Fn("name");t.xform=e,n.push(t);function r(o,l){return l!==void 0?Number(l):l}const i=new Fn("size");return i.xform=r,n.push(i),n.push(new Fn("timeCreated")),n.push(new Fn("updated")),n.push(new Fn("md5Hash",null,!0)),n.push(new Fn("cacheControl",null,!0)),n.push(new Fn("contentDisposition",null,!0)),n.push(new Fn("contentEncoding",null,!0)),n.push(new Fn("contentLanguage",null,!0)),n.push(new Fn("contentType",null,!0)),n.push(new Fn("metadata","customMetadata",!0)),_p=n,_p}function $6(n,e){function t(){const r=n.bucket,i=n.fullPath,o=new yr(r,i);return e._makeStorageReference(o)}Object.defineProperty(n,"ref",{get:t})}function G6(n,e,t){const r={};r.type="file";const i=t.length;for(let o=0;o<i;o++){const l=t[o];r[l.local]=l.xform(r,e[l.server])}return $6(r,n),r}function hN(n,e,t){const r=lN(e);return r===null?null:G6(n,r,t)}function K6(n,e,t,r){const i=lN(e);if(i===null||!lE(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const l=encodeURIComponent;return o.split(",").map(d=>{const p=n.bucket,g=n.fullPath,b="/b/"+l(p)+"/o/"+l(g),_=uE(b,t,r),T=iN({alt:"media",token:d});return _+T})[0]}function W6(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const o=e[i];o.writable&&(t[o.server]=n[o.local])}return JSON.stringify(t)}class fN{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function dN(n){if(!n)throw aE()}function Q6(n,e){function t(r,i){const o=hN(n,i,e);return dN(o!==null),o}return t}function Y6(n,e){function t(r,i){const o=hN(n,i,e);return dN(o!==null),K6(o,i,n.host,n._protocol)}return t}function pN(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=c6():i=l6():t.getStatus()===402?i=a6(n.bucket):t.getStatus()===403?i=u6(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function J6(n){const e=pN(n);function t(r,i){let o=e(r,i);return r.getStatus()===404&&(o=o6(n.path)),o.serverResponse=i.serverResponse,o}return t}function X6(n,e,t){const r=e.fullServerUrl(),i=uE(r,n.host,n._protocol),o="GET",l=n.maxOperationRetryTime,u=new fN(i,o,Y6(n,t),l);return u.errorHandler=J6(e),u}function Z6(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function e5(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=Z6(null,e)),r}function t5(n,e,t,r,i){const o=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function u(){let j="";for(let Y=0;Y<2;Y++)j=j+Math.random().toString().slice(2);return j}const h=u();l["Content-Type"]="multipart/related; boundary="+h;const d=e5(e,r,i),p=W6(d,t),g="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+h+`\r
Content-Type: `+d.contentType+`\r
\r
`,b=`\r
--`+h+"--",_=wo.getBlob(g,r,b);if(_===null)throw g6();const T={name:d.fullPath},x=uE(o,n.host,n._protocol),A="POST",R=n.maxUploadRetryTime,M=new fN(x,A,Q6(n,t),R);return M.urlParams=T,M.headers=l,M.body=_.uploadData(),M.errorHandler=pN(e),M}class n5{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ga.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ga.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ga.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i,o){if(this.sent_)throw dh("cannot .send() more than once");if(ea(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),o!==void 0)for(const l in o)o.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,o[l].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw dh("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw dh("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw dh("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw dh("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class r5 extends n5{initXhr(){this.xhr_.responseType="text"}}function mN(){return new r5}class il{constructor(e,t){this._service=e,t instanceof yr?this._location=t:this._location=yr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new il(e,t)}get root(){const e=new yr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return cN(this._location.path)}get storage(){return this._service}get parent(){const e=z6(this._location.path);if(e===null)return null;const t=new yr(this._location.bucket,e);return new il(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw b6(e)}}function i5(n,e,t){n._throwIfRoot("uploadBytes");const r=t5(n.storage,n._location,uN(),new wo(e,!0),t);return n.storage.makeRequestWithTokens(r,mN).then(i=>({metadata:i,ref:n}))}function s5(n){n._throwIfRoot("getDownloadURL");const e=X6(n.storage,n._location,uN());return n.storage.makeRequestWithTokens(e,mN).then(t=>{if(t===null)throw y6();return t})}function o5(n,e){const t=F6(n._location.path,e),r=new yr(n._location.bucket,t);return new il(n.storage,r)}function a5(n){return/^[A-Za-z]+:\/\//.test(n)}function l5(n,e){return new il(n,e)}function gN(n,e){if(n instanceof hE){const t=n;if(t._bucket==null)throw m6();const r=new il(t,t._bucket);return e!=null?gN(r,e):r}else return e!==void 0?o5(n,e):n}function c5(n,e){if(e&&a5(e)){if(n instanceof hE)return l5(n,e);throw C0("To use ref(service, url), the first argument must be a Storage instance.")}else return gN(n,e)}function _C(n,e){const t=e?.[nN];return t==null?null:yr.makeFromBucketSpec(t,n)}function u5(n,e,t,r={}){n.host=`${e}:${t}`;const i=ea(e);i&&(h_(`https://${n.host}/b`),f_("Storage",!0)),n._isUsingEmulator=!0,n._protocol=i?"https":"http";const{mockUserToken:o}=r;o&&(n._overrideAuthToken=typeof o=="string"?o:DR(o,n.app.options.projectId))}class hE{constructor(e,t,r,i,o,l=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._isUsingEmulator=l,this._bucket=null,this._host=tN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=i6,this._maxUploadRetryTime=s6,this._requests=new Set,i!=null?this._bucket=yr.makeFromBucketSpec(i,this._host):this._bucket=_C(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yr.makeFromBucketSpec(this._url,e):this._bucket=_C(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){bC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){bC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new il(this,e)}_makeRequest(e,t,r,i,o=!0){if(this._deleted)return new _6(rN());{const l=N6(e,this._appId,r,i,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const EC="@firebase/storage",TC="0.14.0";const yN="storage";function fE(n,e,t){return n=mt(n),i5(n,e,t)}function dE(n){return n=mt(n),s5(n)}function pE(n,e){return n=mt(n),c5(n,e)}function h5(n=m_(),e){n=mt(n);const r=mg(n,yN).getImmediate({identifier:e}),i=NR("storage");return i&&f5(r,...i),r}function f5(n,e,t,r={}){u5(n,e,t,r)}function d5(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new hE(t,r,i,e,hl)}function p5(){Za(new qo(yN,d5,"PUBLIC").setMultipleInstances(!0)),Bi(EC,TC,""),Bi(EC,TC,"esm2020")}p5();const m5={apiKey:"AIzaSyA0HsDcwtfSxXDCDIMOnVYBaa2EF6Q399k",authDomain:"yearbooksjmsom.firebaseapp.com",projectId:"yearbooksjmsom",storageBucket:"yearbooksjmsom.firebasestorage.app",messagingSenderId:"your_se419372260118nder_id",appId:"1:419372260118:web:82cff33a84243bb165ce37"},mE=VR(m5),ht=bU(mE),Bc=e6(mE),gE=h5(mE),vN=V.createContext(void 0);function g5({children:n}){const[e,t]=V.useState(null),[r,i]=V.useState(!0),[o,l]=V.useState(null);V.useEffect(()=>{const h=window.setTimeout(()=>{i(!1)},4e3),d=FB(Bc,p=>{t(p),i(!1),l(null),window.clearTimeout(h)},p=>{l(p.message),t(null),i(!1),window.clearTimeout(h)});return()=>{window.clearTimeout(h),d()}},[]);const u=V.useMemo(()=>({user:e,loading:r,error:o,logout:()=>HB(Bc)}),[e,r,o]);return S.jsx(vN.Provider,{value:u,children:n})}function ui(){const n=V.useContext(vN);if(!n)throw new Error("useAuth must be used within AuthProvider");return n}function pn(n){const[e,t]=V.useState({data:[],loading:!0,error:null});return V.useEffect(()=>{if(!n){t({data:[],loading:!1,error:null});return}const r=_I(n,i=>{const o=i.docs.map(l=>({id:l.id,...l.data()}));t({data:o,loading:!1,error:null})},i=>{t({data:[],loading:!1,error:i.message})});return()=>r()},[n]),e}const bN=n=>{if(!n)return null;if(typeof n=="number")return n;if(n instanceof Date)return n.getTime();if(n instanceof pt)return n.toDate().getTime();const e=Date.parse(n);return Number.isNaN(e)?null:e},SC=n=>{const e=bN(n);return e?new Date(e).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"TBD"},_N=n=>{const e=bN(n.closingDate);return e?e>=Date.now():!0},y5={"/":["all"],"/blogs":["developer","admin"],"/job-postings":["developer","admin"],"/admin/downloads":["admin"],"/highlights":["all"],"/profiles":["all"],"/make-profile":["all"],"/polls":["all"],"/write-testimonial":["current"],"/upload-highlight":["current"]},yE="SOM26",Di=n=>n===yE;function EN(n){const e=n?.email?.trim().toLowerCase()??"",t=V.useMemo(()=>e?dn(It(ht,"users"),Fp("email","==",e)):null,[e]),{data:r=[]}=pn(t);return r[0]??null}const v5=[{to:"/",label:"Home"},{to:"/highlights",label:"Highlights",protected:!0},{to:"/upload-highlight",label:"Upload highlight",protected:!0},{to:"/blogs",label:"Blogs",protected:!0},{to:"/profiles",label:"Profiles",protected:!0},{to:"/make-profile",label:"Make my profile",protected:!0},{to:"/write-testimonial",label:"Write testimonial",protected:!0},{to:"/polls",label:"Polls",protected:!0},{to:"/job-postings",label:"Job postings",protected:!0},{to:"/admin/downloads",label:"Downloads",protected:!0}],b5="/job-postings";function _5(){const{user:n,logout:e}=ui(),[t,r]=V.useState(!1),i=EN(n),o=v5,l=V.useMemo(()=>{const g=new Set(["all"]);return i&&(i.batch&&g.add(i.batch===yE?"current":"alum"),i.role==="developer"&&g.add("developer"),(i.role==="admin"||i.role==="CulturalAdmin")&&g.add("admin")),g},[i]),u=V.useMemo(()=>o.filter(g=>g.protected&&!n?!1:(y5[g.to]??["all"]).some(_=>l.has(_))),[o,n,l]),h=V.useMemo(()=>dn(It(ht,"JobPosting")),[]),{data:d=[]}=pn(h),p=d.filter(_N).length;return S.jsxs("header",{className:"nav-wrap",children:[S.jsxs("div",{className:"nav-brand",children:[S.jsx("div",{className:"brand-mark",children:S.jsx("img",{src:"/cult-logo.png",alt:"Cultural Council logo",className:"brand-logo"})}),S.jsxs("div",{children:[S.jsx("p",{className:"brand-title",children:"Memories Portal"}),S.jsx("p",{className:"brand-subtitle",children:"SJMSOM Cultural Council"})]})]}),S.jsxs("button",{type:"button",className:`nav-toggle ${t?"nav-toggle-open":""}`,onClick:()=>r(g=>!g),"aria-label":`${t?"Close":"Open"} navigation`,children:[S.jsx("span",{}),S.jsx("span",{}),S.jsx("span",{})]}),S.jsxs("nav",{className:`nav-links ${t?"nav-links-open":""}`,children:[u.map(g=>S.jsxs(e0,{to:g.to,className:({isActive:b})=>b?"nav-link nav-link-active":"nav-link",onClick:()=>r(!1),children:[g.label,g.to===b5?S.jsx("span",{className:"nav-badge",children:p}):null]},g.to)),n?S.jsx("button",{className:"nav-link nav-button",onClick:()=>{r(!1),e()},children:"Sign out"}):S.jsx(e0,{to:"/login",className:({isActive:g})=>g?"nav-link nav-link-active":"nav-link",onClick:()=>r(!1),children:"Sign in"})]})]})}function E5({children:n}){return S.jsxs("div",{className:"app-shell",children:[S.jsx(_5,{}),S.jsx("main",{className:"app-main",children:n}),S.jsxs("footer",{className:"app-footer",children:[S.jsxs("div",{children:[S.jsx("span",{children:"SJMSOM Memories Portal"}),S.jsx("span",{className:"footer-dot",children:""}),S.jsx("span",{children:"Cultural Council"})]}),S.jsx("span",{className:"footer-note",children:"Memories 2025"})]})]})}function Oi({children:n}){const{user:e,loading:t}=ui(),r=Wi();return t?S.jsx("p",{className:"state-pill",children:"Checking session"}):e?S.jsx(S.Fragment,{children:n}):S.jsx(GL,{to:"/login",state:{from:r.pathname},replace:!0})}const Ep=new Map;async function T5(n){if(Ep.has(n))return Ep.get(n);if(!("caches"in window))return n;try{const e=await caches.open("sjmsom-image-cache-v1"),t=await e.match(n);if(t){const l=await t.blob(),u=URL.createObjectURL(l);return Ep.set(n,u),u}const r=await fetch(n,{mode:"cors"});if(!r.ok)return n;await e.put(n,r.clone());const i=await r.blob(),o=URL.createObjectURL(i);return Ep.set(n,o),o}catch{return n}}async function S5(n){return T5(n)}function w5(n){const[e,t]=V.useState(null),[r,i]=V.useState(!0);return V.useEffect(()=>{let o=!0;if(!n){t(null),i(!1);return}return i(!0),S5(n).then(l=>{o&&(t(l),i(!1))}).catch(()=>{o&&(t(n),i(!1))}),()=>{o=!1}},[n]),{cachedUrl:e,loading:r}}function nf({src:n,alt:e="",width:t,height:r,...i}){const{loading:o,...l}=i,{cachedUrl:u}=w5(n);return n?S.jsx("img",{src:u||n,alt:e,width:t,height:r,loading:o??"lazy",...l}):null}function TN({src:n,alt:e,caption:t,onClose:r}){return V.useEffect(()=>{const i=o=>{o.key==="Escape"&&r()};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[r]),S.jsx("div",{className:"modal-backdrop",onClick:r,role:"presentation",children:S.jsxs("div",{className:"modal-content",onClick:i=>i.stopPropagation(),role:"dialog","aria-modal":"true",children:[S.jsx(nf,{src:n,alt:e,className:"modal-image"}),S.jsxs("div",{className:"modal-meta",children:[S.jsx("p",{children:t}),S.jsx("button",{className:"btn-ghost",type:"button",onClick:r,children:"Close"})]})]})})}function Rn({loading:n,error:e,emptyLabel:t}){return n?S.jsx("p",{className:"state-pill",children:"Loading"}):e?S.jsx("p",{className:"state-pill state-error",children:e}):S.jsx("p",{className:"state-pill",children:t})}function kn({title:n,subtitle:e,accent:t}){return S.jsxs("div",{className:"section-header",children:[t?S.jsx("span",{className:"section-accent",children:t}):null,S.jsxs("div",{children:[S.jsx("h2",{children:n}),e?S.jsx("p",{children:e}):null]})]})}function ru(n){return(n??[]).filter(e=>e.profileType!=="ServiceAccount")}const _b=20;function A5(){const n=V.useMemo(()=>dn(It(ht,"highlights"),si("timestamp","desc")),[]),e=V.useMemo(()=>dn(It(ht,"users")),[]),{data:t,loading:r,error:i}=pn(n),{data:o}=pn(e),l=ru(o),u=V.useMemo(()=>l.reduce((R,M)=>(R[M.id]=M,R),{}),[o]),[h,d]=V.useState(null),p=V.useMemo(()=>t.filter(R=>!!(R.image||R.directlink)),[t]),[g,b]=V.useState({}),[_,T]=V.useState({}),x=V.useMemo(()=>{const R={};return p.forEach(M=>{const j=M.batch||"Unassigned";R[j]||(R[j]=[]),R[j].push(M)}),Object.entries(R).sort(([M],[j])=>j.localeCompare(M)).map(([M,j])=>({batch:M,highlights:j}))},[p]),A=V.useMemo(()=>x.map(R=>{const M=g[R.batch]??_b,j=R.highlights.slice(0,M);return{...R,limit:M,topHighlights:j,hasMore:R.highlights.length>M}}),[x,g]);return S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Highlights",subtitle:"A mosaic of every shared memory.",accent:"Memories"}),p.length===0?S.jsx(Rn,{loading:r,error:i,emptyLabel:"No highlights yet."}):S.jsx("div",{className:"batch-stack",children:A.map(R=>S.jsxs("section",{className:"batch-section",children:[S.jsxs("button",{type:"button",className:"batch-header",onClick:()=>T(M=>({...M,[R.batch]:!M[R.batch]})),children:[S.jsxs("div",{children:[S.jsx("h3",{children:R.batch}),S.jsxs("span",{children:[R.highlights.length," memories"]})]}),S.jsx("span",{className:"batch-toggle",children:_[R.batch]?"Show":"Hide"})]}),_[R.batch]?null:S.jsxs("section",{className:"wall-panel",children:[S.jsx("div",{className:"wall-header",children:S.jsxs("p",{className:"meta",children:["Scroll through ",R.batch," highlights."]})}),S.jsx("div",{className:"wall-grid",children:R.topHighlights.map(M=>{const j=M.directlink||M.image;return j?S.jsxs("button",{className:"wall-tile",type:"button",onClick:()=>d(M),children:[S.jsx(nf,{src:j,alt:M.caption,loading:"lazy"}),S.jsxs("div",{className:"wall-caption",children:[S.jsx("p",{children:M.caption||"A shared memory"}),S.jsx("span",{children:u[M.userId]?.name||M.userId})]})]},M.id):null})}),R.hasMore?S.jsx("div",{className:"load-more-row",children:S.jsxs("button",{type:"button",className:"btn-ghost",onClick:()=>b(M=>({...M,[R.batch]:(M[R.batch]??_b)+_b})),children:["Load more ",R.batch," highlights"]})}):null]})]},R.batch))}),h?S.jsx(TN,{src:h.directlink||h.image||"",alt:h.caption,caption:`${h.caption||"Every memory"}  ${u[h.userId]?.name||h.userId}`,onClose:()=>d(null)}):null]})}function Jo({children:n}){return S.jsx("div",{className:"card-surface",children:n})}function vE(n){const[e,t]=V.useState({data:null,loading:!0,error:null});return V.useEffect(()=>{if(!n){t({data:null,loading:!1,error:null});return}const r=_I(n,i=>{if(!i.exists()){t({data:null,loading:!1,error:null});return}t({data:{id:i.id,...i.data()},loading:!1,error:null})},i=>{t({data:null,loading:!1,error:i.message})});return()=>r()},[n]),e}const Mf={SOM25:[{label:"bestMemory",name:"bestMemory",key:0,placeholder:"Something you'll never forget",type:"textarea",rows:3},{label:"favorite spot",name:"favoriteSpot",key:1,placeholder:"Where did you pass the time?"},{label:"Favorite subject",name:"favoriteSubject",key:2,placeholder:"What made you light up?"},{label:"Theme song",name:"mbaLifeThemeSong",key:3,placeholder:"Track that defines your MBA"},{label:"Life lesson",name:"lifeLesson",key:4,placeholder:"A nugget you carry forward",type:"textarea",rows:3},{label:"MBA life in emojis",name:"mbaLifeEmojis",key:5,placeholder:"Use emoji shorthand"},{label:"MBA life miss",name:"mbaLifeMiss",key:6,placeholder:"What will you miss most?"}],SOM26:[{label:"Your favorite spot on campus",name:"favoriteSpot",key:1,placeholder:"Where do you pause on campus?"},{label:"A SOM memory you treasure",name:"memorableMoment",key:2,placeholder:"A SOM memory you treasure",rows:3},{label:"If your personality was a bollywood movie title, what would it be?",name:"bollywoodTitle",key:3,placeholder:"Give your journey a film name"},{label:"Describe your MBA life in one word",name:"comfortZone",key:4,placeholder:"In one word"},{label:"If you were famous for one thing, what would it be?",name:"famousFor",key:5,placeholder:"What would that be?"},{label:"A faculty / guest session you will never forget",name:"favoriteSession",key:6,placeholder:"Faculty or guest session?"},{label:"What's your go-to hobby?",name:"hobby",key:7,placeholder:"What keeps you busy outside classes?"},{label:"Hostel & room number",name:"hostelRoom",key:8,placeholder:"Where do you crash at night?"},{label:"One word for your MBA life",name:"lifeWord",key:9,placeholder:"Describe the vibe"},{label:"Mobile",name:"mobile",key:10,placeholder:"Phone number"},{label:"Roll number",name:"rollNumber",key:11,placeholder:"Official roll number"}]},rf=Mf.SOM25,C5=Object.values(Mf).flat().reduce((n,e)=>(n[e.label]=e,n),{});function SN(n){return typeof n=="string"?n:typeof n=="number"?String(n):Array.isArray(n)?n.join(", "):""}function Em(n,e="-"){return SN(n)||e}function wN({userId:n}={}){const{id:e}=ML(),t=n||e||"",r=V.useMemo(()=>Pc(ht,"users",t),[t]),{data:i,loading:o,error:l}=vE(r),u=V.useMemo(()=>dn(It(ht,"highlights"),Fp("tags","array-contains",t),si("timestamp","desc")),[t]),h=V.useMemo(()=>dn(It(ht,"highlights"),Fp("userId","==",t),si("timestamp","desc")),[t]),d=V.useMemo(()=>dn(It(ht,"testimonials"),Fp("receiver","==",t),si("timestamp","desc")),[t]),p=pn(u),g=pn(h),b=pn(d),_=V.useMemo(()=>dn(It(ht,"users")),[]),{data:T}=pn(_),x=V.useMemo(()=>ru(T),[T]),A=V.useMemo(()=>x.reduce((L,D)=>(L[D.id]=D,L),{}),[x]),R=V.useMemo(()=>{const L=new Map;return p.data.forEach(D=>L.set(D.id,D)),g.data.forEach(D=>L.set(D.id,D)),Array.from(L.values())},[p.data,g.data]),M=V.useMemo(()=>R.filter(L=>L.image||L.directlink),[R]),[j,Y]=V.useState(20),$=V.useMemo(()=>M.slice(0,j),[M,j]),[G,I]=V.useState(null),{user:N}=ui(),P=V.useMemo(()=>{if(!i)return rf;const L=i.batch||"SOM25",D=i.KeyQA||{},ue=Object.keys(D).length>0,ve=Mf[L]??rf;return[...ue?Object.entries(D).map(([ne,pe])=>{const ke=C5[ne];return{label:ne,name:pe.Name,key:pe.Key,placeholder:ke?.placeholder,type:ke?.type,rows:ke?.rows}}):ve].sort((ne,pe)=>ne.key-pe.key).filter(ne=>ne.name!=="photoURL")},[i]),B=["","","","",""],z=async(L,D)=>{if(!N)return;const ue=Pc(ht,"testimonials",L),J={...b.data.find(ne=>ne.id===L)?.reactions||{},[N.uid]:D};try{await X_(ue,{reactions:J})}catch(ne){console.error("Unable to react",ne)}};return t?S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:i?.name||"Profile",subtitle:"Highlights and testimonials curated around this student.",accent:"Memories"}),o?S.jsx(Rn,{loading:!0,error:null,emptyLabel:"Loading profile"}):l?S.jsx(Rn,{loading:!1,error:l,emptyLabel:""}):i?S.jsxs(Jo,{children:[S.jsxs("div",{className:"profile-hero",children:[i.photoURL?S.jsx("div",{className:"profile-hero-image",children:S.jsx(nf,{src:i.photoURL,alt:i.name,width:160,height:160})}):null,S.jsxs("div",{className:"profile-hero-body",children:[S.jsxs("div",{children:[S.jsx("p",{className:"profile-label",children:"Student profile"}),S.jsx("h3",{children:i.name}),i.nickname?S.jsxs("span",{className:"profile-nickname",children:['"',i.nickname,'"']}):null]}),S.jsx("div",{className:"profile-grid",children:P.map(L=>S.jsxs("div",{children:[S.jsx("span",{children:L.label}),S.jsx("strong",{children:Em(i[L.name])})]},L.name))})]})]}),Di(i.batch)?null:S.jsxs("div",{className:"professional-details-card",children:[S.jsx("h3",{children:"Professional details"}),S.jsxs("div",{className:"professional-details-row",children:[S.jsxs("div",{children:[S.jsx("p",{className:"meta subtle",children:"Current company"}),S.jsx("strong",{children:i.currentCompany||"Not shared"})]}),S.jsxs("div",{children:[S.jsx("p",{className:"meta subtle",children:"Current role"}),S.jsx("strong",{children:i.currentRole||"Not shared"})]})]}),i.linkedinURL?S.jsxs("div",{className:"professional-details-link",children:[S.jsx("span",{children:"LinkedIn"}),S.jsx("a",{href:i.linkedinURL,target:"_blank",rel:"noreferrer",children:"View profile"})]}):null,i.interestAreas?.length?S.jsx("div",{className:"interest-grid",children:i.interestAreas.map(L=>S.jsx("span",{className:"interest-chip",children:L},L))}):null]})]}):S.jsx(Rn,{loading:!1,error:null,emptyLabel:"Profile not found."}),S.jsx(kn,{title:"Highlights",subtitle:"Moments they shared or were tagged in."}),$.length===0?S.jsx(Rn,{loading:p.loading||g.loading,error:p.error||g.error,emptyLabel:"No highlights yet."}):S.jsx("div",{className:"wall-grid",children:$.map(L=>{const D=L.directlink||L.image;return D?S.jsxs("button",{className:"wall-tile",type:"button",onClick:()=>I(L),children:[S.jsx(nf,{src:D,alt:L.caption,loading:"lazy"}),S.jsxs("div",{className:"wall-caption",children:[S.jsx("p",{children:L.caption}),S.jsx("span",{children:A[L.userId]?.name||L.userId})]})]},L.id):null})}),M.length>j?S.jsx("div",{className:"load-more-row",children:S.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>Y(L=>L+20),children:"Load more highlights"})}):null,S.jsx(kn,{title:"Testimonials",subtitle:"Words shared by the community."}),b.data.length===0?S.jsx(Rn,{loading:b.loading,error:b.error,emptyLabel:"No testimonials yet."}):S.jsx("div",{className:"testimonial-stack",children:b.data.map(L=>{const D=A[L.writer],ue=L.reactions?Object.entries(L.reactions):[],ve=ue.reduce((ne,[,pe])=>(ne[pe]=(ne[pe]||0)+1,ne),{}),J=N?ue.find(([ne])=>ne===N.uid)?.[1]:void 0;return S.jsx(Jo,{children:S.jsxs("div",{className:"testimonial-panel",children:[S.jsxs("div",{className:"testimonial-panel-body",children:[S.jsxs("div",{className:"testimonial-writer",children:[S.jsx("div",{className:"writer-avatar-wrapper",children:D?.photoURL?S.jsx("img",{src:D.photoURL,alt:D.name,loading:"lazy"}):S.jsx("span",{children:D?.name?.[0]||"S"})}),S.jsxs("div",{children:[S.jsx("p",{className:"testimonial-writer-name",children:D?.name||"Anonymous"}),S.jsx("p",{className:"testimonial-meta-quiet",children:D?.nickname?`${D.nickname}`:"SJMSOM alumni"})]})]}),S.jsx("p",{className:"testimonial-text",children:L.testimonial?.replace(/[]/g,'"')})]}),S.jsxs("div",{className:"testimonial-panel-foot",children:[S.jsx("div",{children:L.approved?S.jsx("span",{className:"badge badge-soft badge-success",children:"Approved"}):null}),ue.length?S.jsx("div",{className:"reaction-row",children:ue.slice(0,6).map(([ne,pe])=>S.jsx("span",{className:"reaction-pill",title:`Reacted: ${A[ne]?.name||"Someone"}`,children:pe},`${L.id}-${ne}`))}):null]}),S.jsx("div",{className:"reaction-actions",children:B.map(ne=>{const pe=ve[ne]||0;return S.jsxs("button",{type:"button",className:`reaction-button ${J===ne?"reaction-button-active":""}`,onClick:()=>z(L.id,ne),"aria-label":`React with ${ne}`,children:[S.jsx("span",{children:ne}),pe?S.jsx("small",{children:pe}):null]},ne)})})]})},L.id)})}),G?S.jsx(TN,{src:G.directlink||G.image||"",alt:G.caption,caption:`${G.caption}  ${A[G.userId]?.name||G.userId}`,onClose:()=>I(null)}):null]}):S.jsx("div",{className:"page",children:S.jsx(kn,{title:"Profile",subtitle:"Select a profile from the directory."})})}const wC=["/som/20250322_100528.jpg","/som/som1.jpg","/som/som2.jpg","/som/som3.jpg","/som/WhatsApp Image 2025-02-06 at 12.18.55 PM.jpeg","/som/WhatsApp Image 2025-02-06 at 2.40.22 PM.jpeg","/som/WhatsApp Image 2025-04-28 at 4.11.43 PM.jpeg"];function x5(){const{user:n}=ui(),e=V.useMemo(()=>[...wC,...wC],[]);return n?S.jsx(wN,{userId:n.uid}):S.jsxs("div",{className:"page home-page",children:[S.jsxs("header",{className:"home-hero",children:[S.jsxs("div",{className:"home-hero-content",children:[S.jsxs("div",{children:[S.jsx("p",{className:"hero-kicker",children:"SJMSOM Memories Portal"}),S.jsx("h1",{children:"Relive the moments, celebrate the people."}),S.jsx("p",{className:"hero-subtitle",children:"A living memories portal curated by the Cultural Council, designed to capture stories, milestones, and the spirit of SJMSOM across every batch."}),S.jsxs("div",{className:"hero-panel hero-panel-compact",children:[S.jsx("div",{className:"hero-chip",children:"Highlights - Polls - Forum"}),S.jsx("p",{children:"Built for current students to add their stories and for alumni to reminisce on the moments that shaped them."})]})]}),S.jsxs("div",{className:"hero-badges",children:[S.jsx("span",{children:"Highlights"}),S.jsx("span",{children:"Profiles"}),S.jsx("span",{children:"Polls"}),S.jsx("span",{children:"Forum"})]})]}),S.jsx("div",{className:"hero-carousel",children:S.jsx("div",{className:"carousel-track",children:e.map((t,r)=>S.jsx("div",{className:"carousel-slide",children:S.jsx("img",{src:t,alt:"SJMSOM memory",loading:"lazy"})},`${t}-${r}`))})})]}),S.jsx("section",{className:"home-access",children:S.jsxs("div",{className:"home-access-content",children:[S.jsx("p",{className:"hero-kicker accent",children:"Access"}),S.jsx("h2",{children:"Sign in to contribute your batch's story."}),S.jsx("p",{className:"hero-subtitle",children:"Use your SJMSOM email to add highlights, react to testimonials, and keep the Cultural Council's memories fresh."}),S.jsxs("div",{className:"access-grid",children:[S.jsxs("div",{children:[S.jsx("strong",{children:"Highlight wall"}),S.jsx("span",{children:"Upload, tag, and celebrate every capture."})]}),S.jsxs("div",{children:[S.jsx("strong",{children:"Profiles"}),S.jsx("span",{children:"Share your favorite spot, theme song, and life lessons."})]}),S.jsxs("div",{children:[S.jsx("strong",{children:"Community"}),S.jsx("span",{children:"Engage with polls, reactions, and updates."})]})]}),S.jsx(bf,{to:"/login",className:"btn-primary hero-cta",children:"Access the memories"})]})})]})}function R5(){const n=o_(),e=Wi(),{user:t}=ui(),[r,i]=V.useState(""),[o,l]=V.useState(""),[u,h]=V.useState(null),[d,p]=V.useState(!1),[g,b]=V.useState(null),_=e.state?.from||"/profiles";V.useEffect(()=>{t&&n(_,{replace:!0})},[t,n,_]);const T=async A=>{A.preventDefault(),h(null),p(!0);try{await VB(Bc,r,o),n(_,{replace:!0})}catch(R){R instanceof Error?h(R.message):h("Unable to sign in right now.")}finally{p(!1)}},x=async()=>{if(h(null),b(null),!r){h("Enter your email to receive a reset link.");return}try{await PB(Bc,r),b("Password reset link sent. Check your inbox.")}catch(A){h(A instanceof Error?A.message:"Unable to send reset email right now.")}};return S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Welcome back",subtitle:"Sign in with your SJMSOM email to access the memories.",accent:"Login"}),S.jsxs("div",{className:"login-columns",children:[S.jsxs("article",{className:"login-hero-card card-surface",children:[S.jsx("p",{className:"hero-kicker accent",children:"Access"}),S.jsx("h2",{children:"Jump back into the memories."}),S.jsx("p",{className:"hero-subtitle",children:"Create highlights, react to stories, and keep the Cultural Council's wall alive across batches."}),S.jsxs("div",{className:"hero-badges",children:[S.jsx("span",{children:"Highlights"}),S.jsx("span",{children:"Profiles"}),S.jsx("span",{children:"Polls"}),S.jsx("span",{children:"Forum"})]})]}),S.jsxs("div",{className:"auth-shell form-card auth-card-wide",children:[S.jsx("p",{className:"hero-subtitle",children:"Rejoin the memories with your SJMSOM email and password."}),S.jsxs("form",{onSubmit:T,className:"auth-form",children:[S.jsxs("label",{className:"auth-field",children:["Email",S.jsx("input",{type:"email",value:r,onChange:A=>i(A.target.value),required:!0,placeholder:"name@sjmsom.in"})]}),S.jsxs("label",{className:"auth-field",children:["Password",S.jsx("input",{type:"password",value:o,onChange:A=>l(A.target.value),required:!0,placeholder:""})]}),u?S.jsx("p",{className:"state-pill state-error",children:u}):null,g?S.jsx("p",{className:"state-pill",children:g}):null,S.jsxs("div",{className:"auth-actions",children:[S.jsx("button",{className:"btn-primary",type:"submit",disabled:d,children:d?"Signing in":"Sign in"}),S.jsx("button",{type:"button",className:"btn-ghost",onClick:x,disabled:d,children:"Forgot password"})]})]})]})]})]})}const k5=n=>{if(!n?.length)return[];const e=Math.max(...n.map(t=>t.votes||0));return n.filter(t=>(t.votes||0)===e)};function I5(){const{user:n}=ui(),e=V.useMemo(()=>dn(It(ht,"polls"),si("created_at","desc")),[]),t=V.useMemo(()=>dn(It(ht,"users")),[]),{data:r=[]}=pn(t),i=ru(r),o=V.useMemo(()=>i.reduce((R,M)=>(R[M.id]=M,R),{}),[r]),{data:l,loading:u,error:h}=pn(e),d=V.useMemo(()=>{const R={};return l.forEach(M=>{const j=M.batch||"Unassigned";R[j]||(R[j]=[]),R[j].push(M)}),Object.entries(R).sort(([M],[j])=>M.localeCompare(j)).map(([M,j])=>({batch:M,polls:j}))},[l]),[p,g]=V.useState({}),[b,_]=V.useState({}),T=n?o[n.uid]?.batch:void 0,x=V.useMemo(()=>{const R={};return Object.entries(b).forEach(([M,j])=>{const Y=j.trim().toLowerCase();if(!Y){R[M]=[];return}R[M]=i.filter($=>$.batch===T&&(()=>{const G=$.name?.toLowerCase()??"",I=$.email?.toLowerCase()??"";return G.includes(Y)||I.includes(Y)})()).sort(($,G)=>($.name||"").localeCompare(G.name||"")).slice(0,32)}),R},[r,b,T]),A=async(R,M)=>{if(!n||!Di(T))return;const j=Pc(ht,"polls",R);await LU(ht,async Y=>{const I=(await Y.get(j)).data()?.options??[],N=o[M];if(!N||N.batch!==T||!Di(T))return;const P=I.findIndex(L=>L.voters?.includes(n.uid));if(P!==-1&&I[P].id===M){const L=I[P];L.voters=(L.voters??[]).filter(D=>D!==n.uid),L.votes=L.voters.length,Y.update(j,{options:I});return}if(P!==-1){const L=I[P];L.voters=(L.voters??[]).filter(D=>D!==n.uid),L.votes=L.voters.length}let B=I.find(L=>L.id===M);if(!B){const L=o[M]?.name||"Batchmate";B={id:M,name:L,votes:0,voters:[]},I.push(B)}let z=B.voters??[];z.includes(n.uid)||(z=[...z,n.uid]),B.voters=z,B.votes=z.length,Y.update(j,{options:I})})};return S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Polls",subtitle:"Anonymous votes with live results across the batch.",accent:"Live"}),l.length===0?S.jsx(Rn,{loading:u,error:h,emptyLabel:"No polls yet."}):S.jsx("div",{className:"batch-stack",children:d.map(({batch:R,polls:M})=>S.jsxs("section",{className:"batch-section",children:[S.jsxs("button",{type:"button",className:"batch-header",onClick:()=>g(j=>({...j,[R]:!j[R]})),children:[S.jsxs("div",{children:[S.jsx("h3",{children:R}),S.jsxs("span",{children:[M.length," polls"]})]}),S.jsx("span",{className:"batch-toggle",children:p[R]?"Show":"Hide"})]}),!p[R]&&S.jsx("div",{className:"grid-list",children:M.map(j=>{const Y=j.options?.reduce((G,I)=>G+(I.votes||0),0),$=n?j.options?.find(G=>G.voters?.includes(n.uid)):void 0;return S.jsx(Jo,{children:S.jsxs("div",{className:"poll-card",children:[S.jsx("h3",{children:j.question}),S.jsxs("p",{className:"meta",children:["Total votes: ",Y||0]}),Di(R)?null:S.jsx("p",{className:"meta",children:"Showing winner(s) only"}),S.jsx("div",{className:"poll-options",children:(Di(R)?j.options:k5(j.options))?.map(G=>{const I=Y?Math.round((G.votes||0)/Y*100):0;return S.jsxs("div",{className:"poll-option",children:[S.jsxs("div",{className:"poll-option-header",children:[S.jsx("span",{children:G.name}),S.jsxs("span",{children:[G.votes||0," votes"]})]}),S.jsx("div",{className:"poll-bar",children:S.jsx("div",{className:"poll-bar-fill",style:{width:`${I}%`}})})]},G.id)})}),Di(R)?S.jsxs("div",{className:"batchmate-vote-shell",children:[Di(T)?$?S.jsxs("p",{className:"hero-subtitle",children:["You voted for"," ",o[$.id]?.name||$.name||"this batchmate","."]}):null:S.jsxs("p",{className:"meta accent",children:["Only ",yE," batchmates can vote here."]}),S.jsx("input",{type:"text",className:"tag-search",placeholder:"Search batchmates",value:b[j.id]??"",onChange:G=>_(I=>({...I,[j.id]:G.target.value})),disabled:!Di(T)}),S.jsx("div",{className:"batchmate-grid",children:(x[j.id]??[]).map(G=>S.jsx("button",{type:"button",className:`tag-pill tag-suggestion ${$?.id===G.id?"tag-selected":""}`,onClick:()=>A(j.id,G.id),disabled:!n||!Di(T),children:G.name||G.email||"Batchmate"},G.id))})]}):null]})},j.id)})})]},R))})]})}const AN=["IT","Marketing","Supply Chain","Operation","Finance","Consulting","Others"];function N5(){const n=V.useMemo(()=>dn(It(ht,"users"),si("createdAt","desc")),[]),{data:e,loading:t,error:r}=pn(n),[i,o]=V.useState(""),[l,u]=V.useState({}),[h,d]=V.useState(""),[p,g]=V.useState(""),[b,_]=V.useState(""),T=V.useMemo(()=>ru(e),[e]),x=V.useMemo(()=>{const R=i.trim().toLowerCase();return T.filter(M=>R?[M.name,M.nickname].filter(Boolean).some(j=>j?.toLowerCase().includes(R)):!0).filter(M=>{const j=h.trim().toLowerCase();if(j&&!(M.currentCompany?.toLowerCase()||"").includes(j))return!1;const Y=p.trim().toLowerCase();return!(Y&&!(M.currentRole?.toLowerCase()||"").includes(Y)||b&&!(M.interestAreas??[]).includes(b))})},[e,i,h,p,b]),A=V.useMemo(()=>{const R=x.reduce((M,j)=>{const Y=j.batch||"Unassigned";return M[Y]||(M[Y]=[]),M[Y].push(j),M},{});return Object.entries(R).sort(([M],[j])=>j.localeCompare(M)).map(([M,j])=>({batch:M,profiles:j}))},[x]);return S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Profiles",subtitle:"Search by name and explore each batch.",accent:"Memories"}),S.jsxs("div",{className:"profiles-toolbar",children:[S.jsxs("div",{className:"search-field",children:[S.jsx("span",{children:"Search"}),S.jsx("input",{type:"search",value:i,onChange:R=>o(R.target.value),placeholder:"Type a name"})]}),S.jsxs("div",{className:"profiles-meta",children:[S.jsxs("span",{children:[x.length," students"]}),S.jsxs("span",{children:[A.length," batches"]})]})]}),S.jsxs("div",{className:"profiles-filters",children:[S.jsxs("label",{children:["Company",S.jsx("input",{type:"search",placeholder:"Filter by company",value:h,onChange:R=>d(R.target.value)})]}),S.jsxs("label",{children:["Role",S.jsx("input",{type:"search",placeholder:"Filter by role",value:p,onChange:R=>g(R.target.value)})]}),S.jsxs("label",{children:["Interest area",S.jsxs("select",{value:b,onChange:R=>_(R.target.value),children:[S.jsx("option",{value:"",children:"All"}),AN.map(R=>S.jsx("option",{value:R,children:R},R))]})]})]}),x.length===0?S.jsx(Rn,{loading:t,error:r,emptyLabel:"No profiles yet."}):S.jsx("div",{className:"batch-stack",children:A.map(R=>S.jsxs("section",{className:"batch-section",children:[S.jsxs("button",{type:"button",className:"batch-header",onClick:()=>u(M=>({...M,[R.batch]:!M[R.batch]})),children:[S.jsxs("div",{children:[S.jsx("h3",{children:R.batch}),S.jsxs("span",{children:[R.profiles.length," students"]})]}),S.jsx("span",{className:"batch-toggle",children:l[R.batch]?"Show":"Hide"})]}),l[R.batch]?null:S.jsx("div",{className:"profiles-grid",children:R.profiles.map(M=>S.jsxs(bf,{to:`/profiles/${M.id}`,className:"profile-card-modern",children:[S.jsxs("div",{className:"profile-card-header",children:[M.photoURL?S.jsx(nf,{src:M.photoURL,alt:M.name,className:"profile-avatar"}):S.jsx("div",{className:"profile-avatar fallback",children:M.name?.[0]}),S.jsxs("div",{children:[S.jsx("p",{className:"profile-name",children:M.name}),M.nickname?S.jsxs("span",{className:"profile-nickname",children:['"',M.nickname,'"']}):null]})]}),(()=>{const Y=[...Mf[M.batch||"SOM25"]||rf].sort((I,N)=>I.key-N.key),$=Y.slice(0,2),G=Y[2]??Y[0];return S.jsxs(S.Fragment,{children:[S.jsx("div",{className:"profile-card-body",children:$.map(I=>S.jsxs("p",{children:[S.jsx("span",{children:I.label}),S.jsx("strong",{children:Em(M[I.name])})]},I.key))}),S.jsxs("div",{className:"profile-card-footer",children:[S.jsx("span",{children:Em(M[G.name],G.label)}),S.jsx("span",{className:"profile-pill",children:"View profile"})]})]})})()]},M.id))})]},R.batch))})]})}function M5(){const{user:n}=ui();if(!n)return S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Upload highlight",subtitle:"Sign in to add a new memory.",accent:"Highlights"}),S.jsx("p",{className:"state-pill",children:"Sign in to contribute a highlight."})]});const e=V.useMemo(()=>Pc(ht,"users",n.uid),[n]),{data:t,loading:r,error:i}=vE(e),[o,l]=V.useState(""),[u,h]=V.useState(null),[d,p]=V.useState(""),[g,b]=V.useState([]),[_,T]=V.useState(null),[x,A]=V.useState(null),[R,M]=V.useState(!1),[j,Y]=V.useState(!1),$=V.useMemo(()=>dn(It(ht,"users")),[]),{data:G=[]}=pn($),I=V.useMemo(()=>ru(G),[G]),N=V.useMemo(()=>I.reduce((ue,ve)=>(ue[ve.id]=ve,ue),{}),[I]),P=t?.batch,B=V.useMemo(()=>{const ue=d.trim().toLowerCase();return ue?I.filter(J=>!g.includes(J.id)).filter(J=>{const ne=J.name?.toLowerCase()??"",pe=J.email?.toLowerCase()??"";return(P&&J.batch?J.batch===P:!J.batch)&&(ne.includes(ue)||pe.includes(ue))}).slice(0,6):[]},[G,g,d,P]),z=ue=>{g.includes(ue)||b(ve=>[...ve,ue]),p("")},L=ue=>{b(ve=>ve.filter(J=>J!==ue))},D=async ue=>{if(ue.preventDefault(),T(null),A(null),!n){A("You need to sign in to add highlights.");return}if(!o.trim()){A("Add a caption to describe the highlight.");return}if(!u){A("Upload a photo to add a highlight.");return}M(!0);try{const ve={caption:o.trim(),userId:n.uid,timestamp:Mg(),batch:P};if(u){Y(!0),T("Uploading image");const ne=pE(gE,`highlights/${n.uid}/${Date.now()}-${u.name}`);await fE(ne,u),ve.image=await dE(ne)}ve.tags=g;const J=await Dg(It(ht,"highlights"),ve);e&&await X_(e,{ImportantHighlights:xU(J.id)}),T("Highlight added. It may take a moment to appear."),l(""),h(null),b([]),p("")}catch(ve){A(ve instanceof Error?ve.message:"Unable to save highlight right now.")}finally{M(!1),Y(!1)}};return S.jsx("div",{className:"page",children:S.jsxs("div",{className:"upload-highlight-shell",children:[S.jsx(kn,{title:"Upload highlight",subtitle:"Share a photo and caption from your batch.",accent:"Highlights"}),r?S.jsx("p",{className:"state-pill",children:"Loading profile batch"}):i?S.jsx("p",{className:"state-pill state-error",children:i}):null,S.jsxs("form",{onSubmit:D,className:"form-card",children:[S.jsxs("label",{className:"auth-field",children:["Caption",S.jsx("textarea",{rows:3,value:o,onChange:ue=>l(ue.target.value),placeholder:"Describe what happened in this image."})]}),S.jsxs("label",{className:"auth-field",children:["Upload photo",S.jsx("input",{type:"file",accept:"image/*",onChange:ue=>h(ue.target.files?.[0]??null),disabled:j})]}),S.jsxs("label",{className:"auth-field",children:["Tag batchmates",S.jsx("input",{type:"text",value:d,onChange:ue=>p(ue.target.value),placeholder:"Search by name or email"})]}),B.length?S.jsx("div",{className:"tag-suggestion-row",children:B.map(ue=>S.jsx("button",{type:"button",className:"tag-pill tag-suggestion",onClick:()=>z(ue.id),children:ue.name||ue.email||"Batchmate"},ue.id))}):null,g.length?S.jsx("div",{className:"tag-row",children:g.map(ue=>S.jsxs("span",{className:"tag-pill tag-selected",children:[N[ue]?.name||N[ue]?.email||"Tagged",S.jsx("button",{type:"button",onClick:()=>L(ue),children:""})]},ue))}):null,S.jsxs("p",{className:"meta",children:["Your current batch: ",S.jsx("strong",{children:P||"Not assigned"})]}),u&&S.jsxs("p",{className:"meta",children:["Using uploaded file: ",u.name]}),x?S.jsx("p",{className:"state-pill state-error",children:x}):null,_?S.jsx("p",{className:"state-pill",children:_}):null,S.jsx("button",{className:"btn-primary",type:"submit",disabled:R||j,children:R||j?"Uploading":"Add highlight"})]})]})})}function O5(){const{user:n}=ui(),e=V.useMemo(()=>dn(It(ht,"users"),si("name","asc")),[]),{data:t}=pn(e),r=V.useMemo(()=>ru(t),[t]),[i,o]=V.useState(""),[l,u]=V.useState(""),[h,d]=V.useState(null),[p,g]=V.useState(null),[b,_]=V.useState(!1),[T,x]=V.useState(""),A=EN(n),R=r.find(G=>G.id===n?.uid)?.batch,M=A?.batch??R,j=V.useMemo(()=>{if(!T.trim())return r.filter(I=>I.batch===M);const G=T.trim().toLowerCase();return r.filter(I=>I.batch===M&&`${I.name} ${I.nickname||""}`.toLowerCase().includes(G))},[r,T,M]),Y=async G=>{if(G.preventDefault(),d(null),g(null),!n){d("You must sign in first.");return}if(!i){d("Choose a recipient.");return}if(!l.trim()){d("Please add a heartfelt message.");return}if(r.find(N=>N.id===i)?.batch!==M){d("You can only write for your batchmates.");return}_(!0);try{await Dg(It(ht,"testimonials"),{testimonial:l.trim(),writer:n.uid,receiver:i,timestamp:Mg(),approved:!1,show:!1,batch:M??null}),g("Testimonial recorded. Approval may take a moment."),u(""),o("")}catch(N){N instanceof Error?d(N.message):d("Something went wrong; please try again.")}finally{_(!1)}},$=r.find(G=>G.id===i);return S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Write a testimonial",subtitle:"Choose a peer, share a story, and add a little love.",accent:"Appreciation"}),S.jsxs("div",{className:"testimonial-layout",children:[S.jsxs("form",{className:"testimonial-card",onSubmit:Y,children:[S.jsxs("div",{className:"testimonial-card-header",children:[S.jsx("h3",{children:"Send a note"}),S.jsx("p",{children:"We review every message before it appears on a profile."})]}),S.jsxs("div",{className:"search-dropdown",children:[S.jsxs("label",{className:"auth-field search-label",children:[S.jsx("span",{children:"Search"}),S.jsx("input",{type:"text",value:T,onChange:G=>x(G.target.value),placeholder:"Type a batchmates name"})]}),S.jsxs("label",{className:"auth-field search-label",children:[S.jsx("span",{children:"Recipient"}),S.jsxs("select",{value:i,onChange:G=>o(G.target.value),children:[S.jsx("option",{value:"",children:"Choose a peer"}),j.map(G=>S.jsxs("option",{value:G.id,children:[G.name," ",G.nickname?`(${G.nickname})`:""]},G.id))]})]})]}),S.jsxs("label",{className:"auth-field",children:["Your message",S.jsx("textarea",{rows:6,value:l,onChange:G=>u(G.target.value),placeholder:"Share a memory or words of appreciation."})]}),h?S.jsx("p",{className:"state-pill state-error",children:h}):null,p?S.jsx("p",{className:"state-pill",children:p}):null,S.jsx("div",{className:"auth-actions",children:S.jsx("button",{className:"btn-primary",type:"submit",disabled:b,children:b?"Sending":"Submit testimonial"})})]}),S.jsx("aside",{className:"testimonial-card profile-preview",children:$?S.jsxs(S.Fragment,{children:[S.jsx("h4",{children:"Recipient"}),S.jsxs("p",{className:"profile-preview-name",children:[$.name,$.nickname?` (${$.nickname})`:""]}),$.photoURL?S.jsx("div",{className:"profile-preview-image",children:S.jsx("img",{src:$.photoURL,alt:$.name})}):null,S.jsxs("div",{className:"profile-preview-meta",children:[S.jsxs("p",{children:[S.jsx("strong",{children:"Favorite spot:"})," ",$.favoriteSpot||""]}),S.jsxs("p",{children:[S.jsx("strong",{children:"Theme song:"})," ",$.mbaLifeThemeSong||""]})]}),S.jsx("p",{className:"profile-preview-instruction",children:"Keep your words kind and specific to the memory you share."})]}):S.jsx("p",{className:"state-pill",children:"Pick a recipient to preview their card."})})]})]})}function D5(){const{user:n}=ui(),e=V.useMemo(()=>Pc(ht,"users",n.uid),[n]),{data:t,loading:r,error:i}=vE(e),[o,l]=V.useState({name:"",nickname:""}),[u,h]=V.useState(rf),[d,p]=V.useState(null),[g,b]=V.useState(null),_=V.useRef(null),T=V.useRef(null),[x,A]=V.useState(null),[R,M]=V.useState(null),[j,Y]=V.useState(!1),[$,G]=V.useState({currentCompany:"",currentRole:"",linkedinURL:"",interestAreas:[]});V.useEffect(()=>{if(t){const L=t.batch||"SOM25",D=t.KeyQA??{},ue=Object.keys(D).length>0,ve=Mf[L]??rf,ne=[...ue?Object.entries(D).map(([ke,Be])=>{const F=ve.find(se=>se.name===Be.Name);return{label:F?.label??ke,name:Be.Name,key:Be.Key,placeholder:F?.placeholder,type:F?.type,rows:F?.rows}}):ve].sort((ke,Be)=>ke.key-Be.key).filter(ke=>ke.name!=="photoURL");h(ne);const pe=ne.reduce((ke,Be)=>{const F=t[Be.name];return ke[Be.name]=SN(F),ke},{});l({name:t.name||"",nickname:t.nickname||"",...pe}),d||b(t.photoURL||null),G({currentCompany:t.currentCompany||"",currentRole:t.currentRole||"",linkedinURL:t.linkedinURL||"",interestAreas:t.interestAreas??[]})}},[t,d]);const I=!!(t&&!Di(t.batch)),N=L=>{G(D=>{const ue=D.interestAreas.includes(L);return{...D,interestAreas:ue?D.interestAreas.filter(ve=>ve!==L):[...D.interestAreas,L]}})};V.useEffect(()=>()=>{_.current&&(URL.revokeObjectURL(_.current),_.current=null)},[]);const P=L=>{const D=L.target.files?.[0]??null;if(p(D),_.current&&URL.revokeObjectURL(_.current),D){const ue=URL.createObjectURL(D);_.current=ue,b(ue)}else _.current=null,b(t?.photoURL||null)},B=()=>{T.current?.click()},z=async L=>{if(L.preventDefault(),!!n){Y(!0),A(null),M(null);try{let D=t?.photoURL||null;if(d){const ve=pE(gE,`profile_pictures/${n.uid}`);await fE(ve,d),D=await dE(ve)}const ue={name:o.name,nickname:o.nickname||void 0,photoURL:D??void 0,...u.reduce((ve,J)=>{const ne=(o[J.name]||"").trim();return ne&&(ve[J.name]=ne),ve},{}),currentCompany:$.currentCompany.trim()||"",currentRole:$.currentRole.trim()||"",linkedinURL:$.linkedinURL.trim()||"",interestAreas:$.interestAreas.length>0?$.interestAreas:[]};await X_(e,ue),Bc.currentUser&&await UB(Bc.currentUser,{displayName:o.name||void 0,photoURL:D||void 0}),A("Profile updated!"),p(null)}catch(D){console.error(D),M(D instanceof Error?D.message:"Unable to update profile right now.")}finally{Y(!1)}}};return r?S.jsx(Rn,{loading:!0,error:null,emptyLabel:"Loading your profile"}):i?S.jsx(Rn,{loading:!1,error:i,emptyLabel:"Unable to load profile."}):t?S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Make My Profile",subtitle:"Keep your SJMSOM story up to date.",accent:"Profile"}),S.jsxs(Jo,{children:[S.jsxs("div",{className:"profile-hero",children:[S.jsxs("div",{className:"profile-hero-image",role:"button",tabIndex:0,"aria-label":"Change profile photo",onClick:B,onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),B())},children:[g?S.jsx("img",{src:g,alt:t.name,loading:"lazy"}):S.jsx("div",{className:"profile-avatar fallback",children:t.name?.[0]||"S"}),S.jsx("div",{className:"image-overlay",children:"Click to change"})]}),S.jsxs("div",{className:"profile-hero-body",children:[S.jsx("p",{className:"profile-label",children:"This is you"}),S.jsx("h3",{children:o.name||t.name}),S.jsx("div",{className:"tag-row",children:u.slice(0,2).map(L=>S.jsx("span",{className:"tag-pill",children:o[L.name]||Em(t[L.name],L.placeholder)},L.name))})]})]}),S.jsxs("form",{className:"auth-form profile-update-form",onSubmit:z,children:[S.jsx("input",{type:"file",accept:"image/*",ref:T,onChange:P,className:"sr-only"}),S.jsxs("label",{className:"auth-field",children:["Full name",S.jsx("input",{type:"text",value:o.name||"",onChange:L=>l(D=>({...D,name:L.target.value})),placeholder:"How do people know you?"})]}),S.jsxs("label",{className:"auth-field",children:["Nickname",S.jsx("input",{type:"text",value:o.nickname||"",onChange:L=>l(D=>({...D,nickname:L.target.value})),placeholder:"Optional"})]}),u.map(L=>S.jsxs("label",{className:"auth-field",children:[L.label,L.type==="textarea"?S.jsx("textarea",{rows:L.rows??3,value:o[L.name]||"",onChange:D=>l(ue=>({...ue,[L.name]:D.target.value})),placeholder:L.placeholder}):S.jsx("input",{type:"text",value:o[L.name]||"",onChange:D=>l(ue=>({...ue,[L.name]:D.target.value})),placeholder:L.placeholder})]},L.name)),I?S.jsxs("div",{className:"professional-section",children:[S.jsx("h3",{children:"Professional details"}),S.jsx("p",{className:"meta subtle",children:"Available only for alumni batches"}),S.jsxs("label",{className:"auth-field",children:["Current company",S.jsx("input",{type:"text",value:$.currentCompany,onChange:L=>G(D=>({...D,currentCompany:L.target.value})),placeholder:"Where are you working now?"})]}),S.jsxs("label",{className:"auth-field",children:["Current role",S.jsx("input",{type:"text",value:$.currentRole,onChange:L=>G(D=>({...D,currentRole:L.target.value})),placeholder:"What is your role title?"})]}),S.jsxs("label",{className:"auth-field",children:["LinkedIn URL",S.jsx("input",{type:"url",value:$.linkedinURL,onChange:L=>G(D=>({...D,linkedinURL:L.target.value})),placeholder:"https://linkedin.com/in/you"})]}),S.jsxs("div",{className:"professional-interest",children:[S.jsx("p",{className:"auth-field-label",children:"Interest areas"}),S.jsx("div",{className:"interest-grid",children:AN.map(L=>S.jsx("button",{type:"button",className:`tag-pill tag-suggestion ${$.interestAreas.includes(L)?"tag-selected":""}`,onClick:()=>N(L),children:L},L))})]})]}):null,x?S.jsx("p",{className:"state-pill",children:x}):null,R?S.jsx("p",{className:"state-pill state-error",children:R}):null,S.jsx("div",{className:"auth-actions",children:S.jsx("button",{className:"btn-primary",type:"submit",disabled:j,children:j?"Saving":"Save profile"})})]})]})]}):S.jsx(Rn,{loading:!1,error:null,emptyLabel:"Profile not found."})}const L5=[{id:"sample-1",jobTitle:"Associate Product Manager",company:"Sathya Labs",workExperience:"0-2 years",domain:"Fintech",jobDescription:"Join the product team to help build Indias most trusted campus investment insights platform.",location:"Mumbai / Hybrid",postedAt:"2025-12-01T00:00:00Z",createdAt:"2025-12-01T00:00:00Z",closingDate:"2026-04-01T23:59:59Z"},{id:"sample-2",jobTitle:"Client Success Analyst",company:"Lumena Learning",workExperience:"2-4 years",domain:"EdTech",jobDescription:"Own the onboarding of new B2B customers, translate product value, and help faculty adopt the digital classroom toolkit.",location:"Bengaluru / Remote",postedAt:"2026-01-10T00:00:00Z",createdAt:"2026-01-10T00:00:00Z",closingDate:"2026-04-15T23:59:59Z"},{id:"sample-3",jobTitle:"Growth Strategist",company:"Monarch Media",workExperience:"3-5 years",domain:"Media & Storytelling",jobDescription:"Lead audience experiments across social and web, craft hypotheses for virality, and collaborate with the creative studio.",location:"Mumbai / Hybrid",postedAt:"2026-01-20T00:00:00Z",createdAt:"2026-01-20T00:00:00Z",closingDate:"2026-03-31T23:59:59Z"}];function P5(){const{user:n}=ui(),e=V.useMemo(()=>dn(It(ht,"JobPosting"),si("postedAt","desc")),[]),{data:t,loading:r,error:i}=pn(e),o=V.useMemo(()=>(t??[]).filter(_N),[t]),l=o.length>0,u=V.useMemo(()=>l?o:L5,[l,o]),h=V.useMemo(()=>dn(It(ht,"jobApplications")),[]),{data:d=[]}=pn(h),p=V.useMemo(()=>new Set(d.filter(N=>N.applicantId===n?.uid).map(N=>N.jobId)),[d,n?.uid]),[g,b]=V.useState(null),[_,T]=V.useState(""),[x,A]=V.useState(null),[R,M]=V.useState("idle"),[j,Y]=V.useState(null),$=()=>{T(""),A(null),M("idle"),Y(null)},G=async()=>{if(g){if(!n){Y("Sign in to apply for this role.");return}if(!x){Y("Please upload your CV to continue.");return}M("loading"),Y(null);try{const N=pE(gE,`job_applications/${n.uid}/${g.id}/${x.name}`);await fE(N,x);const P=await dE(N),B={jobId:g.id,jobTitle:g.jobTitle,applicantId:n.uid,applicantName:n.displayName||null,applicantEmail:n.email||null,resumeUrl:P,appliedAt:Mg()},z=_.trim();z&&(B.message=z),await Dg(It(ht,"jobApplications"),B),M("success")}catch(N){Y(N.message||"Unable to submit application."),M("error")}}},I=()=>{b(null),$()};return r&&!l?S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Job Postings",subtitle:"Opportunities shared by the SJMSOM community.",accent:"Careers"}),S.jsx(Rn,{loading:!0,error:i,emptyLabel:"Looking for new postings..."})]}):S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Job Postings",subtitle:"Opportunities shared by the SJMSOM community.",accent:"Careers"}),i?S.jsx(Rn,{loading:r,error:i,emptyLabel:"Could not load jobs."}):S.jsxs(S.Fragment,{children:[l?null:S.jsx("p",{className:"meta subtle",children:"Showing sample jobs until `JobPosting` documents are available."}),S.jsx("div",{className:"jobs-grid",children:u.map(N=>{const P=!!(n&&p.has(N.id));return S.jsx(Jo,{children:S.jsxs("div",{className:"job-card",children:[S.jsxs("header",{children:[S.jsx("p",{className:"meta",children:N.company}),S.jsx("h3",{children:N.jobTitle})]}),S.jsxs("div",{className:"job-details",children:[S.jsx("span",{children:N.domain}),S.jsx("span",{children:N.workExperience}),N.location?S.jsx("span",{children:N.location}):null]}),S.jsxs("div",{className:"job-meta-dates",children:[S.jsxs("span",{children:["Created on ",SC(N.createdAt??N.postedAt)]}),S.jsxs("span",{children:["Closing ",SC(N.closingDate)]})]}),S.jsx("p",{className:"job-description",children:N.jobDescription}),S.jsx("div",{className:"job-card-footer",children:S.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{P||($(),b(N))},disabled:P,children:P?"Applied":"Apply with CV"})})]})},N.id)})})]}),g?S.jsx("div",{className:"job-apply-modal",children:S.jsxs("div",{className:"job-apply-panel",children:[S.jsxs("header",{className:"job-apply-head",children:[S.jsxs("div",{children:[S.jsx("p",{className:"meta subtle",children:g.company}),S.jsx("h3",{children:g.jobTitle}),S.jsx("p",{className:"meta",children:g.domain})]}),S.jsx("button",{type:"button",onClick:I,className:"btn-ghost",children:"Close"})]}),S.jsxs("label",{className:"job-apply-field",children:[S.jsx("span",{children:"Your note"}),S.jsx("textarea",{value:_,onChange:N=>T(N.target.value),placeholder:"Tell us why this role excites you (optional)"})]}),S.jsxs("label",{className:"job-apply-field",children:[S.jsx("span",{children:"Upload CV"}),S.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:N=>A(N.target.files?.[0]??null)})]}),j?S.jsx("p",{className:"meta accent",children:j}):null,R==="success"?S.jsx("p",{className:"meta accent",children:"Application received! We will follow up soon."}):null,S.jsxs("div",{className:"job-apply-actions",children:[S.jsx("button",{type:"button",className:"btn-ghost",onClick:I,disabled:R==="loading",children:"Cancel"}),S.jsx("button",{type:"button",className:"btn-primary",onClick:G,disabled:R==="loading",children:R==="loading"?"Sending":"Submit application"})]})]})}):null]})}const Wp=["Campus Life","Club Updates","Recruitment","Academics","Culture","Leadership"];function V5(){const n=V.useMemo(()=>dn(It(ht,"blogs"),si("createdAt","desc")),[]),{data:e,loading:t,error:r}=pn(n),[i,o]=V.useState(""),[l,u]=V.useState(""),h=V.useMemo(()=>{const d=i.trim().toLowerCase();return e.filter(p=>{if(!(l?p.category===l:!0))return!1;if(!d)return!0;const b=p.title?.toLowerCase().includes(d),_=p.authorName?.toLowerCase().includes(d);return b||_})},[e,i,l]);return S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Student blogs",subtitle:"Read stories, club notes, and campus updates.",accent:"Campus"}),S.jsxs("div",{className:"profiles-toolbar",children:[S.jsxs("div",{className:"search-field",children:[S.jsx("span",{children:"Search"}),S.jsx("input",{type:"search",value:i,onChange:d=>o(d.target.value),placeholder:"Search by title or author"})]}),S.jsxs("div",{className:"profiles-meta",children:[S.jsxs("span",{children:[h.length," posts"]}),S.jsx("span",{children:S.jsx(bf,{to:"/write-blog",className:"nav-link",children:"Write a blog"})})]})]}),S.jsx("div",{className:"profiles-filters",children:S.jsxs("label",{children:["Category",S.jsxs("select",{value:l,onChange:d=>u(d.target.value),children:[S.jsx("option",{value:"",children:"All"}),Wp.map(d=>S.jsx("option",{value:d,children:d},d))]})]})}),t&&!e.length?S.jsx(Rn,{loading:!0,error:null,emptyLabel:"Loading blogs"}):r?S.jsx(Rn,{loading:!1,error:r,emptyLabel:"Unable to load blogs."}):h.length===0?S.jsx(Rn,{loading:!1,error:null,emptyLabel:"No blogs found."}):S.jsx("div",{className:"jobs-grid",children:h.map(d=>S.jsx(Jo,{children:S.jsxs("div",{className:"job-card blog-card",children:[S.jsxs("header",{children:[S.jsx("p",{className:"meta",children:d.category}),S.jsx("h3",{children:d.title}),S.jsxs("p",{className:"meta subtle",children:["By ",d.authorName]})]}),S.jsx("p",{className:"job-description",children:d.body})]})},d.id))})]})}var Eb={exports:{}},Tb={};var AC;function j5(){if(AC)return Tb;AC=1;var n=gf();function e(g,b){return g===b&&(g!==0||1/g===1/b)||g!==g&&b!==b}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,o=n.useLayoutEffect,l=n.useDebugValue;function u(g,b){var _=b(),T=r({inst:{value:_,getSnapshot:b}}),x=T[0].inst,A=T[1];return o(function(){x.value=_,x.getSnapshot=b,h(x)&&A({inst:x})},[g,_,b]),i(function(){return h(x)&&A({inst:x}),g(function(){h(x)&&A({inst:x})})},[g]),l(_),_}function h(g){var b=g.getSnapshot;g=g.value;try{var _=b();return!t(g,_)}catch{return!0}}function d(g,b){return b()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:u;return Tb.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:p,Tb}var CC;function CN(){return CC||(CC=1,Eb.exports=j5()),Eb.exports}var xN=CN();function Sn(n){this.content=n}Sn.prototype={constructor:Sn,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new Sn(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Sn(t)},addToStart:function(n,e){return new Sn([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Sn(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new Sn(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Sn.from(n),n.size?new Sn(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Sn.from(n),n.size?new Sn(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Sn.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Sn.from=function(n){if(n instanceof Sn)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Sn(e)};function RN(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let l=0;i.text[l]==o.text[l];l++)t++;return t}if(i.content.size||o.content.size){let l=RN(i.content,o.content,t+1);if(l!=null)return l}t+=i.nodeSize}}function kN(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let l=n.child(--i),u=e.child(--o),h=l.nodeSize;if(l==u){t-=h,r-=h;continue}if(!l.sameMarkup(u))return{a:t,b:r};if(l.isText&&l.text!=u.text){let d=0,p=Math.min(l.text.length,u.text.length);for(;d<p&&l.text[l.text.length-d-1]==u.text[u.text.length-d-1];)d++,t--,r--;return{a:t,b:r}}if(l.content.size||u.content.size){let d=kN(l.content,u.content,t-1,r-1);if(d)return d}t-=h,r-=h}}class le{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let l=0,u=0;u<t;l++){let h=this.content[l],d=u+h.nodeSize;if(d>e&&r(h,i+u,o||null,l)!==!1&&h.content.size){let p=u+1;h.nodesBetween(Math.max(0,e-p),Math.min(h.content.size,t-p),r,i+p)}u=d}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",l=!0;return this.nodesBetween(e,t,(u,h)=>{let d=u.isText?u.text.slice(Math.max(e,h)-h,t-h):u.isLeaf?i?typeof i=="function"?i(u):i:u.type.spec.leafText?u.type.spec.leafText(u):"":"";u.isBlock&&(u.isLeaf&&d||u.isTextblock)&&r&&(l?l=!1:o+=r),o+=d},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new le(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,l=0;l<t;o++){let u=this.content[o],h=l+u.nodeSize;h>e&&((l<e||h>t)&&(u.isText?u=u.cut(Math.max(0,e-l),Math.min(u.text.length,t-l)):u=u.cut(Math.max(0,e-l-1),Math.min(u.content.size,t-l-1))),r.push(u),i+=u.nodeSize),l=h}return new le(r,i)}cutByIndex(e,t){return e==t?le.empty:e==0&&t==this.content.length?this:new le(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new le(i,o)}addToStart(e){return new le([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new le(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return RN(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return kN(this,e,t,r)}findIndex(e){if(e==0)return Tp(0,e);if(e==this.size)return Tp(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,r=0;;t++){let i=this.child(t),o=r+i.nodeSize;if(o>=e)return o==e?Tp(t+1,o):Tp(t,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return le.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new le(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return le.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new le(t||e,r)}static from(e){if(!e)return le.empty;if(e instanceof le)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new le([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}le.empty=new le([],0);const Sb={index:0,offset:0};function Tp(n,e){return Sb.index=n,Sb.offset=e,Sb}function Tm(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Tm(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Tm(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let dt=class x0{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Tm(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=r.create(t.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return x0.none;if(e instanceof x0)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};dt.none=[];class Sm extends Error{}class me{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=NN(this.content,e+this.openStart,t);return r&&new me(r,this.openStart,this.openEnd)}removeBetween(e,t){return new me(IN(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return me.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new me(le.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new me(e,r,i)}}me.empty=new me(le.empty,0,0);function IN(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:l,offset:u}=n.findIndex(t);if(i==e||o.isText){if(u!=t&&!n.child(l).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=l)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(IN(o.content,e-i-1,t-i-1)))}function NN(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),l=n.maybeChild(i);if(o==e||l.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let u=NN(l.content,e-o-1,t,l);return u&&n.replaceChild(i,l.copy(u))}function U5(n,e,t){if(t.openStart>n.depth)throw new Sm("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Sm("Inconsistent open depths");return MN(n,e,t,0)}function MN(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let l=MN(n,e,t,r+1);return o.copy(o.content.replaceChild(i,l))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let l=n.parent,u=l.content;return Wa(l,u.cut(0,n.parentOffset).append(t.content).append(u.cut(e.parentOffset)))}else{let{start:l,end:u}=B5(t,n);return Wa(o,DN(n,l,u,e,r))}else return Wa(o,wm(n,e,r))}function ON(n,e){if(!e.type.compatibleContent(n.type))throw new Sm("Cannot join "+e.type.name+" onto "+n.type.name)}function R0(n,e,t){let r=n.node(t);return ON(r,e.node(t)),r}function Ka(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Ph(n,e,t,r){let i=(e||n).node(t),o=0,l=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(Ka(n.nodeAfter,r),o++));for(let u=o;u<l;u++)Ka(i.child(u),r);e&&e.depth==t&&e.textOffset&&Ka(e.nodeBefore,r)}function Wa(n,e){return n.type.checkContent(e),n.copy(e)}function DN(n,e,t,r,i){let o=n.depth>i&&R0(n,e,i+1),l=r.depth>i&&R0(t,r,i+1),u=[];return Ph(null,n,i,u),o&&l&&e.index(i)==t.index(i)?(ON(o,l),Ka(Wa(o,DN(n,e,t,r,i+1)),u)):(o&&Ka(Wa(o,wm(n,e,i+1)),u),Ph(e,t,i,u),l&&Ka(Wa(l,wm(t,r,i+1)),u)),Ph(r,null,i,u),new le(u)}function wm(n,e,t){let r=[];if(Ph(null,n,t,r),n.depth>t){let i=R0(n,e,t+1);Ka(Wa(i,wm(n,e,t+1)),r)}return Ph(e,null,t,r),new le(r)}function B5(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy(le.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class sf{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return dt.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let u=r;r=i,i=u}let o=r.marks;for(var l=0;l<o.length;l++)o[l].type.spec.inclusive===!1&&(!i||!o[l].isInSet(i.marks))&&(o=o[l--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Am(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let l=e;;){let{index:u,offset:h}=l.content.findIndex(o),d=o-h;if(r.push(l,u,i+h),!d||(l=l.child(u),l.isText))break;o=d-1,i+=h+1}return new sf(t,r,o)}static resolveCached(e,t){let r=xC.get(e);if(r)for(let o=0;o<r.elts.length;o++){let l=r.elts[o];if(l.pos==t)return l}else xC.set(e,r=new z5);let i=r.elts[r.i]=sf.resolve(e,t);return r.i=(r.i+1)%F5,i}}class z5{constructor(){this.elts=[],this.i=0}}const F5=12,xC=new WeakMap;class Am{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const H5=Object.create(null);class oi{constructor(e,t,r,i=dt.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||le.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Tm(this.attrs,t||e.defaultAttrs||H5)&&dt.sameSet(this.marks,r||dt.none)}copy(e=null){return e==this.content?this:new oi(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new oi(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return me.empty;let i=this.resolve(e),o=this.resolve(t),l=r?0:i.sharedDepth(t),u=i.start(l),d=i.node(l).content.cut(i.pos-u,o.pos-u);return new me(d,i.depth-l,o.depth-l)}replace(e,t,r){return U5(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return sf.resolveCached(this,e)}resolveNoCache(e){return sf.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),LN(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=le.empty,i=0,o=r.childCount){let l=this.contentMatchAt(e).matchFragment(r,i,o),u=l&&l.matchFragment(this.content,t);if(!u||!u.validEnd)return!1;for(let h=i;h<o;h++)if(!this.type.allowsMarks(r.child(h).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),l=o&&o.matchFragment(this.content,t);return l?l.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=dt.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!dt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=le.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,i,r);return o.type.checkAttrs(o.attrs),o}}oi.prototype.text=void 0;class Cm extends oi{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):LN(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Cm(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Cm(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function LN(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class sl{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new q5(e,t);if(r.next==null)return sl.empty;let i=PN(r);r.next&&r.err("Unexpected trailing text");let o=J5(Y5(i));return X5(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(l,u){let h=l.matchFragment(e,r);if(h&&(!t||h.validEnd))return le.from(u.map(d=>d.createAndFill()));for(let d=0;d<l.next.length;d++){let{type:p,next:g}=l.next[d];if(!(p.isText||p.hasRequiredAttrs())&&i.indexOf(g)==-1){i.push(g);let b=o(g,u.concat(p));if(b)return b}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let l=[];for(let u=i;u.type;u=u.via)l.push(u.type);return l.reverse()}for(let l=0;l<o.next.length;l++){let{type:u,next:h}=o.next[l];!u.isLeaf&&!u.hasRequiredAttrs()&&!(u.name in t)&&(!i.type||h.validEnd)&&(r.push({match:u.contentMatch,type:u,via:i}),t[u.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let l=0;l<r.next.length;l++)o+=(l?", ":"")+r.next[l].type.name+"->"+e.indexOf(r.next[l].next);return o}).join(`
`)}}sl.empty=new sl(!0);class q5{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function PN(n){let e=[];do e.push($5(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function $5(n){let e=[];do e.push(G5(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function G5(n){let e=Q5(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=K5(n,e);else break;return e}function RC(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function K5(n,e){let t=RC(n),r=t;return n.eat(",")&&(n.next!="}"?r=RC(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function W5(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let l=t[o];l.isInGroup(e)&&i.push(l)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function Q5(n){if(n.eat("(")){let e=PN(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=W5(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Y5(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(l,u,h){let d={term:h,to:u};return e[l].push(d),d}function i(l,u){l.forEach(h=>h.to=u)}function o(l,u){if(l.type=="choice")return l.exprs.reduce((h,d)=>h.concat(o(d,u)),[]);if(l.type=="seq")for(let h=0;;h++){let d=o(l.exprs[h],u);if(h==l.exprs.length-1)return d;i(d,u=t())}else if(l.type=="star"){let h=t();return r(u,h),i(o(l.expr,h),h),[r(h)]}else if(l.type=="plus"){let h=t();return i(o(l.expr,u),h),i(o(l.expr,h),h),[r(h)]}else{if(l.type=="opt")return[r(u)].concat(o(l.expr,u));if(l.type=="range"){let h=u;for(let d=0;d<l.min;d++){let p=t();i(o(l.expr,h),p),h=p}if(l.max==-1)i(o(l.expr,h),h);else for(let d=l.min;d<l.max;d++){let p=t();r(h,p),i(o(l.expr,h),p),h=p}return[r(h)]}else{if(l.type=="name")return[r(u,void 0,l.value)];throw new Error("Unknown expr type")}}}}function VN(n,e){return e-n}function kC(n,e){let t=[];return r(e),t.sort(VN);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let l=0;l<o.length;l++){let{term:u,to:h}=o[l];!u&&t.indexOf(h)==-1&&r(h)}}}function J5(n){let e=Object.create(null);return t(kC(n,0));function t(r){let i=[];r.forEach(l=>{n[l].forEach(({term:u,to:h})=>{if(!u)return;let d;for(let p=0;p<i.length;p++)i[p][0]==u&&(d=i[p][1]);kC(n,h).forEach(p=>{d||i.push([u,d=[]]),d.indexOf(p)==-1&&d.push(p)})})});let o=e[r.join(",")]=new sl(r.indexOf(n.length-1)>-1);for(let l=0;l<i.length;l++){let u=i[l][1].sort(VN);o.next.push({type:i[l][0],next:e[u.join(",")]||t(u)})}return o}}function X5(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,l=[];for(let u=0;u<i.next.length;u++){let{type:h,next:d}=i.next[u];l.push(h.name),o&&!(h.isText||h.hasRequiredAttrs())&&(o=!1),r.indexOf(d)==-1&&r.push(d)}o&&e.err("Only non-generatable nodes ("+l.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function jN(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function UN(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function BN(n,e,t,r){for(let i in e)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in n){let o=n[i];o.validate&&o.validate(e[i])}}function zN(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new e9(n,r,e[r]);return t}let IC=class FN{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=zN(e,r.attrs),this.defaultAttrs=jN(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==sl.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:UN(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new oi(this,this.computeAttrs(e),le.from(t),dt.setFrom(r))}createChecked(e=null,t,r){return t=le.from(t),this.checkContent(t),new oi(this,this.computeAttrs(e),t,dt.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=le.from(t),t.size){let l=this.contentMatch.fillBefore(t);if(!l)return null;t=l.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore(le.empty,!0);return o?new oi(this,e,t.append(o),dt.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){BN(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:dt.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,l)=>r[o]=new FN(o,t,l));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function Z5(n,e,t){let r=t.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${o}`)}}class e9{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?Z5(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Ug{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=zN(e,i.attrs),this.excluded=null;let o=jN(this.attrs);this.instance=o?new dt(this,o):null}create(e=null){return!e&&this.instance?this.instance:new dt(this,UN(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,l)=>r[o]=new Ug(o,i++,t,l)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){BN(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class HN{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=Sn.from(e.nodes),t.marks=Sn.from(e.marks||{}),this.nodes=IC.compile(this.spec.nodes,this),this.marks=Ug.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],l=o.spec.content||"",u=o.spec.marks;if(o.contentMatch=r[l]||(r[l]=sl.parse(l,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=u=="_"?null:u?NC(this,u.split(" ")):u==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],l=o.spec.excludes;o.excluded=l==null?[o]:l==""?[]:NC(this,l.split(" "))}this.nodeFromJSON=i=>oi.fromJSON(this,i),this.markFromJSON=i=>dt.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof IC){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new Cm(r,r.defaultAttrs,e,dt.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function NC(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],l=o;if(o)t.push(o);else for(let u in n.marks){let h=n.marks[u];(i=="_"||h.spec.group&&h.spec.group.split(" ").indexOf(i)>-1)&&t.push(l=h)}if(!l)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function t9(n){return n.tag!=null}function n9(n){return n.style!=null}class Uo{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(i=>{if(t9(i))this.tags.push(i);else if(n9(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new OC(this,t,!1);return r.addAll(e,dt.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new OC(this,t,!0);return r.addAll(e,dt.none,t.from,t.to),me.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(s9(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let l=o.getAttrs(e);if(l===!1)continue;o.attrs=l||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let l=this.styles[o],u=l.style;if(!(u.indexOf(e)!=0||l.context&&!r.matchesContext(l.context)||u.length>e.length&&(u.charCodeAt(e.length)!=61||u.slice(e.length+1)!=t))){if(l.getAttrs){let h=l.getAttrs(t);if(h===!1)continue;l.attrs=h||void 0}return l}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,l=0;for(;l<t.length;l++){let u=t[l];if((u.priority==null?50:u.priority)<o)break}t.splice(l,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(l=>{r(l=DC(l)),l.mark||l.ignore||l.clearMark||(l.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(l=>{r(l=DC(l)),l.node||l.ignore||l.mark||(l.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Uo(e,Uo.schemaRules(e)))}}const qN={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},r9={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},$N={ol:!0,ul:!0},of=1,k0=2,Vh=4;function MC(n,e,t){return e!=null?(e?of:0)|(e==="full"?k0:0):n&&n.whitespace=="pre"?of|k0:t&~Vh}class Sp{constructor(e,t,r,i,o,l){this.type=e,this.attrs=t,this.marks=r,this.solid=i,this.options=l,this.content=[],this.activeMarks=dt.none,this.match=o||(l&Vh?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(le.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&of)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=le.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(le.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!qN.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class OC{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=t.topNode,o,l=MC(null,t.preserveWhitespace,0)|(r?Vh:0);i?o=new Sp(i.type,i.attrs,dt.none,!0,t.topMatch||i.type.contentMatch,l):r?o=new Sp(null,null,dt.none,!0,null,l):o=new Sp(e.schema.topNodeType,null,dt.none,!0,null,l),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,i=this.top,o=i.options&k0?"full":this.localPreserveWS||(i.options&of)>0,{schema:l}=this.parser;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)if(o==="full")r=r.replace(/\r\n?/g,`
`);else if(l.linebreakReplacement&&/[\r\n]/.test(r)&&this.top.findWrapping(l.linebreakReplacement.create())){let u=r.split(/\r?\n|\r/);for(let h=0;h<u.length;h++)h&&this.insertNode(l.linebreakReplacement.create(),t,!0),u[h]&&this.insertNode(l.text(u[h]),t,!/\S/.test(u[h]));r=""}else r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let u=i.content[i.content.length-1],h=e.previousSibling;(!u||h&&h.nodeName=="BR"||u.isText&&/[ \t\r\n\u000c]$/.test(u.text))&&(r=r.slice(1))}r&&this.insertNode(l.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let l=e.nodeName.toLowerCase(),u;$N.hasOwnProperty(l)&&this.parser.normalizeLists&&i9(e);let h=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(u=this.parser.matchTag(e,this,r));e:if(h?h.ignore:r9.hasOwnProperty(l))this.findInside(e),this.ignoreFallback(e,t);else if(!h||h.skip||h.closeParent){h&&h.closeParent?this.open=Math.max(0,this.open-1):h&&h.skip.nodeType&&(e=h.skip);let d,p=this.needsBlock;if(qN.hasOwnProperty(l))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),d=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let g=h&&h.skip?t:this.readStyles(e,t);g&&this.addAll(e,g),d&&this.sync(o),this.needsBlock=p}else{let d=this.readStyles(e,t);d&&this.addElementByRule(e,h,d,h.consuming===!1?u:void 0)}this.localPreserveWS=i}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],l=r.getPropertyValue(o);if(l)for(let u=void 0;;){let h=this.parser.matchStyle(o,l,this,u);if(!h)break;if(h.ignore)return null;if(h.clearMark?t=t.filter(d=>!h.clearMark(d)):t=t.concat(this.parser.schema.marks[h.mark].create(h.attrs)),h.consuming===!1)u=h;else break}}return t}addElementByRule(e,t,r,i){let o,l;if(t.node)if(l=this.parser.schema.nodes[t.node],l.isLeaf)this.insertNode(l.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let h=this.enter(l,t.attrs||null,r,t.preserveWhitespace);h&&(o=!0,r=h)}else{let h=this.parser.schema.marks[t.mark];r=r.concat(h.create(t.attrs))}let u=this.top;if(l&&l.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(h=>this.insertNode(h,r,!1));else{let h=e;typeof t.contentElement=="string"?h=e.querySelector(t.contentElement):typeof t.contentElement=="function"?h=t.contentElement(e):t.contentElement&&(h=t.contentElement),this.findAround(e,h,!0),this.addAll(h,r),this.findAround(e,h,!1)}o&&this.sync(u)&&this.open--}addAll(e,t,r,i){let o=r||0;for(let l=r?e.childNodes[r]:e.firstChild,u=i==null?null:e.childNodes[i];l!=u;l=l.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(l,t);this.findAtPoint(e,o)}findPlace(e,t,r){let i,o;for(let l=this.open,u=0;l>=0;l--){let h=this.nodes[l],d=h.findWrapping(e);if(d&&(!i||i.length>d.length+u)&&(i=d,o=h,!d.length))break;if(h.solid){if(r)break;u+=2}}if(!i)return null;this.sync(o);for(let l=0;l<i.length;l++)t=this.enterInner(i[l],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(t=this.enterInner(o,null,t))}let i=this.findPlace(e,t,r);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let l=dt.none;for(let u of i.concat(e.marks))(o.type?o.type.allowsMarkType(u.type):LC(u.type,e.type))&&(l=u.addToSet(l));return o.content.push(e.mark(l)),!0}return!1}enter(e,t,r,i){let o=this.findPlace(e.create(t),r,!1);return o&&(o=this.enterInner(e,t,r,!0,i)),o}enterInner(e,t,r,i=!1,o){this.closeExtra();let l=this.top;l.match=l.match&&l.match.matchType(e);let u=MC(e,o,l.options);l.options&Vh&&l.content.length==0&&(u|=Vh);let h=dt.none;return r=r.filter(d=>(l.type?l.type.allowsMarkType(d.type):LC(d.type,e))?(h=d.addToSet(h),!1):!0),this.nodes.push(new Sp(e,t,h,i,null,u)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=of)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),l=(u,h)=>{for(;u>=0;u--){let d=t[u];if(d==""){if(u==t.length-1||u==0)continue;for(;h>=o;h--)if(l(u-1,h))return!0;return!1}else{let p=h>0||h==0&&i?this.nodes[h].type:r&&h>=o?r.node(h-o).type:null;if(!p||p.name!=d&&!p.isInGroup(d))return!1;h--}}return!0};return l(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function i9(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&$N.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function s9(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function DC(n){let e={};for(let t in n)e[t]=n[t];return e}function LC(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],l=u=>{o.push(u);for(let h=0;h<u.edgeCount;h++){let{type:d,next:p}=u.edge(h);if(d==e||o.indexOf(p)<0&&l(p))return!0}};if(l(i.contentMatch))return!0}}class gl{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=wb(t).createDocumentFragment());let i=r,o=[];return e.forEach(l=>{if(o.length||l.marks.length){let u=0,h=0;for(;u<o.length&&h<l.marks.length;){let d=l.marks[h];if(!this.marks[d.type.name]){h++;continue}if(!d.eq(o[u][0])||d.type.spec.spanning===!1)break;u++,h++}for(;u<o.length;)i=o.pop()[1];for(;h<l.marks.length;){let d=l.marks[h++],p=this.serializeMark(d,l.isInline,t);p&&(o.push([d,i]),i.appendChild(p.dom),i=p.contentDOM||p.dom)}}i.appendChild(this.serializeNodeInner(l,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Qp(wb(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Qp(wb(r),i(e,t),null,e.attrs)}static renderSpec(e,t,r=null,i){return Qp(e,t,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new gl(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=PC(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return PC(e.marks)}}function PC(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function wb(n){return n.document||window.document}const VC=new WeakMap;function o9(n){let e=VC.get(n);return e===void 0&&VC.set(n,e=a9(n)),e}function a9(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)t(r[i]);else for(let i in r)t(r[i])}return t(n),e}function Qp(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=o9(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let l=i.indexOf(" ");l>0&&(t=i.slice(0,l),i=i.slice(l+1));let u,h=t?n.createElementNS(t,i):n.createElement(i),d=e[1],p=1;if(d&&typeof d=="object"&&d.nodeType==null&&!Array.isArray(d)){p=2;for(let g in d)if(d[g]!=null){let b=g.indexOf(" ");b>0?h.setAttributeNS(g.slice(0,b),g.slice(b+1),d[g]):g=="style"&&h.style?h.style.cssText=d[g]:h.setAttribute(g,d[g])}}for(let g=p;g<e.length;g++){let b=e[g];if(b===0){if(g<e.length-1||g>p)throw new RangeError("Content hole must be the only child of its parent node");return{dom:h,contentDOM:h}}else{let{dom:_,contentDOM:T}=Qp(n,b,t,r);if(h.appendChild(_),T){if(u)throw new RangeError("Multiple content holes");u=T}}}return{dom:h,contentDOM:u}}const GN=65535,KN=Math.pow(2,16);function l9(n,e){return n+e*KN}function jC(n){return n&GN}function c9(n){return(n-(n&GN))/KN}const WN=1,QN=2,Yp=4,YN=8;class I0{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&YN)>0}get deletedBefore(){return(this.delInfo&(WN|Yp))>0}get deletedAfter(){return(this.delInfo&(QN|Yp))>0}get deletedAcross(){return(this.delInfo&Yp)>0}}class mr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&mr.empty)return mr.empty}recover(e){let t=0,r=jC(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+c9(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,l=this.inverted?1:2;for(let u=0;u<this.ranges.length;u+=3){let h=this.ranges[u]-(this.inverted?i:0);if(h>e)break;let d=this.ranges[u+o],p=this.ranges[u+l],g=h+d;if(e<=g){let b=d?e==h?-1:e==g?1:t:t,_=h+i+(b<0?0:p);if(r)return _;let T=e==(t<0?h:g)?null:l9(u/3,e-h),x=e==h?QN:e==g?WN:Yp;return(t<0?e!=h:e!=g)&&(x|=YN),new I0(_,x,T)}i+=p-d}return r?e+i:new I0(e+i,0,null)}touches(e,t){let r=0,i=jC(t),o=this.inverted?2:1,l=this.inverted?1:2;for(let u=0;u<this.ranges.length;u+=3){let h=this.ranges[u]-(this.inverted?r:0);if(h>e)break;let d=this.ranges[u+o],p=h+d;if(e<=p&&u==i*3)return!0;r+=this.ranges[u+l]-d}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let l=this.ranges[i],u=l-(this.inverted?o:0),h=l+(this.inverted?0:o),d=this.ranges[i+t],p=this.ranges[i+r];e(u,u+d,h,h+p),o+=p-d}}invert(){return new mr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?mr.empty:new mr(e<0?[0,-e,0]:[0,0,e])}}mr.empty=new mr([]);class af{constructor(e,t,r=0,i=e?e.length:0){this.mirror=t,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new af(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let i=e.getMirror(t);this.appendMap(e._maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e._maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new af;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let l=this._maps[o],u=l.mapResult(e,t);if(u.recover!=null){let h=this.getMirror(o);if(h!=null&&h>o&&h<this.to){o=h,e=this._maps[h].recover(u.recover);continue}}i|=u.delInfo,e=u.pos}return r?e:new I0(e,i,null)}}const Ab=Object.create(null);class jn{getMap(){return mr.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ab[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ab)throw new RangeError("Duplicate use of step JSON ID "+e);return Ab[e]=t,t.prototype.jsonID=e,t}}class Xt{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Xt(e,null)}static fail(e){return new Xt(null,e)}static fromReplace(e,t,r,i){try{return Xt.ok(e.replace(t,r,i))}catch(o){if(o instanceof Sm)return Xt.fail(o.message);throw o}}}function bE(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(bE(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return le.fromArray(r)}class Ro extends jn{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new me(bE(t.content,(l,u)=>!l.isAtom||!u.type.allowsMarkType(this.mark.type)?l:l.mark(this.mark.addToSet(l.marks)),i),t.openStart,t.openEnd);return Xt.fromReplace(e,this.from,this.to,o)}invert(){return new ri(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ro(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ro&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ro(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ro(t.from,t.to,e.markFromJSON(t.mark))}}jn.jsonID("addMark",Ro);class ri extends jn{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new me(bE(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Xt.fromReplace(e,this.from,this.to,r)}invert(){return new Ro(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new ri(t.pos,r.pos,this.mark)}merge(e){return e instanceof ri&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ri(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ri(t.from,t.to,e.markFromJSON(t.mark))}}jn.jsonID("removeMark",ri);class ko extends jn{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Xt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Xt.fromReplace(e,this.pos,this.pos+1,new me(le.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new ko(this.pos,t.marks[i]);return new ko(this.pos,this.mark)}}return new ol(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ko(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ko(t.pos,e.markFromJSON(t.mark))}}jn.jsonID("addNodeMark",ko);class ol extends jn{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Xt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Xt.fromReplace(e,this.pos,this.pos+1,new me(le.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new ko(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ol(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ol(t.pos,e.markFromJSON(t.mark))}}jn.jsonID("removeNodeMark",ol);class fn extends jn{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&N0(e,this.from,this.to)?Xt.fail("Structure replace would overwrite content"):Xt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new mr([this.from,this.to-this.from,this.slice.size])}invert(e){return new fn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new fn(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof fn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?me.empty:new me(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new fn(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?me.empty:new me(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new fn(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new fn(t.from,t.to,me.fromJSON(e,t.slice),!!t.structure)}}jn.jsonID("replace",fn);class mn extends jn{constructor(e,t,r,i,o,l,u=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=l,this.structure=u}apply(e){if(this.structure&&(N0(e,this.from,this.gapFrom)||N0(e,this.gapTo,this.to)))return Xt.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Xt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Xt.fromReplace(e,this.from,this.to,r):Xt.fail("Content does not fit in gap")}getMap(){return new mr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new mn(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new mn(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new mn(t.from,t.to,t.gapFrom,t.gapTo,me.fromJSON(e,t.slice),t.insert,!!t.structure)}}jn.jsonID("replaceAround",mn);function N0(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let l=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!l||l.isLeaf)return!0;l=l.firstChild,i--}}return!1}function u9(n,e,t,r){let i=[],o=[],l,u;n.doc.nodesBetween(e,t,(h,d,p)=>{if(!h.isInline)return;let g=h.marks;if(!r.isInSet(g)&&p.type.allowsMarkType(r.type)){let b=Math.max(d,e),_=Math.min(d+h.nodeSize,t),T=r.addToSet(g);for(let x=0;x<g.length;x++)g[x].isInSet(T)||(l&&l.to==b&&l.mark.eq(g[x])?l.to=_:i.push(l=new ri(b,_,g[x])));u&&u.to==b?u.to=_:o.push(u=new Ro(b,_,r))}}),i.forEach(h=>n.step(h)),o.forEach(h=>n.step(h))}function h9(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(l,u)=>{if(!l.isInline)return;o++;let h=null;if(r instanceof Ug){let d=l.marks,p;for(;p=r.isInSet(d);)(h||(h=[])).push(p),d=p.removeFromSet(d)}else r?r.isInSet(l.marks)&&(h=[r]):h=l.marks;if(h&&h.length){let d=Math.min(u+l.nodeSize,t);for(let p=0;p<h.length;p++){let g=h[p],b;for(let _=0;_<i.length;_++){let T=i[_];T.step==o-1&&g.eq(i[_].style)&&(b=T)}b?(b.to=d,b.step=o):i.push({style:g,from:Math.max(u,e),to:d,step:o})}}}),i.forEach(l=>n.step(new ri(l.from,l.to,l.style)))}function _E(n,e,t,r=t.contentMatch,i=!0){let o=n.doc.nodeAt(e),l=[],u=e+1;for(let h=0;h<o.childCount;h++){let d=o.child(h),p=u+d.nodeSize,g=r.matchType(d.type);if(!g)l.push(new fn(u,p,me.empty));else{r=g;for(let b=0;b<d.marks.length;b++)t.allowsMarkType(d.marks[b].type)||n.step(new ri(u,p,d.marks[b]));if(i&&d.isText&&t.whitespace!="pre"){let b,_=/\r?\n|\r/g,T;for(;b=_.exec(d.text);)T||(T=new me(le.from(t.schema.text(" ",t.allowedMarks(d.marks))),0,0)),l.push(new fn(u+b.index,u+b.index+b[0].length,T))}}u=p}if(!r.validEnd){let h=r.fillBefore(le.empty,!0);n.replace(u,u,new me(h,0,0))}for(let h=l.length-1;h>=0;h--)n.step(l[h])}function f9(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function iu(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth,i=0,o=0;;--r){let l=n.$from.node(r),u=n.$from.index(r)+i,h=n.$to.indexAfter(r)-o;if(r<n.depth&&l.canReplace(u,h,t))return r;if(r==0||l.type.spec.isolating||!f9(l,u,h))break;u&&(i=1),h<l.childCount&&(o=1)}return null}function d9(n,e,t){let{$from:r,$to:i,depth:o}=e,l=r.before(o+1),u=i.after(o+1),h=l,d=u,p=le.empty,g=0;for(let T=o,x=!1;T>t;T--)x||r.index(T)>0?(x=!0,p=le.from(r.node(T).copy(p)),g++):h--;let b=le.empty,_=0;for(let T=o,x=!1;T>t;T--)x||i.after(T+1)<i.end(T)?(x=!0,b=le.from(i.node(T).copy(b)),_++):d++;n.step(new mn(h,d,l,u,new me(p.append(b),g,_),p.size-g,!0))}function EE(n,e,t=null,r=n){let i=p9(n,e),o=i&&m9(r,e);return o?i.map(UC).concat({type:e,attrs:t}).concat(o.map(UC)):null}function UC(n){return{type:n,attrs:null}}function p9(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let l=o.length?o[0]:e;return t.canReplaceWith(r,i,l)?o:null}function m9(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),l=e.contentMatch.findWrapping(o.type);if(!l)return null;let h=(l.length?l[l.length-1]:e).contentMatch;for(let d=r;h&&d<i;d++)h=h.matchType(t.child(d).type);return!h||!h.validEnd?null:l}function g9(n,e,t){let r=le.empty;for(let l=t.length-1;l>=0;l--){if(r.size){let u=t[l].type.contentMatch.matchFragment(r);if(!u||!u.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=le.from(t[l].type.create(t[l].attrs,r))}let i=e.start,o=e.end;n.step(new mn(i,o,i,o,new me(r,0,0),t.length,!0))}function y9(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(l,u)=>{let h=typeof i=="function"?i(l):i;if(l.isTextblock&&!l.hasMarkup(r,h)&&v9(n.doc,n.mapping.slice(o).map(u),r)){let d=null;if(r.schema.linebreakReplacement){let _=r.whitespace=="pre",T=!!r.contentMatch.matchType(r.schema.linebreakReplacement);_&&!T?d=!1:!_&&T&&(d=!0)}d===!1&&XN(n,l,u,o),_E(n,n.mapping.slice(o).map(u,1),r,void 0,d===null);let p=n.mapping.slice(o),g=p.map(u,1),b=p.map(u+l.nodeSize,1);return n.step(new mn(g,b,g+1,b-1,new me(le.from(r.create(h,null,l.marks)),0,0),1,!0)),d===!0&&JN(n,l,u,o),!1}})}function JN(n,e,t,r){e.forEach((i,o)=>{if(i.isText){let l,u=/\r?\n|\r/g;for(;l=u.exec(i.text);){let h=n.mapping.slice(r).map(t+1+o+l.index);n.replaceWith(h,h+1,e.type.schema.linebreakReplacement.create())}}})}function XN(n,e,t,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let l=n.mapping.slice(r).map(t+1+o);n.replaceWith(l,l+1,e.type.schema.text(`
`))}})}function v9(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function b9(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let l=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,l);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new mn(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new me(le.from(l),0,0),1,!0))}function Cs(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,l=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!l.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let d=i.depth-1,p=t-2;d>o;d--,p--){let g=i.node(d),b=i.index(d);if(g.type.spec.isolating)return!1;let _=g.content.cutByIndex(b,g.childCount),T=r&&r[p+1];T&&(_=_.replaceChild(0,T.type.create(T.attrs)));let x=r&&r[p]||g;if(!g.canReplace(b+1,g.childCount)||!x.type.validContent(_))return!1}let u=i.indexAfter(o),h=r&&r[0];return i.node(o).canReplaceWith(u,u,h?h.type:i.node(o+1).type)}function _9(n,e,t=1,r){let i=n.doc.resolve(e),o=le.empty,l=le.empty;for(let u=i.depth,h=i.depth-t,d=t-1;u>h;u--,d--){o=le.from(i.node(u).copy(o));let p=r&&r[d];l=le.from(p?p.type.create(p.attrs,l):i.node(u).copy(l))}n.step(new fn(e,e,new me(o.append(l),t,t),!0))}function ia(n,e){let t=n.resolve(e),r=t.index();return ZN(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function E9(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),l=o.type==r?n.type.schema.nodes.text:o.type;if(t=t.matchType(l),!t||!n.type.allowsMarks(o.marks))return!1}return t.validEnd}function ZN(n,e){return!!(n&&e&&!n.isLeaf&&E9(n,e))}function Bg(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let o,l,u=r.index(i);if(i==r.depth?(o=r.nodeBefore,l=r.nodeAfter):t>0?(o=r.node(i+1),u++,l=r.node(i).maybeChild(u)):(o=r.node(i).maybeChild(u-1),l=r.node(i+1)),o&&!o.isTextblock&&ZN(o,l)&&r.node(i).canReplace(u,u+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function T9(n,e,t){let r=null,{linebreakReplacement:i}=n.doc.type.schema,o=n.doc.resolve(e-t),l=o.node().type;if(i&&l.inlineContent){let p=l.whitespace=="pre",g=!!l.contentMatch.matchType(i);p&&!g?r=!1:!p&&g&&(r=!0)}let u=n.steps.length;if(r===!1){let p=n.doc.resolve(e+t);XN(n,p.node(),p.before(),u)}l.inlineContent&&_E(n,e+t-1,l,o.node().contentMatchAt(o.index()),r==null);let h=n.mapping.slice(u),d=h.map(e-t);if(n.step(new fn(d,h.map(e+t,-1),me.empty,!0)),r===!0){let p=n.doc.resolve(d);JN(n,p.node(),p.before(),n.steps.length)}return n}function S9(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function eM(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let l=r.depth;l>=0;l--){let u=l==r.depth?0:r.pos<=(r.start(l+1)+r.end(l+1))/2?-1:1,h=r.index(l)+(u>0?1:0),d=r.node(l),p=!1;if(o==1)p=d.canReplace(h,h,i);else{let g=d.contentMatchAt(h).findWrapping(i.firstChild.type);p=g&&d.canReplaceWith(h,h,g[0])}if(p)return u==0?r.pos:u<0?r.before(l+1):r.after(l+1)}return null}function zg(n,e,t=e,r=me.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return tM(i,o,r)?new fn(e,t,r):new w9(i,o,r).fit()}function tM(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class w9{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=le.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=le.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,l=r.depth,u=i.depth;for(;l&&u&&o.childCount==1;)o=o.firstChild.content,l--,u--;let h=new me(o,l,u);return e>-1?new mn(r.pos,e,this.$to.pos,this.$to.end(),h,t):h.size||r.pos!=this.$to.pos?new fn(r.pos,i.pos,h):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Cb(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let l=i.firstChild;for(let u=this.depth;u>=0;u--){let{type:h,match:d}=this.frontier[u],p,g=null;if(t==1&&(l?d.matchType(l.type)||(g=d.fillBefore(le.from(l),!1)):o&&h.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:u,parent:o,inject:g};if(t==2&&l&&(p=d.findWrapping(l.type)))return{sliceDepth:r,frontierDepth:u,parent:o,wrap:p};if(o&&d.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Cb(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new me(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Cb(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new me(Sh(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new me(Sh(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let x=0;x<o.length;x++)this.openFrontierNode(o[x]);let l=this.unplaced,u=r?r.content:l.content,h=l.openStart-e,d=0,p=[],{match:g,type:b}=this.frontier[t];if(i){for(let x=0;x<i.childCount;x++)p.push(i.child(x));g=g.matchFragment(i)}let _=u.size+e-(l.content.size-l.openEnd);for(;d<u.childCount;){let x=u.child(d),A=g.matchType(x.type);if(!A)break;d++,(d>1||h==0||x.content.size)&&(g=A,p.push(nM(x.mark(b.allowedMarks(x.marks)),d==1?h:0,d==u.childCount?_:-1)))}let T=d==u.childCount;T||(_=-1),this.placed=wh(this.placed,t,le.from(p)),this.frontier[t].match=g,T&&_<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let x=0,A=u;x<_;x++){let R=A.lastChild;this.frontier.push({type:R.type,match:R.contentMatchAt(R.childCount)}),A=R.content}this.unplaced=T?e==0?me.empty:new me(Sh(l.content,e-1,1),e-1,_<0?l.openEnd:e-1):new me(Sh(l.content,e,d),l.openStart,l.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!xb(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),l=xb(e,t,i,r,o);if(l){for(let u=t-1;u>=0;u--){let{match:h,type:d}=this.frontier[u],p=xb(e,u,d,h,!0);if(!p||p.childCount)continue e}return{depth:t,fit:l,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=wh(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=wh(this.placed,this.depth,le.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(le.empty,!0);t.childCount&&(this.placed=wh(this.placed,this.frontier.length,t))}}function Sh(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Sh(n.firstChild.content,e-1,t)))}function wh(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(wh(n.lastChild.content,e-1,t)))}function Cb(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function nM(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,nM(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(le.empty,!0)))),n.copy(r)}function xb(n,e,t,r,i){let o=n.node(e),l=i?n.indexAfter(e):n.index(e);if(l==o.childCount&&!t.compatibleContent(o.type))return null;let u=r.fillBefore(o.content,!0,l);return u&&!A9(t,o.content,l)?u:null}function A9(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function C9(n){return n.spec.defining||n.spec.definingForContent}function x9(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(tM(i,o,r))return n.step(new fn(e,t,r));let l=iM(i,o);l[l.length-1]==0&&l.pop();let u=-(i.depth+1);l.unshift(u);for(let b=i.depth,_=i.pos-1;b>0;b--,_--){let T=i.node(b).type.spec;if(T.defining||T.definingAsContext||T.isolating)break;l.indexOf(b)>-1?u=b:i.before(b)==_&&l.splice(1,0,-b)}let h=l.indexOf(u),d=[],p=r.openStart;for(let b=r.content,_=0;;_++){let T=b.firstChild;if(d.push(T),_==r.openStart)break;b=T.content}for(let b=p-1;b>=0;b--){let _=d[b],T=C9(_.type);if(T&&!_.sameMarkup(i.node(Math.abs(u)-1)))p=b;else if(T||!_.type.isTextblock)break}for(let b=r.openStart;b>=0;b--){let _=(b+p+1)%(r.openStart+1),T=d[_];if(T)for(let x=0;x<l.length;x++){let A=l[(x+h)%l.length],R=!0;A<0&&(R=!1,A=-A);let M=i.node(A-1),j=i.index(A-1);if(M.canReplaceWith(j,j,T.type,T.marks))return n.replace(i.before(A),R?o.after(A):t,new me(rM(r.content,0,r.openStart,_),_,r.openEnd))}}let g=n.steps.length;for(let b=l.length-1;b>=0&&(n.replace(e,t,r),!(n.steps.length>g));b--){let _=l[b];_<0||(e=i.before(_),t=o.after(_))}}function rM(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(rM(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),l=o.fillBefore(n).append(n);n=l.append(o.matchFragment(l).fillBefore(le.empty,!0))}return n}function R9(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=S9(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new me(le.from(r),0,0))}function k9(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=iM(r,i);for(let l=0;l<o.length;l++){let u=o[l],h=l==o.length-1;if(h&&u==0||r.node(u).type.contentMatch.validEnd)return n.delete(r.start(u),i.end(u));if(u>0&&(h||r.node(u-1).canReplace(r.index(u-1),i.indexAfter(u-1))))return n.delete(r.before(u),i.after(u))}for(let l=1;l<=r.depth&&l<=i.depth;l++)if(e-r.start(l)==r.depth-l&&t>r.end(l)&&i.end(l)-t!=i.depth-l&&r.start(l-1)==i.start(l-1)&&r.node(l-1).canReplace(r.index(l-1),i.index(l-1)))return n.delete(r.before(l),t);n.delete(e,t)}function iM(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}class xc extends jn{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Xt.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Xt.fromReplace(e,this.pos,this.pos+1,new me(le.from(i),0,t.isLeaf?0:1))}getMap(){return mr.empty}invert(e){return new xc(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new xc(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new xc(t.pos,t.attr,t.value)}}jn.jsonID("attr",xc);class lf extends jn{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return Xt.ok(r)}getMap(){return mr.empty}invert(e){return new lf(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new lf(t.attr,t.value)}}jn.jsonID("docAttr",lf);let zc=class extends Error{};zc=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};zc.prototype=Object.create(Error.prototype);zc.prototype.constructor=zc;zc.prototype.name="TransformError";class sM{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new af}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new zc(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,t=-1e9;for(let r=0;r<this.mapping.maps.length;r++){let i=this.mapping.maps[r];r&&(e=i.map(e,1),t=i.map(t,-1)),i.forEach((o,l,u,h)=>{e=Math.min(e,u),t=Math.max(t,h)})}return e==1e9?null:{from:e,to:t}}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=me.empty){let i=zg(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new me(le.from(r),0,0))}delete(e,t){return this.replace(e,t,me.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return x9(this,e,t,r),this}replaceRangeWith(e,t,r){return R9(this,e,t,r),this}deleteRange(e,t){return k9(this,e,t),this}lift(e,t){return d9(this,e,t),this}join(e,t=1){return T9(this,e,t),this}wrap(e,t){return g9(this,e,t),this}setBlockType(e,t=e,r,i=null){return y9(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return b9(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new xc(e,t,r)),this}setDocAttribute(e,t){return this.step(new lf(e,t)),this}addNodeMark(e,t){return this.step(new ko(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof dt)t.isInSet(r.marks)&&this.step(new ol(e,t));else{let i=r.marks,o,l=[];for(;o=t.isInSet(i);)l.push(new ol(e,o)),i=o.removeFromSet(i);for(let u=l.length-1;u>=0;u--)this.step(l[u])}return this}split(e,t=1,r){return _9(this,e,t,r),this}addMark(e,t,r){return u9(this,e,t,r),this}removeMark(e,t,r){return h9(this,e,t,r),this}clearIncompatible(e,t,r){return _E(this,e,t,r),this}}const Rb=Object.create(null);class Ue{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new I9(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=me.empty){let r=t.content.lastChild,i=null;for(let u=0;u<t.openEnd;u++)i=r,r=r.lastChild;let o=e.steps.length,l=this.ranges;for(let u=0;u<l.length;u++){let{$from:h,$to:d}=l[u],p=e.mapping.slice(o);e.replaceRange(p.map(h.pos),p.map(d.pos),u?me.empty:t),u==0&&FC(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:l,$to:u}=i[o],h=e.mapping.slice(r),d=h.map(l.pos),p=h.map(u.pos);o?e.deleteRange(d,p):(e.replaceRangeWith(d,p,t),FC(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new Ne(e):mc(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let l=t<0?mc(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):mc(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(l)return l}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new br(e.node(0))}static atStart(e){return mc(e,e,0,0,1)||new br(e)}static atEnd(e){return mc(e,e,e.content.size,e.childCount,-1)||new br(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Rb[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Rb)throw new RangeError("Duplicate use of selection JSON ID "+e);return Rb[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Ne.between(this.$anchor,this.$head).getBookmark()}}Ue.prototype.visible=!0;class I9{constructor(e,t){this.$from=e,this.$to=t}}let BC=!1;function zC(n){!BC&&!n.parent.inlineContent&&(BC=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class Ne extends Ue{constructor(e,t=e){zC(e),zC(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return Ue.near(r);let i=e.resolve(t.map(this.anchor));return new Ne(i.parent.inlineContent?i:r,r)}replace(e,t=me.empty){if(super.replace(e,t),t==me.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Ne&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Fg(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ne(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=Ue.findFrom(t,r,!0)||Ue.findFrom(t,-r,!0);if(o)t=o.$head;else return Ue.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(Ue.findFrom(e,-r,!0)||Ue.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new Ne(e,t)}}Ue.jsonID("text",Ne);class Fg{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Fg(e.map(this.anchor),e.map(this.head))}resolve(e){return Ne.between(e.resolve(this.anchor),e.resolve(this.head))}}class we extends Ue{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?Ue.near(o):new we(o)}content(){return new me(le.from(this.node),0,0)}eq(e){return e instanceof we&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new TE(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new we(e.resolve(t.anchor))}static create(e,t){return new we(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}we.prototype.visible=!1;Ue.jsonID("node",we);class TE{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Fg(r,r):new TE(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&we.isSelectable(r)?new we(t):Ue.near(t)}}class br extends Ue{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=me.empty){if(t==me.empty){e.delete(0,e.doc.content.size);let r=Ue.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new br(e)}map(e){return new br(e)}eq(e){return e instanceof br}getBookmark(){return N9}}Ue.jsonID("all",br);const N9={map(){return this},resolve(n){return new br(n)}};function mc(n,e,t,r,i,o=!1){if(e.inlineContent)return Ne.create(n,t);for(let l=r-(i>0?0:1);i>0?l<e.childCount:l>=0;l+=i){let u=e.child(l);if(u.isAtom){if(!o&&we.isSelectable(u))return we.create(n,t-(i<0?u.nodeSize:0))}else{let h=mc(n,u,t+i,i<0?u.childCount:0,i,o);if(h)return h}t+=u.nodeSize*i}return null}function FC(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof fn||i instanceof mn))return;let o=n.mapping.maps[r],l;o.forEach((u,h,d,p)=>{l==null&&(l=p)}),n.setSelection(Ue.near(n.doc.resolve(l),t))}const HC=1,wp=2,qC=4;class M9 extends sM{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|HC)&~wp,this.storedMarks=null,this}get selectionSet(){return(this.updated&HC)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=wp,this}ensureMarks(e){return dt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&wp)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~wp,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||dt.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let l=this.doc.resolve(t);o=r==t?l.marks():l.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,o)),!this.selection.empty&&this.selection.to==t+e.length&&this.setSelection(Ue.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=qC,this}get scrolledIntoView(){return(this.updated&qC)>0}}function $C(n,e){return!e||!n?n:n.bind(e)}class Ah{constructor(e,t,r){this.name=e,this.init=$C(t.init,r),this.apply=$C(t.apply,r)}}const O9=[new Ah("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Ah("selection",{init(n,e){return n.selection||Ue.atStart(e.doc)},apply(n){return n.selection}}),new Ah("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Ah("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class kb{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=O9.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Ah(r.key,r.spec.state,r))})}}class _c{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let l=0;l<this.config.plugins.length;l++){let u=this.config.plugins[l];if(u.spec.appendTransaction){let h=i?i[l].n:0,d=i?i[l].state:this,p=h<t.length&&u.spec.appendTransaction.call(u,h?t.slice(h):t,d,r);if(p&&r.filterTransaction(p,l)){if(p.setMeta("appendedTransaction",e),!i){i=[];for(let g=0;g<this.config.plugins.length;g++)i.push(g<l?{state:r,n:t.length}:{state:this,n:0})}t.push(p),r=r.applyInner(p),o=!0}i&&(i[l]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new _c(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new M9(this)}static create(e){let t=new kb(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new _c(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new kb(this.schema,e.plugins),r=t.fields,i=new _c(t);for(let o=0;o<r.length;o++){let l=r[o].name;i[l]=this.hasOwnProperty(l)?this[l]:r[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new kb(e.schema,e.plugins),o=new _c(i);return i.fields.forEach(l=>{if(l.name=="doc")o.doc=oi.fromJSON(e.schema,t.doc);else if(l.name=="selection")o.selection=Ue.fromJSON(o.doc,t.selection);else if(l.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let u in r){let h=r[u],d=h.spec.state;if(h.key==l.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(t,u)){o[l.name]=d.fromJSON.call(h,e,t[u],o);return}}o[l.name]=l.init(e,o)}}),o}}function oM(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=oM(i,e,{})),t[r]=i}return t}class At{constructor(e){this.spec=e,this.props={},e.props&&oM(e.props,this,this.props),this.key=e.key?e.key.key:aM("plugin")}getState(e){return e[this.key]}}const Ib=Object.create(null);function aM(n){return n in Ib?n+"$"+ ++Ib[n]:(Ib[n]=0,n+"$")}class on{constructor(e="key"){this.key=aM(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const SE=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function lM(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const cM=(n,e,t)=>{let r=lM(n,t);if(!r)return!1;let i=wE(r);if(!i){let l=r.blockRange(),u=l&&iu(l);return u==null?!1:(e&&e(n.tr.lift(l,u).scrollIntoView()),!0)}let o=i.nodeBefore;if(vM(n,i,e,-1))return!0;if(r.parent.content.size==0&&(Fc(o,"end")||we.isSelectable(o)))for(let l=r.depth;;l--){let u=zg(n.doc,r.before(l),r.after(l),me.empty);if(u&&u.slice.size<u.to-u.from){if(e){let h=n.tr.step(u);h.setSelection(Fc(o,"end")?Ue.findFrom(h.doc.resolve(h.mapping.map(i.pos,-1)),-1):we.create(h.doc,i.pos-o.nodeSize)),e(h.scrollIntoView())}return!0}if(l==1||r.node(l-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},D9=(n,e,t)=>{let r=lM(n,t);if(!r)return!1;let i=wE(r);return i?uM(n,i,e):!1},L9=(n,e,t)=>{let r=fM(n,t);if(!r)return!1;let i=AE(r);return i?uM(n,i,e):!1};function uM(n,e,t){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let p=i.lastChild;if(!p)return!1;i=p}let l=e.nodeAfter,u=l,h=e.pos+1;for(;!u.isTextblock;h++){if(u.type.spec.isolating)return!1;let p=u.firstChild;if(!p)return!1;u=p}let d=zg(n.doc,o,h,me.empty);if(!d||d.from!=o||d instanceof fn&&d.slice.size>=h-o)return!1;if(t){let p=n.tr.step(d);p.setSelection(Ne.create(p.doc,o)),t(p.scrollIntoView())}return!0}function Fc(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const hM=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=wE(r)}let l=o&&o.nodeBefore;return!l||!we.isSelectable(l)?!1:(e&&e(n.tr.setSelection(we.create(n.doc,o.pos-l.nodeSize)).scrollIntoView()),!0)};function wE(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function fM(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const dM=(n,e,t)=>{let r=fM(n,t);if(!r)return!1;let i=AE(r);if(!i)return!1;let o=i.nodeAfter;if(vM(n,i,e,1))return!0;if(r.parent.content.size==0&&(Fc(o,"start")||we.isSelectable(o))){let l=zg(n.doc,r.before(),r.after(),me.empty);if(l&&l.slice.size<l.to-l.from){if(e){let u=n.tr.step(l);u.setSelection(Fc(o,"start")?Ue.findFrom(u.doc.resolve(u.mapping.map(i.pos)),1):we.create(u.doc,u.mapping.map(i.pos))),e(u.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},pM=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=AE(r)}let l=o&&o.nodeAfter;return!l||!we.isSelectable(l)?!1:(e&&e(n.tr.setSelection(we.create(n.doc,o.pos)).scrollIntoView()),!0)};function AE(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const P9=(n,e)=>{let t=n.selection,r=t instanceof we,i;if(r){if(t.node.isTextblock||!ia(n.doc,t.from))return!1;i=t.from}else if(i=Bg(n.doc,t.from,-1),i==null)return!1;if(e){let o=n.tr.join(i);r&&o.setSelection(we.create(o.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},V9=(n,e)=>{let t=n.selection,r;if(t instanceof we){if(t.node.isTextblock||!ia(n.doc,t.to))return!1;r=t.to}else if(r=Bg(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},j9=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),o=i&&iu(i);return o==null?!1:(e&&e(n.tr.lift(i,o).scrollIntoView()),!0)},mM=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function CE(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const U9=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),l=CE(i.contentMatchAt(o));if(!l||!i.canReplaceWith(o,o,l))return!1;if(e){let u=t.after(),h=n.tr.replaceWith(u,u,l.createAndFill());h.setSelection(Ue.near(h.doc.resolve(u),1)),e(h.scrollIntoView())}return!0},gM=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof br||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=CE(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let l=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,u=n.tr.insert(l,o.createAndFill());u.setSelection(Ne.create(u.doc,l+1)),e(u.scrollIntoView())}return!0},yM=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(Cs(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&iu(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)};function B9(n){return(e,t)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof we&&e.selection.node.isBlock)return!r.parentOffset||!Cs(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],l,u,h=!1,d=!1;for(let _=r.depth;;_--)if(r.node(_).isBlock){h=r.end(_)==r.pos+(r.depth-_),d=r.start(_)==r.pos-(r.depth-_),u=CE(r.node(_-1).contentMatchAt(r.indexAfter(_-1))),o.unshift(h&&u?{type:u}:null),l=_;break}else{if(_==1)return!1;o.unshift(null)}let p=e.tr;(e.selection instanceof Ne||e.selection instanceof br)&&p.deleteSelection();let g=p.mapping.map(r.pos),b=Cs(p.doc,g,o.length,o);if(b||(o[0]=u?{type:u}:null,b=Cs(p.doc,g,o.length,o)),!b)return!1;if(p.split(g,o.length,o),!h&&d&&r.node(l).type!=u){let _=p.mapping.map(r.before(l)),T=p.doc.resolve(_);u&&r.node(l-1).canReplaceWith(T.index(),T.index()+1,u)&&p.setNodeMarkup(p.mapping.map(r.before(l)),u)}return t&&t(p.scrollIntoView()),!0}}const z9=B9(),F9=(n,e)=>{let{$from:t,to:r}=n.selection,i,o=t.sharedDepth(r);return o==0?!1:(i=t.before(o),e&&e(n.tr.setSelection(we.create(n.doc,i))),!0)};function H9(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||ia(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function vM(n,e,t,r){let i=e.nodeBefore,o=e.nodeAfter,l,u,h=i.type.spec.isolating||o.type.spec.isolating;if(!h&&H9(n,e,t))return!0;let d=!h&&e.parent.canReplace(e.index(),e.index()+1);if(d&&(l=(u=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&u.matchType(l[0]||o.type).validEnd){if(t){let _=e.pos+o.nodeSize,T=le.empty;for(let R=l.length-1;R>=0;R--)T=le.from(l[R].create(null,T));T=le.from(i.copy(T));let x=n.tr.step(new mn(e.pos-1,_,e.pos,_,new me(T,1,0),l.length,!0)),A=x.doc.resolve(_+2*l.length);A.nodeAfter&&A.nodeAfter.type==i.type&&ia(x.doc,A.pos)&&x.join(A.pos),t(x.scrollIntoView())}return!0}let p=o.type.spec.isolating||r>0&&h?null:Ue.findFrom(e,1),g=p&&p.$from.blockRange(p.$to),b=g&&iu(g);if(b!=null&&b>=e.depth)return t&&t(n.tr.lift(g,b).scrollIntoView()),!0;if(d&&Fc(o,"start",!0)&&Fc(i,"end")){let _=i,T=[];for(;T.push(_),!_.isTextblock;)_=_.lastChild;let x=o,A=1;for(;!x.isTextblock;x=x.firstChild)A++;if(_.canReplace(_.childCount,_.childCount,x.content)){if(t){let R=le.empty;for(let j=T.length-1;j>=0;j--)R=le.from(T[j].copy(R));let M=n.tr.step(new mn(e.pos-T.length,e.pos+o.nodeSize,e.pos+A,e.pos+o.nodeSize-A,new me(R,T.length,0),0,!0));t(M.scrollIntoView())}return!0}}return!1}function bM(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection(Ne.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const q9=bM(-1),$9=bM(1);function G9(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,l=i.blockRange(o),u=l&&EE(l,n,e);return u?(r&&r(t.tr.wrap(l,u).scrollIntoView()),!0):!1}}function GC(n,e=null){return function(t,r){let i=!1;for(let o=0;o<t.selection.ranges.length&&!i;o++){let{$from:{pos:l},$to:{pos:u}}=t.selection.ranges[o];t.doc.nodesBetween(l,u,(h,d)=>{if(i)return!1;if(!(!h.isTextblock||h.hasMarkup(n,e)))if(h.type==n)i=!0;else{let p=t.doc.resolve(d),g=p.index();i=p.parent.canReplaceWith(g,g+1,n)}})}if(!i)return!1;if(r){let o=t.tr;for(let l=0;l<t.selection.ranges.length;l++){let{$from:{pos:u},$to:{pos:h}}=t.selection.ranges[l];o.setBlockType(u,h,n,e)}r(o.scrollIntoView())}return!0}}function xE(...n){return function(e,t,r){for(let i=0;i<n.length;i++)if(n[i](e,t,r))return!0;return!1}}xE(SE,cM,hM);xE(SE,dM,pM);xE(mM,gM,yM,z9);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function K9(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,l=i.blockRange(o);if(!l)return!1;let u=r?t.tr:null;return W9(u,l,n,e)?(r&&r(u.scrollIntoView()),!0):!1}}function W9(n,e,t,r=null){let i=!1,o=e,l=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let h=l.resolve(e.start-2);o=new Am(h,h,e.depth),e.endIndex<e.parent.childCount&&(e=new Am(e.$from,l.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let u=EE(o,t,r,e);return u?(n&&Q9(n,e,u,i,t),!0):!1}function Q9(n,e,t,r,i){let o=le.empty;for(let p=t.length-1;p>=0;p--)o=le.from(t[p].type.create(t[p].attrs,o));n.step(new mn(e.start-(r?2:0),e.end,e.start,e.end,new me(o,0,0),t.length,!0));let l=0;for(let p=0;p<t.length;p++)t[p].type==i&&(l=p+1);let u=t.length-l,h=e.start+t.length-(r?2:0),d=e.parent;for(let p=e.startIndex,g=e.endIndex,b=!0;p<g;p++,b=!1)!b&&Cs(n.doc,h,u)&&(n.split(h,u),h+=2*u),h+=d.child(p).nodeSize;return n}function Y9(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,l=>l.childCount>0&&l.firstChild.type==n);return o?t?r.node(o.depth-1).type==n?J9(e,t,n,o):X9(e,t,o):!0:!1}}function J9(n,e,t,r){let i=n.tr,o=r.end,l=r.$to.end(r.depth);o<l&&(i.step(new mn(o-1,l,o,l,new me(le.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Am(i.doc.resolve(r.$from.pos),i.doc.resolve(l),r.depth));const u=iu(r);if(u==null)return!1;i.lift(r,u);let h=i.doc.resolve(i.mapping.map(o,-1)-1);return ia(i.doc,h.pos)&&h.nodeBefore.type==h.nodeAfter.type&&i.join(h.pos),e(i.scrollIntoView()),!0}function X9(n,e,t){let r=n.tr,i=t.parent;for(let _=t.end,T=t.endIndex-1,x=t.startIndex;T>x;T--)_-=i.child(T).nodeSize,r.delete(_-1,_+1);let o=r.doc.resolve(t.start),l=o.nodeAfter;if(r.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let u=t.startIndex==0,h=t.endIndex==i.childCount,d=o.node(-1),p=o.index(-1);if(!d.canReplace(p+(u?0:1),p+1,l.content.append(h?le.empty:le.from(i))))return!1;let g=o.pos,b=g+l.nodeSize;return r.step(new mn(g-(u?1:0),b+(h?1:0),g+1,b-1,new me((u?le.empty:le.from(i.copy(le.empty))).append(h?le.empty:le.from(i.copy(le.empty))),u?0:1,h?0:1),u?0:1)),e(r.scrollIntoView()),!0}function Z9(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,d=>d.childCount>0&&d.firstChild.type==n);if(!o)return!1;let l=o.startIndex;if(l==0)return!1;let u=o.parent,h=u.child(l-1);if(h.type!=n)return!1;if(t){let d=h.lastChild&&h.lastChild.type==u.type,p=le.from(d?n.create():null),g=new me(le.from(n.create(null,le.from(u.type.create(null,p)))),d?3:1,0),b=o.start,_=o.end;t(e.tr.step(new mn(b-(d?3:1),_,b,_,g,1,!0)).scrollIntoView())}return!0}}const An=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Hc=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let M0=null;const Es=function(n,e,t){let r=M0||(M0=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},eF=function(){M0=null},al=function(n,e,t,r){return t&&(KC(n,e,t,r,-1)||KC(n,e,t,r,1))},tF=/^(img|br|input|textarea|hr)$/i;function KC(n,e,t,r,i){for(var o;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Ur(n))){let l=n.parentNode;if(!l||l.nodeType!=1||Of(n)||tF.test(n.nodeName)||n.contentEditable=="false")return!1;e=An(n)+(i<0?0:1),n=l}else if(n.nodeType==1){let l=n.childNodes[e+(i<0?-1:0)];if(l.nodeType==1&&l.contentEditable=="false")if(!((o=l.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=i;else return!1;else n=l,e=i<0?Ur(n):0}else return!1}}function Ur(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function nF(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=Ur(n)}else if(n.parentNode&&!Of(n))e=An(n),n=n.parentNode;else return null}}function rF(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Of(n))e=An(n)+1,n=n.parentNode;else return null}}function iF(n,e,t){for(let r=e==0,i=e==Ur(n);r||i;){if(n==t)return!0;let o=An(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==Ur(n)}}function Of(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Hg=function(n){return n.focusNode&&al(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Ba(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function sF(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function oF(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(Ur(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(Ur(r.startContainer),r.startOffset)}}}const Gi=typeof navigator<"u"?navigator:null,WC=typeof document<"u"?document:null,sa=Gi&&Gi.userAgent||"",O0=/Edge\/(\d+)/.exec(sa),_M=/MSIE \d/.exec(sa),D0=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(sa),ir=!!(_M||D0||O0),Bo=_M?document.documentMode:D0?+D0[1]:O0?+O0[1]:0,Br=!ir&&/gecko\/(\d+)/i.test(sa);Br&&+(/Firefox\/(\d+)/.exec(sa)||[0,0])[1];const L0=!ir&&/Chrome\/(\d+)/.exec(sa),In=!!L0,EM=L0?+L0[1]:0,Vn=!ir&&!!Gi&&/Apple Computer/.test(Gi.vendor),qc=Vn&&(/Mobile\/\w+/.test(sa)||!!Gi&&Gi.maxTouchPoints>2),Vr=qc||(Gi?/Mac/.test(Gi.platform):!1),TM=Gi?/Win/.test(Gi.platform):!1,ws=/Android \d/.test(sa),Df=!!WC&&"webkitFontSmoothing"in WC.documentElement.style,aF=Df?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function lF(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function ys(n,e){return typeof n=="number"?n:n[e]}function cF(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function QC(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let l=t||n.dom;l;){if(l.nodeType!=1){l=Hc(l);continue}let u=l,h=u==o.body,d=h?lF(o):cF(u),p=0,g=0;if(e.top<d.top+ys(r,"top")?g=-(d.top-e.top+ys(i,"top")):e.bottom>d.bottom-ys(r,"bottom")&&(g=e.bottom-e.top>d.bottom-d.top?e.top+ys(i,"top")-d.top:e.bottom-d.bottom+ys(i,"bottom")),e.left<d.left+ys(r,"left")?p=-(d.left-e.left+ys(i,"left")):e.right>d.right-ys(r,"right")&&(p=e.right-d.right+ys(i,"right")),p||g)if(h)o.defaultView.scrollBy(p,g);else{let _=u.scrollLeft,T=u.scrollTop;g&&(u.scrollTop+=g),p&&(u.scrollLeft+=p);let x=u.scrollLeft-_,A=u.scrollTop-T;e={left:e.left-x,top:e.top-A,right:e.right-x,bottom:e.bottom-A}}let b=h?"fixed":getComputedStyle(l).position;if(/^(fixed|sticky)$/.test(b))break;l=b=="absolute"?l.offsetParent:Hc(l)}}function uF(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,l=t+1;l<Math.min(innerHeight,e.bottom);l+=5){let u=n.root.elementFromPoint(o,l);if(!u||u==n.dom||!n.dom.contains(u))continue;let h=u.getBoundingClientRect();if(h.top>=t-20){r=u,i=h.top;break}}return{refDOM:r,refTop:i,stack:SM(n.dom)}}function SM(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Hc(r));return e}function hF({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;wM(t,r==0?0:r-e)}function wM(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:o}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let cc=null;function fF(n){if(n.setActive)return n.setActive();if(cc)return n.focus(cc);let e=SM(n);n.focus(cc==null?{get preventScroll(){return cc={preventScroll:!0},!0}}:void 0),cc||(cc=!1,wM(e,0))}function AM(n,e){let t,r=2e8,i,o=0,l=e.top,u=e.top,h,d;for(let p=n.firstChild,g=0;p;p=p.nextSibling,g++){let b;if(p.nodeType==1)b=p.getClientRects();else if(p.nodeType==3)b=Es(p).getClientRects();else continue;for(let _=0;_<b.length;_++){let T=b[_];if(T.top<=l&&T.bottom>=u){l=Math.max(T.bottom,l),u=Math.min(T.top,u);let x=T.left>e.left?T.left-e.left:T.right<e.left?e.left-T.right:0;if(x<r){t=p,r=x,i=x&&t.nodeType==3?{left:T.right<e.left?T.right:T.left,top:e.top}:e,p.nodeType==1&&x&&(o=g+(e.left>=(T.left+T.right)/2?1:0));continue}}else T.top>e.top&&!h&&T.left<=e.left&&T.right>=e.left&&(h=p,d={left:Math.max(T.left,Math.min(T.right,e.left)),top:T.top});!t&&(e.left>=T.right&&e.top>=T.top||e.left>=T.left&&e.top>=T.bottom)&&(o=g+1)}}return!t&&h&&(t=h,i=d,r=0),t&&t.nodeType==3?dF(t,i):!t||r&&t.nodeType==1?{node:n,offset:o}:AM(t,i)}function dF(n,e){let t=n.nodeValue.length,r=document.createRange(),i;for(let o=0;o<t;o++){r.setEnd(n,o+1),r.setStart(n,o);let l=go(r,1);if(l.top!=l.bottom&&RE(e,l)){i={node:n,offset:o+(e.left>=(l.left+l.right)/2?1:0)};break}}return r.detach(),i||{node:n,offset:0}}function RE(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function pF(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function mF(n,e,t){let{node:r,offset:i}=AM(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let l=r.getBoundingClientRect();o=l.left!=l.right&&t.left>(l.left+l.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function gF(n,e,t,r){let i=-1;for(let o=e,l=!1;o!=n.dom;){let u=n.docView.nearestDesc(o,!0),h;if(!u)return null;if(u.dom.nodeType==1&&(u.node.isBlock&&u.parent||!u.contentDOM)&&((h=u.dom.getBoundingClientRect()).width||h.height)&&(u.node.isBlock&&u.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(u.dom.nodeName)&&(!l&&h.left>r.left||h.top>r.top?i=u.posBefore:(!l&&h.right<r.left||h.bottom<r.top)&&(i=u.posAfter),l=!0),!u.contentDOM&&i<0&&!u.node.isText))return(u.node.isBlock?r.top<(h.top+h.bottom)/2:r.left<(h.left+h.right)/2)?u.posBefore:u.posAfter;o=u.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function CM(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let l=n.childNodes[o];if(l.nodeType==1){let u=l.getClientRects();for(let h=0;h<u.length;h++){let d=u[h];if(RE(e,d))return CM(l,e,d)}}if((o=(o+1)%r)==i)break}return n}function yF(n,e){let t=n.dom.ownerDocument,r,i=0,o=oF(t,e.left,e.top);o&&({node:r,offset:i}=o);let l=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),u;if(!l||!n.dom.contains(l.nodeType!=1?l.parentNode:l)){let d=n.dom.getBoundingClientRect();if(!RE(e,d)||(l=CM(n.dom,e,d),!l))return null}if(Vn)for(let d=l;r&&d;d=Hc(d))d.draggable&&(r=void 0);if(l=pF(l,e),r){if(Br&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let p=r.childNodes[i],g;p.nodeName=="IMG"&&(g=p.getBoundingClientRect()).right<=e.left&&g.bottom>e.top&&i++}let d;Df&&i&&r.nodeType==1&&(d=r.childNodes[i-1]).nodeType==1&&d.contentEditable=="false"&&d.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?u=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(u=gF(n,r,i,e))}u==null&&(u=mF(n,l,e));let h=n.docView.nearestDesc(l,!0);return{pos:u,inside:h?h.posAtStart-h.border:-1}}function YC(n){return n.top<n.bottom||n.left<n.right}function go(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(YC(r))return r}return Array.prototype.find.call(t,YC)||n.getBoundingClientRect()}const vF=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function xM(n,e,t){let{node:r,offset:i,atom:o}=n.docView.domFromPos(e,t<0?-1:1),l=Df||Br;if(r.nodeType==3)if(l&&(vF.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let h=go(Es(r,i,i),t);if(Br&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let d=go(Es(r,i-1,i-1),-1);if(d.top==h.top){let p=go(Es(r,i,i+1),-1);if(p.top!=h.top)return ph(p,p.left<d.left)}}return h}else{let h=i,d=i,p=t<0?1:-1;return t<0&&!i?(d++,p=-1):t>=0&&i==r.nodeValue.length?(h--,p=1):t<0?h--:d++,ph(go(Es(r,h,d),p),p<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==Ur(r))){let h=r.childNodes[i-1];if(h.nodeType==1)return Nb(h.getBoundingClientRect(),!1)}if(o==null&&i<Ur(r)){let h=r.childNodes[i];if(h.nodeType==1)return Nb(h.getBoundingClientRect(),!0)}return Nb(r.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==Ur(r))){let h=r.childNodes[i-1],d=h.nodeType==3?Es(h,Ur(h)-(l?0:1)):h.nodeType==1&&(h.nodeName!="BR"||!h.nextSibling)?h:null;if(d)return ph(go(d,1),!1)}if(o==null&&i<Ur(r)){let h=r.childNodes[i];for(;h.pmViewDesc&&h.pmViewDesc.ignoreForCoords;)h=h.nextSibling;let d=h?h.nodeType==3?Es(h,0,l?0:1):h.nodeType==1?h:null:null;if(d)return ph(go(d,-1),!0)}return ph(go(r.nodeType==3?Es(r):r,-t),t>=0)}function ph(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Nb(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function RM(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function bF(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return RM(n,e,()=>{let{node:o}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let u=n.docView.nearestDesc(o,!0);if(!u)break;if(u.node.isBlock){o=u.contentDOM||u.dom;break}o=u.dom.parentNode}let l=xM(n,i.pos,1);for(let u=o.firstChild;u;u=u.nextSibling){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=Es(u,0,u.nodeValue.length).getClientRects();else continue;for(let d=0;d<h.length;d++){let p=h[d];if(p.bottom>p.top+1&&(t=="up"?l.top-p.top>(p.bottom-l.top)*2:p.bottom-l.bottom>(l.bottom-p.top)*2))return!1}}return!0})}const _F=/[\u0590-\u08ac]/;function EF(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,l=i==r.parent.content.size,u=n.domSelection();return u?!_F.test(r.parent.textContent)||!u.modify?t=="left"||t=="backward"?o:l:RM(n,e,()=>{let{focusNode:h,focusOffset:d,anchorNode:p,anchorOffset:g}=n.domSelectionRange(),b=u.caretBidiLevel;u.modify("move",t,"character");let _=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:T,focusOffset:x}=n.domSelectionRange(),A=T&&!_.contains(T.nodeType==1?T:T.parentNode)||h==T&&d==x;try{u.collapse(p,g),h&&(h!=p||d!=g)&&u.extend&&u.extend(h,d)}catch{}return b!=null&&(u.caretBidiLevel=b),A}):r.pos==r.start()||r.pos==r.end()}let JC=null,XC=null,ZC=!1;function TF(n,e,t){return JC==e&&XC==t?ZC:(JC=e,XC=t,ZC=t=="up"||t=="down"?bF(n,e,t):EF(n,e,t))}const zr=0,ex=1,Fa=2,Ki=3;class Lf{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=zr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,l;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((l=o.pmViewDesc)&&l.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(l)+l.size:this.posAtStart}else{let o,l;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((l=o.pmViewDesc)&&l.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(l):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>An(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),l;if(o&&(!t||o.node))if(r&&(l=o.nodeDOM)&&!(l.nodeType==1?l.contains(e.nodeType==1?e:e.parentNode):l==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let l=0;l<i.children.length;l++){let u=i.children[l];if(u.size){i=u;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let l=this.children[r],u=o+l.size;if(u>e||l instanceof IM){i=e-o;break}o=u}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof kM&&o.side>=0;r--);if(t<=0){let o,l=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,l=!1);return o&&t&&l&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?An(o.dom)+1:0}}else{let o,l=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,l=!1);return o&&l&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?An(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let l=r,u=0;;u++){let h=this.children[u],d=l+h.size;if(i==-1&&e<=d){let p=l+h.border;if(e>=p&&t<=d-h.border&&h.node&&h.contentDOM&&this.contentDOM.contains(h.contentDOM))return h.parseRange(e,t,p);e=l;for(let g=u;g>0;g--){let b=this.children[g-1];if(b.size&&b.dom.parentNode==this.contentDOM&&!b.emptyChildAt(1)){i=An(b.dom)+1;break}e-=b.size}i==-1&&(i=0)}if(i>-1&&(d>t||u==this.children.length-1)){t=d;for(let p=u+1;p<this.children.length;p++){let g=this.children[p];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(-1)){o=An(g.dom);break}t+=g.size}o==-1&&(o=this.contentDOM.childNodes.length);break}l=d}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let o=Math.min(e,t),l=Math.max(e,t);for(let _=0,T=0;_<this.children.length;_++){let x=this.children[_],A=T+x.size;if(o>T&&l<A)return x.setSelection(e-T-x.border,t-T-x.border,r,i);T=A}let u=this.domFromPos(e,e?-1:1),h=t==e?u:this.domFromPos(t,t?-1:1),d=r.root.getSelection(),p=r.domSelectionRange(),g=!1;if((Br||Vn)&&e==t){let{node:_,offset:T}=u;if(_.nodeType==3){if(g=!!(T&&_.nodeValue[T-1]==`
`),g&&T==_.nodeValue.length)for(let x=_,A;x;x=x.parentNode){if(A=x.nextSibling){A.nodeName=="BR"&&(u=h={node:A.parentNode,offset:An(A)+1});break}let R=x.pmViewDesc;if(R&&R.node&&R.node.isBlock)break}}else{let x=_.childNodes[T-1];g=x&&(x.nodeName=="BR"||x.contentEditable=="false")}}if(Br&&p.focusNode&&p.focusNode!=h.node&&p.focusNode.nodeType==1){let _=p.focusNode.childNodes[p.focusOffset];_&&_.contentEditable=="false"&&(i=!0)}if(!(i||g&&Vn)&&al(u.node,u.offset,p.anchorNode,p.anchorOffset)&&al(h.node,h.offset,p.focusNode,p.focusOffset))return;let b=!1;if((d.extend||e==t)&&!(g&&Br)){d.collapse(u.node,u.offset);try{e!=t&&d.extend(h.node,h.offset),b=!0}catch{}}if(!b){if(e>t){let T=u;u=h,h=T}let _=document.createRange();_.setEnd(h.node,h.offset),_.setStart(u.node,u.offset),d.removeAllRanges(),d.addRange(_)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],l=r+o.size;if(r==l?e<=l&&t>=r:e<l&&t>r){let u=r+o.border,h=l-o.border;if(e>=u&&t<=h){this.dirty=e==r||t==l?Fa:ex,e==u&&t==h&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Ki:o.markDirty(e-u,t-u);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Fa:Ki}r=l}this.dirty=Fa}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Fa:ex;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class kM extends Lf{constructor(e,t,r,i){let o,l=t.type.toDOM;if(typeof l=="function"&&(l=l(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(l.nodeType!=1){let u=document.createElement("span");u.appendChild(l),l=u}l.contentEditable="false",l.classList.add("ProseMirror-widget")}super(e,[],l,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==zr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class SF extends Lf{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class ll extends Lf{constructor(e,t,r,i,o){super(e,[],r,i),this.mark=t,this.spec=o}static create(e,t,r,i){let o=i.nodeViews[t.type.name],l=o&&o(t,i,r);return(!l||!l.dom)&&(l=gl.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new ll(e,t,l.dom,l.contentDOM||l.dom,l)}parseRule(){return this.dirty&Ki||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Ki&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=zr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=zr}}slice(e,t,r){let i=ll.create(this.parent,this.mark,!0,r),o=this.children,l=this.size;t<l&&(o=V0(o,t,l,r)),e>0&&(o=V0(o,0,e,r));for(let u=0;u<o.length;u++)o[u].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class zo extends Lf{constructor(e,t,r,i,o,l,u,h,d){super(e,[],o,l),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=u}static create(e,t,r,i,o,l){let u=o.nodeViews[t.type.name],h,d=u&&u(t,o,()=>{if(!h)return l;if(h.parent)return h.parent.posBeforeChild(h)},r,i),p=d&&d.dom,g=d&&d.contentDOM;if(t.isText){if(!p)p=document.createTextNode(t.text);else if(p.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else p||({dom:p,contentDOM:g}=gl.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!g&&!t.isText&&p.nodeName!="BR"&&(p.hasAttribute("contenteditable")||(p.contentEditable="false"),t.type.spec.draggable&&(p.draggable=!0));let b=p;return p=OM(p,r,t),d?h=new wF(e,t,r,i,p,g||null,b,d,o,l+1):t.isText?new qg(e,t,r,i,p,b,o):new zo(e,t,r,i,p,g||null,b,o,l+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>le.empty)}return e}matchesNode(e,t,r){return this.dirty==zr&&e.eq(this.node)&&xm(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,l=o&&o.pos>-1?o:null,u=o&&o.pos<0,h=new CF(this,l&&l.node,e);kF(this.node,this.innerDeco,(d,p,g)=>{d.spec.marks?h.syncToMarks(d.spec.marks,r,e,p):d.type.side>=0&&!g&&h.syncToMarks(p==this.node.childCount?dt.none:this.node.child(p).marks,r,e,p),h.placeWidget(d,e,i)},(d,p,g,b)=>{h.syncToMarks(d.marks,r,e,b);let _;h.findNodeMatch(d,p,g,b)||u&&e.state.selection.from>i&&e.state.selection.to<i+d.nodeSize&&(_=h.findIndexWithChild(o.node))>-1&&h.updateNodeAt(d,p,g,_,e)||h.updateNextNode(d,p,g,e,b,i)||h.addNode(d,p,g,e,i),i+=d.nodeSize}),h.syncToMarks([],r,e,0),this.node.isTextblock&&h.addTextblockHacks(),h.destroyRest(),(h.changed||this.dirty==Fa)&&(l&&this.protectLocalComposition(e,l),NM(this.contentDOM,this.children,e),qc&&IF(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof Ne)||r<t||i>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let l=o.nodeValue,u=NF(this.node.content,l,r-t,i-t);return u<0?null:{node:o,pos:u,text:l}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let l=new SF(this,o,t,i);e.input.compositionNodes.push(l),this.children=V0(this.children,r,r+i.length,e,l)}update(e,t,r,i){return this.dirty==Ki||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=zr}updateOuterDeco(e){if(xm(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=MM(this.dom,this.nodeDOM,P0(this.outerDeco,this.node,t),P0(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function tx(n,e,t,r,i){OM(r,e,n);let o=new zo(void 0,n,e,t,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class qg extends zo{constructor(e,t,r,i,o,l,u){super(e,t,r,i,o,null,l,u,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==Ki||this.dirty!=zr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=zr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=zr,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new qg(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Ki)}get domAtom(){return!1}isText(e){return this.node.text==e}}class IM extends Lf{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==zr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class wF extends zo{constructor(e,t,r,i,o,l,u,h,d,p){super(e,t,r,i,o,l,u,d,p),this.spec=h}update(e,t,r,i){if(this.dirty==Ki)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function NM(n,e,t){let r=n.firstChild,i=!1;for(let o=0;o<e.length;o++){let l=e[o],u=l.dom;if(u.parentNode==n){for(;u!=r;)r=nx(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(u,r);if(l instanceof ll){let h=r?r.previousSibling:n.lastChild;NM(l.contentDOM,l.children,t),r=h?h.nextSibling:n.firstChild}}for(;r;)r=nx(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const jh=function(n){n&&(this.nodeName=n)};jh.prototype=Object.create(null);const Ha=[new jh];function P0(n,e,t){if(n.length==0)return Ha;let r=t?Ha[0]:new jh,i=[r];for(let o=0;o<n.length;o++){let l=n[o].type.attrs;if(l){l.nodeName&&i.push(r=new jh(l.nodeName));for(let u in l){let h=l[u];h!=null&&(t&&i.length==1&&i.push(r=new jh(e.isInline?"span":"div")),u=="class"?r.class=(r.class?r.class+" ":"")+h:u=="style"?r.style=(r.style?r.style+";":"")+h:u!="nodeName"&&(r[u]=h))}}}return i}function MM(n,e,t,r){if(t==Ha&&r==Ha)return e;let i=e;for(let o=0;o<r.length;o++){let l=r[o],u=t[o];if(o){let h;u&&u.nodeName==l.nodeName&&i!=n&&(h=i.parentNode)&&h.nodeName.toLowerCase()==l.nodeName||(h=document.createElement(l.nodeName),h.pmIsDeco=!0,h.appendChild(i),u=Ha[0]),i=h}AF(i,u||Ha[0],l)}return i}function AF(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function OM(n,e,t){return MM(n,n,Ha,P0(e,t,n.nodeType!=1))}function xm(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function nx(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class CF{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=xF(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r,i){let o=0,l=this.stack.length>>1,u=Math.min(l,e.length);for(;o<u&&(o==l-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<l;)this.destroyRest(),this.top.dirty=zr,this.index=this.stack.pop(),this.top=this.stack.pop(),l--;for(;l<e.length;){this.stack.push(this.top,this.index+1);let h=-1,d=this.top.children.length;i<this.preMatch.index&&(d=Math.min(this.index+3,d));for(let p=this.index;p<d;p++){let g=this.top.children[p];if(g.matchesMark(e[l])&&!this.isLocked(g.dom)){h=p;break}}if(h>-1)h>this.index&&(this.changed=!0,this.destroyBetween(this.index,h)),this.top=this.top.children[this.index];else{let p=ll.create(this.top,e[l],t,r);this.top.children.splice(this.index,0,p),this.top=p,this.changed=!0}this.index=0,l++}}findNodeMatch(e,t,r,i){let o=-1,l;if(i>=this.preMatch.index&&(l=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&l.matchesNode(e,t,r))o=this.top.children.indexOf(l,this.index);else for(let u=this.index,h=Math.min(this.top.children.length,u+5);u<h;u++){let d=this.top.children[u];if(d.matchesNode(e,t,r)&&!this.preMatch.matched.has(d)){o=u;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,i,o){let l=this.top.children[i];return l.dirty==Ki&&l.dom==l.contentDOM&&(l.dirty=Fa),l.update(e,t,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,o,l){for(let u=this.index;u<this.top.children.length;u++){let h=this.top.children[u];if(h instanceof zo){let d=this.preMatch.matched.get(h);if(d!=null&&d!=o)return!1;let p=h.dom,g,b=this.isLocked(p)&&!(e.isText&&h.node&&h.node.isText&&h.nodeDOM.nodeValue==e.text&&h.dirty!=Ki&&xm(t,h.outerDeco));if(!b&&h.update(e,t,r,i))return this.destroyBetween(this.index,u),h.dom!=p&&(this.changed=!0),this.index++,!0;if(!b&&(g=this.recreateWrapper(h,e,t,r,i,l)))return this.destroyBetween(this.index,u),this.top.children[this.index]=g,g.contentDOM&&(g.dirty=Fa,g.updateChildren(i,l+1),g.dirty=zr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,o,l){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!xm(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let u=zo.create(this.top,t,r,i,o,l);if(u.contentDOM){u.children=e.children,e.children=[];for(let h of u.children)h.parent=u}return e.destroy(),u}addNode(e,t,r,i,o){let l=zo.create(this.top,e,t,r,i,o);l.contentDOM&&l.updateChildren(i,o+1),this.top.children.splice(this.index++,0,l),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new kM(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof ll;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof qg)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Vn||In)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new IM(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function xF(n,e){let t=e,r=t.children.length,i=n.childCount,o=new Map,l=[];e:for(;i>0;){let u;for(;;)if(r){let d=t.children[r-1];if(d instanceof ll)t=d,r=d.children.length;else{u=d,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let h=u.node;if(h){if(h!=n.child(i-1))break;--i,o.set(u,i),l.push(u)}}return{index:i,matched:o,matches:l.reverse()}}function RF(n,e){return n.type.side-e.type.side}function kF(n,e,t,r){let i=e.locals(n),o=0;if(i.length==0){for(let d=0;d<n.childCount;d++){let p=n.child(d);r(p,i,e.forChild(o,p),d),o+=p.nodeSize}return}let l=0,u=[],h=null;for(let d=0;;){let p,g;for(;l<i.length&&i[l].to==o;){let A=i[l++];A.widget&&(p?(g||(g=[p])).push(A):p=A)}if(p)if(g){g.sort(RF);for(let A=0;A<g.length;A++)t(g[A],d,!!h)}else t(p,d,!!h);let b,_;if(h)_=-1,b=h,h=null;else if(d<n.childCount)_=d,b=n.child(d++);else break;for(let A=0;A<u.length;A++)u[A].to<=o&&u.splice(A--,1);for(;l<i.length&&i[l].from<=o&&i[l].to>o;)u.push(i[l++]);let T=o+b.nodeSize;if(b.isText){let A=T;l<i.length&&i[l].from<A&&(A=i[l].from);for(let R=0;R<u.length;R++)u[R].to<A&&(A=u[R].to);A<T&&(h=b.cut(A-o),b=b.cut(0,A-o),T=A,_=-1)}else for(;l<i.length&&i[l].to<T;)l++;let x=b.isInline&&!b.isLeaf?u.filter(A=>!A.inline):u.slice();r(b,x,e.forChild(o,b),_),o=T}}function IF(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function NF(n,e,t,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let l=n.child(i++),u=o;if(o+=l.nodeSize,!l.isText)continue;let h=l.text;for(;i<n.childCount;){let d=n.child(i++);if(o+=d.nodeSize,!d.isText)break;h+=d.text}if(o>=t){if(o>=r&&h.slice(r-e.length-u,r-u)==e)return r-e.length;let d=u<r?h.lastIndexOf(e,r-u-1):-1;if(d>=0&&d+e.length+u>=t)return u+d;if(t==r&&h.length>=r+e.length-u&&h.slice(r-u,r-u+e.length)==e)return r}}return-1}function V0(n,e,t,r,i){let o=[];for(let l=0,u=0;l<n.length;l++){let h=n[l],d=u,p=u+=h.size;d>=t||p<=e?o.push(h):(d<e&&o.push(h.slice(0,e-d,r)),i&&(o.push(i),i=void 0),p>t&&o.push(h.slice(t-d,h.size,r)))}return o}function kE(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,l=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(l<0)return null;let u=r.resolve(l),h,d;if(Hg(t)){for(h=l;i&&!i.node;)i=i.parent;let g=i.node;if(i&&g.isAtom&&we.isSelectable(g)&&i.parent&&!(g.isInline&&iF(t.focusNode,t.focusOffset,i.dom))){let b=i.posBefore;d=new we(l==b?u:r.resolve(b))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let g=l,b=l;for(let _=0;_<t.rangeCount;_++){let T=t.getRangeAt(_);g=Math.min(g,n.docView.posFromDOM(T.startContainer,T.startOffset,1)),b=Math.max(b,n.docView.posFromDOM(T.endContainer,T.endOffset,-1))}if(g<0)return null;[h,l]=b==n.state.selection.anchor?[b,g]:[g,b],u=r.resolve(l)}else h=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(h<0)return null}let p=r.resolve(h);if(!d){let g=e=="pointer"||n.state.selection.head<u.pos&&!o?1:-1;d=IE(n,p,u,g)}return d}function DM(n){return n.editable?n.hasFocus():PM(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function xs(n,e=!1){let t=n.state.selection;if(LM(n,t),!!DM(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&In){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&al(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)OF(n);else{let{anchor:r,head:i}=t,o,l;rx&&!(t instanceof Ne)&&(t.$from.parent.inlineContent||(o=ix(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(l=ix(n,t.to))),n.docView.setSelection(r,i,n,e),rx&&(o&&sx(o),l&&sx(l)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&MF(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const rx=Vn||In&&EM<63;function ix(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(Vn&&i&&i.contentEditable=="false")return Mb(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return Mb(i);if(o)return Mb(o)}}function Mb(n){return n.contentEditable="true",Vn&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function sx(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function MF(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!DM(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function OF(n){let e=n.domSelection();if(!e)return;let t=n.cursorWrapper.dom,r=t.nodeName=="IMG";r?e.collapse(t.parentNode,An(t)+1):e.collapse(t,0),!r&&!n.state.selection.visible&&ir&&Bo<=11&&(t.disabled=!0,t.disabled=!1)}function LM(n,e){if(e instanceof we){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(ox(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else ox(n)}function ox(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function IE(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||Ne.between(e,t,r)}function ax(n){return n.editable&&!n.hasFocus()?!1:PM(n)}function PM(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function DF(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return al(e.node,e.offset,t.anchorNode,t.anchorOffset)}function j0(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&Ue.findFrom(o,e)}function yo(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function lx(n,e,t){let r=n.state.selection;if(r instanceof Ne)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let l=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return yo(n,new Ne(r.$anchor,l))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=j0(n.state,e);return i&&i instanceof we?yo(n,i):!1}else if(!(Vr&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,l;if(!o||o.isText)return!1;let u=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(l=n.docView.descAt(u))&&!l.contentDOM?we.isSelectable(o)?yo(n,new we(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):Df?yo(n,new Ne(n.state.doc.resolve(e<0?u:u+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof we&&r.node.isInline)return yo(n,new Ne(e>0?r.$to:r.$from));{let i=j0(n.state,e);return i?yo(n,i):!1}}}function Rm(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Uh(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function uc(n,e){return e<0?LF(n):PF(n)}function LF(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,l=!1;for(Br&&t.nodeType==1&&r<Rm(t)&&Uh(t.childNodes[r],-1)&&(l=!0);;)if(r>0){if(t.nodeType!=1)break;{let u=t.childNodes[r-1];if(Uh(u,-1))i=t,o=--r;else if(u.nodeType==3)t=u,r=t.nodeValue.length;else break}}else{if(VM(t))break;{let u=t.previousSibling;for(;u&&Uh(u,-1);)i=t.parentNode,o=An(u),u=u.previousSibling;if(u)t=u,r=Rm(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}l?U0(n,t,r):i&&U0(n,i,o)}function PF(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=Rm(t),o,l;for(;;)if(r<i){if(t.nodeType!=1)break;let u=t.childNodes[r];if(Uh(u,1))o=t,l=++r;else break}else{if(VM(t))break;{let u=t.nextSibling;for(;u&&Uh(u,1);)o=u.parentNode,l=An(u)+1,u=u.nextSibling;if(u)t=u,r=0,i=Rm(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&U0(n,o,l)}function VM(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function VF(n,e){for(;n&&e==n.childNodes.length&&!Of(n);)e=An(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function jF(n,e){for(;n&&!e&&!Of(n);)e=An(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function U0(n,e,t){if(e.nodeType!=3){let o,l;(l=VF(e,t))?(e=l,t=0):(o=jF(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(Hg(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&xs(n)},50)}function cx(n,e){let t=n.state.doc.resolve(e);if(!(In||TM)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),l=(o.top+o.bottom)/2;if(l>i.top&&l<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),l=(o.top+o.bottom)/2;if(l>i.top&&l<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function ux(n,e,t){let r=n.state.selection;if(r instanceof Ne&&!r.empty||t.indexOf("s")>-1||Vr&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let l=j0(n.state,e);if(l&&l instanceof we)return yo(n,l)}if(!i.parent.inlineContent){let l=e<0?i:o,u=r instanceof br?Ue.near(l,e):Ue.findFrom(l,e);return u?yo(n,u):!1}return!1}function hx(n,e){if(!(n.state.selection instanceof Ne))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let l=n.state.tr;return e<0?l.delete(t.pos-o.nodeSize,t.pos):l.delete(t.pos,t.pos+o.nodeSize),n.dispatch(l),!0}return!1}function fx(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function UF(n){if(!Vn||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;fx(n,r,"true"),setTimeout(()=>fx(n,r,"false"),20)}return!1}function BF(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function zF(n,e){let t=e.keyCode,r=BF(e);if(t==8||Vr&&t==72&&r=="c")return hx(n,-1)||uc(n,-1);if(t==46&&!e.shiftKey||Vr&&t==68&&r=="c")return hx(n,1)||uc(n,1);if(t==13||t==27)return!0;if(t==37||Vr&&t==66&&r=="c"){let i=t==37?cx(n,n.state.selection.from)=="ltr"?-1:1:-1;return lx(n,i,r)||uc(n,i)}else if(t==39||Vr&&t==70&&r=="c"){let i=t==39?cx(n,n.state.selection.from)=="ltr"?1:-1:1;return lx(n,i,r)||uc(n,i)}else{if(t==38||Vr&&t==80&&r=="c")return ux(n,-1,r)||uc(n,-1);if(t==40||Vr&&t==78&&r=="c")return UF(n)||ux(n,1,r)||uc(n,1);if(r==(Vr?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function NE(n,e){n.someProp("transformCopied",_=>{e=_(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let _=r.firstChild;t.push(_.type.name,_.attrs!=_.type.defaultAttrs?_.attrs:null),r=_.content}let l=n.someProp("clipboardSerializer")||gl.fromSchema(n.state.schema),u=HM(),h=u.createElement("div");h.appendChild(l.serializeFragment(r,{document:u}));let d=h.firstChild,p,g=0;for(;d&&d.nodeType==1&&(p=FM[d.nodeName.toLowerCase()]);){for(let _=p.length-1;_>=0;_--){let T=u.createElement(p[_]);for(;h.firstChild;)T.appendChild(h.firstChild);h.appendChild(T),g++}d=h.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${i} ${o}${g?` -${g}`:""} ${JSON.stringify(t)}`);let b=n.someProp("clipboardTextSerializer",_=>_(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:h,text:b,slice:e}}function jM(n,e,t,r,i){let o=i.parent.type.spec.code,l,u;if(!t&&!e)return null;let h=!!e&&(r||o||!t);if(h){if(n.someProp("transformPastedText",b=>{e=b(e,o||r,n)}),o)return u=new me(le.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",b=>{u=b(u,n,!0)}),u;let g=n.someProp("clipboardTextParser",b=>b(e,i,r,n));if(g)u=g;else{let b=i.marks(),{schema:_}=n.state,T=gl.fromSchema(_);l=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(x=>{let A=l.appendChild(document.createElement("p"));x&&A.appendChild(T.serializeNode(_.text(x,b)))})}}else n.someProp("transformPastedHTML",g=>{t=g(t,n)}),l=$F(t),Df&&GF(l);let d=l&&l.querySelector("[data-pm-slice]"),p=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(p&&p[3])for(let g=+p[3];g>0;g--){let b=l.firstChild;for(;b&&b.nodeType!=1;)b=b.nextSibling;if(!b)break;l=b}if(u||(u=(n.someProp("clipboardParser")||n.someProp("domParser")||Uo.fromSchema(n.state.schema)).parseSlice(l,{preserveWhitespace:!!(h||p),context:i,ruleFromNode(b){return b.nodeName=="BR"&&!b.nextSibling&&b.parentNode&&!FF.test(b.parentNode.nodeName)?{ignore:!0}:null}})),p)u=KF(dx(u,+p[1],+p[2]),p[4]);else if(u=me.maxOpen(HF(u.content,i),!0),u.openStart||u.openEnd){let g=0,b=0;for(let _=u.content.firstChild;g<u.openStart&&!_.type.spec.isolating;g++,_=_.firstChild);for(let _=u.content.lastChild;b<u.openEnd&&!_.type.spec.isolating;b++,_=_.lastChild);u=dx(u,g,b)}return n.someProp("transformPasted",g=>{u=g(u,n,h)}),u}const FF=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function HF(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,l=[];if(n.forEach(u=>{if(!l)return;let h=i.findWrapping(u.type),d;if(!h)return l=null;if(d=l.length&&o.length&&BM(h,o,u,l[l.length-1],0))l[l.length-1]=d;else{l.length&&(l[l.length-1]=zM(l[l.length-1],o.length));let p=UM(u,h);l.push(p),i=i.matchType(p.type),o=h}}),l)return le.from(l)}return n}function UM(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,le.from(n));return n}function BM(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=BM(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(le.from(UM(t,n,i+1))))}}function zM(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,zM(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(le.empty,!0);return n.copy(t.append(r))}function B0(n,e,t,r,i,o){let l=e<0?n.firstChild:n.lastChild,u=l.content;return n.childCount>1&&(o=0),i<r-1&&(u=B0(u,e,t,r,i+1,o)),i>=t&&(u=e<0?l.contentMatchAt(0).fillBefore(u,o<=i).append(u):u.append(l.contentMatchAt(l.childCount).fillBefore(le.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,l.copy(u))}function dx(n,e,t){return e<n.openStart&&(n=new me(B0(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new me(B0(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const FM={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let px=null;function HM(){return px||(px=document.implementation.createHTMLDocument("title"))}let Ob=null;function qF(n){let e=window.trustedTypes;return e?(Ob||(Ob=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),Ob.createHTML(n)):n}function $F(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=HM().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&FM[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=qF(n),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function GF(n){let e=n.querySelectorAll(In?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function KF(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:l}=n;for(let u=r.length-2;u>=0;u-=2){let h=t.nodes[r[u]];if(!h||h.hasRequiredAttrs())break;i=le.from(h.create(r[u+1],i)),o++,l++}return new me(i,o,l)}const Gn={},Kn={},WF={touchstart:!0,touchmove:!0};class QF{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function YF(n){for(let e in Gn){let t=Gn[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{XF(n,r)&&!ME(n,r)&&(n.editable||!(r.type in Kn))&&t(n,r)},WF[e]?{passive:!0}:void 0)}Vn&&n.dom.addEventListener("input",()=>null),z0(n)}function Io(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function JF(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function z0(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>ME(n,r))})}function ME(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function XF(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function ZF(n,e){!ME(n,e)&&Gn[e.type]&&(n.editable||!(e.type in Kn))&&Gn[e.type](n,e)}Kn.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!$M(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(ws&&In&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),qc&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,Ba(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||zF(n,t)?t.preventDefault():Io(n,"key")};Kn.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Kn.keypress=(n,e)=>{let t=e;if($M(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Vr&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof Ne)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode),o=()=>n.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",l=>l(n,r.$from.pos,r.$to.pos,i,o))&&n.dispatch(o()),t.preventDefault()}};function $g(n){return{left:n.clientX,top:n.clientY}}function eH(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function OE(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let l=o.depth+1;l>0;l--)if(n.someProp(e,u=>l>o.depth?u(n,t,o.nodeAfter,o.before(l),i,!0):u(n,t,o.node(l),o.before(l),i,!1)))return!0;return!1}function Rc(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function tH(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&we.isSelectable(r)?(Rc(n,new we(t)),!0):!1}function nH(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof we&&(r=t.node);let o=n.state.doc.resolve(e);for(let l=o.depth+1;l>0;l--){let u=l>o.depth?o.nodeAfter:o.node(l);if(we.isSelectable(u)){r&&t.$from.depth>0&&l>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(l);break}}return i!=null?(Rc(n,we.create(n.state.doc,i)),!0):!1}function rH(n,e,t,r,i){return OE(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?nH(n,t):tH(n,t))}function iH(n,e,t,r){return OE(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function sH(n,e,t,r){return OE(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||oH(n,t,r)}function oH(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Rc(n,Ne.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let l=o>i.depth?i.nodeAfter:i.node(o),u=i.before(o);if(l.inlineContent)Rc(n,Ne.create(r,u+1,u+1+l.content.size));else if(we.isSelectable(l))Rc(n,we.create(r,u));else continue;return!0}}function DE(n){return km(n)}const qM=Vr?"metaKey":"ctrlKey";Gn.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=DE(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&eH(t,n.input.lastClick)&&!t[qM]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o,button:t.button};let l=n.posAtCoords($g(t));l&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new aH(n,l,t,!!r)):(o=="doubleClick"?iH:sH)(n,l.pos,l.inside,t)?t.preventDefault():Io(n,"pointer"))};class aH{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[qM],this.allowDefault=r.shiftKey;let o,l;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),l=t.inside;else{let p=e.state.doc.resolve(t.pos);o=p.parent,l=p.depth?p.before():0}const u=i?null:r.target,h=u?e.docView.nearestDesc(u,!0):null;this.target=h&&h.nodeDOM.nodeType==1?h.nodeDOM:null;let{selection:d}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||d instanceof we&&d.from<=l&&d.to>l)&&(this.mightDrag={node:o,pos:l,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Br&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Io(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>xs(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords($g(e))),this.updateAllowDefault(e),this.allowDefault||!t?Io(this.view,"pointer"):rH(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Vn&&this.mightDrag&&!this.mightDrag.node.isAtom||In&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Rc(this.view,Ue.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):Io(this.view,"pointer")}move(e){this.updateAllowDefault(e),Io(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Gn.touchstart=n=>{n.input.lastTouch=Date.now(),DE(n),Io(n,"pointer")};Gn.touchmove=n=>{n.input.lastTouch=Date.now(),Io(n,"pointer")};Gn.contextmenu=n=>DE(n);function $M(n,e){return n.composing?!0:Vn&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const lH=ws?5e3:-1;Kn.compositionstart=Kn.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof Ne&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)||In&&TM&&cH(n)))n.markCursor=n.state.storedMarks||t.marks(),km(n,!0),n.markCursor=null;else if(km(n,!e.selection.empty),Br&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let l=o<0?i.lastChild:i.childNodes[o-1];if(!l)break;if(l.nodeType==3){let u=n.domSelection();u&&u.collapse(l,l.nodeValue.length);break}else i=l,o=-1}}n.input.composing=!0}GM(n,lH)};function cH(n){let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(!e||e.nodeType!=1||t>=e.childNodes.length)return!1;let r=e.childNodes[t];return r.nodeType==1&&r.contentEditable=="false"}Kn.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.badSafariComposition?n.domObserver.forceFlush():n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,GM(n,20))};function GM(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>km(n),e))}function KM(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=hH());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function uH(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=nF(e.focusNode,e.focusOffset),r=rF(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let i=r.pmViewDesc,o=n.domObserver.lastChangedTextNode;if(t==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let l=t.pmViewDesc;if(!(!l||!l.isText(t.nodeValue)))return r}}return t||r}function hH(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function km(n,e=!1){if(!(ws&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),KM(n),e||n.docView&&n.docView.dirty){let t=kE(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function fH(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const cf=ir&&Bo<15||qc&&aF<604;Gn.copy=Kn.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=cf?null:t.clipboardData,l=r.content(),{dom:u,text:h}=NE(n,l);o?(t.preventDefault(),o.clearData(),o.setData("text/html",u.innerHTML),o.setData("text/plain",h)):fH(n,u),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function dH(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function pH(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?uf(n,r.value,null,i,e):uf(n,r.textContent,r.innerHTML,i,e)},50)}function uf(n,e,t,r,i){let o=jM(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",h=>h(n,i,o||me.empty)))return!0;if(!o)return!1;let l=dH(o),u=l?n.state.tr.replaceSelectionWith(l,r):n.state.tr.replaceSelection(o);return n.dispatch(u.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function WM(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Kn.paste=(n,e)=>{let t=e;if(n.composing&&!ws)return;let r=cf?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&uf(n,WM(r),r.getData("text/html"),i,t)?t.preventDefault():pH(n,t)};class QM{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const mH=Vr?"altKey":"ctrlKey";function YM(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[mH]}Gn.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords($g(t)),l;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof we?i.to-1:i.to))){if(r&&r.mightDrag)l=we.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let g=n.docView.nearestDesc(t.target,!0);g&&g.node.type.spec.draggable&&g!=n.docView&&(l=we.create(n.state.doc,g.posBefore))}}let u=(l||n.state.selection).content(),{dom:h,text:d,slice:p}=NE(n,u);(!t.dataTransfer.files.length||!In||EM>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(cf?"Text":"text/html",h.innerHTML),t.dataTransfer.effectAllowed="copyMove",cf||t.dataTransfer.setData("text/plain",d),n.dragging=new QM(p,YM(n,t),l)};Gn.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Kn.dragover=Kn.dragenter=(n,e)=>e.preventDefault();Kn.drop=(n,e)=>{try{gH(n,e,n.dragging)}finally{n.dragging=null}};function gH(n,e,t){if(!e.dataTransfer)return;let r=n.posAtCoords($g(e));if(!r)return;let i=n.state.doc.resolve(r.pos),o=t&&t.slice;o?n.someProp("transformPasted",_=>{o=_(o,n,!1)}):o=jM(n,WM(e.dataTransfer),cf?null:e.dataTransfer.getData("text/html"),!1,i);let l=!!(t&&YM(n,e));if(n.someProp("handleDrop",_=>_(n,e,o||me.empty,l))){e.preventDefault();return}if(!o)return;e.preventDefault();let u=o?eM(n.state.doc,i.pos,o):i.pos;u==null&&(u=i.pos);let h=n.state.tr;if(l){let{node:_}=t;_?_.replace(h):h.deleteSelection()}let d=h.mapping.map(u),p=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,g=h.doc;if(p?h.replaceRangeWith(d,d,o.content.firstChild):h.replaceRange(d,d,o),h.doc.eq(g))return;let b=h.doc.resolve(d);if(p&&we.isSelectable(o.content.firstChild)&&b.nodeAfter&&b.nodeAfter.sameMarkup(o.content.firstChild))h.setSelection(new we(b));else{let _=h.mapping.map(u);h.mapping.maps[h.mapping.maps.length-1].forEach((T,x,A,R)=>_=R),h.setSelection(IE(n,b,h.doc.resolve(_)))}n.focus(),n.dispatch(h.setMeta("uiEvent","drop"))}Gn.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&xs(n)},20))};Gn.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Gn.beforeinput=(n,e)=>{if(In&&ws&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,Ba(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Kn)Gn[n]=Kn[n];function hf(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Im{constructor(e,t){this.toDOM=e,this.spec=t||Qa,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:l}=e.mapResult(t.from+i,this.side<0?-1:1);return l?null:new $n(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Im&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&hf(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Fo{constructor(e,t){this.attrs=e,this.spec=t||Qa}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,l=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=l?null:new $n(o,l,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Fo&&hf(this.attrs,e.attrs)&&hf(this.spec,e.spec)}static is(e){return e.type instanceof Fo}destroy(){}}class LE{constructor(e,t){this.attrs=e,this.spec=t||Qa}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let l=e.mapResult(t.to+i,-1);return l.deleted||l.pos<=o.pos?null:new $n(o.pos-r,l.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof LE&&hf(this.attrs,e.attrs)&&hf(this.spec,e.spec)}destroy(){}}class $n{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new $n(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new $n(e,e,new Im(t,r))}static inline(e,t,r,i){return new $n(e,t,new Fo(r,i))}static node(e,t,r,i){return new $n(e,t,new LE(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Fo}get widget(){return this.type instanceof Im}}const gc=[],Qa={};class St{constructor(e,t){this.local=e.length?e:gc,this.children=t.length?t:gc}static create(e,t){return t.length?Nm(t,e,0,Qa):Dn}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let l=0;l<this.local.length;l++){let u=this.local[l];u.from<=t&&u.to>=e&&(!o||o(u.spec))&&r.push(u.copy(u.from+i,u.to+i))}for(let l=0;l<this.children.length;l+=3)if(this.children[l]<t&&this.children[l+1]>e){let u=this.children[l]+1;this.children[l+2].findInner(e-u,t-u,r,i+u,o)}}map(e,t,r){return this==Dn||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Qa)}mapInner(e,t,r,i,o){let l;for(let u=0;u<this.local.length;u++){let h=this.local[u].map(e,r,i);h&&h.type.valid(t,h)?(l||(l=[])).push(h):o.onRemove&&o.onRemove(this.local[u].spec)}return this.children.length?yH(this.children,l||[],e,t,r,i,o):l?new St(l.sort(Ya),gc):Dn}add(e,t){return t.length?this==Dn?St.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((u,h)=>{let d=h+r,p;if(p=XM(t,u,d)){for(i||(i=this.children.slice());o<i.length&&i[o]<h;)o+=3;i[o]==h?i[o+2]=i[o+2].addInner(u,p,d+1):i.splice(o,0,h,h+u.nodeSize,Nm(p,u,d+1,Qa)),o+=3}});let l=JM(o?ZM(t):t,-r);for(let u=0;u<l.length;u++)l[u].type.valid(e,l[u])||l.splice(u--,1);return new St(l.length?this.local.concat(l).sort(Ya):this.local,i||this.children)}remove(e){return e.length==0||this==Dn?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let l,u=r[o]+t,h=r[o+1]+t;for(let p=0,g;p<e.length;p++)(g=e[p])&&g.from>u&&g.to<h&&(e[p]=null,(l||(l=[])).push(g));if(!l)continue;r==this.children&&(r=this.children.slice());let d=r[o+2].removeInner(l,u+1);d!=Dn?r[o+2]=d:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,l;o<e.length;o++)if(l=e[o])for(let u=0;u<i.length;u++)i[u].eq(l,t)&&(i==this.local&&(i=this.local.slice()),i.splice(u--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new St(i,r):Dn}forChild(e,t){if(this==Dn)return this;if(t.isLeaf)return St.empty;let r,i;for(let u=0;u<this.children.length;u+=3)if(this.children[u]>=e){this.children[u]==e&&(r=this.children[u+2]);break}let o=e+1,l=o+t.content.size;for(let u=0;u<this.local.length;u++){let h=this.local[u];if(h.from<l&&h.to>o&&h.type instanceof Fo){let d=Math.max(o,h.from)-o,p=Math.min(l,h.to)-o;d<p&&(i||(i=[])).push(h.copy(d,p))}}if(i){let u=new St(i.sort(Ya),gc);return r?new Ao([u,r]):u}return r||Dn}eq(e){if(this==e)return!0;if(!(e instanceof St)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return PE(this.localsInner(e))}localsInner(e){if(this==Dn)return gc;if(e.inlineContent||!this.local.some(Fo.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Fo||t.push(this.local[r]);return t}forEachSet(e){e(this)}}St.empty=new St([],[]);St.removeOverlap=PE;const Dn=St.empty;class Ao{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Qa));return Ao.from(r)}forChild(e,t){if(t.isLeaf)return St.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=Dn&&(o instanceof Ao?r=r.concat(o.members):r.push(o))}return Ao.from(r)}eq(e){if(!(e instanceof Ao)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let l=0;l<o.length;l++)t.push(o[l])}}return t?PE(r?t:t.sort(Ya)):gc}static from(e){switch(e.length){case 0:return Dn;case 1:return e[0];default:return new Ao(e.every(t=>t instanceof St)?e:e.reduce((t,r)=>t.concat(r instanceof St?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function yH(n,e,t,r,i,o,l){let u=n.slice();for(let d=0,p=o;d<t.maps.length;d++){let g=0;t.maps[d].forEach((b,_,T,x)=>{let A=x-T-(_-b);for(let R=0;R<u.length;R+=3){let M=u[R+1];if(M<0||b>M+p-g)continue;let j=u[R]+p-g;_>=j?u[R+1]=b<=j?-2:-1:b>=p&&A&&(u[R]+=A,u[R+1]+=A)}g+=A}),p=t.maps[d].map(p,-1)}let h=!1;for(let d=0;d<u.length;d+=3)if(u[d+1]<0){if(u[d+1]==-2){h=!0,u[d+1]=-1;continue}let p=t.map(n[d]+o),g=p-i;if(g<0||g>=r.content.size){h=!0;continue}let b=t.map(n[d+1]+o,-1),_=b-i,{index:T,offset:x}=r.content.findIndex(g),A=r.maybeChild(T);if(A&&x==g&&x+A.nodeSize==_){let R=u[d+2].mapInner(t,A,p+1,n[d]+o+1,l);R!=Dn?(u[d]=g,u[d+1]=_,u[d+2]=R):(u[d+1]=-2,h=!0)}else h=!0}if(h){let d=vH(u,n,e,t,i,o,l),p=Nm(d,r,0,l);e=p.local;for(let g=0;g<u.length;g+=3)u[g+1]<0&&(u.splice(g,3),g-=3);for(let g=0,b=0;g<p.children.length;g+=3){let _=p.children[g];for(;b<u.length&&u[b]<_;)b+=3;u.splice(b,0,p.children[g],p.children[g+1],p.children[g+2])}}return new St(e.sort(Ya),u)}function JM(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new $n(i.from+e,i.to+e,i.type))}return t}function vH(n,e,t,r,i,o,l){function u(h,d){for(let p=0;p<h.local.length;p++){let g=h.local[p].map(r,i,d);g?t.push(g):l.onRemove&&l.onRemove(h.local[p].spec)}for(let p=0;p<h.children.length;p+=3)u(h.children[p+2],h.children[p]+d+1)}for(let h=0;h<n.length;h+=3)n[h+1]==-1&&u(n[h+2],e[h]+o+1);return t}function XM(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,l;o<n.length;o++)(l=n[o])&&l.from>t&&l.to<r&&((i||(i=[])).push(l),n[o]=null);return i}function ZM(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Nm(n,e,t,r){let i=[],o=!1;e.forEach((u,h)=>{let d=XM(n,u,h+t);if(d){o=!0;let p=Nm(d,u,t+h+1,r);p!=Dn&&i.push(h,h+u.nodeSize,p)}});let l=JM(o?ZM(n):n,-t).sort(Ya);for(let u=0;u<l.length;u++)l[u].type.valid(e,l[u])||(r.onRemove&&r.onRemove(l[u].spec),l.splice(u--,1));return l.length||i.length?new St(l,i):Dn}function Ya(n,e){return n.from-e.from||n.to-e.to}function PE(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),mx(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),mx(e,i,r.copy(o.from,r.to)));break}}}return e}function mx(n,e,t){for(;e<n.length&&Ya(t,n[e])>0;)e++;n.splice(e,0,t)}function Db(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Dn&&e.push(r)}),n.cursorWrapper&&e.push(St.create(n.state.doc,[n.cursorWrapper.deco])),Ao.from(e)}const bH={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},_H=ir&&Bo<=11;class EH{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class TH{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new EH,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);ir&&Bo<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():Vn&&e.composing&&r.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),_H&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,bH)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(ax(this.view)){if(this.suppressingSelectionUpdates)return xs(this.view);if(ir&&Bo<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&al(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=Hc(o))t.add(o);for(let o=e.anchorNode;o;o=Hc(o))if(t.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&ax(e)&&!this.ignoreSelectionChange(r),o=-1,l=-1,u=!1,h=[];if(e.editable)for(let p=0;p<t.length;p++){let g=this.registerMutation(t[p],h);g&&(o=o<0?g.from:Math.min(g.from,o),l=l<0?g.to:Math.max(g.to,l),g.typeOver&&(u=!0))}if(h.some(p=>p.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let p of h)if(p.nodeName=="BR"&&p.parentNode){let g=p.nextSibling;g&&g.nodeType==1&&g.contentEditable=="false"&&p.parentNode.removeChild(p)}}else if(Br&&h.length){let p=h.filter(g=>g.nodeName=="BR");if(p.length==2){let[g,b]=p;g.parentNode&&g.parentNode.parentNode==b.parentNode?b.remove():g.remove()}else{let{focusNode:g}=this.currentSelection;for(let b of p){let _=b.parentNode;_&&_.nodeName=="LI"&&(!g||AH(e,g)!=_)&&b.remove()}}}let d=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Hg(r)&&(d=kE(e))&&d.eq(Ue.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,xs(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,l),SH(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,CH(e,h)),this.handleDOMChange(o,l,u,h),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||xs(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let p=0;p<e.addedNodes.length;p++){let g=e.addedNodes[p];t.push(g),g.nodeType==3&&(this.lastChangedTextNode=g)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(ir&&Bo<=11&&e.addedNodes.length)for(let p=0;p<e.addedNodes.length;p++){let{previousSibling:g,nextSibling:b}=e.addedNodes[p];(!g||Array.prototype.indexOf.call(e.addedNodes,g)<0)&&(i=g),(!b||Array.prototype.indexOf.call(e.addedNodes,b)<0)&&(o=b)}let l=i&&i.parentNode==e.target?An(i)+1:0,u=r.localPosFromDOM(e.target,l,-1),h=o&&o.parentNode==e.target?An(o):e.target.childNodes.length,d=r.localPosFromDOM(e.target,h,1);return{from:u,to:d}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let gx=new WeakMap,yx=!1;function SH(n){if(!gx.has(n)&&(gx.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Br,yx)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),yx=!0}}function vx(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,l=n.domAtPos(n.state.selection.anchor);return al(l.node,l.offset,i,o)&&([t,r,i,o]=[i,o,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:o}}function wH(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return vx(n,i)}let t;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?vx(n,t):null}function AH(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function CH(n,e){var t;let{focusNode:r,focusOffset:i}=n.domSelectionRange();for(let o of e)if(((t=o.parentNode)===null||t===void 0?void 0:t.nodeName)=="TR"){let l=o.nextSibling;for(;l&&l.nodeName!="TD"&&l.nodeName!="TH";)l=l.nextSibling;if(l){let u=l;for(;;){let h=u.firstChild;if(!h||h.nodeType!=1||h.contentEditable=="false"||/^(BR|IMG)$/.test(h.nodeName))break;u=h}u.insertBefore(o,u.firstChild),r==o&&n.domSelection().collapse(o,i)}else o.parentNode.removeChild(o)}}function xH(n,e,t){let{node:r,fromOffset:i,toOffset:o,from:l,to:u}=n.docView.parseRange(e,t),h=n.domSelectionRange(),d,p=h.anchorNode;if(p&&n.dom.contains(p.nodeType==1?p:p.parentNode)&&(d=[{node:p,offset:h.anchorOffset}],Hg(h)||d.push({node:h.focusNode,offset:h.focusOffset})),In&&n.input.lastKeyCode===8)for(let A=o;A>i;A--){let R=r.childNodes[A-1],M=R.pmViewDesc;if(R.nodeName=="BR"&&!M){o=A;break}if(!M||M.size)break}let g=n.state.doc,b=n.someProp("domParser")||Uo.fromSchema(n.state.schema),_=g.resolve(l),T=null,x=b.parse(r,{topNode:_.parent,topMatch:_.parent.contentMatchAt(_.index()),topOpen:!0,from:i,to:o,preserveWhitespace:_.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:RH,context:_});if(d&&d[0].pos!=null){let A=d[0].pos,R=d[1]&&d[1].pos;R==null&&(R=A),T={anchor:A+l,head:R+l}}return{doc:x,sel:T,from:l,to:u}}function RH(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Vn&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Vn&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const kH=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function IH(n,e,t,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let I=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,N=kE(n,I);if(N&&!n.state.selection.eq(N)){if(In&&ws&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",B=>B(n,Ba(13,"Enter"))))return;let P=n.state.tr.setSelection(N);I=="pointer"?P.setMeta("pointer",!0):I=="key"&&P.scrollIntoView(),o&&P.setMeta("composition",o),n.dispatch(P)}return}let l=n.state.doc.resolve(e),u=l.sharedDepth(t);e=l.before(u+1),t=n.state.doc.resolve(t).after(u+1);let h=n.state.selection,d=xH(n,e,t),p=n.state.doc,g=p.slice(d.from,d.to),b,_;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(b=n.state.selection.to,_="end"):(b=n.state.selection.from,_="start"),n.input.lastKeyCode=null;let T=OH(g.content,d.doc.content,d.from,b,_);if(T&&n.input.domChangeCount++,(qc&&n.input.lastIOSEnter>Date.now()-225||ws)&&i.some(I=>I.nodeType==1&&!kH.test(I.nodeName))&&(!T||T.endA>=T.endB)&&n.someProp("handleKeyDown",I=>I(n,Ba(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!T)if(r&&h instanceof Ne&&!h.empty&&h.$head.sameParent(h.$anchor)&&!n.composing&&!(d.sel&&d.sel.anchor!=d.sel.head))T={start:h.from,endA:h.to,endB:h.to};else{if(d.sel){let I=bx(n,n.state.doc,d.sel);if(I&&!I.eq(n.state.selection)){let N=n.state.tr.setSelection(I);o&&N.setMeta("composition",o),n.dispatch(N)}}return}n.state.selection.from<n.state.selection.to&&T.start==T.endB&&n.state.selection instanceof Ne&&(T.start>n.state.selection.from&&T.start<=n.state.selection.from+2&&n.state.selection.from>=d.from?T.start=n.state.selection.from:T.endA<n.state.selection.to&&T.endA>=n.state.selection.to-2&&n.state.selection.to<=d.to&&(T.endB+=n.state.selection.to-T.endA,T.endA=n.state.selection.to)),ir&&Bo<=11&&T.endB==T.start+1&&T.endA==T.start&&T.start>d.from&&d.doc.textBetween(T.start-d.from-1,T.start-d.from+1)==" "&&(T.start--,T.endA--,T.endB--);let x=d.doc.resolveNoCache(T.start-d.from),A=d.doc.resolveNoCache(T.endB-d.from),R=p.resolve(T.start),M=x.sameParent(A)&&x.parent.inlineContent&&R.end()>=T.endA;if((qc&&n.input.lastIOSEnter>Date.now()-225&&(!M||i.some(I=>I.nodeName=="DIV"||I.nodeName=="P"))||!M&&x.pos<d.doc.content.size&&(!x.sameParent(A)||!x.parent.inlineContent)&&x.pos<A.pos&&!/\S/.test(d.doc.textBetween(x.pos,A.pos,"","")))&&n.someProp("handleKeyDown",I=>I(n,Ba(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>T.start&&MH(p,T.start,T.endA,x,A)&&n.someProp("handleKeyDown",I=>I(n,Ba(8,"Backspace")))){ws&&In&&n.domObserver.suppressSelectionUpdates();return}In&&T.endB==T.start&&(n.input.lastChromeDelete=Date.now()),ws&&!M&&x.start()!=A.start()&&A.parentOffset==0&&x.depth==A.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==T.endA&&(T.endB-=2,A=d.doc.resolveNoCache(T.endB-d.from),setTimeout(()=>{n.someProp("handleKeyDown",function(I){return I(n,Ba(13,"Enter"))})},20));let j=T.start,Y=T.endA,$=I=>{let N=I||n.state.tr.replace(j,Y,d.doc.slice(T.start-d.from,T.endB-d.from));if(d.sel){let P=bx(n,N.doc,d.sel);P&&!(In&&n.composing&&P.empty&&(T.start!=T.endB||n.input.lastChromeDelete<Date.now()-100)&&(P.head==j||P.head==N.mapping.map(Y)-1)||ir&&P.empty&&P.head==j)&&N.setSelection(P)}return o&&N.setMeta("composition",o),N.scrollIntoView()},G;if(M)if(x.pos==A.pos){ir&&Bo<=11&&x.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>xs(n),20));let I=$(n.state.tr.delete(j,Y)),N=p.resolve(T.start).marksAcross(p.resolve(T.endA));N&&I.ensureMarks(N),n.dispatch(I)}else if(T.endA==T.endB&&(G=NH(x.parent.content.cut(x.parentOffset,A.parentOffset),R.parent.content.cut(R.parentOffset,T.endA-R.start())))){let I=$(n.state.tr);G.type=="add"?I.addMark(j,Y,G.mark):I.removeMark(j,Y,G.mark),n.dispatch(I)}else if(x.parent.child(x.index()).isText&&x.index()==A.index()-(A.textOffset?0:1)){let I=x.parent.textBetween(x.parentOffset,A.parentOffset),N=()=>$(n.state.tr.insertText(I,j,Y));n.someProp("handleTextInput",P=>P(n,j,Y,I,N))||n.dispatch(N())}else n.dispatch($());else n.dispatch($())}function bx(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:IE(n,e.resolve(t.anchor),e.resolve(t.head))}function NH(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,o=r,l,u,h;for(let p=0;p<r.length;p++)i=r[p].removeFromSet(i);for(let p=0;p<t.length;p++)o=t[p].removeFromSet(o);if(i.length==1&&o.length==0)u=i[0],l="add",h=p=>p.mark(u.addToSet(p.marks));else if(i.length==0&&o.length==1)u=o[0],l="remove",h=p=>p.mark(u.removeFromSet(p.marks));else return null;let d=[];for(let p=0;p<e.childCount;p++)d.push(h(e.child(p)));if(le.from(d).eq(n))return{mark:u,type:l}}function MH(n,e,t,r,i){if(t-e<=i.pos-r.pos||Lb(r,!0,!1)<i.pos)return!1;let o=n.resolve(e);if(!r.parent.isTextblock){let u=o.nodeAfter;return u!=null&&t==e+u.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let l=n.resolve(Lb(o,!0,!0));return!l.parent.isTextblock||l.pos>t||Lb(l,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(l.parent.content)}function Lb(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function OH(n,e,t,r,i){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:l,b:u}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let h=Math.max(0,o-Math.min(l,u));r-=l+h-o}if(l<o&&n.size<e.size){let h=r<=o&&r>=l?o-r:0;o-=h,o&&o<e.size&&_x(e.textBetween(o-1,o+1))&&(o+=h?1:-1),u=o+(u-l),l=o}else if(u<o){let h=r<=o&&r>=u?o-r:0;o-=h,o&&o<n.size&&_x(n.textBetween(o-1,o+1))&&(o+=h?1:-1),l=o+(l-u),u=o}return{start:o,endA:l,endB:u}}function _x(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class eO{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new QF,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Ax),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Sx(this),Tx(this),this.nodeViews=wx(this),this.docView=tx(this.state.doc,Ex(this),Db(this),this.dom,this),this.domObserver=new TH(this,(r,i,o,l)=>IH(this,r,i,o,l)),this.domObserver.start(),YF(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&z0(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Ax),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,o=!1,l=!1;e.storedMarks&&this.composing&&(KM(this),l=!0),this.state=e;let u=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(u||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let _=wx(this);LH(_,this.nodeViews)&&(this.nodeViews=_,o=!0)}(u||t.handleDOMEvents!=this._props.handleDOMEvents)&&z0(this),this.editable=Sx(this),Tx(this);let h=Db(this),d=Ex(this),p=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",g=o||!this.docView.matchesNode(e.doc,d,h);(g||!e.selection.eq(i.selection))&&(l=!0);let b=p=="preserve"&&l&&this.dom.style.overflowAnchor==null&&uF(this);if(l){this.domObserver.stop();let _=g&&(ir||In)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&DH(i.selection,e.selection);if(g){let T=In?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=uH(this)),(o||!this.docView.update(e.doc,d,h,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=tx(e.doc,d,h,this.dom,this)),T&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(_=!0)}_||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&DF(this))?xs(this,_):(LM(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),p=="reset"?this.dom.scrollTop=0:p=="to selection"?this.scrollToSelection():b&&hF(b)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof we){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&QC(this,t.getBoundingClientRect(),e)}else QC(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new QM(e.slice,e.move,i<0?void 0:we.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let l=0;l<this.directPlugins.length;l++){let u=this.directPlugins[l].props[e];if(u!=null&&(i=t?t(u):u))return i}let o=this.state.plugins;if(o)for(let l=0;l<o.length;l++){let u=o[l].props[e];if(u!=null&&(i=t?t(u):u))return i}}hasFocus(){if(ir){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&fF(this.dom),xs(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return yF(this,e)}coordsAtPos(e,t=1){return xM(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return TF(this,t||this.state,e)}pasteHTML(e,t){return uf(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return uf(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return NE(this,e)}destroy(){this.docView&&(JF(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Db(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,eF())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return ZF(this,e)}domSelectionRange(){let e=this.domSelection();return e?Vn&&this.root.nodeType===11&&sF(this.dom.ownerDocument)==this.dom&&wH(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}eO.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function Ex(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[$n.node(0,n.state.doc.content.size,e)]}function Tx(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:$n.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Sx(n){return!n.someProp("editable",e=>e(n.state)===!1)}function DH(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function wx(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function LH(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function Ax(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Xo={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Mm={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},PH=typeof navigator<"u"&&/Mac/.test(navigator.platform),VH=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Cn=0;Cn<10;Cn++)Xo[48+Cn]=Xo[96+Cn]=String(Cn);for(var Cn=1;Cn<=24;Cn++)Xo[Cn+111]="F"+Cn;for(var Cn=65;Cn<=90;Cn++)Xo[Cn]=String.fromCharCode(Cn+32),Mm[Cn]=String.fromCharCode(Cn);for(var Pb in Xo)Mm.hasOwnProperty(Pb)||(Mm[Pb]=Xo[Pb]);function jH(n){var e=PH&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||VH&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Mm:Xo)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const UH=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),BH=typeof navigator<"u"&&/Win/.test(navigator.platform);function zH(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,l;for(let u=0;u<e.length-1;u++){let h=e[u];if(/^(cmd|meta|m)$/i.test(h))l=!0;else if(/^a(lt)?$/i.test(h))r=!0;else if(/^(c|ctrl|control)$/i.test(h))i=!0;else if(/^s(hift)?$/i.test(h))o=!0;else if(/^mod$/i.test(h))UH?l=!0:i=!0;else throw new Error("Unrecognized modifier name: "+h)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),l&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function FH(n){let e=Object.create(null);for(let t in n)e[zH(t)]=n[t];return e}function Vb(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function HH(n){return new At({props:{handleKeyDown:tO(n)}})}function tO(n){let e=FH(n);return function(t,r){let i=jH(r),o,l=e[Vb(i,r)];if(l&&l(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let u=e[Vb(i,r,!1)];if(u&&u(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(BH&&r.ctrlKey&&r.altKey)&&(o=Xo[r.keyCode])&&o!=i){let u=e[Vb(o,r)];if(u&&u(t.state,t.dispatch,t))return!0}}return!1}}var qH=Object.defineProperty,VE=(n,e)=>{for(var t in e)qH(n,t,{get:e[t],enumerable:!0})};function Gg(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,o=t.storedMarks,t}}}var Kg=class{constructor(n){this.editor=n.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=n.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:n,editor:e,state:t}=this,{view:r}=e,{tr:i}=t,o=this.buildProps(i);return Object.fromEntries(Object.entries(n).map(([l,u])=>[l,(...d)=>{const p=u(...d)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),p}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(n,e=!0){const{rawCommands:t,editor:r,state:i}=this,{view:o}=r,l=[],u=!!n,h=n||i.tr,d=()=>(!u&&e&&!h.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(h),l.every(g=>g===!0)),p={...Object.fromEntries(Object.entries(t).map(([g,b])=>[g,(...T)=>{const x=this.buildProps(h,e),A=b(...T)(x);return l.push(A),p}])),run:d};return p}createCan(n){const{rawCommands:e,state:t}=this,r=!1,i=n||t.tr,o=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(e).map(([u,h])=>[u,(...d)=>h(...d)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(n,e=!0){const{rawCommands:t,editor:r,state:i}=this,{view:o}=r,l={tr:n,editor:r,view:o,state:Gg({state:i,transaction:n}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(n,e),can:()=>this.createCan(n),get commands(){return Object.fromEntries(Object.entries(t).map(([u,h])=>[u,(...d)=>h(...d)(l)]))}};return l}},nO={};VE(nO,{blur:()=>$H,clearContent:()=>GH,clearNodes:()=>KH,command:()=>WH,createParagraphNear:()=>QH,cut:()=>YH,deleteCurrentNode:()=>JH,deleteNode:()=>XH,deleteRange:()=>ZH,deleteSelection:()=>eq,enter:()=>tq,exitCode:()=>nq,extendMarkRange:()=>rq,first:()=>iq,focus:()=>oq,forEach:()=>aq,insertContent:()=>lq,insertContentAt:()=>hq,joinBackward:()=>pq,joinDown:()=>dq,joinForward:()=>mq,joinItemBackward:()=>gq,joinItemForward:()=>yq,joinTextblockBackward:()=>vq,joinTextblockForward:()=>bq,joinUp:()=>fq,keyboardShortcut:()=>Eq,lift:()=>Tq,liftEmptyBlock:()=>Sq,liftListItem:()=>wq,newlineInCode:()=>Aq,resetAttributes:()=>Cq,scrollIntoView:()=>xq,selectAll:()=>Rq,selectNodeBackward:()=>kq,selectNodeForward:()=>Iq,selectParentNode:()=>Nq,selectTextblockEnd:()=>Mq,selectTextblockStart:()=>Oq,setContent:()=>Dq,setMark:()=>e8,setMeta:()=>t8,setNode:()=>n8,setNodeSelection:()=>r8,setTextDirection:()=>i8,setTextSelection:()=>s8,sinkListItem:()=>o8,splitBlock:()=>a8,splitListItem:()=>l8,toggleList:()=>c8,toggleMark:()=>u8,toggleNode:()=>h8,toggleWrap:()=>f8,undoInputRule:()=>d8,unsetAllMarks:()=>p8,unsetMark:()=>m8,unsetTextDirection:()=>g8,updateAttributes:()=>y8,wrapIn:()=>v8,wrapInList:()=>b8});var $H=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window?.getSelection())==null||t.removeAllRanges())}),!0),GH=(n=!0)=>({commands:e})=>e.setContent("",{emitUpdate:n}),KH=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:o,$to:l})=>{n.doc.nodesBetween(o.pos,l.pos,(u,h)=>{if(u.type.isText)return;const{doc:d,mapping:p}=e,g=d.resolve(p.map(h)),b=d.resolve(p.map(h+u.nodeSize)),_=g.blockRange(b);if(!_)return;const T=iu(_);if(u.type.isTextblock){const{defaultType:x}=g.parent.contentMatchAt(g.index());e.setNodeMarkup(_.start,x)}(T||T===0)&&e.lift(_,T)})}),!0},WH=n=>e=>n(e),QH=()=>({state:n,dispatch:e})=>gM(n,e),YH=(n,e)=>({editor:t,tr:r})=>{const{state:i}=t,o=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const l=r.mapping.map(e);return r.insert(l,o.content),r.setSelection(new Ne(r.doc.resolve(Math.max(l-1,0)))),!0},JH=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const u=i.before(o),h=i.after(o);n.delete(u,h).scrollIntoView()}return!0}return!1};function Zt(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}var XH=n=>({tr:e,state:t,dispatch:r})=>{const i=Zt(n,t.schema),o=e.selection.$anchor;for(let l=o.depth;l>0;l-=1)if(o.node(l).type===i){if(r){const h=o.before(l),d=o.after(l);e.delete(h,d).scrollIntoView()}return!0}return!1},ZH=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},eq=()=>({state:n,dispatch:e})=>SE(n,e),tq=()=>({commands:n})=>n.keyboardShortcut("Enter"),nq=()=>({state:n,dispatch:e})=>U9(n,e);function jE(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function Om(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:jE(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function rO(n,e,t={}){return n.find(r=>r.type===e&&Om(Object.fromEntries(Object.keys(t).map(i=>[i,r.attrs[i]])),t))}function Cx(n,e,t={}){return!!rO(n,e,t)}function UE(n,e,t){var r;if(!n||!e)return;let i=n.parent.childAfter(n.parentOffset);if((!i.node||!i.node.marks.some(p=>p.type===e))&&(i=n.parent.childBefore(n.parentOffset)),!i.node||!i.node.marks.some(p=>p.type===e)||(t=t||((r=i.node.marks[0])==null?void 0:r.attrs),!rO([...i.node.marks],e,t)))return;let l=i.index,u=n.start()+i.offset,h=l+1,d=u+i.node.nodeSize;for(;l>0&&Cx([...n.parent.child(l-1).marks],e,t);)l-=1,u-=n.parent.child(l).nodeSize;for(;h<n.parent.childCount&&Cx([...n.parent.child(h).marks],e,t);)d+=n.parent.child(h).nodeSize,h+=1;return{from:u,to:d}}function Os(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}var rq=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const o=Os(n,r.schema),{doc:l,selection:u}=t,{$from:h,from:d,to:p}=u;if(i){const g=UE(h,o,e);if(g&&g.from<=d&&g.to>=p){const b=Ne.create(l,g.from,g.to);t.setSelection(b)}}return!0},iq=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function iO(n){return n instanceof Ne}function qa(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function sO(n,e=null){if(!e)return null;const t=Ue.atStart(n),r=Ue.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,o=r.to;return e==="all"?Ne.create(n,qa(0,i,o),qa(n.content.size,i,o)):Ne.create(n,qa(e,i,o),qa(e,i,o))}function xx(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Dm(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function sq(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var oq=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const l=()=>{(Dm()||xx())&&r.dom.focus(),sq()&&!Dm()&&!xx()&&r.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};try{if(r.hasFocus()&&n===null||n===!1)return!0}catch{return!1}if(o&&n===null&&!iO(t.state.selection))return l(),!0;const u=sO(i.doc,n)||t.state.selection,h=t.state.selection.eq(u);return o&&(h||i.setSelection(u),h&&i.storedMarks&&i.setStoredMarks(i.storedMarks),l()),!0},aq=(n,e)=>t=>n.every((r,i)=>e(r,{...t,index:i})),lq=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),oO=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&oO(r)}return n};function Ap(n){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return oO(t)}function ff(n,e,t){if(n instanceof oi||n instanceof le)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,i=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return le.fromArray(n.map(u=>e.nodeFromJSON(u)));const l=e.nodeFromJSON(n);return t.errorOnInvalidContent&&l.check(),l}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),ff("",e,t)}if(i){if(t.errorOnInvalidContent){let l=!1,u="";const h=new HN({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:d=>(l=!0,u=typeof d=="string"?d:d.outerHTML,null)}]}})});if(t.slice?Uo.fromSchema(h).parseSlice(Ap(n),t.parseOptions):Uo.fromSchema(h).parse(Ap(n),t.parseOptions),t.errorOnInvalidContent&&l)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${u}`)})}const o=Uo.fromSchema(e);return t.slice?o.parseSlice(Ap(n),t.parseOptions).content:o.parse(Ap(n),t.parseOptions)}return ff("",e,t)}function cq(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof fn||i instanceof mn))return;const o=n.mapping.maps[r];let l=0;o.forEach((u,h,d,p)=>{l===0&&(l=p)}),n.setSelection(Ue.near(n.doc.resolve(l),t))}var uq=n=>!("type"in n),hq=(n,e,t)=>({tr:r,dispatch:i,editor:o})=>{var l;if(i){t={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let u;const h=A=>{o.emit("contentError",{editor:o,error:A,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},d={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{ff(e,o.schema,{parseOptions:d,errorOnInvalidContent:!0})}catch(A){h(A)}try{u=ff(e,o.schema,{parseOptions:d,errorOnInvalidContent:(l=t.errorOnInvalidContent)!=null?l:o.options.enableContentCheck})}catch(A){return h(A),!1}let{from:p,to:g}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},b=!0,_=!0;if((uq(u)?u:[u]).forEach(A=>{A.check(),b=b?A.isText&&A.marks.length===0:!1,_=_?A.isBlock:!1}),p===g&&_){const{parent:A}=r.doc.resolve(p);A.isTextblock&&!A.type.spec.code&&!A.childCount&&(p-=1,g+=1)}let x;if(b){if(Array.isArray(e))x=e.map(A=>A.text||"").join("");else if(e instanceof le){let A="";e.forEach(R=>{R.text&&(A+=R.text)}),x=A}else typeof e=="object"&&e&&e.text?x=e.text:x=e;r.insertText(x,p,g)}else{x=u;const A=r.doc.resolve(p),R=A.node(),M=A.parentOffset===0,j=R.isText||R.isTextblock,Y=R.content.size>0;M&&j&&Y&&(p=Math.max(0,p-1)),r.replaceWith(p,g,x)}t.updateSelection&&cq(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:p,text:x}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:p,text:x})}return!0},fq=()=>({state:n,dispatch:e})=>P9(n,e),dq=()=>({state:n,dispatch:e})=>V9(n,e),pq=()=>({state:n,dispatch:e})=>cM(n,e),mq=()=>({state:n,dispatch:e})=>dM(n,e),gq=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Bg(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},yq=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Bg(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},vq=()=>({state:n,dispatch:e})=>D9(n,e),bq=()=>({state:n,dispatch:e})=>L9(n,e);function aO(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function _q(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,o,l;for(let u=0;u<e.length-1;u+=1){const h=e[u];if(/^(cmd|meta|m)$/i.test(h))l=!0;else if(/^a(lt)?$/i.test(h))r=!0;else if(/^(c|ctrl|control)$/i.test(h))i=!0;else if(/^s(hift)?$/i.test(h))o=!0;else if(/^mod$/i.test(h))Dm()||aO()?l=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${h}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),l&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}var Eq=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const o=_q(n).split(/-(?!$)/),l=o.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),u=new KeyboardEvent("keydown",{key:l==="Space"?" ":l,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),h=e.captureTransaction(()=>{t.someProp("handleKeyDown",d=>d(t,u))});return h?.steps.forEach(d=>{const p=d.map(r.mapping);p&&i&&r.maybeStep(p)}),!0};function Zo(n,e,t={}){const{from:r,to:i,empty:o}=n.selection,l=e?Zt(e,n.schema):null,u=[];n.doc.nodesBetween(r,i,(g,b)=>{if(g.isText)return;const _=Math.max(r,b),T=Math.min(i,b+g.nodeSize);u.push({node:g,from:_,to:T})});const h=i-r,d=u.filter(g=>l?l.name===g.node.type.name:!0).filter(g=>Om(g.node.attrs,t,{strict:!1}));return o?!!d.length:d.reduce((g,b)=>g+b.to-b.from,0)>=h}var Tq=(n,e={})=>({state:t,dispatch:r})=>{const i=Zt(n,t.schema);return Zo(t,i,e)?j9(t,r):!1},Sq=()=>({state:n,dispatch:e})=>yM(n,e),wq=n=>({state:e,dispatch:t})=>{const r=Zt(n,e.schema);return Y9(r)(e,t)},Aq=()=>({state:n,dispatch:e})=>mM(n,e);function Wg(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function Rx(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}var Cq=(n,e)=>({tr:t,state:r,dispatch:i})=>{let o=null,l=null;const u=Wg(typeof n=="string"?n:n.name,r.schema);if(!u)return!1;u==="node"&&(o=Zt(n,r.schema)),u==="mark"&&(l=Os(n,r.schema));let h=!1;return t.selection.ranges.forEach(d=>{r.doc.nodesBetween(d.$from.pos,d.$to.pos,(p,g)=>{o&&o===p.type&&(h=!0,i&&t.setNodeMarkup(g,void 0,Rx(p.attrs,e))),l&&p.marks.length&&p.marks.forEach(b=>{l===b.type&&(h=!0,i&&t.addMark(g,g+p.nodeSize,l.create(Rx(b.attrs,e))))})})}),h},xq=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),Rq=()=>({tr:n,dispatch:e})=>{if(e){const t=new br(n.doc);n.setSelection(t)}return!0},kq=()=>({state:n,dispatch:e})=>hM(n,e),Iq=()=>({state:n,dispatch:e})=>pM(n,e),Nq=()=>({state:n,dispatch:e})=>F9(n,e),Mq=()=>({state:n,dispatch:e})=>$9(n,e),Oq=()=>({state:n,dispatch:e})=>q9(n,e);function F0(n,e,t={},r={}){return ff(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}var Dq=(n,{errorOnInvalidContent:e,emitUpdate:t=!0,parseOptions:r={}}={})=>({editor:i,tr:o,dispatch:l,commands:u})=>{const{doc:h}=o;if(r.preserveWhitespace!=="full"){const d=F0(n,i.schema,r,{errorOnInvalidContent:e??i.options.enableContentCheck});return l&&o.replaceWith(0,h.content.size,d).setMeta("preventUpdate",!t),!0}return l&&o.setMeta("preventUpdate",!t),u.insertContentAt({from:0,to:h.content.size},n,{parseOptions:r,errorOnInvalidContent:e??i.options.enableContentCheck})};function lO(n,e){const t=Os(e,n.schema),{from:r,to:i,empty:o}=n.selection,l=[];o?(n.storedMarks&&l.push(...n.storedMarks),l.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,h=>{l.push(...h.marks)});const u=l.find(h=>h.type.name===t.name);return u?{...u.attrs}:{}}function cO(n,e){const t=new sM(n);return e.forEach(r=>{r.steps.forEach(i=>{t.step(i)})}),t}function Lq(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function Pq(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(i,o)=>{t(i)&&r.push({node:i,pos:o})}),r}function Vq(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Qg(n){return e=>Vq(e.$from,n)}function Ee(n,e,t){return n.config[e]===void 0&&n.parent?Ee(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?Ee(n.parent,e,t):null}):n.config[e]}function BE(n){return n.map(e=>{const t={name:e.name,options:e.options,storage:e.storage},r=Ee(e,"addExtensions",t);return r?[e,...BE(r())]:e}).flat(10)}function zE(n,e){const t=gl.fromSchema(e).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}function uO(n){return typeof n=="function"}function st(n,e=void 0,...t){return uO(n)?e?n.bind(e)(...t):n(...t):n}function jq(n={}){return Object.keys(n).length===0&&n.constructor===Object}function $c(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function hO(n){const e=[],{nodeExtensions:t,markExtensions:r}=$c(n),i=[...t,...r],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(l=>{const u={name:l.name,options:l.options,storage:l.storage,extensions:i},h=Ee(l,"addGlobalAttributes",u);if(!h)return;h().forEach(p=>{p.types.forEach(g=>{Object.entries(p.attributes).forEach(([b,_])=>{e.push({type:g,name:b,attribute:{...o,..._}})})})})}),i.forEach(l=>{const u={name:l.name,options:l.options,storage:l.storage},h=Ee(l,"addAttributes",u);if(!h)return;const d=h();Object.entries(d).forEach(([p,g])=>{const b={...o,...g};typeof b?.default=="function"&&(b.default=b.default()),b?.isRequired&&b?.default===void 0&&delete b.default,e.push({type:l.name,name:p,attribute:b})})}),e}function en(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const u=o?String(o).split(" "):[],h=r[i]?r[i].split(" "):[],d=u.filter(p=>!h.includes(p));r[i]=[...h,...d].join(" ")}else if(i==="style"){const u=o?o.split(";").map(p=>p.trim()).filter(Boolean):[],h=r[i]?r[i].split(";").map(p=>p.trim()).filter(Boolean):[],d=new Map;h.forEach(p=>{const[g,b]=p.split(":").map(_=>_.trim());d.set(g,b)}),u.forEach(p=>{const[g,b]=p.split(":").map(_=>_.trim());d.set(g,b)}),r[i]=Array.from(d.entries()).map(([p,g])=>`${p}: ${g}`).join("; ")}else r[i]=o}),r},{})}function df(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>en(t,r),{})}function Uq(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function kx(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const i=e.reduce((o,l)=>{const u=l.attribute.parseHTML?l.attribute.parseHTML(t):Uq(t.getAttribute(l.name));return u==null?o:{...o,[l.name]:u}},{});return{...r,...i}}}}function Ix(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&jq(t)?!1:t!=null))}function Nx(n){var e,t;const r={};return!((e=n?.attribute)!=null&&e.isRequired)&&"default"in(n?.attribute||{})&&(r.default=n.attribute.default),((t=n?.attribute)==null?void 0:t.validate)!==void 0&&(r.validate=n.attribute.validate),[n.name,r]}function Bq(n,e){var t;const r=hO(n),{nodeExtensions:i,markExtensions:o}=$c(n),l=(t=i.find(d=>Ee(d,"topNode")))==null?void 0:t.name,u=Object.fromEntries(i.map(d=>{const p=r.filter(R=>R.type===d.name),g={name:d.name,options:d.options,storage:d.storage,editor:e},b=n.reduce((R,M)=>{const j=Ee(M,"extendNodeSchema",g);return{...R,...j?j(d):{}}},{}),_=Ix({...b,content:st(Ee(d,"content",g)),marks:st(Ee(d,"marks",g)),group:st(Ee(d,"group",g)),inline:st(Ee(d,"inline",g)),atom:st(Ee(d,"atom",g)),selectable:st(Ee(d,"selectable",g)),draggable:st(Ee(d,"draggable",g)),code:st(Ee(d,"code",g)),whitespace:st(Ee(d,"whitespace",g)),linebreakReplacement:st(Ee(d,"linebreakReplacement",g)),defining:st(Ee(d,"defining",g)),isolating:st(Ee(d,"isolating",g)),attrs:Object.fromEntries(p.map(Nx))}),T=st(Ee(d,"parseHTML",g));T&&(_.parseDOM=T.map(R=>kx(R,p)));const x=Ee(d,"renderHTML",g);x&&(_.toDOM=R=>x({node:R,HTMLAttributes:df(R,p)}));const A=Ee(d,"renderText",g);return A&&(_.toText=A),[d.name,_]})),h=Object.fromEntries(o.map(d=>{const p=r.filter(A=>A.type===d.name),g={name:d.name,options:d.options,storage:d.storage,editor:e},b=n.reduce((A,R)=>{const M=Ee(R,"extendMarkSchema",g);return{...A,...M?M(d):{}}},{}),_=Ix({...b,inclusive:st(Ee(d,"inclusive",g)),excludes:st(Ee(d,"excludes",g)),group:st(Ee(d,"group",g)),spanning:st(Ee(d,"spanning",g)),code:st(Ee(d,"code",g)),attrs:Object.fromEntries(p.map(Nx))}),T=st(Ee(d,"parseHTML",g));T&&(_.parseDOM=T.map(A=>kx(A,p)));const x=Ee(d,"renderHTML",g);return x&&(_.toDOM=A=>x({mark:A,HTMLAttributes:df(A,p)})),[d.name,_]}));return new HN({topNode:l,nodes:u,marks:h})}function zq(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}function Lm(n){return n.sort((t,r)=>{const i=Ee(t,"priority")||100,o=Ee(r,"priority")||100;return i>o?-1:i<o?1:0})}function fO(n){const e=Lm(BE(n)),t=zq(e.map(r=>r.name));return t.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${t.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function dO(n,e,t){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:l={}}=t||{};let u="";return n.nodesBetween(r,i,(h,d,p,g)=>{var b;h.isBlock&&d>r&&(u+=o);const _=l?.[h.type.name];if(_)return p&&(u+=_({node:h,pos:d,parent:p,index:g,range:e})),!1;h.isText&&(u+=(b=h?.text)==null?void 0:b.slice(Math.max(r,d)-d,i-d))}),u}function Fq(n,e){const t={from:0,to:n.content.size};return dO(n,t,e)}function pO(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}function Hq(n,e){const t=Zt(e,n.schema),{from:r,to:i}=n.selection,o=[];n.doc.nodesBetween(r,i,u=>{o.push(u)});const l=o.reverse().find(u=>u.type.name===t.name);return l?{...l.attrs}:{}}function mO(n,e){const t=Wg(typeof e=="string"?e:e.name,n.schema);return t==="node"?Hq(n,e):t==="mark"?lO(n,e):{}}function qq(n,e=JSON.stringify){const t={};return n.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(t,i)?!1:t[i]=!0})}function $q(n){const e=qq(n);return e.length===1?e:e.filter((t,r)=>!e.filter((o,l)=>l!==r).some(o=>t.oldRange.from>=o.oldRange.from&&t.oldRange.to<=o.oldRange.to&&t.newRange.from>=o.newRange.from&&t.newRange.to<=o.newRange.to))}function gO(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((i,o)=>{const l=[];if(i.ranges.length)i.forEach((u,h)=>{l.push({from:u,to:h})});else{const{from:u,to:h}=t[o];if(u===void 0||h===void 0)return;l.push({from:u,to:h})}l.forEach(({from:u,to:h})=>{const d=e.slice(o).map(u,-1),p=e.slice(o).map(h),g=e.invert().map(d,-1),b=e.invert().map(p);r.push({oldRange:{from:g,to:b},newRange:{from:d,to:p}})})}),$q(r)}function FE(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(i=>{const o=t.resolve(n),l=UE(o,i.type);l&&r.push({mark:i,...l})}):t.nodesBetween(n,e,(i,o)=>{!i||i?.nodeSize===void 0||r.push(...i.marks.map(l=>({from:o,to:o+i.nodeSize,mark:l})))}),r}var Gq=(n,e,t,r=20)=>{const i=n.doc.resolve(t);let o=r,l=null;for(;o>0&&l===null;){const u=i.node(o);u?.type.name===e?l=u:o-=1}return[l,o]};function Cp(n,e){return e.nodes[n]||e.marks[n]||null}function Jp(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}var Kq=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(i,o,l,u)=>{var h,d;const p=((d=(h=i.type.spec).toText)==null?void 0:d.call(h,{node:i,pos:o,parent:l,index:u}))||i.textContent||"%leaf%";t+=i.isAtom&&!i.isText?p:p.slice(0,Math.max(0,r-o))}),t};function H0(n,e,t={}){const{empty:r,ranges:i}=n.selection,o=e?Os(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(g=>o?o.name===g.type.name:!0).find(g=>Om(g.attrs,t,{strict:!1}));let l=0;const u=[];if(i.forEach(({$from:g,$to:b})=>{const _=g.pos,T=b.pos;n.doc.nodesBetween(_,T,(x,A)=>{if(!x.isText&&!x.marks.length)return;const R=Math.max(_,A),M=Math.min(T,A+x.nodeSize),j=M-R;l+=j,u.push(...x.marks.map(Y=>({mark:Y,from:R,to:M})))})}),l===0)return!1;const h=u.filter(g=>o?o.name===g.mark.type.name:!0).filter(g=>Om(g.mark.attrs,t,{strict:!1})).reduce((g,b)=>g+b.to-b.from,0),d=u.filter(g=>o?g.mark.type!==o&&g.mark.type.excludes(o):!0).reduce((g,b)=>g+b.to-b.from,0);return(h>0?h+d:h)>=l}function Wq(n,e,t={}){if(!e)return Zo(n,null,t)||H0(n,null,t);const r=Wg(e,n.schema);return r==="node"?Zo(n,e,t):r==="mark"?H0(n,e,t):!1}var Qq=(n,e)=>{const{$from:t,$to:r,$anchor:i}=n.selection;if(e){const o=Qg(u=>u.type.name===e)(n.selection);if(!o)return!1;const l=n.doc.resolve(o.pos+1);return i.pos+1===l.end()}return!(r.parentOffset<r.parent.nodeSize-2||t.pos!==r.pos)},Yq=n=>{const{$from:e,$to:t}=n.selection;return!(e.parentOffset>0||e.pos!==t.pos)};function Mx(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function Ox(n,e){const{nodeExtensions:t}=$c(e),r=t.find(l=>l.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=st(Ee(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function Yg(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!=null?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let i=!0;return n.content.forEach(o=>{i!==!1&&(Yg(o,{ignoreWhitespace:t,checkChildren:e})||(i=!1))}),i}return!1}function yO(n){return n instanceof we}var vO=class bO{constructor(e){this.position=e}static fromJSON(e){return new bO(e.position)}toJSON(){return{position:this.position}}};function Jq(n,e){const t=e.mapping.mapResult(n.position);return{position:new vO(t.pos),mapResult:t}}function Xq(n){return new vO(n)}function Zq(n,e,t){var r;const{selection:i}=e;let o=null;if(iO(i)&&(o=i.$cursor),o){const u=(r=n.storedMarks)!=null?r:o.marks();return o.parent.type.allowsMarkType(t)&&(!!t.isInSet(u)||!u.some(d=>d.type.excludes(t)))}const{ranges:l}=i;return l.some(({$from:u,$to:h})=>{let d=u.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(u.pos,h.pos,(p,g,b)=>{if(d)return!1;if(p.isInline){const _=!b||b.type.allowsMarkType(t),T=!!t.isInSet(p.marks)||!p.marks.some(x=>x.type.excludes(t));d=_&&T}return!d}),d})}var e8=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:o}=t,{empty:l,ranges:u}=o,h=Os(n,r.schema);if(i)if(l){const d=lO(r,h);t.addStoredMark(h.create({...d,...e}))}else u.forEach(d=>{const p=d.$from.pos,g=d.$to.pos;r.doc.nodesBetween(p,g,(b,_)=>{const T=Math.max(_,p),x=Math.min(_+b.nodeSize,g);b.marks.find(R=>R.type===h)?b.marks.forEach(R=>{h===R.type&&t.addMark(T,x,h.create({...R.attrs,...e}))}):t.addMark(T,x,h.create(e))})});return Zq(r,t,h)},t8=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),n8=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const o=Zt(n,t.schema);let l;return t.selection.$anchor.sameParent(t.selection.$head)&&(l=t.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:u})=>GC(o,{...l,...e})(t)?!0:u.clearNodes()).command(({state:u})=>GC(o,{...l,...e})(u,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},r8=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=qa(n,0,r.content.size),o=we.create(r,i);e.setSelection(o)}return!0},i8=(n,e)=>({tr:t,state:r,dispatch:i})=>{const{selection:o}=r;let l,u;return typeof e=="number"?(l=e,u=e):e&&"from"in e&&"to"in e?(l=e.from,u=e.to):(l=o.from,u=o.to),i&&t.doc.nodesBetween(l,u,(h,d)=>{h.isText||t.setNodeMarkup(d,void 0,{...h.attrs,dir:n})}),!0},s8=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:o}=typeof n=="number"?{from:n,to:n}:n,l=Ne.atStart(r).from,u=Ne.atEnd(r).to,h=qa(i,l,u),d=qa(o,l,u),p=Ne.create(r,h,d);e.setSelection(p)}return!0},o8=n=>({state:e,dispatch:t})=>{const r=Zt(n,e.schema);return Z9(r)(e,t)};function Dx(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e?.includes(i.type.name));n.tr.ensureMarks(r)}}var a8=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:o,doc:l}=e,{$from:u,$to:h}=o,d=i.extensionManager.attributes,p=Jp(d,u.node().type.name,u.node().attrs);if(o instanceof we&&o.node.isBlock)return!u.parentOffset||!Cs(l,u.pos)?!1:(r&&(n&&Dx(t,i.extensionManager.splittableMarks),e.split(u.pos).scrollIntoView()),!0);if(!u.parent.isBlock)return!1;const g=h.parentOffset===h.parent.content.size,b=u.depth===0?void 0:Lq(u.node(-1).contentMatchAt(u.indexAfter(-1)));let _=g&&b?[{type:b,attrs:p}]:void 0,T=Cs(e.doc,e.mapping.map(u.pos),1,_);if(!_&&!T&&Cs(e.doc,e.mapping.map(u.pos),1,b?[{type:b}]:void 0)&&(T=!0,_=b?[{type:b,attrs:p}]:void 0),r){if(T&&(o instanceof Ne&&e.deleteSelection(),e.split(e.mapping.map(u.pos),1,_),b&&!g&&!u.parentOffset&&u.parent.type!==b)){const x=e.mapping.map(u.before()),A=e.doc.resolve(x);u.node(-1).canReplaceWith(A.index(),A.index()+1,b)&&e.setNodeMarkup(e.mapping.map(u.before()),b)}n&&Dx(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return T},l8=(n,e={})=>({tr:t,state:r,dispatch:i,editor:o})=>{var l;const u=Zt(n,r.schema),{$from:h,$to:d}=r.selection,p=r.selection.node;if(p&&p.isBlock||h.depth<2||!h.sameParent(d))return!1;const g=h.node(-1);if(g.type!==u)return!1;const b=o.extensionManager.attributes;if(h.parent.content.size===0&&h.node(-1).childCount===h.indexAfter(-1)){if(h.depth===2||h.node(-3).type!==u||h.index(-2)!==h.node(-2).childCount-1)return!1;if(i){let R=le.empty;const M=h.index(-1)?1:h.index(-2)?2:3;for(let N=h.depth-M;N>=h.depth-3;N-=1)R=le.from(h.node(N).copy(R));const j=h.indexAfter(-1)<h.node(-2).childCount?1:h.indexAfter(-2)<h.node(-3).childCount?2:3,Y={...Jp(b,h.node().type.name,h.node().attrs),...e},$=((l=u.contentMatch.defaultType)==null?void 0:l.createAndFill(Y))||void 0;R=R.append(le.from(u.createAndFill(null,$)||void 0));const G=h.before(h.depth-(M-1));t.replace(G,h.after(-j),new me(R,4-M,0));let I=-1;t.doc.nodesBetween(G,t.doc.content.size,(N,P)=>{if(I>-1)return!1;N.isTextblock&&N.content.size===0&&(I=P+1)}),I>-1&&t.setSelection(Ne.near(t.doc.resolve(I))),t.scrollIntoView()}return!0}const _=d.pos===h.end()?g.contentMatchAt(0).defaultType:null,T={...Jp(b,g.type.name,g.attrs),...e},x={...Jp(b,h.node().type.name,h.node().attrs),...e};t.delete(h.pos,d.pos);const A=_?[{type:u,attrs:T},{type:_,attrs:x}]:[{type:u,attrs:T}];if(!Cs(t.doc,h.pos,2))return!1;if(i){const{selection:R,storedMarks:M}=r,{splittableMarks:j}=o.extensionManager,Y=M||R.$to.parentOffset&&R.$from.marks();if(t.split(h.pos,2,A).scrollIntoView(),!Y||!i)return!0;const $=Y.filter(G=>j.includes(G.type.name));t.ensureMarks($)}return!0},jb=(n,e)=>{const t=Qg(l=>l.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&ia(n.doc,t.pos)&&n.join(t.pos),!0},Ub=(n,e)=>{const t=Qg(l=>l.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&ia(n.doc,r)&&n.join(r),!0},c8=(n,e,t,r={})=>({editor:i,tr:o,state:l,dispatch:u,chain:h,commands:d,can:p})=>{const{extensions:g,splittableMarks:b}=i.extensionManager,_=Zt(n,l.schema),T=Zt(e,l.schema),{selection:x,storedMarks:A}=l,{$from:R,$to:M}=x,j=R.blockRange(M),Y=A||x.$to.parentOffset&&x.$from.marks();if(!j)return!1;const $=Qg(G=>Ox(G.type.name,g))(x);if(j.depth>=1&&$&&j.depth-$.depth<=1){if($.node.type===_)return d.liftListItem(T);if(Ox($.node.type.name,g)&&_.validContent($.node.content)&&u)return h().command(()=>(o.setNodeMarkup($.pos,_),!0)).command(()=>jb(o,_)).command(()=>Ub(o,_)).run()}return!t||!Y||!u?h().command(()=>p().wrapInList(_,r)?!0:d.clearNodes()).wrapInList(_,r).command(()=>jb(o,_)).command(()=>Ub(o,_)).run():h().command(()=>{const G=p().wrapInList(_,r),I=Y.filter(N=>b.includes(N.type.name));return o.ensureMarks(I),G?!0:d.clearNodes()}).wrapInList(_,r).command(()=>jb(o,_)).command(()=>Ub(o,_)).run()},u8=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=t,l=Os(n,r.schema);return H0(r,l,e)?i.unsetMark(l,{extendEmptyMarkRange:o}):i.setMark(l,e)},h8=(n,e,t={})=>({state:r,commands:i})=>{const o=Zt(n,r.schema),l=Zt(e,r.schema),u=Zo(r,o,t);let h;return r.selection.$anchor.sameParent(r.selection.$head)&&(h=r.selection.$anchor.parent.attrs),u?i.setNode(l,h):i.setNode(o,{...h,...t})},f8=(n,e={})=>({state:t,commands:r})=>{const i=Zt(n,t.schema);return Zo(t,i,e)?r.lift(i):r.wrapIn(i,e)},d8=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let o;if(i.spec.isInputRules&&(o=i.getState(n))){if(e){const l=n.tr,u=o.transform;for(let h=u.steps.length-1;h>=0;h-=1)l.step(u.steps[h].invert(u.docs[h]));if(o.text){const h=l.doc.resolve(o.from).marks();l.replaceWith(o.from,o.to,n.schema.text(o.text,h))}else l.delete(o.from,o.to)}return!0}}return!1},p8=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(o=>{n.removeMark(o.$from.pos,o.$to.pos)}),!0},m8=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:l=!1}=e,{selection:u}=t,h=Os(n,r.schema),{$from:d,empty:p,ranges:g}=u;if(!i)return!0;if(p&&l){let{from:b,to:_}=u;const T=(o=d.marks().find(A=>A.type===h))==null?void 0:o.attrs,x=UE(d,h,T);x&&(b=x.from,_=x.to),t.removeMark(b,_,h)}else g.forEach(b=>{t.removeMark(b.$from.pos,b.$to.pos,h)});return t.removeStoredMark(h),!0},g8=n=>({tr:e,state:t,dispatch:r})=>{const{selection:i}=t;let o,l;return typeof n=="number"?(o=n,l=n):n&&"from"in n&&"to"in n?(o=n.from,l=n.to):(o=i.from,l=i.to),r&&e.doc.nodesBetween(o,l,(u,h)=>{if(u.isText)return;const d={...u.attrs};delete d.dir,e.setNodeMarkup(h,void 0,d)}),!0},y8=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let o=null,l=null;const u=Wg(typeof n=="string"?n:n.name,r.schema);if(!u)return!1;u==="node"&&(o=Zt(n,r.schema)),u==="mark"&&(l=Os(n,r.schema));let h=!1;return t.selection.ranges.forEach(d=>{const p=d.$from.pos,g=d.$to.pos;let b,_,T,x;t.selection.empty?r.doc.nodesBetween(p,g,(A,R)=>{o&&o===A.type&&(h=!0,T=Math.max(R,p),x=Math.min(R+A.nodeSize,g),b=R,_=A)}):r.doc.nodesBetween(p,g,(A,R)=>{R<p&&o&&o===A.type&&(h=!0,T=Math.max(R,p),x=Math.min(R+A.nodeSize,g),b=R,_=A),R>=p&&R<=g&&(o&&o===A.type&&(h=!0,i&&t.setNodeMarkup(R,void 0,{...A.attrs,...e})),l&&A.marks.length&&A.marks.forEach(M=>{if(l===M.type&&(h=!0,i)){const j=Math.max(R,p),Y=Math.min(R+A.nodeSize,g);t.addMark(j,Y,l.create({...M.attrs,...e}))}}))}),_&&(b!==void 0&&i&&t.setNodeMarkup(b,void 0,{..._.attrs,...e}),l&&_.marks.length&&_.marks.forEach(A=>{l===A.type&&i&&t.addMark(T,x,l.create({...A.attrs,...e}))}))}),h},v8=(n,e={})=>({state:t,dispatch:r})=>{const i=Zt(n,t.schema);return G9(i,e)(t,r)},b8=(n,e={})=>({state:t,dispatch:r})=>{const i=Zt(n,t.schema);return K9(i,e)(t,r)},_8=class{constructor(){this.callbacks={}}on(n,e){return this.callbacks[n]||(this.callbacks[n]=[]),this.callbacks[n].push(e),this}emit(n,...e){const t=this.callbacks[n];return t&&t.forEach(r=>r.apply(this,e)),this}off(n,e){const t=this.callbacks[n];return t&&(e?this.callbacks[n]=t.filter(r=>r!==e):delete this.callbacks[n]),this}once(n,e){const t=(...r)=>{this.off(n,t),e.apply(this,r)};return this.on(n,t)}removeAllListeners(){this.callbacks={}}},Jg=class{constructor(n){var e;this.find=n.find,this.handler=n.handler,this.undoable=(e=n.undoable)!=null?e:!0}},E8=(n,e)=>{if(jE(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function xp(n){var e;const{editor:t,from:r,to:i,text:o,rules:l,plugin:u}=n,{view:h}=t;if(h.composing)return!1;const d=h.state.doc.resolve(r);if(d.parent.type.spec.code||(e=d.nodeBefore||d.nodeAfter)!=null&&e.marks.find(b=>b.type.spec.code))return!1;let p=!1;const g=Kq(d)+o;return l.forEach(b=>{if(p)return;const _=E8(g,b.find);if(!_)return;const T=h.state.tr,x=Gg({state:h.state,transaction:T}),A={from:r-(_[0].length-o.length),to:i},{commands:R,chain:M,can:j}=new Kg({editor:t,state:x});b.handler({state:x,range:A,match:_,commands:R,chain:M,can:j})===null||!T.steps.length||(b.undoable&&T.setMeta(u,{transform:T,from:r,to:i,text:o}),h.dispatch(T),p=!0)}),p}function T8(n){const{editor:e,rules:t}=n,r=new At({state:{init(){return null},apply(i,o,l){const u=i.getMeta(r);if(u)return u;const h=i.getMeta("applyInputRules");return h&&setTimeout(()=>{let{text:p}=h;typeof p=="string"?p=p:p=zE(le.from(p),l.schema);const{from:g}=h,b=g+p.length;xp({editor:e,from:g,to:b,text:p,rules:t,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,l,u){return xp({editor:e,from:o,to:l,text:u,rules:t,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&xp({editor:e,from:o.pos,to:o.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:l}=i.state.selection;return l?xp({editor:e,from:l.pos,to:l.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function S8(n){return Object.prototype.toString.call(n).slice(8,-1)}function Rp(n){return S8(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function _O(n,e){const t={...n};return Rp(n)&&Rp(e)&&Object.keys(e).forEach(r=>{Rp(e[r])&&Rp(n[r])?t[r]=_O(n[r],e[r]):t[r]=e[r]}),t}var HE=class{constructor(n={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...n},this.name=this.config.name}get options(){return{...st(Ee(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...st(Ee(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(n={}){const e=this.extend({...this.config,addOptions:()=>_O(this.options,n)});return e.name=this.name,e.parent=this.parent,e}extend(n={}){const e=new this.constructor({...this.config,...n});return e.parent=this,this.child=e,e.name="name"in n?n.name:e.parent.name,e}},yl=class EO extends HE{constructor(){super(...arguments),this.type="mark"}static create(e={}){const t=typeof e=="function"?e():e;return new EO(t)}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const l=i.marks();if(!!!l.find(d=>d?.type.name===t.name))return!1;const h=l.find(d=>d?.type.name===t.name);return h&&r.removeStoredMark(h),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}};function w8(n){return typeof n=="number"}var A8=class{constructor(n){this.find=n.find,this.handler=n.handler}},C8=(n,e,t)=>{if(jE(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=n,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function x8(n){const{editor:e,state:t,from:r,to:i,rule:o,pasteEvent:l,dropEvent:u}=n,{commands:h,chain:d,can:p}=new Kg({editor:e,state:t}),g=[];return t.doc.nodesBetween(r,i,(_,T)=>{var x,A,R,M,j;if((A=(x=_.type)==null?void 0:x.spec)!=null&&A.code||!(_.isText||_.isTextblock||_.isInline))return;const Y=(j=(M=(R=_.content)==null?void 0:R.size)!=null?M:_.nodeSize)!=null?j:0,$=Math.max(r,T),G=Math.min(i,T+Y);if($>=G)return;const I=_.isText?_.text||"":_.textBetween($-T,G-T,void 0,"");C8(I,o.find,l).forEach(P=>{if(P.index===void 0)return;const B=$+P.index+1,z=B+P[0].length,L={from:t.tr.mapping.map(B),to:t.tr.mapping.map(z)},D=o.handler({state:t,range:L,match:P,commands:h,chain:d,can:p,pasteEvent:l,dropEvent:u});g.push(D)})}),g.every(_=>_!==null)}var kp=null,R8=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)==null||e.setData("text/html",n),t};function k8(n){const{editor:e,rules:t}=n;let r=null,i=!1,o=!1,l=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,u;try{u=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{u=null}const h=({state:p,from:g,to:b,rule:_,pasteEvt:T})=>{const x=p.tr,A=Gg({state:p,transaction:x});if(!(!x8({editor:e,state:A,from:Math.max(g-1,0),to:b.b-1,rule:_,pasteEvent:T,dropEvent:u})||!x.steps.length)){try{u=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{u=null}return l=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,x}};return t.map(p=>new At({view(g){const b=T=>{var x;r=(x=g.dom.parentElement)!=null&&x.contains(T.target)?g.dom.parentElement:null,r&&(kp=e)},_=()=>{kp&&(kp=null)};return window.addEventListener("dragstart",b),window.addEventListener("dragend",_),{destroy(){window.removeEventListener("dragstart",b),window.removeEventListener("dragend",_)}}},props:{handleDOMEvents:{drop:(g,b)=>{if(o=r===g.dom.parentElement,u=b,!o){const _=kp;_?.isEditable&&setTimeout(()=>{const T=_.state.selection;T&&_.commands.deleteRange({from:T.from,to:T.to})},10)}return!1},paste:(g,b)=>{var _;const T=(_=b.clipboardData)==null?void 0:_.getData("text/html");return l=b,i=!!T?.includes("data-pm-slice"),!1}}},appendTransaction:(g,b,_)=>{const T=g[0],x=T.getMeta("uiEvent")==="paste"&&!i,A=T.getMeta("uiEvent")==="drop"&&!o,R=T.getMeta("applyPasteRules"),M=!!R;if(!x&&!A&&!M)return;if(M){let{text:$}=R;typeof $=="string"?$=$:$=zE(le.from($),_.schema);const{from:G}=R,I=G+$.length,N=R8($);return h({rule:p,state:_,from:G,to:{b:I},pasteEvt:N})}const j=b.doc.content.findDiffStart(_.doc.content),Y=b.doc.content.findDiffEnd(_.doc.content);if(!(!w8(j)||!Y||j===Y.b))return h({rule:p,state:_,from:j,to:Y,pasteEvt:l})}}))}var Xg=class{constructor(n,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=n,this.extensions=fO(n),this.schema=Bq(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((n,e)=>{const t={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Cp(e.name,this.schema)},r=Ee(e,"addCommands",t);return r?{...n,...r()}:n},{})}get plugins(){const{editor:n}=this;return Lm([...this.extensions].reverse()).flatMap(r=>{const i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:n,type:Cp(r.name,this.schema)},o=[],l=Ee(r,"addKeyboardShortcuts",i);let u={};if(r.type==="mark"&&Ee(r,"exitable",i)&&(u.ArrowRight=()=>yl.handleExit({editor:n,mark:r})),l){const b=Object.fromEntries(Object.entries(l()).map(([_,T])=>[_,()=>T({editor:n})]));u={...u,...b}}const h=HH(u);o.push(h);const d=Ee(r,"addInputRules",i);if(Mx(r,n.options.enableInputRules)&&d){const b=d();if(b&&b.length){const _=T8({editor:n,rules:b}),T=Array.isArray(_)?_:[_];o.push(...T)}}const p=Ee(r,"addPasteRules",i);if(Mx(r,n.options.enablePasteRules)&&p){const b=p();if(b&&b.length){const _=k8({editor:n,rules:b});o.push(..._)}}const g=Ee(r,"addProseMirrorPlugins",i);if(g){const b=g();o.push(...b)}return o})}get attributes(){return hO(this.extensions)}get nodeViews(){const{editor:n}=this,{nodeExtensions:e}=$c(this.extensions);return Object.fromEntries(e.filter(t=>!!Ee(t,"addNodeView")).map(t=>{const r=this.attributes.filter(h=>h.type===t.name),i={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:n,type:Zt(t.name,this.schema)},o=Ee(t,"addNodeView",i);if(!o)return[];const l=o();if(!l)return[];const u=(h,d,p,g,b)=>{const _=df(h,r);return l({node:h,view:d,getPos:p,decorations:g,innerDecorations:b,editor:n,extension:t,HTMLAttributes:_})};return[t.name,u]}))}dispatchTransaction(n){const{editor:e}=this;return Lm([...this.extensions].reverse()).reduceRight((r,i)=>{const o={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:e,type:Cp(i.name,this.schema)},l=Ee(i,"dispatchTransaction",o);return l?u=>{l.call(o,{transaction:u,next:r})}:r},n)}get markViews(){const{editor:n}=this,{markExtensions:e}=$c(this.extensions);return Object.fromEntries(e.filter(t=>!!Ee(t,"addMarkView")).map(t=>{const r=this.attributes.filter(u=>u.type===t.name),i={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:n,type:Os(t.name,this.schema)},o=Ee(t,"addMarkView",i);if(!o)return[];const l=(u,h,d)=>{const p=df(u,r);return o()({mark:u,view:h,inline:d,editor:n,extension:t,HTMLAttributes:p,updateAttributes:g=>{H8(u,n,g)}})};return[t.name,l]}))}setupExtensions(){const n=this.extensions;this.editor.extensionStorage=Object.fromEntries(n.map(e=>[e.name,e.storage])),n.forEach(e=>{var t;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Cp(e.name,this.schema)};e.type==="mark"&&((t=st(Ee(e,"keepOnSplit",r)))==null||t)&&this.splittableMarks.push(e.name);const i=Ee(e,"onBeforeCreate",r),o=Ee(e,"onCreate",r),l=Ee(e,"onUpdate",r),u=Ee(e,"onSelectionUpdate",r),h=Ee(e,"onTransaction",r),d=Ee(e,"onFocus",r),p=Ee(e,"onBlur",r),g=Ee(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),l&&this.editor.on("update",l),u&&this.editor.on("selectionUpdate",u),h&&this.editor.on("transaction",h),d&&this.editor.on("focus",d),p&&this.editor.on("blur",p),g&&this.editor.on("destroy",g)})}};Xg.resolve=fO;Xg.sort=Lm;Xg.flatten=BE;var I8={};VE(I8,{ClipboardTextSerializer:()=>SO,Commands:()=>wO,Delete:()=>AO,Drop:()=>CO,Editable:()=>xO,FocusEvents:()=>kO,Keymap:()=>IO,Paste:()=>NO,Tabindex:()=>MO,TextDirection:()=>OO,focusEventsPluginKey:()=>RO});var Ut=class TO extends HE{constructor(){super(...arguments),this.type="extension"}static create(e={}){const t=typeof e=="function"?e():e;return new TO(t)}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}},SO=Ut.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new At({key:new on("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:o}=i,l=Math.min(...o.map(p=>p.$from.pos)),u=Math.max(...o.map(p=>p.$to.pos)),h=pO(t);return dO(r,{from:l,to:u},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:h})}}})]}}),wO=Ut.create({name:"commands",addCommands(){return{...nO}}}),AO=Ut.create({name:"delete",onUpdate({transaction:n,appendedTransactions:e}){var t,r,i;const o=()=>{var l,u,h,d;if((d=(h=(u=(l=this.editor.options.coreExtensionOptions)==null?void 0:l.delete)==null?void 0:u.filterTransaction)==null?void 0:h.call(u,n))!=null?d:n.getMeta("y-sync$"))return;const p=cO(n.before,[n,...e]);gO(p).forEach(_=>{p.mapping.mapResult(_.oldRange.from).deletedAfter&&p.mapping.mapResult(_.oldRange.to).deletedBefore&&p.before.nodesBetween(_.oldRange.from,_.oldRange.to,(T,x)=>{const A=x+T.nodeSize-2,R=_.oldRange.from<=x&&A<=_.oldRange.to;this.editor.emit("delete",{type:"node",node:T,from:x,to:A,newFrom:p.mapping.map(x),newTo:p.mapping.map(A),deletedRange:_.oldRange,newRange:_.newRange,partial:!R,editor:this.editor,transaction:n,combinedTransform:p})})});const b=p.mapping;p.steps.forEach((_,T)=>{var x,A;if(_ instanceof ri){const R=b.slice(T).map(_.from,-1),M=b.slice(T).map(_.to),j=b.invert().map(R,-1),Y=b.invert().map(M),$=(x=p.doc.nodeAt(R-1))==null?void 0:x.marks.some(I=>I.eq(_.mark)),G=(A=p.doc.nodeAt(M))==null?void 0:A.marks.some(I=>I.eq(_.mark));this.editor.emit("delete",{type:"mark",mark:_.mark,from:_.from,to:_.to,deletedRange:{from:j,to:Y},newRange:{from:R,to:M},partial:!!(G||$),editor:this.editor,transaction:n,combinedTransform:p})}})};(i=(r=(t=this.editor.options.coreExtensionOptions)==null?void 0:t.delete)==null?void 0:r.async)==null||i?setTimeout(o,0):o()}}),CO=Ut.create({name:"drop",addProseMirrorPlugins(){return[new At({key:new on("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),xO=Ut.create({name:"editable",addProseMirrorPlugins(){return[new At({key:new on("editable"),props:{editable:()=>this.editor.options.editable}})]}}),RO=new on("focusEvents"),kO=Ut.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new At({key:RO,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),IO=Ut.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:l})=>[()=>l.undoInputRule(),()=>l.command(({tr:u})=>{const{selection:h,doc:d}=u,{empty:p,$anchor:g}=h,{pos:b,parent:_}=g,T=g.parent.isTextblock&&b>0?u.doc.resolve(b-1):g,x=T.parent.type.spec.isolating,A=g.pos-g.parentOffset,R=x&&T.parent.childCount===1?A===g.pos:Ue.atStart(d).from===b;return!p||!_.type.isTextblock||_.textContent.length||!R||R&&g.parent.type.name==="paragraph"?!1:l.clearNodes()}),()=>l.deleteSelection(),()=>l.joinBackward(),()=>l.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:l})=>[()=>l.deleteSelection(),()=>l.deleteCurrentNode(),()=>l.joinForward(),()=>l.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:l})=>[()=>l.newlineInCode(),()=>l.createParagraphNear(),()=>l.liftEmptyBlock(),()=>l.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Dm()||aO()?o:i},addProseMirrorPlugins(){return[new At({key:new on("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(x=>x.getMeta("composition")))return;const r=n.some(x=>x.docChanged)&&!e.doc.eq(t.doc),i=n.some(x=>x.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:l,to:u}=e.selection,h=Ue.atStart(e.doc).from,d=Ue.atEnd(e.doc).to;if(o||!(l===h&&u===d)||!Yg(t.doc))return;const b=t.tr,_=Gg({state:t,transaction:b}),{commands:T}=new Kg({editor:this.editor,state:_});if(T.clearNodes(),!!b.steps.length)return b}})]}}),NO=Ut.create({name:"paste",addProseMirrorPlugins(){return[new At({key:new on("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),MO=Ut.create({name:"tabindex",addProseMirrorPlugins(){return[new At({key:new on("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),OO=Ut.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:n}=$c(this.extensions);return[{types:n.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const t=e.getAttribute("dir");return t&&(t==="ltr"||t==="rtl"||t==="auto")?t:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new At({key:new on("textDirection"),props:{attributes:()=>{const n=this.options.direction;return n?{dir:n}:{}}}})]}}),N8=class Ch{constructor(e,t,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Ch(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Ch(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Ch(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const i=t.isBlock&&!t.isTextblock,o=t.isAtom&&!t.isText,l=t.isInline,u=this.pos+r+(o?0:1);if(u<0||u>this.resolvedPos.doc.nodeSize-2)return;const h=this.resolvedPos.doc.resolve(u);if(!i&&!l&&h.depth<=this.depth)return;const d=new Ch(h,this.editor,i,i||l?t:null);i&&(d.actualDepth=this.depth+1),e.push(d)}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(t).length>0){const o=i.node.attrs,l=Object.keys(t);for(let u=0;u<l.length;u+=1){const h=l[u];if(o[h]!==t[h])break}}else r=i;i=i.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(t);return this.children.forEach(l=>{r&&i.length>0||(l.node.type.name===e&&o.every(h=>t[h]===l.node.attrs[h])&&i.push(l),!(r&&i.length>0)&&(i=i.concat(l.querySelectorAll(e,t,r))))}),i}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}},M8=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function O8(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}var D8=class extends _8{constructor(n={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:Jq,createMappablePosition:Xq},this.setOptions(n),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:i,moved:o})=>this.options.onDrop(r,i,o)),this.on("paste",({event:r,slice:i})=>this.options.onPaste(r,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),t=sO(e,this.options.autofocus);this.editorState=_c.create({doc:e,schema:this.schema,selection:t||void 0}),this.options.element&&this.mount(this.options.element)}mount(n){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(n),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const n=this.editorView.dom;n?.editor&&delete n.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(n){console.warn("Failed to remove CSS element:",n)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=O8(M8,this.options.injectNonce))}setOptions(n={}){this.options={...this.options,...n},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(n,e=!0){this.setOptions({editable:n}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:n=>{this.editorState=n},dispatch:n=>{this.dispatchTransaction(n)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(n,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in n)return Reflect.get(n,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(n,e){const t=uO(e)?e(n,[...this.state.plugins]):[...this.state.plugins,n],r=this.state.reconfigure({plugins:t});return this.view.updateState(r),r}unregisterPlugin(n){if(this.isDestroyed)return;const e=this.state.plugins;let t=e;if([].concat(n).forEach(i=>{const o=typeof i=="string"?`${i}$`:i.key;t=t.filter(l=>!l.key.startsWith(o))}),e.length===t.length)return;const r=this.state.reconfigure({plugins:t});return this.view.updateState(r),r}createExtensionManager(){var n,e;const r=[...this.options.enableCoreExtensions?[xO,SO.configure({blockSeparator:(e=(n=this.options.coreExtensionOptions)==null?void 0:n.clipboardTextSerializer)==null?void 0:e.blockSeparator}),wO,kO,IO,MO,CO,NO,AO,OO.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Xg(r,this)}createCommandManager(){this.commandManager=new Kg({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let n;try{n=F0(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(t=>t.name!=="collaboration"),this.createExtensionManager()}}),n=F0(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return n}createView(n){const{editorProps:e,enableExtensionDispatchTransaction:t}=this.options,r=e.dispatchTransaction||this.dispatchTransaction.bind(this),i=t?this.extensionManager.dispatchTransaction(r):r;this.editorView=new eO(n,{...e,attributes:{role:"textbox",...e?.attributes},dispatchTransaction:i,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.prependClass(),this.injectCSS();const l=this.view.dom;l.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(n){this.isCapturingTransaction=!0,n(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(n){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=n;return}n.steps.forEach(d=>{var p;return(p=this.capturedTransaction)==null?void 0:p.step(d)});return}const{state:e,transactions:t}=this.state.applyTransaction(n),r=!this.state.selection.eq(e.selection),i=t.includes(n),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:n,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:n,appendedTransactions:t.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:n});const l=t.findLast(d=>d.getMeta("focus")||d.getMeta("blur")),u=l?.getMeta("focus"),h=l?.getMeta("blur");u&&this.emit("focus",{editor:this,event:u.event,transaction:l}),h&&this.emit("blur",{editor:this,event:h.event,transaction:l}),!(n.getMeta("preventUpdate")||!t.some(d=>d.docChanged)||o.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:n,appendedTransactions:t.slice(1)})}getAttributes(n){return mO(this.state,n)}isActive(n,e){const t=typeof n=="string"?n:null,r=typeof n=="string"?e:n;return Wq(this.state,t,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return zE(this.state.doc.content,this.schema)}getText(n){const{blockSeparator:e=`

`,textSerializers:t={}}=n||{};return Fq(this.state.doc,{blockSeparator:e,textSerializers:{...pO(this.schema),...t}})}get isEmpty(){return Yg(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var n,e;return(e=(n=this.editorView)==null?void 0:n.isDestroyed)!=null?e:!0}$node(n,e){var t;return((t=this.$doc)==null?void 0:t.querySelector(n,e))||null}$nodes(n,e){var t;return((t=this.$doc)==null?void 0:t.querySelectorAll(n,e))||null}$pos(n){const e=this.state.doc.resolve(n);return new N8(e,this)}get $doc(){return this.$pos(0)}};function Gc(n){return new Jg({find:n.find,handler:({state:e,range:t,match:r})=>{const i=st(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,l=r[r.length-1],u=r[0];if(l){const h=u.search(/\S/),d=t.from+u.indexOf(l),p=d+l.length;if(FE(t.from,t.to,e.doc).filter(_=>_.mark.type.excluded.find(x=>x===n.type&&x!==_.mark.type)).filter(_=>_.to>d).length)return null;p<t.to&&o.delete(p,t.to),d>t.from&&o.delete(t.from+h,d);const b=t.from+h+l.length;o.addMark(t.from+h,b,n.type.create(i||{})),o.removeStoredMark(n.type)}},undoable:n.undoable})}function L8(n){return new Jg({find:n.find,handler:({state:e,range:t,match:r})=>{const i=st(n.getAttributes,void 0,r)||{},{tr:o}=e,l=t.from;let u=t.to;const h=n.type.create(i);if(r[1]){const d=r[0].lastIndexOf(r[1]);let p=l+d;p>u?p=u:u=p+r[1].length;const g=r[0][r[0].length-1];o.insertText(g,l+r[0].length-1),o.replaceWith(p,u,h)}else if(r[0]){const d=n.type.isInline?l:l-1;o.insert(d,n.type.create(i)).delete(o.mapping.map(l),o.mapping.map(u))}o.scrollIntoView()},undoable:n.undoable})}function q0(n){return new Jg({find:n.find,handler:({state:e,range:t,match:r})=>{const i=e.doc.resolve(t.from),o=st(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,o)},undoable:n.undoable})}function Kc(n){return new Jg({find:n.find,handler:({state:e,range:t,match:r,chain:i})=>{const o=st(n.getAttributes,void 0,r)||{},l=e.tr.delete(t.from,t.to),h=l.doc.resolve(t.from).blockRange(),d=h&&EE(h,n.type,o);if(!d)return null;if(l.wrap(h,d),n.keepMarks&&n.editor){const{selection:g,storedMarks:b}=e,{splittableMarks:_}=n.editor.extensionManager,T=b||g.$to.parentOffset&&g.$from.marks();if(T){const x=T.filter(A=>_.includes(A.type.name));l.ensureMarks(x)}}if(n.keepAttributes){const g=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(g,o).run()}const p=l.doc.resolve(t.from-1).nodeBefore;p&&p.type===n.type&&ia(l.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,p))&&l.join(t.from-1)},undoable:n.undoable})}function P8(n,e){const{selection:t}=n,{$from:r}=t;if(t instanceof we){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let i=r.depth;for(;i>=0;){const o=r.index(i);if(r.node(i).contentMatchAt(o).matchType(e))return!0;i-=1}return!1}var V8={};VE(V8,{createAtomBlockMarkdownSpec:()=>j8,createBlockMarkdownSpec:()=>U8,createInlineMarkdownSpec:()=>F8,parseAttributes:()=>qE,parseIndentedBlocks:()=>$0,renderNestedMarkdownContent:()=>GE,serializeAttributes:()=>$E});function qE(n){if(!n?.trim())return{};const e={},t=[],r=n.replace(/["']([^"']*)["']/g,d=>(t.push(d),`__QUOTED_${t.length-1}__`)),i=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const d=i.map(p=>p.trim().slice(1));e.class=d.join(" ")}const o=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(e.id=o[1]);const l=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(l)).forEach(([,d,p])=>{var g;const b=parseInt(((g=p.match(/__QUOTED_(\d+)__/))==null?void 0:g[1])||"0",10),_=t[b];_&&(e[d]=_.slice(1,-1))});const h=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return h&&h.split(/\s+/).filter(Boolean).forEach(p=>{p.match(/^[a-zA-Z][\w-]*$/)&&(e[p]=!0)}),e}function $E(n){if(!n||Object.keys(n).length===0)return"";const e=[];return n.class&&String(n.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),n.id&&e.push(`#${n.id}`),Object.entries(n).forEach(([t,r])=>{t==="class"||t==="id"||(r===!0?e.push(t):r!==!1&&r!=null&&e.push(`${t}="${String(r)}"`))}),e.join(" ")}function j8(n){const{nodeName:e,name:t,parseAttributes:r=qE,serializeAttributes:i=$E,defaultAttributes:o={},requiredAttributes:l=[],allowedAttributes:u}=n,h=t||e,d=p=>{if(!u)return p;const g={};return u.forEach(b=>{b in p&&(g[b]=p[b])}),g};return{parseMarkdown:(p,g)=>{const b={...o,...p.attributes};return g.createNode(e,b,[])},markdownTokenizer:{name:e,level:"block",start(p){var g;const b=new RegExp(`^:::${h}(?:\\s|$)`,"m"),_=(g=p.match(b))==null?void 0:g.index;return _!==void 0?_:-1},tokenize(p,g,b){const _=new RegExp(`^:::${h}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),T=p.match(_);if(!T)return;const x=T[1]||"",A=r(x);if(!l.find(M=>!(M in A)))return{type:e,raw:T[0],attributes:A}}},renderMarkdown:p=>{const g=d(p.attrs||{}),b=i(g),_=b?` {${b}}`:"";return`:::${h}${_} :::`}}}function U8(n){const{nodeName:e,name:t,getContent:r,parseAttributes:i=qE,serializeAttributes:o=$E,defaultAttributes:l={},content:u="block",allowedAttributes:h}=n,d=t||e,p=g=>{if(!h)return g;const b={};return h.forEach(_=>{_ in g&&(b[_]=g[_])}),b};return{parseMarkdown:(g,b)=>{let _;if(r){const x=r(g);_=typeof x=="string"?[{type:"text",text:x}]:x}else u==="block"?_=b.parseChildren(g.tokens||[]):_=b.parseInline(g.tokens||[]);const T={...l,...g.attributes};return b.createNode(e,T,_)},markdownTokenizer:{name:e,level:"block",start(g){var b;const _=new RegExp(`^:::${d}`,"m"),T=(b=g.match(_))==null?void 0:b.index;return T!==void 0?T:-1},tokenize(g,b,_){var T;const x=new RegExp(`^:::${d}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),A=g.match(x);if(!A)return;const[R,M=""]=A,j=i(M);let Y=1;const $=R.length;let G="";const I=/^:::([\w-]*)(\s.*)?/gm,N=g.slice($);for(I.lastIndex=0;;){const P=I.exec(N);if(P===null)break;const B=P.index,z=P[1];if(!((T=P[2])!=null&&T.endsWith(":::"))){if(z)Y+=1;else if(Y-=1,Y===0){const L=N.slice(0,B);G=L.trim();const D=g.slice(0,$+B+P[0].length);let ue=[];if(G)if(u==="block")for(ue=_.blockTokens(L),ue.forEach(ve=>{ve.text&&(!ve.tokens||ve.tokens.length===0)&&(ve.tokens=_.inlineTokens(ve.text))});ue.length>0;){const ve=ue[ue.length-1];if(ve.type==="paragraph"&&(!ve.text||ve.text.trim()===""))ue.pop();else break}else ue=_.inlineTokens(G);return{type:e,raw:D,attributes:j,content:G,tokens:ue}}}}}},renderMarkdown:(g,b)=>{const _=p(g.attrs||{}),T=o(_),x=T?` {${T}}`:"",A=b.renderChildren(g.content||[],`

`);return`:::${d}${x}

${A}

:::`}}}function B8(n){if(!n.trim())return{};const e={},t=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=t.exec(n);for(;r!==null;){const[,i,o,l]=r;e[i]=o||l,r=t.exec(n)}return e}function z8(n){return Object.entries(n).filter(([,e])=>e!=null).map(([e,t])=>`${e}="${t}"`).join(" ")}function F8(n){const{nodeName:e,name:t,getContent:r,parseAttributes:i=B8,serializeAttributes:o=z8,defaultAttributes:l={},selfClosing:u=!1,allowedAttributes:h}=n,d=t||e,p=b=>{if(!h)return b;const _={};return h.forEach(T=>{const x=typeof T=="string"?T:T.name,A=typeof T=="string"?void 0:T.skipIfDefault;if(x in b){const R=b[x];if(A!==void 0&&R===A)return;_[x]=R}}),_},g=d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(b,_)=>{const T={...l,...b.attributes};if(u)return _.createNode(e,T);const x=r?r(b):b.content||"";return x?_.createNode(e,T,[_.createTextNode(x)]):_.createNode(e,T,[])},markdownTokenizer:{name:e,level:"inline",start(b){const _=u?new RegExp(`\\[${g}\\s*[^\\]]*\\]`):new RegExp(`\\[${g}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${g}\\]`),T=b.match(_),x=T?.index;return x!==void 0?x:-1},tokenize(b,_,T){const x=u?new RegExp(`^\\[${g}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${g}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${g}\\]`),A=b.match(x);if(!A)return;let R="",M="";if(u){const[,Y]=A;M=Y}else{const[,Y,$]=A;M=Y,R=$||""}const j=i(M.trim());return{type:e,raw:A[0],content:R.trim(),attributes:j}}},renderMarkdown:b=>{let _="";r?_=r(b):b.content&&b.content.length>0&&(_=b.content.filter(R=>R.type==="text").map(R=>R.text).join(""));const T=p(b.attrs||{}),x=o(T),A=x?` ${x}`:"";return u?`[${d}${A}]`:`[${d}${A}]${_}[/${d}]`}}}function $0(n,e,t){var r,i,o,l;const u=n.split(`
`),h=[];let d="",p=0;const g=e.baseIndentSize||2;for(;p<u.length;){const b=u[p],_=b.match(e.itemPattern);if(!_){if(h.length>0)break;if(b.trim()===""){p+=1,d=`${d}${b}
`;continue}else return}const T=e.extractItemData(_),{indentLevel:x,mainContent:A}=T;d=`${d}${b}
`;const R=[A];for(p+=1;p<u.length;){const $=u[p];if($.trim()===""){const I=u.slice(p+1).findIndex(B=>B.trim()!=="");if(I===-1)break;if((((i=(r=u[p+1+I].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:i.length)||0)>x){R.push($),d=`${d}${$}
`,p+=1;continue}else break}if((((l=(o=$.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:l.length)||0)>x)R.push($),d=`${d}${$}
`,p+=1;else break}let M;const j=R.slice(1);if(j.length>0){const $=j.map(G=>G.slice(x+g)).join(`
`);$.trim()&&(e.customNestedParser?M=e.customNestedParser($):M=t.blockTokens($))}const Y=e.createToken(T,M);h.push(Y)}if(h.length!==0)return{items:h,raw:d}}function GE(n,e,t,r){if(!n||!Array.isArray(n.content))return"";const i=typeof t=="function"?t(r):t,[o,...l]=n.content,u=e.renderChildren([o]),h=[`${i}${u}`];return l&&l.length>0&&l.forEach(d=>{const p=e.renderChildren([d]);if(p){const g=p.split(`
`).map(b=>b?e.indent(b):"").join(`
`);h.push(g)}}),h.join(`
`)}function H8(n,e,t={}){const{state:r}=e,{doc:i,tr:o}=r,l=n;i.descendants((u,h)=>{const d=o.mapping.map(h),p=o.mapping.map(h)+u.nodeSize;let g=null;if(u.marks.forEach(_=>{if(_!==l)return!1;g=_}),!g)return;let b=!1;if(Object.keys(t).forEach(_=>{t[_]!==g.attrs[_]&&(b=!0)}),b){const _=n.type.create({...n.attrs,...t});o.removeMark(d,p,n.type),o.addMark(d,p,_)}}),o.docChanged&&e.view.dispatch(o)}var Er=class DO extends HE{constructor(){super(...arguments),this.type="node"}static create(e={}){const t=typeof e=="function"?e():e;return new DO(t)}configure(e){return super.configure(e)}extend(e){const t=typeof e=="function"?e():e;return super.extend(t)}};function cl(n){return new A8({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:i})=>{const o=st(n.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:l}=e,u=r[r.length-1],h=r[0];let d=t.to;if(u){const p=h.search(/\S/),g=t.from+h.indexOf(u),b=g+u.length;if(FE(t.from,t.to,e.doc).filter(T=>T.mark.type.excluded.find(A=>A===n.type&&A!==T.mark.type)).filter(T=>T.to>g).length)return null;b<t.to&&l.delete(b,t.to),g>t.from&&l.delete(t.from+p,g),d=t.from+p+u.length,l.addMark(t.from+p,d,n.type.create(o||{})),l.removeStoredMark(n.type)}}})}const{getOwnPropertyNames:q8,getOwnPropertySymbols:$8}=Object,{hasOwnProperty:G8}=Object.prototype;function Bb(n,e){return function(r,i,o){return n(r,i,o)&&e(r,i,o)}}function Ip(n){return function(t,r,i){if(!t||!r||typeof t!="object"||typeof r!="object")return n(t,r,i);const{cache:o}=i,l=o.get(t),u=o.get(r);if(l&&u)return l===r&&u===t;o.set(t,r),o.set(r,t);const h=n(t,r,i);return o.delete(t),o.delete(r),h}}function K8(n){return n?.[Symbol.toStringTag]}function Lx(n){return q8(n).concat($8(n))}const W8=Object.hasOwn||((n,e)=>G8.call(n,e));function vl(n,e){return n===e||!n&&!e&&n!==n&&e!==e}const Q8="__v",Y8="__o",J8="_owner",{getOwnPropertyDescriptor:Px,keys:Vx}=Object;function X8(n,e){return n.byteLength===e.byteLength&&Pm(new Uint8Array(n),new Uint8Array(e))}function Z8(n,e,t){let r=n.length;if(e.length!==r)return!1;for(;r-- >0;)if(!t.equals(n[r],e[r],r,r,n,e,t))return!1;return!0}function e7(n,e){return n.byteLength===e.byteLength&&Pm(new Uint8Array(n.buffer,n.byteOffset,n.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function t7(n,e){return vl(n.getTime(),e.getTime())}function n7(n,e){return n.name===e.name&&n.message===e.message&&n.cause===e.cause&&n.stack===e.stack}function r7(n,e){return n===e}function jx(n,e,t){const r=n.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),o=n.entries();let l,u,h=0;for(;(l=o.next())&&!l.done;){const d=e.entries();let p=!1,g=0;for(;(u=d.next())&&!u.done;){if(i[g]){g++;continue}const b=l.value,_=u.value;if(t.equals(b[0],_[0],h,g,n,e,t)&&t.equals(b[1],_[1],b[0],_[0],n,e,t)){p=i[g]=!0;break}g++}if(!p)return!1;h++}return!0}const i7=vl;function s7(n,e,t){const r=Vx(n);let i=r.length;if(Vx(e).length!==i)return!1;for(;i-- >0;)if(!LO(n,e,t,r[i]))return!1;return!0}function mh(n,e,t){const r=Lx(n);let i=r.length;if(Lx(e).length!==i)return!1;let o,l,u;for(;i-- >0;)if(o=r[i],!LO(n,e,t,o)||(l=Px(n,o),u=Px(e,o),(l||u)&&(!l||!u||l.configurable!==u.configurable||l.enumerable!==u.enumerable||l.writable!==u.writable)))return!1;return!0}function o7(n,e){return vl(n.valueOf(),e.valueOf())}function a7(n,e){return n.source===e.source&&n.flags===e.flags}function Ux(n,e,t){const r=n.size;if(r!==e.size)return!1;if(!r)return!0;const i=new Array(r),o=n.values();let l,u;for(;(l=o.next())&&!l.done;){const h=e.values();let d=!1,p=0;for(;(u=h.next())&&!u.done;){if(!i[p]&&t.equals(l.value,u.value,l.value,u.value,n,e,t)){d=i[p]=!0;break}p++}if(!d)return!1}return!0}function Pm(n,e){let t=n.byteLength;if(e.byteLength!==t||n.byteOffset!==e.byteOffset)return!1;for(;t-- >0;)if(n[t]!==e[t])return!1;return!0}function l7(n,e){return n.hostname===e.hostname&&n.pathname===e.pathname&&n.protocol===e.protocol&&n.port===e.port&&n.hash===e.hash&&n.username===e.username&&n.password===e.password}function LO(n,e,t,r){return(r===J8||r===Y8||r===Q8)&&(n.$$typeof||e.$$typeof)?!0:W8(e,r)&&t.equals(n[r],e[r],r,r,n,e,t)}const c7="[object ArrayBuffer]",u7="[object Arguments]",h7="[object Boolean]",f7="[object DataView]",d7="[object Date]",p7="[object Error]",m7="[object Map]",g7="[object Number]",y7="[object Object]",v7="[object RegExp]",b7="[object Set]",_7="[object String]",E7={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},T7="[object URL]",S7=Object.prototype.toString;function w7({areArrayBuffersEqual:n,areArraysEqual:e,areDataViewsEqual:t,areDatesEqual:r,areErrorsEqual:i,areFunctionsEqual:o,areMapsEqual:l,areNumbersEqual:u,areObjectsEqual:h,arePrimitiveWrappersEqual:d,areRegExpsEqual:p,areSetsEqual:g,areTypedArraysEqual:b,areUrlsEqual:_,unknownTagComparators:T}){return function(A,R,M){if(A===R)return!0;if(A==null||R==null)return!1;const j=typeof A;if(j!==typeof R)return!1;if(j!=="object")return j==="number"?u(A,R,M):j==="function"?o(A,R,M):!1;const Y=A.constructor;if(Y!==R.constructor)return!1;if(Y===Object)return h(A,R,M);if(Array.isArray(A))return e(A,R,M);if(Y===Date)return r(A,R,M);if(Y===RegExp)return p(A,R,M);if(Y===Map)return l(A,R,M);if(Y===Set)return g(A,R,M);const $=S7.call(A);if($===d7)return r(A,R,M);if($===v7)return p(A,R,M);if($===m7)return l(A,R,M);if($===b7)return g(A,R,M);if($===y7)return typeof A.then!="function"&&typeof R.then!="function"&&h(A,R,M);if($===T7)return _(A,R,M);if($===p7)return i(A,R,M);if($===u7)return h(A,R,M);if(E7[$])return b(A,R,M);if($===c7)return n(A,R,M);if($===f7)return t(A,R,M);if($===h7||$===g7||$===_7)return d(A,R,M);if(T){let G=T[$];if(!G){const I=K8(A);I&&(G=T[I])}if(G)return G(A,R,M)}return!1}}function A7({circular:n,createCustomConfig:e,strict:t}){let r={areArrayBuffersEqual:X8,areArraysEqual:t?mh:Z8,areDataViewsEqual:e7,areDatesEqual:t7,areErrorsEqual:n7,areFunctionsEqual:r7,areMapsEqual:t?Bb(jx,mh):jx,areNumbersEqual:i7,areObjectsEqual:t?mh:s7,arePrimitiveWrappersEqual:o7,areRegExpsEqual:a7,areSetsEqual:t?Bb(Ux,mh):Ux,areTypedArraysEqual:t?Bb(Pm,mh):Pm,areUrlsEqual:l7,unknownTagComparators:void 0};if(e&&(r=Object.assign({},r,e(r))),n){const i=Ip(r.areArraysEqual),o=Ip(r.areMapsEqual),l=Ip(r.areObjectsEqual),u=Ip(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:u})}return r}function C7(n){return function(e,t,r,i,o,l,u){return n(e,t,u)}}function x7({circular:n,comparator:e,createState:t,equals:r,strict:i}){if(t)return function(u,h){const{cache:d=n?new WeakMap:void 0,meta:p}=t();return e(u,h,{cache:d,equals:r,meta:p,strict:i})};if(n)return function(u,h){return e(u,h,{cache:new WeakMap,equals:r,meta:void 0,strict:i})};const o={cache:void 0,equals:r,meta:void 0,strict:i};return function(u,h){return e(u,h,o)}}const R7=oa();oa({strict:!0});oa({circular:!0});oa({circular:!0,strict:!0});oa({createInternalComparator:()=>vl});oa({strict:!0,createInternalComparator:()=>vl});oa({circular:!0,createInternalComparator:()=>vl});oa({circular:!0,createInternalComparator:()=>vl,strict:!0});function oa(n={}){const{circular:e=!1,createInternalComparator:t,createState:r,strict:i=!1}=n,o=A7(n),l=w7(o),u=t?t(l):C7(l);return x7({circular:e,comparator:l,createState:r,equals:u,strict:i})}var zb={exports:{}},Fb={};var Bx;function k7(){if(Bx)return Fb;Bx=1;var n=gf(),e=CN();function t(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,o=n.useRef,l=n.useEffect,u=n.useMemo,h=n.useDebugValue;return Fb.useSyncExternalStoreWithSelector=function(d,p,g,b,_){var T=o(null);if(T.current===null){var x={hasValue:!1,value:null};T.current=x}else x=T.current;T=u(function(){function R(G){if(!M){if(M=!0,j=G,G=b(G),_!==void 0&&x.hasValue){var I=x.value;if(_(I,G))return Y=I}return Y=G}if(I=Y,r(j,G))return I;var N=b(G);return _!==void 0&&_(I,N)?(j=G,I):(j=G,Y=N)}var M=!1,j,Y,$=g===void 0?null:g;return[function(){return R(p())},$===null?void 0:function(){return R($())}]},[p,g,b,_]);var A=i(d,T[0],T[1]);return l(function(){x.hasValue=!0,x.value=A},[A]),h(A),A},Fb}var zx;function I7(){return zx||(zx=1,zb.exports=k7()),zb.exports}var N7=I7(),M7=(...n)=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},O7=({contentComponent:n})=>{const e=xN.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return S.jsx(S.Fragment,{children:Object.values(e)})};function D7(){const n=new Set;let e={};return{subscribe(t){return n.add(t),()=>{n.delete(t)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(t,r){e={...e,[t]:RP.createPortal(r.reactElement,r.element,t)},n.forEach(i=>i())},removeRenderer(t){const r={...e};delete r[t],e=r,n.forEach(i=>i())}}}var L7=class extends Xa.Component{constructor(n){var e;super(n),this.editorContentRef=Xa.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=n.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var n;const e=this.props.editor;if(e&&!e.isDestroyed&&((n=e.view.dom)!=null&&n.parentNode)){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:t}),e.contentComponent=D7(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var n;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((n=e.view.dom)!=null&&n.parentNode))return;const t=document.createElement("div");t.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:t})}catch{}}}render(){const{editor:n,innerRef:e,...t}=this.props;return S.jsxs(S.Fragment,{children:[S.jsx("div",{ref:M7(e,this.editorContentRef),...t}),n?.contentComponent&&S.jsx(O7,{contentComponent:n.contentComponent})]})}},P7=V.forwardRef((n,e)=>{const t=Xa.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return Xa.createElement(L7,{key:t,innerRef:e,...n})}),PO=Xa.memo(P7),V7=typeof window<"u"?V.useLayoutEffect:V.useEffect,j7=class{constructor(n){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=n,this.lastSnapshot={editor:n,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(n){return this.subscribers.add(n),()=>{this.subscribers.delete(n)}}watch(n){if(this.editor=n,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}};function U7(n){var e;const[t]=V.useState(()=>new j7(n.editor)),r=N7.useSyncExternalStoreWithSelector(t.subscribe,t.getSnapshot,t.getServerSnapshot,n.selector,(e=n.equalityFn)!=null?e:R7);return V7(()=>t.watch(n.editor),[n.editor,t]),V.useDebugValue(r),r}var B7=!1,G0=typeof window>"u",z7=G0||!!(typeof window<"u"&&window.next),F7=class VO{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?G0||z7?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)==null?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)==null?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)==null?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)==null?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)==null?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)==null?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)==null?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)==null?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)==null?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)==null?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)==null?void 0:o.call(i,...r)},onDelete:(...r)=>{var i,o;return(o=(i=this.options.current).onDelete)==null?void 0:o.call(i,...r)}};return new D8(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&t.extensions?e.extensions.length!==t.extensions.length?!1:e.extensions.every((i,o)=>{var l;return i===((l=t.extensions)==null?void 0:l[o])}):e[r]===t[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?VO.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function H7(n={},e=[]){const t=V.useRef(n);t.current=n;const[r]=V.useState(()=>new F7(t)),i=xN.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return V.useDebugValue(i),V.useEffect(r.onRender(e)),U7({editor:i,selector:({transactionNumber:o})=>n.shouldRerenderOnTransaction===!1||n.shouldRerenderOnTransaction===void 0?null:n.immediatelyRender&&o===0?0:o+1}),i}var jO=V.createContext({editor:null});jO.Consumer;var q7=V.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),$7=()=>V.useContext(q7);Xa.forwardRef((n,e)=>{const{onDragStart:t}=$7(),r=n.as||"div";return S.jsx(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});Xa.createContext({markViewContentRef:()=>{}});var KE=V.createContext({get editor(){throw new Error("useTiptap must be used within a <Tiptap> provider")}});KE.displayName="TiptapContext";var G7=()=>V.useContext(KE);function UO({editor:n,instance:e,children:t}){const r=n??e;if(!r)throw new Error("Tiptap: An editor instance is required. Pass a non-null `editor` prop.");const i=V.useMemo(()=>({editor:r}),[r]),o=V.useMemo(()=>({editor:r}),[r]);return S.jsx(jO.Provider,{value:o,children:S.jsx(KE.Provider,{value:i,children:t})})}UO.displayName="Tiptap";function BO({...n}){const{editor:e}=G7();return S.jsx(PO,{editor:e,...n})}BO.displayName="Tiptap.Content";Object.assign(UO,{Content:BO});var Vm=(n,e)=>{if(n==="slot")return 0;if(n instanceof Function)return n(e);const{children:t,...r}=e??{};if(n==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[n,r,t]},K7=/^\s*>\s$/,W7=Er.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return Vm("blockquote",{...en(this.options.HTMLAttributes,n),children:Vm("slot",{})})},parseMarkdown:(n,e)=>e.createNode("blockquote",void 0,e.parseChildren(n.tokens||[])),renderMarkdown:(n,e)=>{if(!n.content)return"";const t=">",r=[];return n.content.forEach(i=>{const u=e.renderChildren([i]).split(`
`).map(h=>h.trim()===""?t:`${t} ${h}`);r.push(u.join(`
`))}),r.join(`
${t}
`)},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Kc({find:K7,type:this.type})]}}),Q7=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Y7=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,J7=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,X7=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Z7=yl.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return Vm("strong",{...en(this.options.HTMLAttributes,n),children:Vm("slot",{})})},markdownTokenName:"strong",parseMarkdown:(n,e)=>e.applyMark("bold",e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>`**${e.renderChildren(n)}**`,addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Gc({find:Q7,type:this.type}),Gc({find:J7,type:this.type})]},addPasteRules(){return[cl({find:Y7,type:this.type}),cl({find:X7,type:this.type})]}}),e$=/(^|[^`])`([^`]+)`(?!`)$/,t$=/(^|[^`])`([^`]+)`(?!`)/g,n$=yl.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",en(this.options.HTMLAttributes,n),0]},markdownTokenName:"codespan",parseMarkdown:(n,e)=>e.applyMark("code",[{type:"text",text:n.text||""}]),renderMarkdown:(n,e)=>n.content?`\`${e.renderChildren(n.content)}\``:"",addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Gc({find:e$,type:this.type})]},addPasteRules(){return[cl({find:t$,type:this.type})]}}),Hb=4,r$=/^```([a-z]+)?[\s\n]$/,i$=/^~~~([a-z]+)?[\s\n]$/,s$=Er.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Hb,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options;if(!t)return null;const o=[...((e=n.firstElementChild)==null?void 0:e.classList)||[]].filter(l=>l.startsWith(t)).map(l=>l.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",en(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(n,e)=>{var t;return((t=n.raw)==null?void 0:t.startsWith("```"))===!1&&n.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:n.lang||null},n.text?[e.createTextNode(n.text)]:[])},renderMarkdown:(n,e)=>{var t;let r="";const i=((t=n.attrs)==null?void 0:t.language)||"";return n.content?r=[`\`\`\`${i}`,e.renderChildren(n.content),"```"].join(`
`):r=`\`\`\`${i}

\`\`\``,r},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:n})=>{var e;if(!this.options.enableTabIndentation)return!1;const t=(e=this.options.tabSize)!=null?e:Hb,{state:r}=n,{selection:i}=r,{$from:o,empty:l}=i;if(o.parent.type!==this.type)return!1;const u=" ".repeat(t);return l?n.commands.insertContent(u):n.commands.command(({tr:h})=>{const{from:d,to:p}=i,_=r.doc.textBetween(d,p,`
`,`
`).split(`
`).map(T=>u+T).join(`
`);return h.replaceWith(d,p,r.schema.text(_)),!0})},"Shift-Tab":({editor:n})=>{var e;if(!this.options.enableTabIndentation)return!1;const t=(e=this.options.tabSize)!=null?e:Hb,{state:r}=n,{selection:i}=r,{$from:o,empty:l}=i;return o.parent.type!==this.type?!1:l?n.commands.command(({tr:u})=>{var h;const{pos:d}=o,p=o.start(),g=o.end(),_=r.doc.textBetween(p,g,`
`,`
`).split(`
`);let T=0,x=0;const A=d-p;for(let G=0;G<_.length;G+=1){if(x+_[G].length>=A){T=G;break}x+=_[G].length+1}const M=((h=_[T].match(/^ */))==null?void 0:h[0])||"",j=Math.min(M.length,t);if(j===0)return!0;let Y=p;for(let G=0;G<T;G+=1)Y+=_[G].length+1;return u.delete(Y,Y+j),d-Y<=j&&u.setSelection(Ne.create(u.doc,Y)),!0}):n.commands.command(({tr:u})=>{const{from:h,to:d}=i,b=r.doc.textBetween(h,d,`
`,`
`).split(`
`).map(_=>{var T;const x=((T=_.match(/^ */))==null?void 0:T[0])||"",A=Math.min(x.length,t);return _.slice(A)}).join(`
`);return u.replaceWith(h,d,r.schema.text(b)),!0})},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,l=r.parent.textContent.endsWith(`

`);return!o||!l?!1:n.chain().command(({tr:u})=>(u.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:i,empty:o}=t;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const u=i.after();return u===void 0?!1:r.nodeAt(u)?n.commands.command(({tr:d})=>(d.setSelection(Ue.near(r.resolve(u))),!0)):n.commands.exitCode()}}},addInputRules(){return[q0({find:r$,type:this.type,getAttributes:n=>({language:n[1]})}),q0({find:i$,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new At({key:new on("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i?.mode;if(!t||!o)return!1;const{tr:l,schema:u}=n.state,h=u.text(t.replace(/\r\n?/g,`
`));return l.replaceSelectionWith(this.type.create({language:o},h)),l.selection.$from.parent.type!==this.type&&l.setSelection(Ne.near(l.doc.resolve(Math.max(0,l.selection.from-2)))),l.setMeta("paste",!0),n.dispatch(l),!0}}})]}}),o$=Er.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`

`):""}),a$=Er.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",en(this.options.HTMLAttributes,n)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:o}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:l}=this.options,{splittableMarks:u}=r.extensionManager,h=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:d,dispatch:p})=>{if(p&&h&&l){const g=h.filter(b=>u.includes(b.type.name));d.ensureMarks(g)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),l$=Er.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,en(this.options.HTMLAttributes,e),0]},parseMarkdown:(n,e)=>e.createNode("heading",{level:n.depth||1},e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>{var t;const r=(t=n.attrs)!=null&&t.level?parseInt(n.attrs.level,10):1,i="#".repeat(r);return n.content?`${i} ${e.renderChildren(n.content)}`:""},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>q0({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}}),c$=Er.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",en(this.options.HTMLAttributes,n)]},markdownTokenName:"hr",parseMarkdown:(n,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{if(!P8(e,e.schema.nodes[this.name]))return!1;const{selection:t}=e,{$to:r}=t,i=n();return yO(t)?i.insertContentAt(r.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:o,tr:l,dispatch:u})=>{if(u){const{$to:h}=l.selection,d=h.end();if(h.nodeAfter)h.nodeAfter.isTextblock?l.setSelection(Ne.create(l.doc,h.pos+1)):h.nodeAfter.isBlock?l.setSelection(we.create(l.doc,h.pos)):l.setSelection(Ne.create(l.doc,h.pos));else{const p=o.schema.nodes[this.options.nextNodeType]||h.parent.type.contentMatch.defaultType,g=p?.create();g&&(l.insert(d,g),l.setSelection(Ne.create(l.doc,d+1)))}l.scrollIntoView()}return!0}).run()}}},addInputRules(){return[L8({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),u$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,h$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,f$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,d$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,p$=yl.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",en(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(n,e)=>e.applyMark("italic",e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>`*${e.renderChildren(n)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Gc({find:u$,type:this.type}),Gc({find:f$,type:this.type})]},addPasteRules(){return[cl({find:h$,type:this.type}),cl({find:d$,type:this.type})]}});const m$="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",g$="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",K0="numeric",W0="ascii",Q0="alpha",Bh="asciinumeric",xh="alphanumeric",Y0="domain",zO="emoji",y$="scheme",v$="slashscheme",qb="whitespace";function b$(n,e){return n in e||(e[n]=[]),e[n]}function $a(n,e,t){e[K0]&&(e[Bh]=!0,e[xh]=!0),e[W0]&&(e[Bh]=!0,e[Q0]=!0),e[Bh]&&(e[xh]=!0),e[Q0]&&(e[xh]=!0),e[xh]&&(e[Y0]=!0),e[zO]&&(e[Y0]=!0);for(const r in e){const i=b$(r,t);i.indexOf(n)<0&&i.push(n)}}function _$(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function rr(n=null){this.j={},this.jr=[],this.jd=null,this.t=n}rr.groups={};rr.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],o=e.jr[r][1];if(o&&i.test(n))return o}return e.jd},has(n,e=!1){return e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let i=0;i<n.length;i++)this.tt(n[i],e,t,r)},tr(n,e,t,r){r=r||rr.groups;let i;return e&&e.j?i=e:(i=new rr(e),t&&r&&$a(e,t,r)),this.jr.push([n,i]),i},ts(n,e,t,r){let i=this;const o=n.length;if(!o)return i;for(let l=0;l<o-1;l++)i=i.tt(n[l]);return i.tt(n[o-1],e,t,r)},tt(n,e,t,r){r=r||rr.groups;const i=this;if(e&&e.j)return i.j[n]=e,e;const o=e;let l,u=i.go(n);if(u?(l=new rr,Object.assign(l.j,u.j),l.jr.push.apply(l.jr,u.jr),l.jd=u.jd,l.t=u.t):l=new rr,o){if(r)if(l.t&&typeof l.t=="string"){const h=Object.assign(_$(l.t,r),t);$a(o,h,r)}else t&&$a(o,t,r);l.t=o}return i.j[n]=l,l}};const je=(n,e,t,r,i)=>n.ta(e,t,r,i),Rt=(n,e,t,r,i)=>n.tr(e,t,r,i),Fx=(n,e,t,r,i)=>n.ts(e,t,r,i),ce=(n,e,t,r,i)=>n.tt(e,t,r,i),_s="WORD",J0="UWORD",FO="ASCIINUMERICAL",HO="ALPHANUMERICAL",pf="LOCALHOST",X0="TLD",Z0="UTLD",Xp="SCHEME",yc="SLASH_SCHEME",WE="NUM",e_="WS",QE="NL",zh="OPENBRACE",Fh="CLOSEBRACE",jm="OPENBRACKET",Um="CLOSEBRACKET",Bm="OPENPAREN",zm="CLOSEPAREN",Fm="OPENANGLEBRACKET",Hm="CLOSEANGLEBRACKET",qm="FULLWIDTHLEFTPAREN",$m="FULLWIDTHRIGHTPAREN",Gm="LEFTCORNERBRACKET",Km="RIGHTCORNERBRACKET",Wm="LEFTWHITECORNERBRACKET",Qm="RIGHTWHITECORNERBRACKET",Ym="FULLWIDTHLESSTHAN",Jm="FULLWIDTHGREATERTHAN",Xm="AMPERSAND",Zm="APOSTROPHE",eg="ASTERISK",vo="AT",tg="BACKSLASH",ng="BACKTICK",rg="CARET",Co="COLON",YE="COMMA",ig="DOLLAR",Li="DOT",sg="EQUALS",JE="EXCLAMATION",Pr="HYPHEN",Hh="PERCENT",og="PIPE",ag="PLUS",lg="POUND",qh="QUERY",XE="QUOTE",qO="FULLWIDTHMIDDLEDOT",ZE="SEMI",Pi="SLASH",$h="TILDE",cg="UNDERSCORE",$O="EMOJI",ug="SYM";var GO=Object.freeze({__proto__:null,ALPHANUMERICAL:HO,AMPERSAND:Xm,APOSTROPHE:Zm,ASCIINUMERICAL:FO,ASTERISK:eg,AT:vo,BACKSLASH:tg,BACKTICK:ng,CARET:rg,CLOSEANGLEBRACKET:Hm,CLOSEBRACE:Fh,CLOSEBRACKET:Um,CLOSEPAREN:zm,COLON:Co,COMMA:YE,DOLLAR:ig,DOT:Li,EMOJI:$O,EQUALS:sg,EXCLAMATION:JE,FULLWIDTHGREATERTHAN:Jm,FULLWIDTHLEFTPAREN:qm,FULLWIDTHLESSTHAN:Ym,FULLWIDTHMIDDLEDOT:qO,FULLWIDTHRIGHTPAREN:$m,HYPHEN:Pr,LEFTCORNERBRACKET:Gm,LEFTWHITECORNERBRACKET:Wm,LOCALHOST:pf,NL:QE,NUM:WE,OPENANGLEBRACKET:Fm,OPENBRACE:zh,OPENBRACKET:jm,OPENPAREN:Bm,PERCENT:Hh,PIPE:og,PLUS:ag,POUND:lg,QUERY:qh,QUOTE:XE,RIGHTCORNERBRACKET:Km,RIGHTWHITECORNERBRACKET:Qm,SCHEME:Xp,SEMI:ZE,SLASH:Pi,SLASH_SCHEME:yc,SYM:ug,TILDE:$h,TLD:X0,UNDERSCORE:cg,UTLD:Z0,UWORD:J0,WORD:_s,WS:e_});const vs=/[a-z]/,gh=new RegExp("\\p{L}","u"),$b=new RegExp("\\p{Emoji}","u"),bs=/\d/,Gb=/\s/,Hx="\r",Kb=`
`,E$="",T$="",Wb="";let Np=null,Mp=null;function S$(n=[]){const e={};rr.groups=e;const t=new rr;Np==null&&(Np=qx(m$)),Mp==null&&(Mp=qx(g$)),ce(t,"'",Zm),ce(t,"{",zh),ce(t,"}",Fh),ce(t,"[",jm),ce(t,"]",Um),ce(t,"(",Bm),ce(t,")",zm),ce(t,"<",Fm),ce(t,">",Hm),ce(t,"",qm),ce(t,"",$m),ce(t,"",Gm),ce(t,"",Km),ce(t,"",Wm),ce(t,"",Qm),ce(t,"",Ym),ce(t,"",Jm),ce(t,"&",Xm),ce(t,"*",eg),ce(t,"@",vo),ce(t,"`",ng),ce(t,"^",rg),ce(t,":",Co),ce(t,",",YE),ce(t,"$",ig),ce(t,".",Li),ce(t,"=",sg),ce(t,"!",JE),ce(t,"-",Pr),ce(t,"%",Hh),ce(t,"|",og),ce(t,"+",ag),ce(t,"#",lg),ce(t,"?",qh),ce(t,'"',XE),ce(t,"/",Pi),ce(t,";",ZE),ce(t,"~",$h),ce(t,"_",cg),ce(t,"\\",tg),ce(t,"",qO);const r=Rt(t,bs,WE,{[K0]:!0});Rt(r,bs,r);const i=Rt(r,vs,FO,{[Bh]:!0}),o=Rt(r,gh,HO,{[xh]:!0}),l=Rt(t,vs,_s,{[W0]:!0});Rt(l,bs,i),Rt(l,vs,l),Rt(i,bs,i),Rt(i,vs,i);const u=Rt(t,gh,J0,{[Q0]:!0});Rt(u,vs),Rt(u,bs,o),Rt(u,gh,u),Rt(o,bs,o),Rt(o,vs),Rt(o,gh,o);const h=ce(t,Kb,QE,{[qb]:!0}),d=ce(t,Hx,e_,{[qb]:!0}),p=Rt(t,Gb,e_,{[qb]:!0});ce(t,Wb,p),ce(d,Kb,h),ce(d,Wb,p),Rt(d,Gb,p),ce(p,Hx),ce(p,Kb),Rt(p,Gb,p),ce(p,Wb,p);const g=Rt(t,$b,$O,{[zO]:!0});ce(g,"#"),Rt(g,$b,g),ce(g,E$,g);const b=ce(g,T$);ce(b,"#"),Rt(b,$b,g);const _=[[vs,l],[bs,i]],T=[[vs,null],[gh,u],[bs,o]];for(let x=0;x<Np.length;x++)mo(t,Np[x],X0,_s,_);for(let x=0;x<Mp.length;x++)mo(t,Mp[x],Z0,J0,T);$a(X0,{tld:!0,ascii:!0},e),$a(Z0,{utld:!0,alpha:!0},e),mo(t,"file",Xp,_s,_),mo(t,"mailto",Xp,_s,_),mo(t,"http",yc,_s,_),mo(t,"https",yc,_s,_),mo(t,"ftp",yc,_s,_),mo(t,"ftps",yc,_s,_),$a(Xp,{scheme:!0,ascii:!0},e),$a(yc,{slashscheme:!0,ascii:!0},e),n=n.sort((x,A)=>x[0]>A[0]?1:-1);for(let x=0;x<n.length;x++){const A=n[x][0],M=n[x][1]?{[y$]:!0}:{[v$]:!0};A.indexOf("-")>=0?M[Y0]=!0:vs.test(A)?bs.test(A)?M[Bh]=!0:M[W0]=!0:M[K0]=!0,Fx(t,A,A,M)}return Fx(t,"localhost",pf,{ascii:!0}),t.jd=new rr(ug),{start:t,tokens:Object.assign({groups:e},GO)}}function KO(n,e){const t=w$(e.replace(/[A-Z]/g,u=>u.toLowerCase())),r=t.length,i=[];let o=0,l=0;for(;l<r;){let u=n,h=null,d=0,p=null,g=-1,b=-1;for(;l<r&&(h=u.go(t[l]));)u=h,u.accepts()?(g=0,b=0,p=u):g>=0&&(g+=t[l].length,b++),d+=t[l].length,o+=t[l].length,l++;o-=g,l-=b,d-=g,i.push({t:p.t,v:e.slice(o-d,o),s:o-d,e:o})}return i}function w$(n){const e=[],t=n.length;let r=0;for(;r<t;){let i=n.charCodeAt(r),o,l=i<55296||i>56319||r+1===t||(o=n.charCodeAt(r+1))<56320||o>57343?n[r]:n.slice(r,r+2);e.push(l),r+=l.length}return e}function mo(n,e,t,r,i){let o;const l=e.length;for(let u=0;u<l-1;u++){const h=e[u];n.j[h]?o=n.j[h]:(o=new rr(r),o.jr=i.slice(),n.j[h]=o),n=o}return o=new rr(t),o.jr=i.slice(),n.j[e[l-1]]=o,o}function qx(n){const e=[],t=[];let r=0,i="0123456789";for(;r<n.length;){let o=0;for(;i.indexOf(n[r+o])>=0;)o++;if(o>0){e.push(t.join(""));for(let l=parseInt(n.substring(r,r+o),10);l>0;l--)t.pop();r+=o}else t.push(n[r]),r++}return e}const mf={defaultProtocol:"http",events:null,format:$x,formatHref:$x,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function eT(n,e=null){let t=Object.assign({},mf);n&&(t=Object.assign(t,n instanceof eT?n.o:n));const r=t.ignoreTags,i=[];for(let o=0;o<r.length;o++)i.push(r[o].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=i}eT.prototype={o:mf,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let i=this.o[n];return i&&(typeof i=="object"?(i=t.t in i?i[t.t]:mf[n],typeof i=="function"&&r&&(i=i(e,t))):typeof i=="function"&&r&&(i=i(e,t.t,t)),i)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function $x(n){return n}function WO(n,e){this.t="token",this.v=n,this.tk=e}WO.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n=mf.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),i=n.get("tagName",t,e),o=this.toFormattedString(n),l={},u=n.get("className",t,e),h=n.get("target",t,e),d=n.get("rel",t,e),p=n.getObj("attributes",t,e),g=n.getObj("events",t,e);return l.href=r,u&&(l.class=u),h&&(l.target=h),d&&(l.rel=d),p&&Object.assign(l,p),{tagName:i,attributes:l,content:o,eventListeners:g}}};function Zg(n,e){class t extends WO{constructor(i,o){super(i,o),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const Gx=Zg("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Kx=Zg("text"),A$=Zg("nl"),Op=Zg("url",{isLink:!0,toHref(n=mf.defaultProtocol){return this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==pf&&n[1].t===Co}}),Lr=n=>new rr(n);function C$({groups:n}){const e=n.domain.concat([Xm,eg,vo,tg,ng,rg,ig,sg,Pr,WE,Hh,og,ag,lg,Pi,ug,$h,cg]),t=[Zm,Co,YE,Li,JE,Hh,qh,XE,ZE,Fm,Hm,zh,Fh,Um,jm,Bm,zm,qm,$m,Gm,Km,Wm,Qm,Ym,Jm],r=[Xm,Zm,eg,tg,ng,rg,ig,sg,Pr,zh,Fh,Hh,og,ag,lg,qh,Pi,ug,$h,cg],i=Lr(),o=ce(i,$h);je(o,r,o),je(o,n.domain,o);const l=Lr(),u=Lr(),h=Lr();je(i,n.domain,l),je(i,n.scheme,u),je(i,n.slashscheme,h),je(l,r,o),je(l,n.domain,l);const d=ce(l,vo);ce(o,vo,d),ce(u,vo,d),ce(h,vo,d);const p=ce(o,Li);je(p,r,o),je(p,n.domain,o);const g=Lr();je(d,n.domain,g),je(g,n.domain,g);const b=ce(g,Li);je(b,n.domain,g);const _=Lr(Gx);je(b,n.tld,_),je(b,n.utld,_),ce(d,pf,_);const T=ce(g,Pr);ce(T,Pr,T),je(T,n.domain,g),je(_,n.domain,g),ce(_,Li,b),ce(_,Pr,T);const x=ce(_,Co);je(x,n.numeric,Gx);const A=ce(l,Pr),R=ce(l,Li);ce(A,Pr,A),je(A,n.domain,l),je(R,r,o),je(R,n.domain,l);const M=Lr(Op);je(R,n.tld,M),je(R,n.utld,M),je(M,n.domain,l),je(M,r,o),ce(M,Li,R),ce(M,Pr,A),ce(M,vo,d);const j=ce(M,Co),Y=Lr(Op);je(j,n.numeric,Y);const $=Lr(Op),G=Lr();je($,e,$),je($,t,G),je(G,e,$),je(G,t,G),ce(M,Pi,$),ce(Y,Pi,$);const I=ce(u,Co),N=ce(h,Co),P=ce(N,Pi),B=ce(P,Pi);je(u,n.domain,l),ce(u,Li,R),ce(u,Pr,A),je(h,n.domain,l),ce(h,Li,R),ce(h,Pr,A),je(I,n.domain,$),ce(I,Pi,$),ce(I,qh,$),je(B,n.domain,$),je(B,e,$),ce(B,Pi,$);const z=[[zh,Fh],[jm,Um],[Bm,zm],[Fm,Hm],[qm,$m],[Gm,Km],[Wm,Qm],[Ym,Jm]];for(let L=0;L<z.length;L++){const[D,ue]=z[L],ve=ce($,D);ce(G,D,ve),ce(ve,ue,$);const J=Lr(Op);je(ve,e,J);const ne=Lr();je(ve,t),je(J,e,J),je(J,t,ne),je(ne,e,J),je(ne,t,ne),ce(J,ue,$),ce(ne,ue,$)}return ce(i,pf,M),ce(i,QE,A$),{start:i,tokens:GO}}function x$(n,e,t){let r=t.length,i=0,o=[],l=[];for(;i<r;){let u=n,h=null,d=null,p=0,g=null,b=-1;for(;i<r&&!(h=u.go(t[i].t));)l.push(t[i++]);for(;i<r&&(d=h||u.go(t[i].t));)h=null,u=d,u.accepts()?(b=0,g=u):b>=0&&b++,i++,p++;if(b<0)i-=p,i<r&&(l.push(t[i]),i++);else{l.length>0&&(o.push(Qb(Kx,e,l)),l=[]),i-=b,p-=b;const _=g.t,T=t.slice(i-p,i);o.push(Qb(_,e,T))}}return l.length>0&&o.push(Qb(Kx,e,l)),o}function Qb(n,e,t){const r=t[0].s,i=t[t.length-1].e,o=e.slice(r,i);return new n(o,t)}const R$=typeof console<"u"&&console&&console.warn||(()=>{}),k$="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",vt={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function I$(){return rr.groups={},vt.scanner=null,vt.parser=null,vt.tokenQueue=[],vt.pluginQueue=[],vt.customSchemes=[],vt.initialized=!1,vt}function Wx(n,e=!1){if(vt.initialized&&R$(`linkifyjs: already initialized - will not register custom scheme "${n}" ${k$}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);vt.customSchemes.push([n,e])}function N$(){vt.scanner=S$(vt.customSchemes);for(let n=0;n<vt.tokenQueue.length;n++)vt.tokenQueue[n][1]({scanner:vt.scanner});vt.parser=C$(vt.scanner.tokens);for(let n=0;n<vt.pluginQueue.length;n++)vt.pluginQueue[n][1]({scanner:vt.scanner,parser:vt.parser});return vt.initialized=!0,vt}function tT(n){return vt.initialized||N$(),x$(vt.parser.start,n,KO(vt.scanner.start,n))}tT.scan=KO;function QO(n,e=null,t=null){if(e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}const r=new eT(t),i=tT(n),o=[];for(let l=0;l<i.length;l++){const u=i[l];u.isLink&&(!e||u.t===e)&&r.check(u)&&o.push(u.toFormattedObject(r))}return o}var nT="[\0- -\u2029]",M$=new RegExp(nT),O$=new RegExp(`${nT}$`),D$=new RegExp(nT,"g");function L$(n){return n.length===1?n[0].isLink:n.length===3&&n[1].isLink?["()","[]"].includes(n[0].value+n[2].value):!1}function P$(n){return new At({key:new on("autolink"),appendTransaction:(e,t,r)=>{const i=e.some(d=>d.docChanged)&&!t.doc.eq(r.doc),o=e.some(d=>d.getMeta("preventAutolink"));if(!i||o)return;const{tr:l}=r,u=cO(t.doc,[...e]);if(gO(u).forEach(({newRange:d})=>{const p=Pq(r.doc,d,_=>_.isTextblock);let g,b;if(p.length>1)g=p[0],b=r.doc.textBetween(g.pos,g.pos+g.node.nodeSize,void 0," ");else if(p.length){const _=r.doc.textBetween(d.from,d.to," "," ");if(!O$.test(_))return;g=p[0],b=r.doc.textBetween(g.pos,d.to,void 0," ")}if(g&&b){const _=b.split(M$).filter(Boolean);if(_.length<=0)return!1;const T=_[_.length-1],x=g.pos+b.lastIndexOf(T);if(!T)return!1;const A=tT(T).map(R=>R.toObject(n.defaultProtocol));if(!L$(A))return!1;A.filter(R=>R.isLink).map(R=>({...R,from:x+R.start+1,to:x+R.end+1})).filter(R=>r.schema.marks.code?!r.doc.rangeHasMark(R.from,R.to,r.schema.marks.code):!0).filter(R=>n.validate(R.value)).filter(R=>n.shouldAutoLink(R.value)).forEach(R=>{FE(R.from,R.to,r.doc).some(M=>M.mark.type===n.type)||l.addMark(R.from,R.to,n.type.create({href:R.href}))})}}),!!l.steps.length)return l}})}function V$(n){return new At({key:new on("handleClickLink"),props:{handleClick:(e,t,r)=>{var i,o;if(r.button!==0||!e.editable)return!1;let l=null;if(r.target instanceof HTMLAnchorElement)l=r.target;else{const h=r.target;if(!h)return!1;const d=n.editor.view.dom;l=h.closest("a"),l&&!d.contains(l)&&(l=null)}if(!l)return!1;let u=!1;if(n.enableClickSelection&&(u=n.editor.commands.extendMarkRange(n.type.name)),n.openOnClick){const h=mO(e.state,n.type.name),d=(i=l.href)!=null?i:h.href,p=(o=l.target)!=null?o:h.target;d&&(window.open(d,p),u=!0)}return u}}})}function j$(n){return new At({key:new on("handlePasteLink"),props:{handlePaste:(e,t,r)=>{const{shouldAutoLink:i}=n,{state:o}=e,{selection:l}=o,{empty:u}=l;if(u)return!1;let h="";r.content.forEach(p=>{h+=p.textContent});const d=QO(h,{defaultProtocol:n.defaultProtocol}).find(p=>p.isLink&&p.value===h);return!h||!d||i!==void 0&&!i(d.value)?!1:n.editor.commands.setMark(n.type,{href:d.href})}}})}function ja(n,e){const t=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const i=typeof r=="string"?r:r.scheme;i&&t.push(i)}),!n||n.replace(D$,"").match(new RegExp(`^(?:(?:${t.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var U$=yl.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(n=>{if(typeof n=="string"){Wx(n);return}Wx(n.scheme,n.optionalSlashes)})},onDestroy(){I$()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(n,e)=>!!ja(n,e.protocols),validate:n=>!!n,shouldAutoLink:n=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(n),t=/^[a-z][a-z0-9+.-]*:/i.test(n);if(e||t&&!n.includes("@"))return!0;const i=(n.includes("@")?n.split("@").pop():n).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(n){return n.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class},title:{default:null}}},parseHTML(){return[{tag:"a[href]",getAttrs:n=>{const e=n.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:t=>!!ja(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:n}){return this.options.isAllowedUri(n.href,{defaultValidate:e=>!!ja(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",en(this.options.HTMLAttributes,n),0]:["a",en(this.options.HTMLAttributes,{...n,href:""}),0]},markdownTokenName:"link",parseMarkdown:(n,e)=>e.applyMark("link",e.parseInline(n.tokens||[]),{href:n.href,title:n.title||null}),renderMarkdown:(n,e)=>{var t,r,i,o;const l=(r=(t=n.attrs)==null?void 0:t.href)!=null?r:"",u=(o=(i=n.attrs)==null?void 0:i.title)!=null?o:"",h=e.renderChildren(n);return u?`[${h}](${l} "${u}")`:`[${h}](${l})`},addCommands(){return{setLink:n=>({chain:e})=>{const{href:t}=n;return this.options.isAllowedUri(t,{defaultValidate:r=>!!ja(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,n).setMeta("preventAutolink",!0).run():!1},toggleLink:n=>({chain:e})=>{const{href:t}=n||{};return t&&!this.options.isAllowedUri(t,{defaultValidate:r=>!!ja(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[cl({find:n=>{const e=[];if(n){const{protocols:t,defaultProtocol:r}=this.options,i=QO(n).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:l=>!!ja(l,t),protocols:t,defaultProtocol:r}));i.length&&i.forEach(o=>{this.options.shouldAutoLink(o.value)&&e.push({text:o.value,data:{href:o.href},index:o.start})})}return e},type:this.type,getAttributes:n=>{var e;return{href:(e=n.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const n=[],{protocols:e,defaultProtocol:t}=this.options;return this.options.autolink&&n.push(P$({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:i=>!!ja(i,e),protocols:e,defaultProtocol:t}),shouldAutoLink:this.options.shouldAutoLink})),n.push(V$({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&n.push(j$({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),n}}),B$=Object.defineProperty,z$=(n,e)=>{for(var t in e)B$(n,t,{get:e[t],enumerable:!0})},F$="listItem",Qx="textStyle",Yx=/^\s*([-+*])\s$/,YO=Er.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",en(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,e)=>n.type!=="list"||n.ordered?[]:{type:"bulletList",content:n.items?e.parseChildren(n.items):[]},renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(F$,this.editor.getAttributes(Qx)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=Kc({find:Yx,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Kc({find:Yx,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Qx),editor:this.editor})),[n]}}),JO=Er.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",en(this.options.HTMLAttributes,n),0]},markdownTokenName:"list_item",parseMarkdown:(n,e)=>{if(n.type!=="list_item")return[];let t=[];if(n.tokens&&n.tokens.length>0)if(n.tokens.some(i=>i.type==="paragraph"))t=e.parseChildren(n.tokens);else{const i=n.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(t=[{type:"paragraph",content:e.parseInline(i.tokens)}],n.tokens.length>1){const l=n.tokens.slice(1),u=e.parseChildren(l);t.push(...u)}}else t=e.parseChildren(n.tokens)}return t.length===0&&(t=[{type:"paragraph",content:[]}]),{type:"listItem",content:t}},renderMarkdown:(n,e,t)=>GE(n,e,r=>{var i,o;return r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${(((o=(i=r.meta)==null?void 0:i.parentAttrs)==null?void 0:o.start)||1)+r.index}. `:"- "},t),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),H$={};z$(H$,{findListItemPos:()=>Pf,getNextListDepth:()=>rT,handleBackspace:()=>t_,handleDelete:()=>n_,hasListBefore:()=>XO,hasListItemAfter:()=>q$,hasListItemBefore:()=>ZO,listItemHasSubList:()=>eD,nextListIsDeeper:()=>tD,nextListIsHigher:()=>nD});var Pf=(n,e)=>{const{$from:t}=e.selection,r=Zt(n,e.schema);let i=null,o=t.depth,l=t.pos,u=null;for(;o>0&&u===null;)i=t.node(o),i.type===r?u=o:(o-=1,l-=1);return u===null?null:{$pos:e.doc.resolve(l),depth:u}},rT=(n,e)=>{const t=Pf(n,e);if(!t)return!1;const[,r]=Gq(e,n,t.$pos.pos+4);return r},XO=(n,e,t)=>{const{$anchor:r}=n.selection,i=Math.max(0,r.pos-2),o=n.doc.resolve(i).node();return!(!o||!t.includes(o.type.name))},ZO=(n,e)=>{var t;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-2);return!(i.index()===0||((t=i.nodeBefore)==null?void 0:t.type.name)!==n)},eD=(n,e,t)=>{if(!t)return!1;const r=Zt(n,e.schema);let i=!1;return t.descendants(o=>{o.type===r&&(i=!0)}),i},t_=(n,e,t)=>{if(n.commands.undoInputRule())return!0;if(n.state.selection.from!==n.state.selection.to)return!1;if(!Zo(n.state,e)&&XO(n.state,e,t)){const{$anchor:u}=n.state.selection,h=n.state.doc.resolve(u.before()-1),d=[];h.node().descendants((b,_)=>{b.type.name===e&&d.push({node:b,pos:_})});const p=d.at(-1);if(!p)return!1;const g=n.state.doc.resolve(h.start()+p.pos+1);return n.chain().cut({from:u.start()-1,to:u.end()+1},g.end()).joinForward().run()}if(!Zo(n.state,e)||!Yq(n.state))return!1;const r=Pf(e,n.state);if(!r)return!1;const o=n.state.doc.resolve(r.$pos.pos-2).node(r.depth),l=eD(e,n.state,o);return ZO(e,n.state)&&!l?n.commands.joinItemBackward():n.chain().liftListItem(e).run()},tD=(n,e)=>{const t=rT(n,e),r=Pf(n,e);return!r||!t?!1:t>r.depth},nD=(n,e)=>{const t=rT(n,e),r=Pf(n,e);return!r||!t?!1:t<r.depth},n_=(n,e)=>{if(!Zo(n.state,e)||!Qq(n.state,e))return!1;const{selection:t}=n.state,{$from:r,$to:i}=t;return!t.empty&&r.sameParent(i)?!1:tD(e,n.state)?n.chain().focus(n.state.selection.from+4).lift(e).joinBackward().run():nD(e,n.state)?n.chain().joinForward().joinBackward().run():n.commands.joinItemForward()},q$=(n,e)=>{var t;const{$anchor:r}=e.selection,i=e.doc.resolve(r.pos-r.parentOffset-2);return!(i.index()===i.parent.childCount-1||((t=i.nodeAfter)==null?void 0:t.type.name)!==n)},rD=Ut.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{n.state.schema.nodes[t]!==void 0&&n_(n,t)&&(e=!0)}),e},"Mod-Delete":({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t})=>{n.state.schema.nodes[t]!==void 0&&n_(n,t)&&(e=!0)}),e},Backspace:({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:r})=>{n.state.schema.nodes[t]!==void 0&&t_(n,t,r)&&(e=!0)}),e},"Mod-Backspace":({editor:n})=>{let e=!1;return this.options.listTypes.forEach(({itemName:t,wrapperNames:r})=>{n.state.schema.nodes[t]!==void 0&&t_(n,t,r)&&(e=!0)}),e}}}}),Jx=/^(\s*)(\d+)\.\s+(.*)$/,$$=/^\s/;function G$(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t],o=i.match(Jx);if(!o)break;const[,l,u,h]=o,d=l.length;let p=h,g=t+1;const b=[i];for(;g<n.length;){const _=n[g];if(_.match(Jx))break;if(_.trim()==="")b.push(_),p+=`
`,g+=1;else if(_.match($$))b.push(_),p+=`
${_.slice(d+2)}`,g+=1;else break}e.push({indent:d,number:parseInt(u,10),content:p.trim(),raw:b.join(`
`)}),r=g,t=g}return[e,r]}function iD(n,e,t){var r;const i=[];let o=0;for(;o<n.length;){const l=n[o];if(l.indent===e){const u=l.content.split(`
`),h=((r=u[0])==null?void 0:r.trim())||"",d=[];h&&d.push({type:"paragraph",raw:h,tokens:t.inlineTokens(h)});const p=u.slice(1).join(`
`).trim();if(p){const _=t.blockTokens(p);d.push(..._)}let g=o+1;const b=[];for(;g<n.length&&n[g].indent>e;)b.push(n[g]),g+=1;if(b.length>0){const _=Math.min(...b.map(x=>x.indent)),T=iD(b,_,t);d.push({type:"list",ordered:!0,start:b[0].number,items:T,raw:b.map(x=>x.raw).join(`
`)})}i.push({type:"list_item",raw:l.raw,tokens:d}),o=g}else o+=1}return i}function K$(n,e){return n.map(t=>{if(t.type!=="list_item")return e.parseChildren([t])[0];const r=[];return t.tokens&&t.tokens.length>0&&t.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")r.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const o=e.parseChildren([i]);r.push({type:"paragraph",content:o})}else{const o=e.parseChildren([i]);o.length>0&&r.push(...o)}}),{type:"listItem",content:r}})}var W$="listItem",Xx="textStyle",Zx=/^(\d+)\.\s$/,sD=Er.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",en(this.options.HTMLAttributes,t),0]:["ol",en(this.options.HTMLAttributes,n),0]},markdownTokenName:"list",parseMarkdown:(n,e)=>{if(n.type!=="list"||!n.ordered)return[];const t=n.start||1,r=n.items?K$(n.items,e):[];return t!==1?{type:"orderedList",attrs:{start:t},content:r}:{type:"orderedList",content:r}},renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:n=>{const e=n.match(/^(\s*)(\d+)\.\s+/),t=e?.index;return t!==void 0?t:-1},tokenize:(n,e,t)=>{var r;const i=n.split(`
`),[o,l]=G$(i);if(o.length===0)return;const u=iD(o,0,t);return u.length===0?void 0:{type:"list",ordered:!0,start:((r=o[0])==null?void 0:r.number)||1,items:u,raw:i.slice(0,l).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(W$,this.editor.getAttributes(Xx)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=Kc({find:Zx,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Kc({find:Zx,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Xx)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),Q$=/^\s*(\[([( |x])?\])\s$/,Y$=Er.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:n=>{const e=n.getAttribute("data-checked");return e===""||e==="true"},renderHTML:n=>({"data-checked":n.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:n,HTMLAttributes:e}){return["li",en(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:n.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(n,e)=>{const t=[];if(n.tokens&&n.tokens.length>0?t.push(e.createNode("paragraph",{},e.parseInline(n.tokens))):n.text?t.push(e.createNode("paragraph",{},[e.createNode("text",{text:n.text})])):t.push(e.createNode("paragraph",{},[])),n.nestedTokens&&n.nestedTokens.length>0){const r=e.parseChildren(n.nestedTokens);t.push(...r)}return e.createNode("taskItem",{checked:n.checked||!1},t)},renderMarkdown:(n,e)=>{var t;const i=`- [${(t=n.attrs)!=null&&t.checked?"x":" "}] `;return GE(n,e,i)},addKeyboardShortcuts(){const n={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...n,Tab:()=>this.editor.commands.sinkListItem(this.name)}:n},addNodeView(){return({node:n,HTMLAttributes:e,getPos:t,editor:r})=>{const i=document.createElement("li"),o=document.createElement("label"),l=document.createElement("span"),u=document.createElement("input"),h=document.createElement("div"),d=g=>{var b,_;u.ariaLabel=((_=(b=this.options.a11y)==null?void 0:b.checkboxLabel)==null?void 0:_.call(b,g,u.checked))||`Task item checkbox for ${g.textContent||"empty task item"}`};d(n),o.contentEditable="false",u.type="checkbox",u.addEventListener("mousedown",g=>g.preventDefault()),u.addEventListener("change",g=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){u.checked=!u.checked;return}const{checked:b}=g.target;r.isEditable&&typeof t=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:_})=>{const T=t();if(typeof T!="number")return!1;const x=_.doc.nodeAt(T);return _.setNodeMarkup(T,void 0,{...x?.attrs,checked:b}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(n,b)||(u.checked=!u.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([g,b])=>{i.setAttribute(g,b)}),i.dataset.checked=n.attrs.checked,u.checked=n.attrs.checked,o.append(u,l),i.append(o,h),Object.entries(e).forEach(([g,b])=>{i.setAttribute(g,b)});let p=new Set(Object.keys(e));return{dom:i,contentDOM:h,update:g=>{if(g.type!==this.type)return!1;i.dataset.checked=g.attrs.checked,u.checked=g.attrs.checked,d(g);const b=r.extensionManager.attributes,_=df(g,b),T=new Set(Object.keys(_)),x=this.options.HTMLAttributes;return p.forEach(A=>{T.has(A)||(A in x?i.setAttribute(A,x[A]):i.removeAttribute(A))}),Object.entries(_).forEach(([A,R])=>{R==null?A in x?i.setAttribute(A,x[A]):i.removeAttribute(A):i.setAttribute(A,R)}),p=T,!0}}}},addInputRules(){return[Kc({find:Q$,type:this.type,getAttributes:n=>({checked:n[n.length-1]==="x"})})]}}),J$=Er.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:n}){return["ul",en(this.options.HTMLAttributes,n,{"data-type":this.name}),0]},parseMarkdown:(n,e)=>e.createNode("taskList",{},e.parseChildren(n.items||[])),renderMarkdown:(n,e)=>n.content?e.renderChildren(n.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(n){var e;const t=(e=n.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return t!==void 0?t:-1},tokenize(n,e,t){const r=o=>{const l=$0(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:u=>({indentLevel:u[1].length,mainContent:u[4],checked:u[3].toLowerCase()==="x"}),createToken:(u,h)=>({type:"taskItem",raw:"",mainContent:u.mainContent,indentLevel:u.indentLevel,checked:u.checked,text:u.mainContent,tokens:t.inlineTokens(u.mainContent),nestedTokens:h}),customNestedParser:r},t);return l?[{type:"taskList",raw:l.raw,items:l.items}]:t.blockTokens(o)},i=$0(n,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,l)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:t.inlineTokens(o.mainContent),nestedTokens:l}),customNestedParser:r},t);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:n})=>n.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Ut.create({name:"listKit",addExtensions(){const n=[];return this.options.bulletList!==!1&&n.push(YO.configure(this.options.bulletList)),this.options.listItem!==!1&&n.push(JO.configure(this.options.listItem)),this.options.listKeymap!==!1&&n.push(rD.configure(this.options.listKeymap)),this.options.orderedList!==!1&&n.push(sD.configure(this.options.orderedList)),this.options.taskItem!==!1&&n.push(Y$.configure(this.options.taskItem)),this.options.taskList!==!1&&n.push(J$.configure(this.options.taskList)),n}});var eR="&nbsp;",X$="",Z$=Er.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",en(this.options.HTMLAttributes,n),0]},parseMarkdown:(n,e)=>{const t=n.tokens||[];if(t.length===1&&t[0].type==="image")return e.parseChildren([t[0]]);const r=e.parseInline(t);return r.length===1&&r[0].type==="text"&&(r[0].text===eR||r[0].text===X$)?e.createNode("paragraph",void 0,[]):e.createNode("paragraph",void 0,r)},renderMarkdown:(n,e)=>{if(!n)return"";const t=Array.isArray(n.content)?n.content:[];return t.length===0?eR:e.renderChildren(t)},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),eG=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,tG=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,nG=yl.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",en(this.options.HTMLAttributes,n),0]},markdownTokenName:"del",parseMarkdown:(n,e)=>e.applyMark("strike",e.parseInline(n.tokens||[])),renderMarkdown:(n,e)=>`~~${e.renderChildren(n)}~~`,addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Gc({find:eG,type:this.type})]},addPasteRules(){return[cl({find:tG,type:this.type})]}}),rG=Er.create({name:"text",group:"inline",parseMarkdown:n=>({type:"text",text:n.text||""}),renderMarkdown:n=>n.text||""}),iG=yl.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",en(this.options.HTMLAttributes,n),0]},parseMarkdown(n,e){return e.applyMark(this.name||"underline",e.parseInline(n.tokens||[]))},renderMarkdown(n,e){return`++${e.renderChildren(n)}++`},markdownTokenizer:{name:"underline",level:"inline",start(n){return n.indexOf("++")},tokenize(n,e,t){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(n);if(!i)return;const o=i[2].trim();return{type:"underline",raw:i[0],text:o,tokens:t.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function sG(n={}){return new At({view(e){return new oG(e,n)}})}class oG{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=l=>{this[i](l)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,i=this.editorView.dom,o=i.getBoundingClientRect(),l=o.width/i.offsetWidth,u=o.height/i.offsetHeight;if(t){let g=e.nodeBefore,b=e.nodeAfter;if(g||b){let _=this.editorView.nodeDOM(this.cursorPos-(g?g.nodeSize:0));if(_){let T=_.getBoundingClientRect(),x=g?T.bottom:T.top;g&&b&&(x=(x+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let A=this.width/2*u;r={left:T.left,right:T.right,top:x-A,bottom:x+A}}}}if(!r){let g=this.editorView.coordsAtPos(this.cursorPos),b=this.width/2*l;r={left:g.left-b,right:g.left+b,top:g.top,bottom:g.bottom}}let h=this.editorView.dom.offsetParent;this.element||(this.element=h.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let d,p;if(!h||h==document.body&&getComputedStyle(h).position=="static")d=-pageXOffset,p=-pageYOffset;else{let g=h.getBoundingClientRect(),b=g.width/h.offsetWidth,_=g.height/h.offsetHeight;d=g.left-h.scrollLeft*b,p=g.top-h.scrollTop*_}this.element.style.left=(r.left-d)/l+"px",this.element.style.top=(r.top-p)/u+"px",this.element.style.width=(r.right-r.left)/l+"px",this.element.style.height=(r.bottom-r.top)/u+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!o){let l=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let u=eM(this.editorView.state.doc,l,this.editorView.dragging.slice);u!=null&&(l=u)}this.setCursor(l),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class kt extends Ue{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return kt.valid(r)?new kt(r):Ue.near(r)}content(){return me.empty}eq(e){return e instanceof kt&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new kt(e.resolve(t.pos))}getBookmark(){return new iT(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!aG(e)||!lG(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&kt.valid(e))return e;let i=e.pos,o=null;for(let l=e.depth;;l--){let u=e.node(l);if(t>0?e.indexAfter(l)<u.childCount:e.index(l)>0){o=u.child(t>0?e.indexAfter(l):e.index(l)-1);break}else if(l==0)return null;i+=t;let h=e.doc.resolve(i);if(kt.valid(h))return h}for(;;){let l=t>0?o.firstChild:o.lastChild;if(!l){if(o.isAtom&&!o.isText&&!we.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),r=!1;continue e}break}o=l,i+=t;let u=e.doc.resolve(i);if(kt.valid(u))return u}return null}}}kt.prototype.visible=!1;kt.findFrom=kt.findGapCursorFrom;Ue.jsonID("gapcursor",kt);class iT{constructor(e){this.pos=e}map(e){return new iT(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return kt.valid(t)?new kt(t):Ue.near(t)}}function oD(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function aG(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||oD(i.type))return!0;if(i.inlineContent)return!1}}return!0}function lG(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||oD(i.type))return!0;if(i.inlineContent)return!1}}return!0}function cG(){return new At({props:{decorations:dG,createSelectionBetween(n,e,t){return e.pos==t.pos&&kt.valid(t)?new kt(t):null},handleClick:hG,handleKeyDown:uG,handleDOMEvents:{beforeinput:fG}}})}const uG=tO({ArrowLeft:Dp("horiz",-1),ArrowRight:Dp("horiz",1),ArrowUp:Dp("vert",-1),ArrowDown:Dp("vert",1)});function Dp(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let l=r.selection,u=e>0?l.$to:l.$from,h=l.empty;if(l instanceof Ne){if(!o.endOfTextblock(t)||u.depth==0)return!1;h=!1,u=r.doc.resolve(e>0?u.after():u.before())}let d=kt.findGapCursorFrom(u,e,h);return d?(i&&i(r.tr.setSelection(new kt(d))),!0):!1}}function hG(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!kt.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&we.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new kt(r))),!0)}function fG(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof kt))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=le.empty;for(let l=r.length-1;l>=0;l--)i=le.from(r[l].createAndFill(null,i));let o=n.state.tr.replace(t.pos,t.pos,new me(i,0,0));return o.setSelection(Ne.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function dG(n){if(!(n.selection instanceof kt))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",St.create(n.doc,[$n.widget(n.selection.head,e,{key:"gapcursor"})])}var hg=200,gn=function(){};gn.prototype.append=function(e){return e.length?(e=gn.from(e),!this.length&&e||e.length<hg&&this.leafAppend(e)||this.length<hg&&e.leafPrepend(this)||this.appendInner(e)):this};gn.prototype.prepend=function(e){return e.length?gn.from(e).append(this):this};gn.prototype.appendInner=function(e){return new pG(this,e)};gn.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?gn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};gn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};gn.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};gn.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,l){return i.push(e(o,l))},t,r),i};gn.from=function(e){return e instanceof gn?e:e&&e.length?new aD(e):gn.empty};var aD=(function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,l,u){for(var h=o;h<l;h++)if(i(this.values[h],u+h)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,l,u){for(var h=o-1;h>=l;h--)if(i(this.values[h],u+h)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=hg)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=hg)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e})(gn);gn.empty=new aD([]);var pG=(function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,l){var u=this.left.length;if(i<u&&this.left.forEachInner(r,i,Math.min(o,u),l)===!1||o>u&&this.right.forEachInner(r,Math.max(i-u,0),Math.min(this.length,o)-u,l+u)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,l){var u=this.left.length;if(i>u&&this.right.forEachInvertedInner(r,i-u,Math.max(o,u)-u,l+u)===!1||o<u&&this.left.forEachInvertedInner(r,Math.min(i,u),o,l)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e})(gn);const mG=500;class ti{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;t&&(i=this.remapping(r,this.items.length),o=i.maps.length);let l=e.tr,u,h,d=[],p=[];return this.items.forEach((g,b)=>{if(!g.step){i||(i=this.remapping(r,b+1),o=i.maps.length),o--,p.push(g);return}if(i){p.push(new Vi(g.map));let _=g.step.map(i.slice(o)),T;_&&l.maybeStep(_).doc&&(T=l.mapping.maps[l.mapping.maps.length-1],d.push(new Vi(T,void 0,void 0,d.length+p.length))),o--,T&&i.appendMap(T,o)}else l.maybeStep(g.step);if(g.selection)return u=i?g.selection.map(i.slice(o)):g.selection,h=new ti(this.items.slice(0,r).append(p.reverse().concat(d)),this.eventCount-1),!1},this.items.length,0),{remaining:h,transform:l,selection:u}}addTransform(e,t,r,i){let o=[],l=this.eventCount,u=this.items,h=!i&&u.length?u.get(u.length-1):null;for(let p=0;p<e.steps.length;p++){let g=e.steps[p].invert(e.docs[p]),b=new Vi(e.mapping.maps[p],g,t),_;(_=h&&h.merge(b))&&(b=_,p?o.pop():u=u.slice(0,u.length-1)),o.push(b),t&&(l++,t=void 0),i||(h=b)}let d=l-r.depth;return d>yG&&(u=gG(u,d),l-=d),new ti(u.append(o),l)}remapping(e,t){let r=new af;return this.items.forEach((i,o)=>{let l=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,l)},e,t),r}addMaps(e){return this.eventCount==0?this:new ti(this.items.append(e.map(t=>new Vi(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),o=e.mapping,l=e.steps.length,u=this.eventCount;this.items.forEach(b=>{b.selection&&u--},i);let h=t;this.items.forEach(b=>{let _=o.getMirror(--h);if(_==null)return;l=Math.min(l,_);let T=o.maps[_];if(b.step){let x=e.steps[_].invert(e.docs[_]),A=b.selection&&b.selection.map(o.slice(h+1,_));A&&u++,r.push(new Vi(T,x,A))}else r.push(new Vi(T))},i);let d=[];for(let b=t;b<l;b++)d.push(new Vi(o.maps[b]));let p=this.items.slice(0,i).append(d).append(r),g=new ti(p,u);return g.emptyItemCount()>mG&&(g=g.compress(this.items.length-r.length)),g}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],o=0;return this.items.forEach((l,u)=>{if(u>=e)i.push(l),l.selection&&o++;else if(l.step){let h=l.step.map(t.slice(r)),d=h&&h.getMap();if(r--,d&&t.appendMap(d,r),h){let p=l.selection&&l.selection.map(t.slice(r));p&&o++;let g=new Vi(d.invert(),h,p),b,_=i.length-1;(b=i.length&&i[_].merge(g))?i[_]=b:i.push(g)}}else l.map&&r--},this.items.length,0),new ti(gn.from(i.reverse()),o)}}ti.empty=new ti(gn.empty,0);function gG(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class Vi{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Vi(t.getMap().invert(),t,this.selection)}}}class bo{constructor(e,t,r,i,o){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const yG=20;function vG(n,e,t,r){let i=t.getMeta(Ja),o;if(i)return i.historyState;t.getMeta(EG)&&(n=new bo(n.done,n.undone,null,0,-1));let l=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(l&&l.getMeta(Ja))return l.getMeta(Ja).redo?new bo(n.done.addTransform(t,void 0,r,Zp(e)),n.undone,tR(t.mapping.maps),n.prevTime,n.prevComposition):new bo(n.done,n.undone.addTransform(t,void 0,r,Zp(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(l&&l.getMeta("addToHistory")===!1)){let u=t.getMeta("composition"),h=n.prevTime==0||!l&&n.prevComposition!=u&&(n.prevTime<(t.time||0)-r.newGroupDelay||!bG(t,n.prevRanges)),d=l?Yb(n.prevRanges,t.mapping):tR(t.mapping.maps);return new bo(n.done.addTransform(t,h?e.selection.getBookmark():void 0,r,Zp(e)),ti.empty,d,t.time,u??n.prevComposition)}else return(o=t.getMeta("rebased"))?new bo(n.done.rebased(t,o),n.undone.rebased(t,o),Yb(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new bo(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Yb(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function bG(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(t=!0)}),t}function tR(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,i,o,l)=>e.push(o,l));return e}function Yb(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),o=e.map(n[r+1],-1);i<=o&&t.push(i,o)}return t}function _G(n,e,t){let r=Zp(e),i=Ja.get(e).spec.config,o=(t?n.undone:n.done).popEvent(e,r);if(!o)return null;let l=o.selection.resolve(o.transform.doc),u=(t?n.done:n.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),h=new bo(t?u:o.remaining,t?o.remaining:u,null,0,-1);return o.transform.setSelection(l).setMeta(Ja,{redo:t,historyState:h})}let Jb=!1,nR=null;function Zp(n){let e=n.plugins;if(nR!=e){Jb=!1,nR=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Jb=!0;break}}return Jb}const Ja=new on("history"),EG=new on("closeHistory");function TG(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new At({key:Ja,state:{init(){return new bo(ti.empty,ti.empty,null,0,-1)},apply(e,t,r){return vG(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?cD:r=="historyRedo"?uD:null;return!i||!e.editable?!1:(t.preventDefault(),i(e.state,e.dispatch))}}}})}function lD(n,e){return(t,r)=>{let i=Ja.getState(t);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let o=_G(i,t,n);o&&r(e?o.scrollIntoView():o)}return!0}}const cD=lD(!1,!0),uD=lD(!0,!0);Ut.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:n=>n.length,wordCounter:n=>n.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=n=>{const e=n?.node||this.editor.state.doc;if((n?.mode||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=n=>{const e=n?.node||this.editor.state.doc,t=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(t)}},addProseMirrorPlugins(){let n=!1;return[new At({key:new on("characterCount"),appendTransaction:(e,t,r)=>{if(n)return;const i=this.options.limit;if(i==null||i===0){n=!0;return}const o=this.storage.characters({node:r.doc});if(o>i){const l=o-i,u=0,h=l;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const d=r.tr.deleteRange(u,h);return n=!0,d}n=!0},filterTransaction:(e,t)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const i=this.storage.characters({node:t.doc}),o=this.storage.characters({node:e.doc});if(o<=r||i>r&&o>r&&o<=i)return!0;if(i>r&&o>r&&o>i||!e.getMeta("paste"))return!1;const u=e.selection.$head.pos,h=o-r,d=u-h,p=u;return e.deleteRange(d,p),!(this.storage.characters({node:e.doc})>r)}})]}});var SG=Ut.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[sG(this.options)]}});Ut.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new At({key:new on("focus"),props:{decorations:({doc:n,selection:e})=>{const{isEditable:t,isFocused:r}=this.editor,{anchor:i}=e,o=[];if(!t||!r)return St.create(n,[]);let l=0;this.options.mode==="deepest"&&n.descendants((h,d)=>{if(h.isText)return;if(!(i>=d&&i<=d+h.nodeSize-1))return!1;l+=1});let u=0;return n.descendants((h,d)=>{if(h.isText||!(i>=d&&i<=d+h.nodeSize-1))return!1;if(u+=1,this.options.mode==="deepest"&&l-u>0||this.options.mode==="shallowest"&&u>1)return this.options.mode==="deepest";o.push($n.node(d,d+h.nodeSize,{class:this.options.className}))}),St.create(n,o)}}})]}});var wG=Ut.create({name:"gapCursor",addProseMirrorPlugins(){return[cG()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=st(Ee(n,"allowGapCursor",t)))!=null?e:null}}}),rR="placeholder";function AG(n){return n.replace(/\s+/g,"-").replace(/[^a-zA-Z0-9-]/g,"").replace(/^[0-9-]+/,"").replace(/^-+/,"").toLowerCase()}Ut.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",dataAttribute:rR,placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){const n=this.options.dataAttribute?`data-${AG(this.options.dataAttribute)}`:`data-${rR}`;return[new At({key:new on("placeholder"),props:{decorations:({doc:e,selection:t})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=t,o=[];if(!r)return null;const l=this.editor.isEmpty;return e.descendants((u,h)=>{const d=i>=h&&i<=h+u.nodeSize,p=!u.isLeaf&&Yg(u);if((d||!this.options.showOnlyCurrent)&&p){const g=[this.options.emptyNodeClass];l&&g.push(this.options.emptyEditorClass);const b=$n.node(h,h+u.nodeSize,{class:g.join(" "),[n]:typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:u,pos:h,hasAnchor:d}):this.options.placeholder});o.push(b)}return this.options.includeChildren}),St.create(e,o)}}})]}});Ut.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:n,options:e}=this;return[new At({key:new on("selection"),props:{decorations(t){return t.selection.empty||n.isFocused||!n.isEditable||yO(t.selection)||n.view.dragging?null:St.create(t.doc,[$n.inline(t.selection.from,t.selection.to,{class:e.className})])}}})]}});function iR({types:n,node:e}){return e&&Array.isArray(n)&&n.includes(e.type)||e?.type===n}var CG=Ut.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var n;const e=new on(this.name),t=this.options.node||((n=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:n.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(t).includes(i.name));return[new At({key:e,appendTransaction:(i,o,l)=>{const{doc:u,tr:h,schema:d}=l,p=e.getState(l),g=u.content.size,b=d.nodes[t];if(p)return h.insert(g,b.create())},state:{init:(i,o)=>{const l=o.tr.doc.lastChild;return!iR({node:l,types:r})},apply:(i,o)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return o;const l=i.doc.lastChild;return!iR({node:l,types:r})}}})]}}),xG=Ut.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>cD(n,e),redo:()=>({state:n,dispatch:e})=>uD(n,e)}},addProseMirrorPlugins(){return[TG(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),RG=Ut.create({name:"starterKit",addExtensions(){var n,e,t,r;const i=[];return this.options.bold!==!1&&i.push(Z7.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(W7.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(YO.configure(this.options.bulletList)),this.options.code!==!1&&i.push(n$.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(s$.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(o$.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(SG.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(wG.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(a$.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(l$.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(xG.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(c$.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(p$.configure(this.options.italic)),this.options.listItem!==!1&&i.push(JO.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(rD.configure((n=this.options)==null?void 0:n.listKeymap)),this.options.link!==!1&&i.push(U$.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(sD.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(Z$.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(nG.configure(this.options.strike)),this.options.text!==!1&&i.push(rG.configure(this.options.text)),this.options.underline!==!1&&i.push(iG.configure((t=this.options)==null?void 0:t.underline)),this.options.trailingNode!==!1&&i.push(CG.configure((r=this.options)==null?void 0:r.trailingNode)),i}}),kG=RG;function IG(){const{user:n}=ui(),[e,t]=V.useState(""),[r,i]=V.useState(Wp[0]),[o,l]=V.useState(""),[u,h]=V.useState("idle"),[d,p]=V.useState(null),[g,b]=V.useState(null),_=H7({extensions:[kG],content:"",onUpdate:({editor:A})=>l(A.getHTML())});V.useEffect(()=>{const A=window.localStorage.getItem("blogDraft");if(A)try{const R=JSON.parse(A);t(R.title||""),l(R.body||""),R.category&&Wp.includes(R.category)&&i(R.category),R.savedAt&&b(R.savedAt),_&&_.commands.setContent(R.body||"")}catch{window.localStorage.removeItem("blogDraft")}},[_]);const T=async A=>{if(A.preventDefault(),!n){p("Sign in to write a blog post.");return}h("sending"),p(null);try{const R=_?_.getHTML():o,M={title:e.trim(),body:R.trim(),authorId:n.uid,authorName:n.displayName||n.email||"SJMSOM student",category:r,createdAt:Mg()};await Dg(It(ht,"blogs"),M),h("success"),t(""),l(""),window.localStorage.removeItem("blogDraft"),b(null)}catch(R){p(R.message||"Unable to post blog."),h("error")}},x=()=>{const A={title:e,body:_?_.getHTML():o,category:r,savedAt:new Date().toISOString()};window.localStorage.setItem("blogDraft",JSON.stringify(A)),b(A.savedAt)};return S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Write a blog",subtitle:"Share updates, reflections, or recommendations.",accent:"Campus"}),S.jsx(Jo,{children:S.jsxs("form",{className:"auth-form profile-update-form",onSubmit:T,children:[S.jsxs("label",{className:"auth-field",children:["Blog title",S.jsx("input",{type:"text",value:e,onChange:A=>t(A.target.value),placeholder:"Give your blog a hook",required:!0})]}),S.jsxs("label",{className:"auth-field",children:["Category",S.jsx("select",{value:r,onChange:A=>i(A.target.value),className:"category-select",children:Wp.map(A=>S.jsx("option",{value:A,children:A},A))})]}),S.jsxs("label",{className:"auth-field",children:["Body",S.jsx(PO,{editor:_,className:"editor-content"})]}),S.jsxs("div",{className:"editor-toolbar",children:[S.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>_?.chain().focus().toggleBold().run(),children:"Bold"}),S.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>_?.chain().focus().toggleItalic().run(),children:"Italic"}),S.jsx("button",{type:"button",className:"btn-ghost",onClick:()=>_?.chain().focus().toggleBulletList().run(),children:"Bullet"})]}),d?S.jsx("p",{className:"state-pill state-error",children:d}):null,u==="success"?S.jsx("p",{className:"state-pill",children:"Blog posted successfully!"}):null,g?S.jsxs("p",{className:"meta subtle",children:["Draft saved at ",new Date(g).toLocaleTimeString()]}):null,S.jsxs("div",{className:"auth-actions",children:[S.jsx("button",{className:"btn-primary",type:"submit",disabled:u==="sending",children:u==="sending"?"Publishing":"Publish blog"}),S.jsx("button",{type:"button",className:"btn-ghost",onClick:x,disabled:u==="sending",children:"Save draft"})]})]})})]})}const sR=n=>n.map(e=>e.map(t=>`"${String(t||"").replace(/"/g,'""')}"`).join(",")).join(`
`),oR=n=>{if(!n)return"";if(n instanceof Date)return n.toISOString();if(n&&typeof n.toDate=="function")return n.toDate().toISOString();try{return new Date(n).toISOString()}catch{return""}},aR=(n,e,t="text/csv")=>{const r=new Blob([e],{type:t}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=n,o.click(),URL.revokeObjectURL(i)};function NG(){const n=V.useMemo(()=>dn(It(ht,"testimonials"),si("timestamp","desc")),[]),e=V.useMemo(()=>dn(It(ht,"highlights"),si("timestamp","desc")),[]),{data:t,loading:r}=pn(n),{data:i,loading:o}=pn(e),l=V.useMemo(()=>{const T=[...t,...i].map(x=>x.batch||"Unassigned");return Array.from(new Set(T))},[i,t]),[u,h]=V.useState(null),d=V.useMemo(()=>u?t.filter(T=>(T.batch||"Unassigned")===u):t,[u,t]),p=V.useMemo(()=>u?i.filter(T=>(T.batch||"Unassigned")===u):i,[u,i]),g=()=>{const T=[["Question","Writer","Receiver","Timestamp"],...d.map(x=>[x.testimonial,x.writer,x.receiver,oR(x.timestamp)])];aR(`testimonials-${u??"all"}.csv`,sR(T))},b=()=>{const T=[["Caption","Batch","UserId","Timestamp","Tags","Image"],...p.map(x=>[x.caption,x.batch||"Unassigned",x.userId,oR(x.timestamp),(x.tags||[]).join("|"),x.image||x.directlink||""])];aR(`highlights-${u??"all"}.csv`,sR(T))},_=r||o;return S.jsxs("div",{className:"page",children:[S.jsx(kn,{title:"Cultural downloads",subtitle:"Export testimonials and highlights by batch.",accent:"Admin"}),S.jsxs(Jo,{children:[S.jsxs("div",{className:"profiles-toolbar",children:[S.jsxs("div",{className:"search-field",children:[S.jsx("span",{children:"Batch"}),S.jsxs("select",{value:u??"",onChange:T=>h(T.target.value||null),children:[S.jsx("option",{value:"",children:"All batches"}),l.map(T=>S.jsx("option",{value:T,children:T},T))]})]}),S.jsxs("div",{className:"auth-actions",children:[S.jsx("button",{className:"btn-ghost",type:"button",onClick:g,disabled:_,children:"Download testimonials"}),S.jsx("button",{className:"btn-ghost",type:"button",onClick:b,disabled:_,children:"Download highlights"})]})]}),_?S.jsx(Rn,{loading:!0,error:null,emptyLabel:"Preparing export"}):S.jsxs("p",{className:"meta subtle",children:[d.length," testimonials  ",p.length," highlights"]})]})]})}function MG(){return S.jsx(g5,{children:S.jsx(vP,{children:S.jsx(E5,{children:S.jsxs(WL,{children:[S.jsx(tr,{path:"/",element:S.jsx(x5,{})}),S.jsx(tr,{path:"/login",element:S.jsx(R5,{})}),S.jsx(tr,{path:"/highlights",element:S.jsx(Oi,{children:S.jsx(A5,{})})}),S.jsx(tr,{path:"/profiles",element:S.jsx(Oi,{children:S.jsx(N5,{})})}),S.jsx(tr,{path:"/profiles/:id",element:S.jsx(Oi,{children:S.jsx(wN,{})})}),S.jsx(tr,{path:"/make-profile",element:S.jsx(Oi,{children:S.jsx(D5,{})})}),S.jsx(tr,{path:"/write-testimonial",element:S.jsx(Oi,{children:S.jsx(O5,{})})}),S.jsx(tr,{path:"/upload-highlight",element:S.jsx(Oi,{children:S.jsx(M5,{})})}),S.jsx(tr,{path:"/polls",element:S.jsx(Oi,{children:S.jsx(I5,{})})}),S.jsx(tr,{path:"/job-postings",element:S.jsx(Oi,{children:S.jsx(P5,{})})}),S.jsx(tr,{path:"/blogs",element:S.jsx(V5,{})}),S.jsx(tr,{path:"/write-blog",element:S.jsx(Oi,{children:S.jsx(IG,{})})}),S.jsx(tr,{path:"/admin/downloads",element:S.jsx(Oi,{children:S.jsx(NG,{})})})]})})})})}Q2.createRoot(document.getElementById("root")).render(S.jsx(V.StrictMode,{children:S.jsx(MG,{})}));
